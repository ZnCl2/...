var _text='Type your plaintext here. Then click "Encrypt" to encrypt it.';var spadding="iso7816";var block="OFB";var _keySizeInBits=256;var Crypt=new Crypt();function cmdEncryptClick(){var d=new Date().getTime();var a=$("#txtPlaintext").val().trim();var e;var c=document.getElementById("selFunction");if(c.value==="AES"){var g=$("#passphrase").val().trim();if(g.length==0){e=Crypt.AES.encrypt(a)}else{e=Crypt.AES.encrypt(a,g)}}else{if(c.value==="MD5"){e=Crypt.HASH.md5(a)}else{if(c.value==="SHA1"){e=Crypt.HASH.sha1(a)}else{if(c.value==="SHA224"){e=Crypt.HASH.sha224(a)}else{if(c.value==="SHA256"){e=Crypt.HASH.sha256(a)}else{if(c.value==="SHA384"){e=Crypt.HASH.sha384(a)}else{if(c.value==="SHA512"){e=Crypt.HASH.sha512(a)}else{if(c.value==="SHA3"){e=Crypt.HASH.sha3(a)}}}}}}}}$("#txtCiphertext").val(e);var b=new Date().getTime();var f=(b-d);document.getElementById("txtMessages").value="Done. Encryption took "+(f)+" milliseconds."}function cmdVerifyClick(){var d=new Date().getTime();var c=document.getElementById("selFunction");if(c.value==="AES"){var e=$("#txtCiphertext").val().trim();var g=$("#passphrase").val().trim();if(g.length==0){var a=Crypt.AES.decrypt(e)}else{var a=Crypt.AES.decrypt(e,g)}$("#txtVerification").val(a)}var b=new Date().getTime();var f=(b-d);document.getElementById("txtMessages").value="Done. Decryption took "+(f)+" milliseconds."}function generate_salt(b){var c=Crypto.util.randomBytes(b);var a=Crypto.util.bytesToHex(c);return a}function generate_iv(c){var b=Crypto.util.randomBytes(c);var a=Crypto.util.bytesToHex(b);return a}function getMode(a){var b=null;if(block==="CBC"){b=new Crypto.mode.CBC(a)}else{if(block==="ECB"){b=new Crypto.mode.ECB(a)}else{if(block==="CFB"){b=new Crypto.mode.CFB(a)}else{if(block==="OFB"){b=new Crypto.mode.OFB(a)}else{if(block==="CTR"){b=new Crypto.mode.CTR(a)}}}}}return b}function cmdResetFormClick(){if((document.getElementById("txtPlaintext")==null)||(document.getElementById("txtCiphertext")==null)||(document.getElementById("txtVerification")==null)||(document.getElementById("txtMessages")==null)||(document.getElementById("passphrase")==null)){alert("form non valid!");return false}document.getElementById("txtPlaintext").value=_text;document.getElementById("lenPlaintext").innerHTML=_text.length;document.getElementById("txtCiphertext").value="";document.getElementById("txtVerification").value="";document.getElementById("txtMessages").value="";document.getElementById("passphrase").value="";if((document.getElementById("selKeySize")==null)||(document.getElementById("selMode")==null)||(document.getElementById("selPad")==null)){alert("select invalid!");return false}objK=document.getElementById("selKeySize");objK.value=_keySizeInBits;objM=document.getElementById("selMode");objM.value="OFB";objP=document.getElementById("selPad");objP.value="iso7816";spadding="iso7816";block="OFB";_keySize=_keySizeInBits/8;en_time="";de_time="";resetDivAndButton()}function selBlockChange(a){if((a==="OFB")||(a==="CBC")||(a==="CFB")||(a==="CTR")||(a==="ECB")){block=a;return true}return false}function selPadChange(b){spadding=b;var a=null;if(b==="iso7816"){a=Crypto.pad.iso7816}else{if(b==="ansix923"){a=Crypto.pad.ansix923}else{if(b==="iso10126"){a=Crypto.pad.iso10126}else{if(b==="pkcs7"){a=Crypto.pad.pkcs7}else{if(b==="ZeroPadding"){a=Crypto.pad.ZeroPadding}else{if(b==="NoPadding"){a=Crypto.pad.NoPadding}}}}}}return a}function selKeySizeChange(a){a=parseInt(a);if((a==128)||(a==192)||(a==256)){_keySizeInBits=a;_keySize=_keySizeInBits/8;return true}return false}function selFunctionChange(a){if(a==="AES"){$("#option_aes").show();$("#subtable").show();$("#cmdVerify").show();$("#div_txtVerification").show()}else{$("#option_aes").hide();$("#subtable").hide();$("#cmdVerify").hide();$("#div_txtVerification").hide();$("#txtCiphertext").val("");$("#txtVerification").val("")}}function _genPassphrase(){var a=_randomPassphrase(_keySizeInBits);document.getElementById("passphrase").value=a}function _randomPassphrase(c){try{var d=String(rand(10000));var b=_getHash(d,c);return b}catch(a){return -1}}function _getHash(c,e){var d=Crypt.HASH.sha256(c);var b=parseInt(e);if(b==128){var a=128/4;d=troncaNum(d,a)}else{if(b==192){var a=192/4;d=troncaNum(d,a)}else{if(b==256){}}}return d};