<!DOCTYPE html>
<html>

<head>
	<title>Кросспостинг</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" href="../../css/global.css">
</head>

<body>
	
<header>
  <a href="../../index.html"><img src="../../img/logo.png" width="55"></a><br>ChronCache	
</header>
	
<nav>
	<hr>
  <p><a href="../../talk.html">архив</a> <tt>|</tt> <a href="../../help.html">помощь</a> <tt>|</tt> <a href="/1Q9LVNLD1ghusGxpiwjYnVjPsxD5xGTGc7/donate/index.html">донат</a></p>
	<hr>
</nav>

<article>
	
<acide><p>Это резервная страница от 13.02.2019 / <a href="/1F4WVHDpQYxuJL6xEY3EZTYkZds9TTjVHC/?Topic:1_17eKk6mdR7bth2Fi8f74P5JV8AfHsERT4F/">оригинал</a></p></acide>

<section>
	<h1>Кросспостинг</h1><p><b>zerro:</b> <tt>(Oct 21, 2016)</tt><br>Допустим, есть два форума полностью друг другу идентичных но на разных машинах и доступные по разным адресам. Пусть они принадлежат одному человеку. На каждом достаточно высокая скорость постинга. Пусть это будет что-то среднее между форумом и чатом.</p>
	<p>Какую суммарную скорость постинга может обеспечить Infonesy теоретически. Как определяется очередность постов и разрешение конфликтных ситуаций? Используется ли для этого некоторый общий центральный сервер синхронизации, либо это происходит рассылкой сообщений? Что будет, если не все узлы узнали о публикации нового сообщения.</p>
</section>
	
<hr><p>Комментарии:</p>
	
<section class="com">
	<div>
		<p><b>balancer73:</b> <tt>(Oct 22, 2016)</tt><br>В той реализации, которой я сейчас занимаюсь, скорость будет лимитироваться скоростью внешней синхронизации, а внешняя синхронизация у меня сейчас обеспечивается JSON/Markdown-файлами через BTSync. Вообще, годится любой канал, просто такая файловая синхронизация проще в отладке и переживает разрывы связи. Соответственно, типичная задержка синхронизации измеряется десятком-другим секунд, а скорость обработки входящей информации лимитируется скоростью постинга на сам форум (адаптер просто берёт данные из локального каталога и скармливает их форуму).</p>
		<p>Вот с очерёдностью постов есть некоторая концептуальная проблема. Есть два очевидных решения — помещать их в форум по дате написания и помещать их в форум по дате получения. У каждого варианта есть свои плюсы и минусы. Задавался этим вопросом у себя на форуме, хотя обсуждения особого не вышло, народ вообще не шибко пока интересуется этой темой, но решил, всё же, у себя размещать по дате написания. В большинстве случаев разницы практически не будет (задержка, как я отмечал, измеряется секундами), но в случае, например, вливания большой массы старой информации при каких-то объединениях и т.п. топики не будут переполняться старым контентом.</p>
	<p>Конфликтов не должно быть по самой сути протокола. У каждого однажды написанного сообщения есть свой UUID и при размещении на форуме вся привязка к источнику идёт по UUID, а не по внутренним ID форумов. Пока сеть доверенная, UUID все являются задаваемыми нодами, однозначно идентифицирующие ноду и ID сообщения на этой ноде. Например, <code>ru.balancer.board.post.2645427</code></p>
		<p>Центральных узлов нет, связь каждого узла с каждым — их индивидуальное дело. Сейчас у меня каждый форум просто кладёт размещаемые сообщения в каталог, раздаваемый в R/O по BTSync. Те узлы, кто на этот форум подписан, сами тянут эти данные по ключу и загружают к себе. Попутно проверяя на соответствие своим правилам, например, блокируя сообщения от забаненных у себя пользователей и т.п.</p>
		<p>Если, приходит новое сообщение старого топика, который начинался задолго до начала обмена данными и на принимающей ноде этого топика с предыдущими сообщениями нет, то в текущем варианте топик будет просто не полным. Позже не сложно добавить командный обмен, когда в таком случае нода-приёмник может послать запрос ноде-источнику на отсылку всего топика. В принципе, сейчас в теле топиков отсылаются все UUID постингов, так что приёмная нода может знать есть ли у неё все эти постинги.</p>
		<p>Командные потоки тоже отлаживаются, хотя и в другом контексте. Форум у меня, встретив YouTube-ссылку по такому каналу кидает в сеть запрос «сохраните кто-нибудь на всякий пожарный», запрос принимается на домашней машине и утягивает ролик по youtube-dl. Хотя ужасно расточительно по трафику, но удаётся сохранить видео, которые быстро удаляют :)</p>
	</div>
</section>
	
<p class="dr">Oct 21, 2016 / Infonesy.Talks</p>
	
</article>		
		
</body>
</html>