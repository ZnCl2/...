<!DOCTYPE html>
<html>

<head>
	<title>Понимаем ZeroFrame API</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" href="../../css/global.css">
</head>

<body>
	
<header>
  <a href="../../index.html"><img src="../../img/logo.png" width="55"></a><br>ChronCache	
</header>
	
<nav>
	<hr>
  <p><a href="../../blog.html">архив</a> <tt>|</tt> <a href="../../help.html">помощь</a> <tt>|</tt> <a href="/1Q9LVNLD1ghusGxpiwjYnVjPsxD5xGTGc7/donate/index.html">донат</a></p>
	<hr>
</nav>

<article>
	
<acide><p>Это резервная страница от 14.02.2019 / <a href="/1CpGZyfbUBBV5uXUoY653wVoqZFRojbEzd/?Post:3">оригинал</a></p></acide>

<section>
	<h1>Понимаем ZeroFrame API</h1>
	<p>Итак, что же у нас под капотом. Если вы девелопер, хотите замутить свой оригинальный сайт, вас ждет большой сюрприз. Если вы хотите создать что-то отличное от единичной HTML'ки, где будет какой-то контент, то вам нужно погрузиться в то, как работает ZeroNet, как разные пользователи могут оставлять комментарии и прочие ништяки, доступные нам в обычном Интернете.</p>
	<p>Итак, если мы пройдем на <a href="https://zeronet.readthedocs.org/en/latest/site_development/getting_started/" target="_blank">сайт с документацией для девелоперов</a>, то увидим, что нам предлагают встроить в свой сайт нейкий <a href="https://github.com/HelloZeroNet/ZeroHello/blob/master/js/lib/ZeroFrame.coffee" target="_blank">ZeroFrame.coffee</a></p>
	<p>Ну тут я немного сначала расстроился, зачем казалось бы этот CoffeScript, есть ли возможность использовать не его (ведь все это выполняется в браузере, наверняка есть!) и что за чертов ZeroFrame и как его юзать?</p>
	<p>Чуть выдохнув и посмотрел в этот самый <a href="https://github.com/HelloZeroNet/ZeroHello/blob/master/js/lib/ZeroFrame.coffee" target="_blank">скрипт</a>, понял, что ничего сложного в этом нет и на самом деле, это ни что иное, как небольшая обертка над iframe-коммуникациями.</p>
	<p>Что я имею ввиду. Ну во первых, достаточно быстро понимаешь, что любой ZeroNet сайт открывается в iframe основной оболочки. Таким образом ZeroNet делает для сайта песочницу, в рамках которой он вполне может вытворять все, что угодно, однако вне - ничего (ну или я так надеюсь). Но будь у нас в распоряжении один лишь iframe, было бы очень не весело. Здравствуй freenet, статический и беспощадный. Пипл что называется не схавает.</p>
	<p>Но разработчики ZeroNet поступили довольно изящно.</p>
	<p>Дело в том, что современные web-стандарты позволяют контактировать с iframe-родителем. Разумеется iframe-родитель должен об этом знать и ожидать. Так вот, он знает и ожидает. Он предоставляет вам несколько вызовов для того, чтобы вы, как разработчик, могли сделать действительно толковое приложение.</p>
	<p>Стоит правда заметить, что о своем личном backend придется забыть. Оно и понятно, если фронтенд можно раздавать, будто бы это обычный контент торрент-трекера, то как поступать с бэкендом? Как посетители сайта смогут его запустить? Всем на машины тащить каждый существующий интерпретатор и компилятор? Не круто же!</p>
	<p>Так вот, роль backend'а будет выполнять ядро ZeroNet'а. Оно предоставляет нам некоторые особые вызовы, чтобы сделать распределенную децентрализованную базу данных, обращаться к ней и в общем все по взрослому и с динамикой. Однако об этих возможностях мы поговорим позже, а сейчас вернемся к нашему ZeroFrame</p>
	<p>Хотя что тут возвращаться, всего лишь класс с парой функций, самая интересные две строчки в нем</p>
	<code>window.addEventListener("message", @onMessage, false)</code>
	<p>и</p>
	<code>@target.postMessage(message, "*")</code>
	<p>в первой строчке мы начинаем слушать сообщения от оболочки ZeroNet'а (он же родительский iframe), а во второй осуществляется отправка команд родительскому iframe.</p>
	<p>Подробнее о командах мы поговорим в следующей записи.</p>
	<p>И напоследок, мой вариант ZeroFrame, переписанный на ES6<br><a href="https://gist.github.com/GomZik/02e85df5fb7a5eb819cd" target="_blank">тыц</a></p>
</section>	
	
<hr><p>Комментарии:</p>
	
<section class="com">
	<div>
		<p><b>sthetz:</b> <tt>(Feb 11, 2016)</tt><br>Неплохо пишешь, подписался.</p>
	</div>
	<div>
		<p><b>shift:</b> <tt>(Feb 12, 2016)</tt><br>Полезно, на хабр бы вытащить это, не хочешь?</p>
	</div>
	<div>
		<p><b>gomzik:</b> <tt>(Feb 12, 2016)</tt><br><em><b>shift:</b> Полезно, на хабр бы вытащить это...</em><br>Пока рано, будет небольшой цикл статей тут, потом соберу в кучку и можно наверное и на хабр идти.</p>
	</div>
	<div>
		<p><b>shift:</b> <tt>(Feb 12, 2016)</tt><br><em><b>gomzik:</b> Пока рано, будет небольшой цикл статей тут...</em><br>Лучше не цикл а полноценный мануал о создании распределенного сайта с распределенной БД (т.е динамика) и можно публиковатся</p>
	</div>
	<div>
		<p><b>shift:</b> <tt>(Feb 12, 2016)</tt><br>Нашел прикольную фигню если ноль справа сверху потянуть влево =)</p>
	</div>
	<div>
		<p><b>zimm:</b> <tt>(Mar 06, 2016)</tt><br>Тоже на днях вот открыл для себя сие чудо и тут же наткнулся на твой блог, будем изучать :)</p>
	</div>
	<div>
		<p><b>gomzik:</b> <tt>(Mar 06, 2016)</tt><br><em><b>zimm:</b> ... наткнулся на твой блог, будем изучать</em><br>Я тут как-то в последнее время публикаций не делаю, ибо занялся переписыванием ZeroTalk под нужды русского сообщества :) Но как закончу, обязательно наверстаю упущенное. Да и к разработке можно присоедениться, хотя у меня там только немного интерфейса есть.</p>
	</div>
</section>
	
<p class="dr">Feb 11, 2016 / GomZik's Blog</p>
	
</article>		
		
</body>
</html>