var Promise,slice=[].slice;Promise=function(){function t(){this.resolved=!1,this.end_promise=null,this.result=null,this.callbacks=[]}return t.join=function(){var e,r,n,i,s,o,l,h,a;for(a=1<=arguments.length?slice.call(arguments,0):[],s=a.length,e=new Array(s),o=new t,r=function(t){return l.then(function(){var r,n,i,l,h;if(e[t]=Array.prototype.slice.call(arguments),0===--s){for(h=[],n=0,i=(l=o.callbacks).length;n<i;n++)r=l[n],h.push(r.apply(o,e));return h}})},h=n=0,i=a.length;n<i;h=++n)l=a[h],r(h);return o},t.prototype.resolve=function(){var t,e,r,n,i;if(this.resolved)return!1;for(this.resolved=!0,this.data=arguments,arguments.length||(this.data=[!0]),this.result=this.data[0],r=0,n=(i=this.callbacks).length;r<n;r++)t=(e=i[r]).apply(e,this.data);return this.end_promise&&t&&t.then?t.then(function(t){return function(e){return t.end_promise.resolve(e)}}(this)):void 0},t.prototype.fail=function(){return this.resolve(!1)},t.prototype.then=function(e){return!0===this.resolved?e.apply(e,this.data):(this.callbacks.push(e),this.end_promise=new t,this.end_promise)},t}(),window.Promise=Promise;
