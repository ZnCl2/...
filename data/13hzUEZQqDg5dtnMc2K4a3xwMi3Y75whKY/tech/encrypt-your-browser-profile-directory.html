<!DOCTYPE html>
<html lang="en">
  <!-- Beautiful Jekyll | MIT license | Copyright Dean Attali 2016 -->
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Encrypt Your Browser Profile Directory</title>

  <meta name="author" content="Dread Pirate Westley" />

  
  <meta name="description" content="by Miracle Max">
  

  <link rel="alternate" type="application/rss+xml" title="Dread Pirates Society - Lessons from life on board the pirate ship Revenge" href="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/feed.xml" />

  

  

  
    
      <link rel="stylesheet" href="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/css/bootstrap.min.css" />
    
      <link rel="stylesheet" href="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/css/bootstrap-social.css" />
    
      <link rel="stylesheet" href="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/css/main.css" />
    
  

  

  

  

  

    <!-- Facebook OpenGraph tags -->
  

  
  <meta property="og:title" content="Encrypt Your Browser Profile Directory" />
  

   
  <meta property="og:description" content="by Miracle Max">
  


  <meta property="og:type" content="website" />

  
  <meta property="og:url" content="http://127.0.0.1:43110/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/tech/encrypt-your-browser-profile-directory.html" />
  <link rel="canonical" href="http://127.0.0.1:43110/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/tech/encrypt-your-browser-profile-directory.html" />
  

  
  <meta property="og:image" content="http://127.0.0.1:43110/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/img/westley.jpg" />
  
  

  <!-- Twitter summary cards -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <meta name="twitter:creator" content="@" />

  
  <meta name="twitter:title" content="Encrypt Your Browser Profile Directory" />
  

  
  <meta name="twitter:description" content="by Miracle Max">
  

  
  <meta name="twitter:image" content="http://127.0.0.1:43110/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/img/westley.jpg" />
  

</head>


  <body>

    
  
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
        <a class="navbar-brand" href="http://127.0.0.1:43110/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY">Dread Pirates Society</a>
      
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
          <li class="navlinks-container">
            <a class="navlinks-parent" href="javascript:void(0)">The Crew</a>
            <div class="navlinks-children">
              
                
                  
            





<a href="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/westley.html">Westley</a>

                
              
                
                  
            





<a href="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/regulars.html">The Regulars</a>

                
              
            </div>
          </li>
        
        
        
          <li>
            
            





<a href="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/categories/">Categories</a>

          </li>
        
        
        
          <li>
            
            





<a href="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/book-club/">Book Club</a>

          </li>
        
        
        
          <li class="navlinks-container">
            <a class="navlinks-parent" href="javascript:void(0)">Mirrors</a>
            <div class="navlinks-children">
              
                
                  
            





<a href="http://dreadpiratessociety.i2p">i2p</a>

                
              
                
                  
            





<a href="http://127.0.0.1:43110/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY">ZeroNet</a>

                
              
            </div>
          </li>
        
        
      </ul>
    </div>

	
	<div class="avatar-container">
	  <div class="avatar-img-border">
	    <a href="http://127.0.0.1:43110/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY ">
	      <img class="avatar-img" src="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/img/miracleMax.jpg" />
		</a>
	  </div>
	</div>
	

  </div>
</nav>


    <!-- TODO this file has become a mess, refactor it -->





<header class="header-section ">

<div class="intro-header no-img">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <h1>Encrypt Your Browser Profile Directory</h1>
		  
		    
			<h2 class="post-subheading">by Miracle Max</h2>
			
		  
		  
		  
		  <span class="post-meta">Posted on January 3, 2019</span>
		  
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

      <article role="main" class="blog-post">
        <p>For some added security, you can create a separate browser profile for browsing the dark web and then encrypt it using <a href="https://en.wikipedia.org/wiki/EncFS">EncFS</a>. If you use <a href="https://moritzmolch.com/apps/gencfsm/">gnome-encfs-manager</a> and a little bash scripting, you can have the encrypted drive automatically unmounted after you close the browser.</p>

<p>As a play-on-words, I like to call my dark-web profile for the <em>brave</em> browser, <strong>timid</strong>.</p>

<h2 id="summary">Summary</h2>

<p>Assuming you use Linux:</p>

<ul>
  <li>Create a <em>Private</em> directory with two sub-directories
    <ul>
      <li>.encdata (<em>stash directory</em> for encrypted files)</li>
      <li>data (mount-point for the decrypted files)</li>
    </ul>
  </li>
  <li>Set up <em>gnome-encfs-manager</em> to use the folders above and to automatically unmount when idle for 15 minutes</li>
  <li>Mount the share and create a subdirectory for your new browser profile
    <ul>
      <li>e.g. $HOME/Private/data/timid-browser</li>
    </ul>
  </li>
  <li>Fire up your browser with the command-line option to use this new profile
    <ul>
      <li>e.g. For <em>brave-browser</em>: <code class="highlighter-rouge">--user-data-dir=$HOME/Private/data/timid-browser</code></li>
    </ul>
  </li>
  <li>Create a <code class="highlighter-rouge">stayactive</code> file in your new data directory
    <ul>
      <li><code class="highlighter-rouge">touch $HOME/Private/data</code></li>
    </ul>
  </li>
  <li>Put a script like the one below in your path (e.g. <code class="highlighter-rouge">~/bin</code>) so you can easily launch the browser with the new profile</li>
</ul>

<h2 id="the-launching-script">The Launching Script</h2>

<p>Here’s my script to launch <em>brave-browser</em> with my dark-net-only profile.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>
<span class="nv">checkfile</span><span class="o">=</span><span class="nv">$HOME</span>/Private/data/stayactive
<span class="k">if</span> <span class="o">[</span> <span class="nt">-f</span> <span class="nv">$checkfile</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="c"># Start Browser in background</span>
    <span class="c">#/usr/bin/brave-browser --incognito --user-data-dir=$HOME/Private/data/timid-browser --proxy-server="127.0.0.1:8118"</span>
    /usr/bin/brave-browser <span class="nt">--user-data-dir</span><span class="o">=</span><span class="nv">$HOME</span>/Private/data/timid-browser <span class="nt">--proxy-server</span><span class="o">=</span><span class="s2">"127.0.0.1:8118"</span> &amp;
    <span class="nv">pid</span><span class="o">=</span><span class="nv">$!</span>

    <span class="c"># If this script is killed, kill the browser process</span>
    <span class="nb">trap</span> <span class="s2">"kill </span><span class="nv">$pid</span><span class="s2"> 2&gt; /dev/null"</span> EXIT

    <span class="c"># Update Checkfile while browser is running</span>
    <span class="k">while </span><span class="nb">kill</span> <span class="nt">-0</span> <span class="nv">$pid</span> 2&gt; /dev/null
    <span class="k">do
        </span><span class="nb">date</span> <span class="o">&gt;</span> <span class="nv">$checkfile</span>
        <span class="nb">sleep </span>10m
    <span class="k">done</span>

    <span class="c"># Disable the trap on a normal exit.</span>
    <span class="nb">trap</span> - EXIT
<span class="k">else
    </span>gmessage <span class="nt">-title</span> <span class="s2">"Timid Browser"</span> <span class="nt">-timeout</span> 15 <span class="s2">"Encrypted profile directory is not mounted. Mount encrypted drive and try again."</span>
<span class="k">fi</span>
</code></pre></div></div>
<p>This script is easily modified for use with other browsers.</p>

<blockquote>
  <p>I call my dark-web <em>midori</em> profile <strong>absinthe</strong></p>
</blockquote>

<h3 id="what-the-script-does">What the script does</h3>

<p>So this script will first check that the <em>stayactive</em> file is in the data directory. If it isn’t, that means the drive either isn’t mounted, or you forgot to create the file (or maybe deleted it somehow).</p>

<p>If the drive isn’t mounted, we issue a warning; otherwise, we launch the browser with the settings for the custom profile directory and the proxy (if it needs to be specified in the command line).</p>

<p>While the browser is running (<code class="highlighter-rouge">kill -0 $pid</code> just checks that the process exists), the script updates the <em>stayactive</em> file every 10 minutes with the current date and time.</p>

<blockquote>
  <p>I probably could have used <em>touch</em> to update the timestamp on the file, but I wasn’t 100% sure that would be enough for <em>gnome-encfs-manager</em> to see the drive as active.</p>
</blockquote>

<p>Once the browser is closed, the file stops being updated (unless you have another browser-launching script updating the file; as in two browsers running). Fifteen minutes later, <em>gnome-encfs-manager</em> unmounts the encrypted drive.</p>

<h2 id="extending-this-to-tor-browser">Extending this to TOR Browser</h2>

<p>Let’s say you want to store <em>TOR Browser</em> in an encrypted folder.</p>

<p>Tor Browser comes pretty much self-contained; you just extract the files to a directory and run the browser.</p>

<p>It makes sense to just encryt the whole thing, then. You can create an encrypted drive with <em>encfs</em> and extract or move the <em>TOR Browser</em> files to it, and then modify the launching script above to keep the drive mounted until you close the browser.</p>

<p>You could also create a single file to act as an encrypted drive using something such as <a href="https://www.veracrypt.fr/en/Home.html">Veracrypt</a> or <a href="http://freesoftwaremagazine.com/articles/create_encrypted_disk_image_gnulinux/">cryptsetup</a>. These utilities allow you to create essentially an encrypted disk image file that you can mount as if it’s a physical drive.</p>

<blockquote>
  <p>This technique has some advantages over EncFS, but some disadvanteges too. For example, the file for an 8GB disk image has to be 8GB even if you only write 247 MB to it (TOR Browser is about 247 MB). And then if you ever need more space, you’ll have to resize the disk</p>

  <p>I use EncFS already because it works well with Dropbox and Google Drive, so that’s what I’ve chosen to use here.</p>
</blockquote>

<p>Of course, <em>TOR Browser</em> by default, doesn’t store history and cookies and what not, so there isn’t much reason to encrypt it unless you change that behavior.</p>

<h2 id="background">Background</h2>

<p>I got the idea for this when I noticed that the <a href="http://brave.com">Brave browser</a> seemed to be working a lot faster than the last time I tried it out. And not only that, but it was launching much faster than <em>Midori</em>, which is a small browser I like to use. Apparently, despite being small it doesn’t load faster than bigger browsers such as <em>Brave</em> or <em>Opera</em>.</p>

<p>I find <em>Opera</em> to be an excellent browser, but because of <em>Brave’s</em> focus on security and anonymity, I decided to switch to <em>Brave</em> for a while. That meant setting up a script to launch <em>brave</em> with <em>privoxy</em> set as the proxy server. In the linux version of <em>brave</em>, this can only be done through the command line; hence the need for a launching script (unless you want to remember the command-line options and type them in every time).</p>

<p>This got me thinking about how I can also use the command-line options to use a unique profile directory (I also have a custom profile for doing online banking). From there, it was a small step to encrypting that directory for more security (which is something I do with dropbox and google drive).</p>

<p>Along the way, I discovered <em>gnome-encfs-manager’s</em> option to unmount an encrypted drive and I knew that that a little bash scripting could create something really slick.</p>

      </article>

      
        <div class="blog-tags">
          Tags:
          
          
	  <a href="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/tag/encryption/">encryption</a>
          
	  <a href="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/tag/security/">security</a>
          
	  <a href="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/tag/max/">max</a>
          
          
        </div>
      

      

      <ul class="pager blog-pager">
        
        <li class="previous">
          <a href="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/wealth/dividend-riches-screen-2019-01.html" data-toggle="tooltip" data-placement="top" title="Dividend Riches Screen for January, 2019">&larr; Previous Post</a>
        </li>
        
        
      </ul>

      
    </div>
  </div>
</div>


    <footer>
  <div class="container beautiful-jekyll-footer">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
		  
	  
      
		  
          <li>
            <a href="mailto:dreadpiratewestl" title="Email me">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		  
		  
		  
      
      
      
      
      
		  
        </ul>
        <p class="copyright text-muted">
		  
		      
		      <a href="mailto:dreadpiratewestl" title="ZeroMail">Dread Pirate Westley</a>
                      
                  
		  &nbsp;&bull;&nbsp;
		  2019

		  
		  &nbsp;&bull;&nbsp;
		  <a href="http://127.0.0.1:43110/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY">DreadPiratesSociety</a>
		  
	    </p>
	        <!-- Please don't remove this, keep my open source work credited :) -->
		<p class="theme-by text-muted">
		  Theme by
		  <a href="http://deanattali.com/beautiful-jekyll/" target="_blank">beautiful-jekyll</a>
		</p>
      </div>
    </div>
  </div>
</footer>


    






  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script>
      	if (typeof jQuery == 'undefined') {
      	  document.write('<script src="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/js/jquery-1.11.2.min.js"></scr' + 'ipt>');
      	}
      </script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/js/bootstrap.min.js"></script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/13hzUEZQqDg5dtnMc2K4a3xwMi3Y75whKY/js/main.js"></script>
    
  




  
  
  </body>
</html>
