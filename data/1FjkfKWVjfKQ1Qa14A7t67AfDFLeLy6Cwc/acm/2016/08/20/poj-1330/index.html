<!DOCTYPE html>
<html lang="en">
<head>
  <title>POJ-1330 Nearest Common Ancestors - 科学君的不科学博客</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <meta name="author" content="Liu233w" />
  <meta name="keywords" content="acm" />
  <style>
   #ds-thread #ds-reset .ds-comment-body p {color: #ffffff;}
   #ds-thread #ds-reset .ds-comment-body p a {color: #ff0;}
   #ds-thread #ds-reset .ds-comment-body p a:hover {color: #0ff;}
   #disqus_thread a {color: #00ffff;}
  </style>
  <link rel="stylesheet" href="http://liu233w.github.io/media/css/main.css" type="text/css"/>
  <link rel="stylesheet" href="http://liu233w.github.io/media/css/comment.css" type="text/css"/>
  <link rel="Shortcut Icon" href="https://raw.githubusercontent.com/Liu233w/liu233w.github.io/source/avatar.jpg" type="image/x-icon">
</head>

  <body><div class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="http://liu233w.github.io/">科学君的不科学博客</a></h1>
    <p>by 不科学的科学君</p>
    <nav class="site-nav">
      <div class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z" fill="#ffff00"/>
          <path d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z" fill="#ffff00"/>
          <path d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z" fill="#ffff00"/>
        </svg>
      </div>
      <ul class="trigger">
        <li><a href="http://liu233w.github.io/所有文章/">所有文章</a></li>
        <li><a href="http://liu233w.github.io/tags/">按标签索引</a></li>
        <li><a href="http://liu233w.github.io/acm/">Acm</a></li>
        <li><a href="http://liu233w.github.io/blog/">Blog</a></li>
        <li><a href="http://liu233w.github.io/about/">About</a></li>
        <li><a href="https://github.com/liu233w/liu233w.github.io">Github</a></li>
        <li><a href="http://liu233w.github.io/rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="http://www.google.com/search">
      <input type="text" class="field" name="q" id="s" placeholder="Search">
      <input type="hidden" name="as_sitesearch" value="liu233w.github.io">
    </form>
    <img id="avatarid" class="avatar" src="https://raw.githubusercontent.com/Liu233w/liu233w.github.io/source/avatar.jpg" />
  </header>
</div>

<div>
<div class="post">
<h1 class="title">POJ-1330 Nearest Common Ancestors</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org23f7691">题目：</a></li>
<li><a href="#org1cd742f">解析&amp;吐槽：</a></li>
</ul>
</div>
</div>

<div id="outline-container-org23f7691" class="outline-2">
<h2 id="org23f7691">题目：</h2>
<div class="outline-text-2" id="text-org23f7691">
<p class="verse">
&#xa0;Nearest Common Ancestors
Time Limit: 1000MS 	  	Memory Limit: 10000K
Total Submissions: 25094 	  	Accepted: 13049

Description
A rooted tree is a well-known data structure in computer science and engineering. An example is shown below:


In the figure, each node is labeled with an integer from {1, 2,...,16}. Node 8 is the root of the tree. Node x is an ancestor of node y if node x is in the path between the root and node y. For example, node 4 is an ancestor of node 16. Node 10 is also an ancestor of node 16. As a matter of fact, nodes 8, 4, 10, and 16 are the ancestors of node 16. Remember that a node is an ancestor of itself. Nodes 8, 4, 6, and 7 are the ancestors of node 7. A node x is called a common ancestor of two different nodes y and z if node x is an ancestor of node y and an ancestor of node z. Thus, nodes 8 and 4 are the common ancestors of nodes 16 and 7. A node x is called the nearest common ancestor of nodes y and z if x is a common ancestor of y and z and nearest to y and z among their common ancestors. Hence, the nearest common ancestor of nodes 16 and 7 is node 4. Node 4 is nearer to nodes 16 and 7 than node 8 is.

For other examples, the nearest common ancestor of nodes 2 and 3 is node 10, the nearest common ancestor of nodes 6 and 13 is node 8, and the nearest common ancestor of nodes 4 and 12 is node 4. In the last example, if y is an ancestor of z, then the nearest common ancestor of y and z is y.

Write a program that finds the nearest common ancestor of two distinct nodes in a tree.

Input
The input consists of T test cases. The number of test cases (T) is given in the first line of the input file. Each test case starts with a line containing an integer N , the number of nodes in a tree, 2&lt;=N&lt;=10,000. The nodes are labeled with integers 1, 2,..., N. Each of the next N -1 lines contains a pair of integers that represent an edge --the first integer is the parent node of the second integer. Note that a tree with N nodes has exactly N - 1 edges. The last line of each test case contains two distinct integers whose nearest common ancestor is to be computed.

Output
Print exactly one line for each test case. The line should contain the integer that is the nearest common ancestor.

Sample Input

2
16
1 14
8 5
10 16
5 9
4 6
8 4
4 10
1 13
6 15
10 11
6 7
10 2
16 3
8 1
16 12
16 7
5
2 3
3 4
3 1
1 5
3 5

Sample Output

4
3
</p>
</div>
</div>

<div id="outline-container-org1cd742f" class="outline-2">
<h2 id="org1cd742f">解析&amp;吐槽：</h2>
<div class="outline-text-2" id="text-org1cd742f">
<p>
求最近公共祖先的算法。本来应该用转化为 RMQ || tarjan 算法的方法来做的，可惜我不会_(:зゝ∠)_
</p>

<p>
这里用了两种方法来做，第一种是用 dfs 遍历。设两个要找的节点分别为 first 和 second，那么如果有一个节点的子节点中同时包含有 first 和 second，则此节点是它们的一个公共祖先（但不一定是最近的），我们可以利用 dfs 的后序遍历的方法，从下往上处理。dfs 函数返回一个 bool 值，如果此节点包含 first 或者 second 的子节点或者就是这两个节点之一，将会返回 true；不包含
first 和 second 的时候返回 false。依次遍历每一个节点的孩子节点，如果有两个 dfs 返回 true，代表此节点就是我们要找的节点。我通过抛出异常的方式退出了递归链，这只是为了方便而已，工程中可不建议这么写。需要注意的是，dfs 的开头如果发现当前的节点就是 first 或者 second 之一，不能立刻返回 true，必须要递增计数器，否则如果 first 是 second 的祖先的话，就处理不了了。
</p>

<p>
贴上代码：
</p>
<div class="org-src-container">
<pre class="src src-c++"><span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">iostream</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #586e75;">//</span><span style="color: #586e75;">#include &lt;cstdio&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">cstring</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">iomanip</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">limits</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">algorithm</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">numeric</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">string</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">utility</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">cstdlib</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">vector</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">sstream</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">list</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">iterator</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">cmath</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">queue</span><span style="color: #2aa198;">&gt;</span>

<span style="color: #859900; font-weight: bold;">using</span> <span style="color: #859900; font-weight: bold;">namespace</span> <span style="color: #268bd2; font-weight: bold;">std</span>;

<span style="color: #b58900;">int</span> <span style="color: #268bd2;">ans</span>, <span style="color: #268bd2;">first</span>, <span style="color: #268bd2;">second</span>;
<span style="color: #b58900;">vector</span><span style="color: #2aa198;">&lt;</span><span style="color: #b58900;">int</span><span style="color: #2aa198;">&gt;</span> <span style="color: #268bd2;">child</span><span style="color: #2aa198;">[</span><span style="color: #6c71c4;">10010</span><span style="color: #2aa198;">]</span>;
<span style="color: #b58900;">int</span> <span style="color: #268bd2;">pre</span><span style="color: #2aa198;">[</span><span style="color: #6c71c4;">10010</span><span style="color: #2aa198;">]</span>;

<span style="color: #b58900;">bool</span> <span style="color: #268bd2;">dfs</span><span style="color: #2aa198;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">root</span><span style="color: #2aa198;">)</span>
<span style="color: #2aa198;">{</span>
    <span style="color: #b58900;">int</span> <span style="color: #268bd2;">res</span> = <span style="color: #6c71c4;">0</span>;
    <span style="color: #859900; font-weight: bold;">if</span> <span style="color: #b58900;">(</span>root == first || root == second<span style="color: #b58900;">)</span>
        ++res;

    <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span> = <span style="color: #6c71c4;">0</span>;i &lt; child<span style="color: #268bd2;">[</span>root<span style="color: #268bd2;">]</span>.size<span style="color: #268bd2;">()</span>;++i<span style="color: #b58900;">)</span>
    <span style="color: #b58900;">{</span>
        <span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2;">(</span>dfs<span style="color: #6c71c4;">(</span>child<span style="color: #859900;">[</span>root<span style="color: #859900;">][</span>i<span style="color: #859900;">]</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>
            ++res;
        <span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2;">(</span>res &gt;= <span style="color: #6c71c4;">2</span><span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">{</span>
            ans = root;
            <span style="color: #859900; font-weight: bold;">throw</span> <span style="color: #b58900;">int</span><span style="color: #6c71c4;">()</span>;
        <span style="color: #268bd2;">}</span>
    <span style="color: #b58900;">}</span>

    <span style="color: #859900; font-weight: bold;">if</span> <span style="color: #b58900;">(</span>res == <span style="color: #6c71c4;">1</span><span style="color: #b58900;">)</span>
        <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">true</span>;
    <span style="color: #859900; font-weight: bold;">else</span>
        <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #268bd2; font-weight: bold;">false</span>;
<span style="color: #2aa198;">}</span>

<span style="color: #b58900;">int</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span>
<span style="color: #2aa198;">{</span>
    <span style="color: #268bd2; font-weight: bold;">ios</span>::sync_with_stdio<span style="color: #b58900;">(</span><span style="color: #268bd2; font-weight: bold;">false</span><span style="color: #b58900;">)</span>;
    cin.tie<span style="color: #b58900;">(</span><span style="color: #268bd2; font-weight: bold;">NULL</span><span style="color: #b58900;">)</span>;

    <span style="color: #b58900;">int</span> <span style="color: #268bd2;">T</span>;
    cin &gt;&gt; T;
    <span style="color: #859900; font-weight: bold;">while</span> <span style="color: #b58900;">(</span>T--<span style="color: #b58900;">)</span>
    <span style="color: #b58900;">{</span>
        <span style="color: #b58900;">int</span> <span style="color: #268bd2;">n</span>;
        cin &gt;&gt; n;
        <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span> = <span style="color: #6c71c4;">1</span>;i &lt;= n;++i<span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">{</span>
            child<span style="color: #6c71c4;">[</span>i<span style="color: #6c71c4;">]</span>.clear<span style="color: #6c71c4;">()</span>;
            pre<span style="color: #6c71c4;">[</span>i<span style="color: #6c71c4;">]</span> = i;
        <span style="color: #268bd2;">}</span>
        <span style="color: #b58900;">int</span> <span style="color: #268bd2;">m</span> = n - <span style="color: #6c71c4;">1</span>;
        <span style="color: #859900; font-weight: bold;">while</span><span style="color: #268bd2;">(</span>m--<span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">{</span>
            <span style="color: #b58900;">int</span> <span style="color: #268bd2;">a</span>, <span style="color: #268bd2;">b</span>;
            cin &gt;&gt; a &gt;&gt; b;
            child<span style="color: #6c71c4;">[</span>a<span style="color: #6c71c4;">]</span>.push_back<span style="color: #6c71c4;">(</span>b<span style="color: #6c71c4;">)</span>;
            pre<span style="color: #6c71c4;">[</span>b<span style="color: #6c71c4;">]</span> = a;
        <span style="color: #268bd2;">}</span>

        cin &gt;&gt; first &gt;&gt; second;
        ans = <span style="color: #6c71c4;">0</span>;

        <span style="color: #b58900;">int</span> <span style="color: #268bd2;">root</span> = <span style="color: #6c71c4;">1</span>;
        <span style="color: #859900; font-weight: bold;">while</span> <span style="color: #268bd2;">(</span>pre<span style="color: #6c71c4;">[</span>root<span style="color: #6c71c4;">]</span> != root<span style="color: #268bd2;">)</span>
            root = pre<span style="color: #268bd2;">[</span>root<span style="color: #268bd2;">]</span>;

        <span style="color: #859900; font-weight: bold;">try</span> <span style="color: #268bd2;">{</span> dfs<span style="color: #6c71c4;">(</span>root<span style="color: #6c71c4;">)</span>; <span style="color: #268bd2;">}</span>
        <span style="color: #859900; font-weight: bold;">catch</span> <span style="color: #268bd2;">(</span><span style="color: #b58900;">int</span><span style="color: #268bd2;">)</span> <span style="color: #268bd2;">{}</span>

        cout &lt;&lt; ans &lt;&lt; endl;
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
耗时 266ms。
</p>

<p>
第二种方法简单粗暴，使用保存父节点的方式存储树，然后从 first 节点向上回溯到 root，标记所有遇到的节点。然后从 second 向上回溯，找到的第一个被标记的节点就是 LCA。
</p>

<div class="org-src-container">
<pre class="src src-c++"><span style="color: #586e75;">// </span><span style="color: #586e75;">oj.cpp : &#23450;&#20041;&#25511;&#21046;&#21488;&#24212;&#29992;&#31243;&#24207;&#30340;&#20837;&#21475;&#28857;&#12290;</span>
<span style="color: #586e75;">//</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">iostream</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #586e75;">//</span><span style="color: #586e75;">#include &lt;cstdio&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">cstring</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">iomanip</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">limits</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">algorithm</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">numeric</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">string</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">utility</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">cstdlib</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">vector</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">sstream</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">list</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">iterator</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">cmath</span><span style="color: #2aa198;">&gt;</span>
<span style="color: #268bd2;">#include</span> <span style="color: #2aa198;">&lt;</span><span style="color: #2aa198;">queue</span><span style="color: #2aa198;">&gt;</span>

<span style="color: #859900; font-weight: bold;">using</span> <span style="color: #859900; font-weight: bold;">namespace</span> <span style="color: #268bd2; font-weight: bold;">std</span>;

<span style="color: #b58900;">int</span> <span style="color: #268bd2;">pre</span><span style="color: #2aa198;">[</span><span style="color: #6c71c4;">10010</span><span style="color: #2aa198;">]</span>;
<span style="color: #b58900;">bool</span> <span style="color: #268bd2;">visited</span><span style="color: #2aa198;">[</span><span style="color: #6c71c4;">10010</span><span style="color: #2aa198;">]</span>;

<span style="color: #b58900;">int</span> <span style="color: #268bd2;">main</span><span style="color: #2aa198;">()</span>
<span style="color: #2aa198;">{</span>
    <span style="color: #268bd2; font-weight: bold;">ios</span>::sync_with_stdio<span style="color: #b58900;">(</span><span style="color: #268bd2; font-weight: bold;">false</span><span style="color: #b58900;">)</span>;
    cin.tie<span style="color: #b58900;">(</span><span style="color: #268bd2; font-weight: bold;">NULL</span><span style="color: #b58900;">)</span>;

    <span style="color: #b58900;">int</span> <span style="color: #268bd2;">T</span>;
    cin &gt;&gt; T;
    <span style="color: #859900; font-weight: bold;">while</span> <span style="color: #b58900;">(</span>T--<span style="color: #b58900;">)</span>
    <span style="color: #b58900;">{</span>
        <span style="color: #b58900;">int</span> <span style="color: #268bd2;">n</span>;
        cin &gt;&gt; n;
        <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span> = <span style="color: #6c71c4;">1</span>;i &lt;= n;++i<span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">{</span>
            visited<span style="color: #6c71c4;">[</span>i<span style="color: #6c71c4;">]</span> = <span style="color: #268bd2; font-weight: bold;">false</span>;
            pre<span style="color: #6c71c4;">[</span>i<span style="color: #6c71c4;">]</span> = i;
        <span style="color: #268bd2;">}</span>
        <span style="color: #b58900;">int</span> <span style="color: #268bd2;">m</span> = n - <span style="color: #6c71c4;">1</span>;
        <span style="color: #859900; font-weight: bold;">while</span> <span style="color: #268bd2;">(</span>m--<span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">{</span>
            <span style="color: #b58900;">int</span> <span style="color: #268bd2;">a</span>, <span style="color: #268bd2;">b</span>;
            cin &gt;&gt; a &gt;&gt; b;
            pre<span style="color: #6c71c4;">[</span>b<span style="color: #6c71c4;">]</span> = a;
        <span style="color: #268bd2;">}</span>

        <span style="color: #b58900;">int</span> <span style="color: #268bd2;">first</span>, <span style="color: #268bd2;">second</span>;

        cin &gt;&gt; first &gt;&gt; second;

        visited<span style="color: #268bd2;">[</span>first<span style="color: #268bd2;">]</span> = <span style="color: #268bd2; font-weight: bold;">true</span>;
        <span style="color: #859900; font-weight: bold;">while</span> <span style="color: #268bd2;">(</span>pre<span style="color: #6c71c4;">[</span>first<span style="color: #6c71c4;">]</span> != first<span style="color: #268bd2;">)</span>
        <span style="color: #268bd2;">{</span>
            first = pre<span style="color: #6c71c4;">[</span>first<span style="color: #6c71c4;">]</span>;
            visited<span style="color: #6c71c4;">[</span>first<span style="color: #6c71c4;">]</span> = <span style="color: #268bd2; font-weight: bold;">true</span>;
        <span style="color: #268bd2;">}</span>

        <span style="color: #859900; font-weight: bold;">while</span> <span style="color: #268bd2;">(</span>pre<span style="color: #6c71c4;">[</span>second<span style="color: #6c71c4;">]</span> != second &amp;&amp; <span style="color: #b58900; font-weight: bold;">!</span>visited<span style="color: #6c71c4;">[</span>second<span style="color: #6c71c4;">]</span><span style="color: #268bd2;">)</span>
            second = pre<span style="color: #268bd2;">[</span>second<span style="color: #268bd2;">]</span>;

        cout &lt;&lt; second &lt;&lt; endl;
    <span style="color: #b58900;">}</span>
<span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
耗时 125ms。顺带一提，这道题如果把 cin 改成 scanf，时间可以减少到 16ms。
</p>
</div>
</div>

</div>
</div>
<div>
        <div class="post-meta">
            <span title="发布日期" class="post-info">2016-08-20</span>
            <span title="最后修改日期" class="post-info">2017-02-24</span>
            <span title="标签" class="post-info">:<a href="http://liu233w.github.io/tags/acm">acm</a>:</span>
            <span title="作者" class="post-info"><a href="mailto:wwwlsmcom &lt;at&gt; outlook &lt;dot&gt; com">Liu233w</a></span>
        </div>
    <script src="http://liu233w.github.io/media/js/jquery-2.1.3.min.js"></script>
        <section>
            <h1>Comments</h1>
            <div id="comment-wrap">
                    <a class="disqus_label">使用 Disqus 评论</a>
                    <a class="ds-label">使用多说评论</a>
    </ul>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
         //var disqus_developer = 1;
         var preempt_signal=false;
         var disqus_identifier = "/acm/2016/08/20/poj-1330/";
         var disqus_url = "http://liu233w.github.io/acm/2016/08/20/poj-1330/";
         var disqus_shortname = 'liu233w';
         /* * * DON'T EDIT BELOW THIS LINE * * */
         (function() {
             var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
             dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
             $('#disqus_thread').css('display','none');
         })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        <div class="ds-thread"></div>
        <script type="text/javascript">
         var duoshuoQuery = {short_name:'liu233w'};
         (function() {
             var ds = document.createElement('script');
             ds.type = 'text/javascript';ds.async = true;
             ds.src = 'http://static.duoshuo.com/embed.js';
             ds.charset = 'UTF-8';
             (document.getElementsByTagName('head')[0]
           || document.getElementsByTagName('body')[0]).appendChild(ds);
             $('.ds-thread').css('display','block');
         })();
        </script>
    <script>
     /* comments */
     var ego_disqus_thread=$('#disqus_thread');
     var ego_ds_label=$('.ds-thread');
     $('.disqus_label').click(function(){
         ego_disqus_thread.show();
         ego_ds_label.hide();
     });
     $('.ds-label').click(function(){
         ego_disqus_thread.hide();
         ego_ds_label.show();
     });
    </script>
        </section>
    <script src="http://liu233w.github.io/media/js/main.js"></script>
    <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
        <p>
            Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:wwwlsmcom &lt;at&gt; outlook &lt;dot&gt; com">Liu233w</a>
            &nbsp;&nbsp;-&nbsp;&nbsp;
            Powered by <a href="https://github.com/emacs-china/ego" target="_blank">EGO</a><br/>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License" class="center"></a>
            <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
    </div>
            </div>
            <script type="text/javascript"
                    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG">
            </script>
            <script type="text/x-mathjax-config">
             MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });
            </script>
</div>

  </div></body>
</html>
