<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Upvote feature on topics, even more source code realign - 0git - 0git - a list of git repositories on ZeroNet
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="0git.git Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>0git</h1><span class="desc">0git - a list of git repositories on ZeroNet
</span></td></tr><tr class="url"><td></td><td>git clone <a href="http://127.0.0.1:43110/0git.bit/0git.git">http://127.0.0.1:43110/0git.bit/0git.git</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/455b43dbb9053862c25dcccea3463bea822a3350.html">455b43dbb9053862c25dcccea3463bea822a3350</a>
<b>parent</b> <a href="../commit/6bcc0e18cd16ad4ea746bb0c8610c67cc7059ee9.html">6bcc0e18cd16ad4ea746bb0c8610c67cc7059ee9</a>
<b>Author:</b> HelloZeroNet &lt;<a href="mailto:hello@noloop.me">hello@noloop.me</a>&gt;
<b>Date:</b>   Fri Mar  6 02:37:08 +0100

Upvote feature on topics, even more source code realign

<b>Diffstat:</b>
<table><tr><td><a href="#h0">content.json</a></td><td> | </td><td class="num">26</td><td><span class="i">+++++++++++++</span><span class="d">-------------</span></td></tr>
<tr><td><a href="#h1">css/ZeroTalk.css</a></td><td> | </td><td class="num">31</td><td><span class="i">+++++++++++++++++++++++++</span><span class="d">------</span></td></tr>
<tr><td><a href="#h2">css/all.css</a></td><td> | </td><td class="num">34</td><td><span class="i">++++++++++++++++++++++++++++</span><span class="d">------</span></td></tr>
<tr><td><a href="#h3">css/icons.css</a></td><td> | </td><td class="num">5</td><td><span class="i">+++</span><span class="d">--</span></td></tr>
<tr><td><a href="#h4">index.html</a></td><td> | </td><td class="num">24</td><td><span class="i">+++++++++++++++++</span><span class="d">-------</span></td></tr>
<tr><td><a href="#h5">js/InlineEditor.coffee</a></td><td> | </td><td class="num">160</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------------</span></td></tr>
<tr><td><a href="#h6">js/TopicList.coffee</a></td><td> | </td><td class="num">126</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------</span></td></tr>
<tr><td><a href="#h7">js/TopicShow.coffee</a></td><td> | </td><td class="num">24</td><td><span class="i">+++++++++++++++</span><span class="d">---------</span></td></tr>
<tr><td><a href="#h8">js/Users.coffee</a></td><td> | </td><td class="num">59</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td><a href="#h9">js/ZeroTalk.coffee</a></td><td> | </td><td class="num">76</td><td><span class="i">++++++++++++++++++++++++</span><span class="d">----------------------------------------------------</span></td></tr>
<tr><td><a href="#h10">js/all.js</a></td><td> | </td><td class="num">414</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------------</span></td></tr>
<tr><td><a href="#h11">js/utils/Class.coffee</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td><a href="#h12">js/utils/ZeroFrame.coffee</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
</table>13 files changed, 536 insertions(+), 449 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/content.json.html">content.json</a> b/<a href="../file/content.json.html">content.json</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -4,9 +4,9 @@
</a>   &quot;description&quot;: &quot;Decentralized forum demo&quot;, 
   &quot;files&quot;: {
     &quot;css/all.css&quot;: {
<a href="#h0-0-3" id="h0-0-3" class="d">-      &quot;sha1&quot;: &quot;eaee15bceb86b802a3c05cabd4a81ae6885583e3&quot;, 
</a><a href="#h0-0-4" id="h0-0-4" class="d">-      &quot;sha512&quot;: &quot;8d626adb43427910e1c49a05b5a4bbee8bb14c6e6a0de5ced84e9c173470b549&quot;, 
</a><a href="#h0-0-5" id="h0-0-5" class="d">-      &quot;size&quot;: 144524
</a><a href="#h0-0-6" id="h0-0-6" class="i">+      &quot;sha1&quot;: &quot;730b1b4aa774854ebfe91638f42fc60bfbf3cd21&quot;, 
</a><a href="#h0-0-7" id="h0-0-7" class="i">+      &quot;sha512&quot;: &quot;05fbb9b3df7386407f4ddfa803c1dc352aee2e2ff5e3bdff769825abe3bc9b15&quot;, 
</a><a href="#h0-0-8" id="h0-0-8" class="i">+      &quot;size&quot;: 146746
</a>     }, 
     &quot;img/loading.gif&quot;: {
       &quot;sha1&quot;: &quot;a669dbd8a577f6957656fc88ba4960b93fcd23d9&quot;, 
<a href="#h0-1" id="h0-1" class="h">@@ -14,14 +14,14 @@
</a>       &quot;size&quot;: 723
     }, 
     &quot;index.html&quot;: {
<a href="#h0-1-3" id="h0-1-3" class="d">-      &quot;sha1&quot;: &quot;ab17450cfa19878f47d7b3574cc659812b6c381d&quot;, 
</a><a href="#h0-1-4" id="h0-1-4" class="d">-      &quot;sha512&quot;: &quot;6beddd119daee5715957c0cdcdfe090114fc398ba81cc61b802202616576be33&quot;, 
</a><a href="#h0-1-5" id="h0-1-5" class="d">-      &quot;size&quot;: 4690
</a><a href="#h0-1-6" id="h0-1-6" class="i">+      &quot;sha1&quot;: &quot;9f4702c5717eae460d1f159f6d96d95432cb08af&quot;, 
</a><a href="#h0-1-7" id="h0-1-7" class="i">+      &quot;sha512&quot;: &quot;4d8f63e5e511f8513ab7fc0b2d17a5fb08afad83a60b6335f93abf84e51867e1&quot;, 
</a><a href="#h0-1-8" id="h0-1-8" class="i">+      &quot;size&quot;: 5228
</a>     }, 
     &quot;js/all.js&quot;: {
<a href="#h0-1-11" id="h0-1-11" class="d">-      &quot;sha1&quot;: &quot;64ac85351952cc5a24db6fa623cf491a2aa8c329&quot;, 
</a><a href="#h0-1-12" id="h0-1-12" class="d">-      &quot;sha512&quot;: &quot;5c692e5b97b88a3c3a18d3a04044f6fc4536d665725470ce2a5e25f5d3f504bc&quot;, 
</a><a href="#h0-1-13" id="h0-1-13" class="d">-      &quot;size&quot;: 209307
</a><a href="#h0-1-14" id="h0-1-14" class="i">+      &quot;sha1&quot;: &quot;357951c3d9d6d2cfb6bcb5aa8f8e2ef39860d28f&quot;, 
</a><a href="#h0-1-15" id="h0-1-15" class="i">+      &quot;sha512&quot;: &quot;eb9d6d8c011a55375d23de005e5a01c2e821e4dc617fd802382c1730f71cc420&quot;, 
</a><a href="#h0-1-16" id="h0-1-16" class="i">+      &quot;size&quot;: 213799
</a>     }
   }, 
   &quot;ignore&quot;: &quot;((js|css)/(?!all.(js|css))|data/users/.*)&quot;, 
<a href="#h0-2" id="h0-2" class="h">@@ -33,14 +33,14 @@
</a>       &quot;signers_required&quot;: 1
     }
   }, 
<a href="#h0-2-3" id="h0-2-3" class="d">-  &quot;modified&quot;: 1425250514.245, 
</a><a href="#h0-2-4" id="h0-2-4" class="i">+  &quot;modified&quot;: 1425600381.362, 
</a>   &quot;sign&quot;: [
<a href="#h0-2-6" id="h0-2-6" class="d">-    66207809463890109912286135964736777909555344423812490854027447069127926424527, 
</a><a href="#h0-2-7" id="h0-2-7" class="d">-    10233740391543917105537258017234721770504840294794623397728938704813203974703
</a><a href="#h0-2-8" id="h0-2-8" class="i">+    57938245372641132553917984673472983916822006482607054704132354895336542225430, 
</a><a href="#h0-2-9" id="h0-2-9" class="i">+    31030230030819534477684645452975832902723838753678569116002348027140204419951
</a>   ], 
   &quot;signers_sign&quot;: &quot;HKNDz9IUHcBc/l2Jm2Bl70XQDL9HYHhJ2hUdg8AMyunACLgxyXBr7EW1/ME4hGkaFZSFmIxlInmxH+BrMVXbnLw=&quot;, 
   &quot;signs&quot;: {
<a href="#h0-2-13" id="h0-2-13" class="d">-    &quot;1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ&quot;: &quot;HJKBfWTis/3rFdArpoky3VVBp0HArqxZYVYJTtgmcOm6UCSv5Zrdyfzt4bmec1xzpPquHZ2QaQ/EI3wnLQKPAqI=&quot;
</a><a href="#h0-2-14" id="h0-2-14" class="i">+    &quot;1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ&quot;: &quot;G4Mmy34IYrA2l7ZTfkAEAMhwyYDATn55MGj5iqKCUTGtCRl1zynmiXP1khPtupESPh+hatAKpUAzUD6YY+7O6C8=&quot;
</a>   }, 
   &quot;signs_required&quot;: 1, 
   &quot;title&quot;: &quot;ZeroTalk&quot;, 
<b>diff --git a/<a id="h1" href="../file/css/ZeroTalk.css.html">css/ZeroTalk.css</a> b/<a href="../file/css/ZeroTalk.css.html">css/ZeroTalk.css</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -26,7 +26,7 @@ a.nolink:active { border-bottom: none }
</a> .link:hover .icon-link { opacity: 1 }
 .link:active .link-url { border-bottom: 0.1em solid #333 }
 
<a href="#h1-0-3" id="h1-0-3" class="d">-.username { font-weight: bold; color: #666 }
</a><a href="#h1-0-4" id="h1-0-4" class="i">+.user_name { font-weight: bold; color: #666 }
</a> .userbullet { color: #AAA; }
 
 /*.center { margin-left: auto; margin-right: auto; max-width: 800px }*/
<a href="#h1-1" id="h1-1" class="h">@@ -97,7 +97,7 @@ input.text:focus, textarea:focus { border-color: #5FC0EA; outline: none; backgro
</a> .topic .body { line-height: 1.5em; display: block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap }
 .topic .body p { margin: 0px }
 .topic .link { font-size: 13px; color: #AAA; margin-bottom: 7px }
<a href="#h1-1-3" id="h1-1-3" class="d">-.topic .info { font-size: 12px; color: #AAA; margin-bottom: 7px }
</a><a href="#h1-1-4" id="h1-1-4" class="i">+.topic .info { font-size: 12px; color: #AAA; margin-bottom: 7px; margin-top: 10px }
</a> .topic .info span { font-weight: bold }
 .topic .comment-num { font-weight: bold; color: #666; border-bottom: 1px solid #AAA }
 .topic .comment-num:hover { border-bottom: 1px solid #333 }
<a href="#h1-2" id="h1-2" class="h">@@ -111,7 +111,7 @@ input.text:focus, textarea:focus { border-color: #5FC0EA; outline: none; backgro
</a> .topics .body ul { margin: 0px }
 .topics-loading { 
 	background-color: #DB3207; padding: 5px 14px; display: inline-block; color: white; 
<a href="#h1-2-3" id="h1-2-3" class="d">-	position: absolute; left: 50%; top: -30px; transition: all 0.3s 
</a><a href="#h1-2-4" id="h1-2-4" class="i">+	position: absolute; left: 50%; top: -30px; transition: all 0.3s
</a> }
 .topics-loading img { opacity: 0.5; margin-right: 10px }
 
<a href="#h1-3" id="h1-3" class="h">@@ -122,7 +122,7 @@ input.text:focus, textarea:focus { border-color: #5FC0EA; outline: none; backgro
</a> /* Messages */
 .comments { margin-bottom: 60px }
 .comment { background-color: white; padding: 15px 25px; margin: 1px }
<a href="#h1-3-3" id="h1-3-3" class="d">-.comment .username { font-size: 14px }
</a><a href="#h1-3-4" id="h1-3-4" class="i">+.comment .user_name { font-size: 14px }
</a> .comment .added { color: #AAA }
 .comment .info { font-size: 12px; color: #AAA; margin-bottom: 7px }
 .comment .body { line-height: 1.5em }
<a href="#h1-4" id="h1-4" class="h">@@ -137,10 +137,30 @@ input.text:focus, textarea:focus { border-color: #5FC0EA; outline: none; backgro
</a> .comment-new { margin-bottom: 5px }
 .comment-new .button-submit { }
 
<a href="#h1-4-3" id="h1-4-3" class="i">+/* Score */
</a><a href="#h1-4-4" id="h1-4-4" class="i">+.score { 
</a><a href="#h1-4-5" id="h1-4-5" class="i">+	border: 1px solid #eee; margin-right: 5px; padding: 2px 7px; border-radius: 10px; color: #AAA; background-position: left center; 
</a><a href="#h1-4-6" id="h1-4-6" class="i">+	display: inline-block; height: 1.2em; overflow: hidden; vertical-align: -0.5em; line-height: 1em; transition: background-color 0.3s
</a><a href="#h1-4-7" id="h1-4-7" class="i">+}
</a><a href="#h1-4-8" id="h1-4-8" class="i">+.score-active, .score-inactive { transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); display: inline-block }
</a><a href="#h1-4-9" id="h1-4-9" class="i">+.score-active { display: block; margin-top: 2px }
</a><a href="#h1-4-10" id="h1-4-10" class="i">+.score.active { background-color: #2ecc71; color: white }
</a><a href="#h1-4-11" id="h1-4-11" class="i">+.score.loading { 
</a><a href="#h1-4-12" id="h1-4-12" class="i">+	color: rgba(255,255,255,0); background: #2ecc71 url(../img/loading.gif) no-repeat center center; 
</a><a href="#h1-4-13" id="h1-4-13" class="i">+	transition: background 0.5s ease-out; pointer-events: none; border: 1px solid #2ecc71
</a><a href="#h1-4-14" id="h1-4-14" class="i">+}
</a><a href="#h1-4-15" id="h1-4-15" class="i">+
</a><a href="#h1-4-16" id="h1-4-16" class="i">+.score.active .score-inactive, .score:hover .score-inactive { transform: translateY(-1.2em); opacity: 0.5 }
</a><a href="#h1-4-17" id="h1-4-17" class="i">+.score.active .score-active, .score:hover .score-active { transform: translateY(-1.2em) }
</a><a href="#h1-4-18" id="h1-4-18" class="i">+.score:hover, .score.active { border: 1px solid #2ecc71; }
</a><a href="#h1-4-19" id="h1-4-19" class="i">+
</a><a href="#h1-4-20" id="h1-4-20" class="i">+.score:active {  border: 1px solid #AAA !important; transform: translateY(1px) }
</a><a href="#h1-4-21" id="h1-4-21" class="i">+
</a> 
 /* Pages */
 .topics-list, .topics-full, .comments, .comments-new { display: none }
 .page-main .topics-list { display: inherit }
 .page-topic .comments { display: inherit }
 .page-topic .topics-full { display: inherit }
<a href="#h1-4-28" id="h1-4-28" class="d">-.page-topic .comments-new { display: inherit }</a><a href="#h1-4-29" id="h1-4-29" class="d">-
\ No newline at end of file
</a><a href="#h1-4-30" id="h1-4-30" class="i">+.page-topic .comments-new { display: inherit }
</a><a href="#h1-4-31" id="h1-4-31" class="i">+
</a><b>diff --git a/<a id="h2" href="../file/css/all.css.html">css/all.css</a> b/<a href="../file/css/all.css.html">css/all.css</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -73,7 +73,7 @@ a.nolink:active { border-bottom: none }
</a> .link:hover .icon-link { opacity: 1 }
 .link:active .link-url { border-bottom: 0.1em solid #333 }
 
<a href="#h2-0-3" id="h2-0-3" class="d">-.username { font-weight: bold; color: #666 }
</a><a href="#h2-0-4" id="h2-0-4" class="i">+.user_name { font-weight: bold; color: #666 }
</a> .userbullet { color: #AAA; }
 
 /*.center { margin-left: auto; margin-right: auto; max-width: 800px }*/
<a href="#h2-1" id="h2-1" class="h">@@ -144,7 +144,7 @@ input.text:focus, textarea:focus { border-color: #5FC0EA; outline: none; backgro
</a> .topic .body { line-height: 1.5em; display: block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap }
 .topic .body p { margin: 0px }
 .topic .link { font-size: 13px; color: #AAA; margin-bottom: 7px }
<a href="#h2-1-3" id="h2-1-3" class="d">-.topic .info { font-size: 12px; color: #AAA; margin-bottom: 7px }
</a><a href="#h2-1-4" id="h2-1-4" class="i">+.topic .info { font-size: 12px; color: #AAA; margin-bottom: 7px; margin-top: 10px }
</a> .topic .info span { font-weight: bold }
 .topic .comment-num { font-weight: bold; color: #666; border-bottom: 1px solid #AAA }
 .topic .comment-num:hover { border-bottom: 1px solid #333 }
<a href="#h2-2" id="h2-2" class="h">@@ -158,7 +158,7 @@ input.text:focus, textarea:focus { border-color: #5FC0EA; outline: none; backgro
</a> .topics .body ul { margin: 0px }
 .topics-loading { 
 	background-color: #DB3207; padding: 5px 14px; display: inline-block; color: white; 
<a href="#h2-2-3" id="h2-2-3" class="d">-	position: absolute; left: 50%; top: -30px; transition: all 0.3s 
</a><a href="#h2-2-4" id="h2-2-4" class="i">+	position: absolute; left: 50%; top: -30px; transition: all 0.3s
</a> }
 .topics-loading img { opacity: 0.5; margin-right: 10px }
 
<a href="#h2-3" id="h2-3" class="h">@@ -169,7 +169,7 @@ input.text:focus, textarea:focus { border-color: #5FC0EA; outline: none; backgro
</a> /* Messages */
 .comments { margin-bottom: 60px }
 .comment { background-color: white; padding: 15px 25px; margin: 1px }
<a href="#h2-3-3" id="h2-3-3" class="d">-.comment .username { font-size: 14px }
</a><a href="#h2-3-4" id="h2-3-4" class="i">+.comment .user_name { font-size: 14px }
</a> .comment .added { color: #AAA }
 .comment .info { font-size: 12px; color: #AAA; margin-bottom: 7px }
 .comment .body { line-height: 1.5em }
<a href="#h2-4" id="h2-4" class="h">@@ -184,6 +184,25 @@ input.text:focus, textarea:focus { border-color: #5FC0EA; outline: none; backgro
</a> .comment-new { margin-bottom: 5px }
 .comment-new .button-submit { }
 
<a href="#h2-4-3" id="h2-4-3" class="i">+/* Score */
</a><a href="#h2-4-4" id="h2-4-4" class="i">+.score { 
</a><a href="#h2-4-5" id="h2-4-5" class="i">+	border: 1px solid #eee; margin-right: 5px; padding: 2px 7px; -webkit-border-radius: 10px; -moz-border-radius: 10px; -o-border-radius: 10px; -ms-border-radius: 10px; border-radius: 10px ; color: #AAA; background-position: left center; 
</a><a href="#h2-4-6" id="h2-4-6" class="i">+	display: inline-block; height: 1.2em; overflow: hidden; vertical-align: -0.5em; line-height: 1em; transition: background-color 0.3s
</a><a href="#h2-4-7" id="h2-4-7" class="i">+}
</a><a href="#h2-4-8" id="h2-4-8" class="i">+.score-active, .score-inactive { -webkit-transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); -moz-transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); -o-transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); -ms-transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) ; display: inline-block }
</a><a href="#h2-4-9" id="h2-4-9" class="i">+.score-active { display: block; margin-top: 2px }
</a><a href="#h2-4-10" id="h2-4-10" class="i">+.score.active { background-color: #2ecc71; color: white }
</a><a href="#h2-4-11" id="h2-4-11" class="i">+.score.loading { 
</a><a href="#h2-4-12" id="h2-4-12" class="i">+	color: rgba(255,255,255,0); background: #2ecc71 url(../img/loading.gif) no-repeat center center; 
</a><a href="#h2-4-13" id="h2-4-13" class="i">+	-webkit-transition: background 0.5s ease-out; -moz-transition: background 0.5s ease-out; -o-transition: background 0.5s ease-out; -ms-transition: background 0.5s ease-out; transition: background 0.5s ease-out ; pointer-events: none; border: 1px solid #2ecc71
</a><a href="#h2-4-14" id="h2-4-14" class="i">+}
</a><a href="#h2-4-15" id="h2-4-15" class="i">+
</a><a href="#h2-4-16" id="h2-4-16" class="i">+.score.active .score-inactive, .score:hover .score-inactive { -webkit-transform: translateY(-1.2em); -moz-transform: translateY(-1.2em); -o-transform: translateY(-1.2em); -ms-transform: translateY(-1.2em); transform: translateY(-1.2em) ; opacity: 0.5 }
</a><a href="#h2-4-17" id="h2-4-17" class="i">+.score.active .score-active, .score:hover .score-active { -webkit-transform: translateY(-1.2em) ; -moz-transform: translateY(-1.2em) ; -o-transform: translateY(-1.2em) ; -ms-transform: translateY(-1.2em) ; transform: translateY(-1.2em)  }
</a><a href="#h2-4-18" id="h2-4-18" class="i">+.score:hover, .score.active { border: 1px solid #2ecc71; }
</a><a href="#h2-4-19" id="h2-4-19" class="i">+
</a><a href="#h2-4-20" id="h2-4-20" class="i">+.score:active {  border: 1px solid #AAA !important; -webkit-transform: translateY(1px) ; -moz-transform: translateY(1px) ; -o-transform: translateY(1px) ; -ms-transform: translateY(1px) ; transform: translateY(1px)  }
</a><a href="#h2-4-21" id="h2-4-21" class="i">+
</a> 
 /* Pages */
 .topics-list, .topics-full, .comments, .comments-new { display: none }
<a href="#h2-5" id="h2-5" class="h">@@ -193,6 +212,8 @@ input.text:focus, textarea:focus { border-color: #5FC0EA; outline: none; backgro
</a> .page-topic .comments-new { display: inherit }
 
 
<a href="#h2-5-3" id="h2-5-3" class="i">+
</a><a href="#h2-5-4" id="h2-5-4" class="i">+
</a> /* ---- data/1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ/css/fonts.css ---- */
 
 
<a href="#h2-6" id="h2-6" class="h">@@ -254,4 +275,5 @@ input.text:focus, textarea:focus { border-color: #5FC0EA; outline: none; backgro
</a> .icon-topic-link {
 	width: 48px; height: 48px;
 	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAk1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgoKAgICBMTEwAAACUs4MBAAAAMHRSTlMA8YrbZwXzJBH4qVJMFwjOc1kN/O66d0nq4cOzryqRe0I4E7dhgmzJmi/THgJO5IQK5/RpAAACX0lEQVRIx6VW6ZqiMBBMAkQB5UY5VURHR53dev+nWw414XS/3fojHSqx6eojZICjycI4qBCHzFySD1iqiQ8JfqLO7VkzDtDU2S6WFRbbTUoBytYTdM3h8DNTa4w9a34sM/NBHW2Mv7ABI39ZOl5PuQHYiyF/RaEchBlAPG8VBNs+3wGulrzflAzPgP/V5Z+APZnBGTh1/PGhkll8QZe8yjk25AP24Pk7njaMeXYd1gz2K7obKN4c/WdTMz0FzlNfjsNctuyer7egrea7WYfUCL+fjxlYk50c35P0gwL8ehnf4McmYOkU/W5Aj/HztkvU8tkwJyOJXR5cxIKLyliDWqN0M8KtIAakvLM41sQd9yhP4J8IOeAqr5ZwyW5MZIsBrP7jSNe6Tu5IiNWAX8TIFq2kp24NoCQKhsURwW7TGkrP0WohwKDKGcpWS6Ov0BER0aE5lKpyK0BCzsjq8zI5apQzC3q9QVVilwiEtZOsItvwZP8VZV9t6Lv0juQZNxE/yaXhR0dohUwQi0Xpo8teWJ22WA83XIbhM5H2hfMQt1kH0Sa6wrkI5SUDBXmcgeuRjCCESdbgluRkfQTFpSBj8HS/Ouciy3+LihTcJeNwkdQ1iFRaoU3WTSBsArKk7wR4BEA5jI0oUdooyd5N4Ap7RaaRgXXbzGqm/4k2IxqZphbTbNHIRKt8zLC7rZLcI5zJBzBE979r95po9/8yUIRkOtKlbHdqMIRujg1FSQQO6VWMYDs+dstiOHaLUIzd4WBH4raZpLYxt9QEYrDPXB28Sihxdfj/y8nw+lOfPH79+QPyB0NEYoODdgAAAABJRU5ErkJggg==);
<a href="#h2-6-3" id="h2-6-3" class="d">-}</a><a href="#h2-6-4" id="h2-6-4" class="d">-
\ No newline at end of file
</a><a href="#h2-6-5" id="h2-6-5" class="i">+}
</a><a href="#h2-6-6" id="h2-6-6" class="i">+.icon-up { font-weight: normal !important; font-size: 15px; font-family: Tahoma; vertical-align: -4px; padding-right: 5px; display: inline-block; height: 1px; }</a><a href="#h2-6-7" id="h2-6-7" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h3" href="../file/css/icons.css.html">css/icons.css</a> b/<a href="../file/css/icons.css.html">css/icons.css</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -11,4 +11,5 @@
</a> .icon-topic-link {
 	width: 48px; height: 48px;
 	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAk1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgoKAgICBMTEwAAACUs4MBAAAAMHRSTlMA8YrbZwXzJBH4qVJMFwjOc1kN/O66d0nq4cOzryqRe0I4E7dhgmzJmi/THgJO5IQK5/RpAAACX0lEQVRIx6VW6ZqiMBBMAkQB5UY5VURHR53dev+nWw414XS/3fojHSqx6eojZICjycI4qBCHzFySD1iqiQ8JfqLO7VkzDtDU2S6WFRbbTUoBytYTdM3h8DNTa4w9a34sM/NBHW2Mv7ABI39ZOl5PuQHYiyF/RaEchBlAPG8VBNs+3wGulrzflAzPgP/V5Z+APZnBGTh1/PGhkll8QZe8yjk25AP24Pk7njaMeXYd1gz2K7obKN4c/WdTMz0FzlNfjsNctuyer7egrea7WYfUCL+fjxlYk50c35P0gwL8ehnf4McmYOkU/W5Aj/HztkvU8tkwJyOJXR5cxIKLyliDWqN0M8KtIAakvLM41sQd9yhP4J8IOeAqr5ZwyW5MZIsBrP7jSNe6Tu5IiNWAX8TIFq2kp24NoCQKhsURwW7TGkrP0WohwKDKGcpWS6Ov0BER0aE5lKpyK0BCzsjq8zI5apQzC3q9QVVilwiEtZOsItvwZP8VZV9t6Lv0juQZNxE/yaXhR0dohUwQi0Xpo8teWJ22WA83XIbhM5H2hfMQt1kH0Sa6wrkI5SUDBXmcgeuRjCCESdbgluRkfQTFpSBj8HS/Ouciy3+LihTcJeNwkdQ1iFRaoU3WTSBsArKk7wR4BEA5jI0oUdooyd5N4Ap7RaaRgXXbzGqm/4k2IxqZphbTbNHIRKt8zLC7rZLcI5zJBzBE979r95po9/8yUIRkOtKlbHdqMIRujg1FSQQO6VWMYDs+dstiOHaLUIzd4WBH4raZpLYxt9QEYrDPXB28Sihxdfj/y8nw+lOfPH79+QPyB0NEYoODdgAAAABJRU5ErkJggg==);
<a href="#h3-0-3" id="h3-0-3" class="d">-}</a><a href="#h3-0-4" id="h3-0-4" class="d">-
\ No newline at end of file
</a><a href="#h3-0-5" id="h3-0-5" class="i">+}
</a><a href="#h3-0-6" id="h3-0-6" class="i">+.icon-up { font-weight: normal !important; font-size: 15px; font-family: Tahoma; vertical-align: -4px; padding-right: 5px; display: inline-block; height: 1px; }</a><a href="#h3-0-7" id="h3-0-7" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h4" href="../file/index.html.html">index.html</a> b/<a href="../file/index.html.html">index.html</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -44,13 +44,13 @@
</a>  &lt;a class=&apos;logo nolink&apos; href=&quot;?Home&quot;&gt;Zer0&lt;br&gt;Talk&lt;/a&gt;
 
  &lt;div class=&quot;head-user registered&quot; style=&quot;display: none&quot;&gt;
<a href="#h4-0-3" id="h4-0-3" class="d">-  &lt;div&gt;Hello &lt;span class=&quot;userbullet&quot;&gt;&amp;bullet;&lt;/span&gt; &lt;span class=&quot;username username-my&quot;&gt;username&lt;/span&gt;!&lt;/div&gt;
</a><a href="#h4-0-4" id="h4-0-4" class="i">+  &lt;div&gt;Hello &lt;span class=&quot;userbullet&quot;&gt;&amp;bullet;&lt;/span&gt; &lt;span class=&quot;user_name user_name-my&quot;&gt;user_name&lt;/span&gt;!&lt;/div&gt;
</a>   &lt;div class=&quot;size size-used&quot;&gt;&amp;nbsp;&lt;/div&gt;
   &lt;div class=&quot;size&quot;&gt;&amp;nbsp;&lt;/div&gt;
  &lt;/div&gt;
 
  &lt;div class=&quot;head-user visitor&quot; style=&quot;display: none&quot;&gt;
<a href="#h4-0-10" id="h4-0-10" class="d">-  &lt;div&gt;Hello &lt;span class=&quot;userbullet&quot;&gt;&amp;bullet;&lt;/span&gt; &lt;span class=&quot;username username-my&quot;&gt;Visitor&lt;/span&gt;!&lt;/div&gt;
</a><a href="#h4-0-11" id="h4-0-11" class="i">+  &lt;div&gt;Hello &lt;span class=&quot;userbullet&quot;&gt;&amp;bullet;&lt;/span&gt; &lt;span class=&quot;user_name user_name-my&quot;&gt;Visitor&lt;/span&gt;!&lt;/div&gt;
</a>   &lt;a href=&quot;#Sign+up&quot; class=&quot;button button-submit button-small signup&quot;&gt;Request access&lt;/a&gt;
  &lt;/div&gt;
 
<a href="#h4-1" id="h4-1" class="h">@@ -68,7 +68,7 @@
</a>   &lt;a href=&quot;#&quot; class=&quot;image nolink&quot;&gt;&lt;div class=&quot;icon icon-topic-chat&quot;&gt;&lt;/div&gt;&lt;/a&gt;
   &lt;h2 class=&quot;title&quot;&gt;&lt;input type=&quot;text&quot; id=&quot;topic_title&quot; class=&quot;text&quot; placeholder=&quot;Topic title&quot;&gt;&lt;/h2&gt;
   &lt;div class=&quot;body&quot;&gt;&lt;textarea id=&quot;topic_body&quot; placeholder=&quot;Topic description&quot;&gt;&lt;/textarea&gt;&lt;/div&gt;
<a href="#h4-1-3" id="h4-1-3" class="d">-  &lt;div class=&quot;info&quot;&gt;&lt;span class=&quot;username username-my&quot;&gt;username&lt;/span&gt; &amp;#9473; &lt;span class=&quot;added&quot;&gt;new topic&lt;/span&gt;&lt;/div&gt;
</a><a href="#h4-1-4" id="h4-1-4" class="i">+  &lt;div class=&quot;info&quot;&gt;&lt;span class=&quot;user_name user_name-my&quot;&gt;user_name&lt;/span&gt; &amp;#9473; &lt;span class=&quot;added&quot;&gt;new topic&lt;/span&gt;&lt;/div&gt;
</a>   &lt;a href=&quot;#Add+new+topic&quot; class=&quot;button button-submit&quot;&gt;Add new topic&lt;/a&gt;
   &lt;div style=&quot;clear: both&quot;&gt;&lt;/div&gt;
  &lt;/div&gt;
<a href="#h4-2" id="h4-2" class="h">@@ -85,9 +85,13 @@
</a>    &lt;div class=&quot;body&quot;&gt;Body&lt;/div&gt;
    &lt;a href=&quot;#&quot; class=&quot;link&quot;&gt;&lt;div class=&quot;icon icon-link&quot;&gt;&lt;/div&gt; &lt;span class=&quot;link-url&quot;&gt;&lt;/span&gt;&lt;/a&gt;
    &lt;div class=&quot;info&quot;&gt;
<a href="#h4-2-3" id="h4-2-3" class="i">+    &lt;a class=&quot;score&quot; href=&quot;#Upvote&quot;&gt;
</a><a href="#h4-2-4" id="h4-2-4" class="i">+     &lt;span class=&quot;score-inactive&quot;&gt; &lt;span class=&quot;icon-up&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;score-num&quot;&gt;1&lt;/span&gt; &lt;/span&gt;
</a><a href="#h4-2-5" id="h4-2-5" class="i">+     &lt;span class=&quot;score-active&quot;&gt; &lt;span class=&quot;icon-up&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;score-num&quot;&gt;2&lt;/span&gt; &lt;/span&gt;
</a><a href="#h4-2-6" id="h4-2-6" class="i">+    &lt;/a&gt;
</a>     &lt;a href=&quot;#&quot; class=&quot;comment-num&quot;&gt;&lt;/a&gt; 
     &lt;span class=&quot;added&quot;&gt;added&lt;/span&gt;
<a href="#h4-2-9" id="h4-2-9" class="d">-     &amp;#9473; posted by &lt;span class=&quot;username&quot;&gt;username&lt;/span&gt;
</a><a href="#h4-2-10" id="h4-2-10" class="i">+     &amp;#9473; submitted by &lt;span class=&quot;user_name&quot;&gt;user_name&lt;/span&gt;
</a>    &lt;/div&gt;
   &lt;/div&gt;
   &lt;!-- EOF Template: Topic main --&gt;
<a href="#h4-3" id="h4-3" class="h">@@ -105,12 +109,18 @@
</a>   &lt;a href=&quot;#&quot; class=&quot;image nolink&quot;&gt;&lt;div class=&quot;icon icon-topic-chat&quot;&gt;&lt;/div&gt;&lt;/a&gt;
   &lt;h2 class=&quot;title&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;title-link&quot;&gt;Title&lt;/a&gt;&lt;/h2&gt;
   &lt;div class=&quot;body&quot;&gt;Body&lt;/div&gt;
<a href="#h4-3-3" id="h4-3-3" class="d">-  &lt;div class=&quot;info&quot;&gt;&lt;span class=&quot;username&quot;&gt;username&lt;/span&gt; posted &lt;span class=&quot;added&quot;&gt;added&lt;/span&gt;&lt;/div&gt;
</a><a href="#h4-3-4" id="h4-3-4" class="i">+  &lt;div class=&quot;info&quot;&gt;
</a><a href="#h4-3-5" id="h4-3-5" class="i">+    &lt;a class=&quot;score&quot; href=&quot;#Upvote&quot;&gt;
</a><a href="#h4-3-6" id="h4-3-6" class="i">+     &lt;span class=&quot;score-inactive&quot;&gt; &lt;span class=&quot;icon-up&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;score-num&quot;&gt;?&lt;/span&gt; &lt;/span&gt;
</a><a href="#h4-3-7" id="h4-3-7" class="i">+     &lt;span class=&quot;score-active&quot;&gt; &lt;span class=&quot;icon-up&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;score-num&quot;&gt;0&lt;/span&gt; &lt;/span&gt;
</a><a href="#h4-3-8" id="h4-3-8" class="i">+    &lt;/a&gt;
</a><a href="#h4-3-9" id="h4-3-9" class="i">+   &lt;span class=&quot;user_name&quot;&gt;username&lt;/span&gt; posted &lt;span class=&quot;added&quot;&gt;added&lt;/span&gt;
</a><a href="#h4-3-10" id="h4-3-10" class="i">+  &lt;/div&gt;
</a>  &lt;/div&gt;
 
  &lt;!-- New comment --&gt;
  &lt;div class=&quot;comment comment-new&quot;&gt;
<a href="#h4-3-15" id="h4-3-15" class="d">-  &lt;div class=&quot;info&quot;&gt;&lt;span class=&quot;username username-my&quot;&gt;username&lt;/span&gt; &amp;#9473; &lt;span class=&quot;added&quot;&gt;new comment&lt;/span&gt;&lt;/div&gt;
</a><a href="#h4-3-16" id="h4-3-16" class="i">+  &lt;div class=&quot;info&quot;&gt;&lt;span class=&quot;user_name user_name-my&quot;&gt;user_name&lt;/span&gt; &amp;#9473; &lt;span class=&quot;added&quot;&gt;new comment&lt;/span&gt;&lt;/div&gt;
</a>   &lt;div class=&quot;body&quot;&gt;
    &lt;textarea id=&quot;comment_body&quot;&gt;&lt;/textarea&gt;
    &lt;a href=&quot;#Submit+comment&quot; class=&quot;button button-submit&quot;&gt;Submit comment&lt;/a&gt;
<a href="#h4-4" id="h4-4" class="h">@@ -122,7 +132,7 @@
</a> 
   &lt;!-- Template: Comment --&gt;
   &lt;div class=&quot;comment template&quot;&gt;
<a href="#h4-4-3" id="h4-4-3" class="d">-   &lt;div class=&quot;info&quot;&gt;&lt;span class=&quot;username&quot;&gt;username&lt;/span&gt; &amp;#9473; &lt;a class=&quot;added&quot; href=&quot;#Reply&quot; title=&quot;Reply&quot;&gt;added&lt;/a&gt;&lt;/div&gt;
</a><a href="#h4-4-4" id="h4-4-4" class="i">+   &lt;div class=&quot;info&quot;&gt;&lt;span class=&quot;user_name&quot;&gt;user_name&lt;/span&gt; &amp;#9473; &lt;a class=&quot;added&quot; href=&quot;#Reply&quot; title=&quot;Reply&quot;&gt;added&lt;/a&gt;&lt;/div&gt;
</a>    &lt;div class=&quot;body&quot;&gt;Body&lt;/div&gt;
   &lt;/div&gt;
   &lt;!-- EOF Template: Comment --&gt;
<b>diff --git a/<a id="h5" href="../file/js/InlineEditor.coffee.html">js/InlineEditor.coffee</a> b/<a href="../file/js/InlineEditor.coffee.html">js/InlineEditor.coffee</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -1,159 +0,0 @@
</a><a href="#h5-0-0" id="h5-0-0" class="d">-class InlineEditor
</a><a href="#h5-0-1" id="h5-0-1" class="d">-	constructor: (@elem, @getContent, @saveContent, @getObject) -&gt;
</a><a href="#h5-0-2" id="h5-0-2" class="d">-		@edit_button = $(&quot;&lt;a href=&apos;#Edit&apos; class=&apos;editable-edit&apos;&gt;§&lt;/a&gt;&quot;)
</a><a href="#h5-0-3" id="h5-0-3" class="d">-		@edit_button.on &quot;click&quot;, @startEdit
</a><a href="#h5-0-4" id="h5-0-4" class="d">-		@elem.addClass(&quot;editable&quot;).before(@edit_button)
</a><a href="#h5-0-5" id="h5-0-5" class="d">-		@editor = null
</a><a href="#h5-0-6" id="h5-0-6" class="d">-		@elem.on &quot;mouseenter&quot;, (e) =&gt;
</a><a href="#h5-0-7" id="h5-0-7" class="d">-			@edit_button.css(&quot;opacity&quot;, &quot;1&quot;)
</a><a href="#h5-0-8" id="h5-0-8" class="d">-			# Keep in display
</a><a href="#h5-0-9" id="h5-0-9" class="d">-			scrolltop = $(window).scrollTop()
</a><a href="#h5-0-10" id="h5-0-10" class="d">-			top = @edit_button.offset().top-parseInt(@edit_button.css(&quot;margin-top&quot;))
</a><a href="#h5-0-11" id="h5-0-11" class="d">-			if scrolltop &gt; top
</a><a href="#h5-0-12" id="h5-0-12" class="d">-				@edit_button.css(&quot;margin-top&quot;, scrolltop-top+e.clientY-20)
</a><a href="#h5-0-13" id="h5-0-13" class="d">-			else
</a><a href="#h5-0-14" id="h5-0-14" class="d">-				@edit_button.css(&quot;margin-top&quot;, &quot;&quot;)
</a><a href="#h5-0-15" id="h5-0-15" class="d">-		@elem.on &quot;mouseleave&quot;, =&gt;
</a><a href="#h5-0-16" id="h5-0-16" class="d">-			@edit_button.css(&quot;opacity&quot;, &quot;&quot;)
</a><a href="#h5-0-17" id="h5-0-17" class="d">-
</a><a href="#h5-0-18" id="h5-0-18" class="d">-		if @elem.is(&quot;:hover&quot;) then @elem.trigger &quot;mouseenter&quot;
</a><a href="#h5-0-19" id="h5-0-19" class="d">-
</a><a href="#h5-0-20" id="h5-0-20" class="d">-
</a><a href="#h5-0-21" id="h5-0-21" class="d">-	startEdit: =&gt;
</a><a href="#h5-0-22" id="h5-0-22" class="d">-		@content_before = @elem.html() # Save current to restore on cancel
</a><a href="#h5-0-23" id="h5-0-23" class="d">-
</a><a href="#h5-0-24" id="h5-0-24" class="d">-		@editor = $(&quot;&lt;textarea class=&apos;editor&apos;&gt;&lt;/textarea&gt;&quot;)
</a><a href="#h5-0-25" id="h5-0-25" class="d">-		@editor.css(&quot;outline&quot;, &quot;10000px solid rgba(255,255,255,0)&quot;).cssLater(&quot;transition&quot;, &quot;outline 0.3s&quot;, 5).cssLater(&quot;outline&quot;, &quot;10000px solid rgba(255,255,255,0.9)&quot;, 10) # Animate other elements fadeout
</a><a href="#h5-0-26" id="h5-0-26" class="d">-		@editor.val @getContent(@elem, &quot;raw&quot;)
</a><a href="#h5-0-27" id="h5-0-27" class="d">-		@elem.after(@editor)
</a><a href="#h5-0-28" id="h5-0-28" class="d">-
</a><a href="#h5-0-29" id="h5-0-29" class="d">-		@elem.html [1..50].join(&quot;fill the width&quot;) # To make sure we span the editor as far as we can
</a><a href="#h5-0-30" id="h5-0-30" class="d">-		@copyStyle(@elem, @editor) # Copy elem style to editor
</a><a href="#h5-0-31" id="h5-0-31" class="d">-		@elem.html @content_before # Restore content
</a><a href="#h5-0-32" id="h5-0-32" class="d">-
</a><a href="#h5-0-33" id="h5-0-33" class="d">-		
</a><a href="#h5-0-34" id="h5-0-34" class="d">-		@autoExpand(@editor) # Set editor to autoexpand
</a><a href="#h5-0-35" id="h5-0-35" class="d">-		@elem.css(&quot;display&quot;, &quot;none&quot;) # Hide elem
</a><a href="#h5-0-36" id="h5-0-36" class="d">-
</a><a href="#h5-0-37" id="h5-0-37" class="d">-		if $(window).scrollTop() == 0 # Focus textfield if scroll on top
</a><a href="#h5-0-38" id="h5-0-38" class="d">-			@editor[0].selectionEnd = 0
</a><a href="#h5-0-39" id="h5-0-39" class="d">-			@editor.focus()
</a><a href="#h5-0-40" id="h5-0-40" class="d">-
</a><a href="#h5-0-41" id="h5-0-41" class="d">-		$(&quot;.editable-edit&quot;).css(&quot;display&quot;, &quot;none&quot;) # Hide all edit button until its not finished
</a><a href="#h5-0-42" id="h5-0-42" class="d">-
</a><a href="#h5-0-43" id="h5-0-43" class="d">-		$(&quot;.editbar&quot;).css(&quot;display&quot;, &quot;inline-block&quot;).addClassLater(&quot;visible&quot;, 10) 
</a><a href="#h5-0-44" id="h5-0-44" class="d">-		$(&quot;.publishbar&quot;).css(&quot;opacity&quot;, 0) # Hide publishbar
</a><a href="#h5-0-45" id="h5-0-45" class="d">-		$(&quot;.editbar .object&quot;).text @getObject(@elem).data(&quot;object&quot;)+&quot;.&quot;+@elem.data(&quot;editable&quot;)
</a><a href="#h5-0-46" id="h5-0-46" class="d">-		$(&quot;.editbar .button&quot;).removeClass(&quot;loading&quot;)
</a><a href="#h5-0-47" id="h5-0-47" class="d">-
</a><a href="#h5-0-48" id="h5-0-48" class="d">-		$(&quot;.editbar .save&quot;).off(&quot;click&quot;).on &quot;click&quot;, @saveEdit
</a><a href="#h5-0-49" id="h5-0-49" class="d">-		$(&quot;.editbar .delete&quot;).off(&quot;click&quot;).on &quot;click&quot;, @deleteObject
</a><a href="#h5-0-50" id="h5-0-50" class="d">-		$(&quot;.editbar .cancel&quot;).off(&quot;click&quot;).on &quot;click&quot;, @cancelEdit
</a><a href="#h5-0-51" id="h5-0-51" class="d">-
</a><a href="#h5-0-52" id="h5-0-52" class="d">-		# Deletable button show/hide
</a><a href="#h5-0-53" id="h5-0-53" class="d">-		if @getObject(@elem).data(&quot;deletable&quot;)
</a><a href="#h5-0-54" id="h5-0-54" class="d">-			$(&quot;.editbar .delete&quot;).css(&quot;display&quot;, &quot;&quot;).html(&quot;Delete &quot;+@getObject(@elem).data(&quot;object&quot;).split(&quot;:&quot;)[0])
</a><a href="#h5-0-55" id="h5-0-55" class="d">-		else
</a><a href="#h5-0-56" id="h5-0-56" class="d">-			$(&quot;.editbar .delete&quot;).css(&quot;display&quot;, &quot;none&quot;)
</a><a href="#h5-0-57" id="h5-0-57" class="d">-
</a><a href="#h5-0-58" id="h5-0-58" class="d">-		window.onbeforeunload = -&gt;
</a><a href="#h5-0-59" id="h5-0-59" class="d">-			return &apos;Your unsaved blog changes will be lost!&apos;
</a><a href="#h5-0-60" id="h5-0-60" class="d">-		
</a><a href="#h5-0-61" id="h5-0-61" class="d">-		return false
</a><a href="#h5-0-62" id="h5-0-62" class="d">-
</a><a href="#h5-0-63" id="h5-0-63" class="d">-
</a><a href="#h5-0-64" id="h5-0-64" class="d">-	stopEdit: =&gt;
</a><a href="#h5-0-65" id="h5-0-65" class="d">-		@editor.remove()
</a><a href="#h5-0-66" id="h5-0-66" class="d">-		@editor = null
</a><a href="#h5-0-67" id="h5-0-67" class="d">-		@elem.css(&quot;display&quot;, &quot;&quot;)
</a><a href="#h5-0-68" id="h5-0-68" class="d">-
</a><a href="#h5-0-69" id="h5-0-69" class="d">-		$(&quot;.editable-edit&quot;).css(&quot;display&quot;, &quot;&quot;) # Show edit buttons
</a><a href="#h5-0-70" id="h5-0-70" class="d">-
</a><a href="#h5-0-71" id="h5-0-71" class="d">-		$(&quot;.editbar&quot;).cssLater(&quot;display&quot;, &quot;none&quot;, 1000).removeClass(&quot;visible&quot;) # Hide editbar
</a><a href="#h5-0-72" id="h5-0-72" class="d">-		$(&quot;.publishbar&quot;).css(&quot;opacity&quot;, 1) # Show publishbar
</a><a href="#h5-0-73" id="h5-0-73" class="d">-
</a><a href="#h5-0-74" id="h5-0-74" class="d">-		window.onbeforeunload = null
</a><a href="#h5-0-75" id="h5-0-75" class="d">-
</a><a href="#h5-0-76" id="h5-0-76" class="d">-
</a><a href="#h5-0-77" id="h5-0-77" class="d">-	saveEdit: =&gt;
</a><a href="#h5-0-78" id="h5-0-78" class="d">-		content = @editor.val()
</a><a href="#h5-0-79" id="h5-0-79" class="d">-		$(&quot;.editbar .save&quot;).addClass(&quot;loading&quot;)
</a><a href="#h5-0-80" id="h5-0-80" class="d">-		@saveContent @elem, content, (content_html) =&gt;
</a><a href="#h5-0-81" id="h5-0-81" class="d">-			if content_html # File write ok
</a><a href="#h5-0-82" id="h5-0-82" class="d">-				$(&quot;.editbar .save&quot;).removeClass(&quot;loading&quot;)
</a><a href="#h5-0-83" id="h5-0-83" class="d">-				@stopEdit()
</a><a href="#h5-0-84" id="h5-0-84" class="d">-				if typeof content_html == &quot;string&quot; # Returned the new content
</a><a href="#h5-0-85" id="h5-0-85" class="d">-					@elem.html content_html
</a><a href="#h5-0-86" id="h5-0-86" class="d">-
</a><a href="#h5-0-87" id="h5-0-87" class="d">-				$(&apos;pre code&apos;).each (i, block) -&gt; # Higlight code blocks
</a><a href="#h5-0-88" id="h5-0-88" class="d">-					hljs.highlightBlock(block)
</a><a href="#h5-0-89" id="h5-0-89" class="d">-			else
</a><a href="#h5-0-90" id="h5-0-90" class="d">-				$(&quot;.editbar .save&quot;).removeClass(&quot;loading&quot;)
</a><a href="#h5-0-91" id="h5-0-91" class="d">-
</a><a href="#h5-0-92" id="h5-0-92" class="d">-		return false
</a><a href="#h5-0-93" id="h5-0-93" class="d">-
</a><a href="#h5-0-94" id="h5-0-94" class="d">-
</a><a href="#h5-0-95" id="h5-0-95" class="d">-	deleteObject: =&gt;
</a><a href="#h5-0-96" id="h5-0-96" class="d">-		object_type = @getObject(@elem).data(&quot;object&quot;).split(&quot;:&quot;)[0]
</a><a href="#h5-0-97" id="h5-0-97" class="d">-		window.zero_talk.cmd &quot;wrapperConfirm&quot;, [&quot;Are you sure you sure to delete this #{object_type}?&quot;, &quot;Delete&quot;], (confirmed) =&gt; 
</a><a href="#h5-0-98" id="h5-0-98" class="d">-			$(&quot;.editbar .delete&quot;).addClass(&quot;loading&quot;)
</a><a href="#h5-0-99" id="h5-0-99" class="d">-			@saveContent @getObject(@elem), null, =&gt;
</a><a href="#h5-0-100" id="h5-0-100" class="d">-				@stopEdit()
</a><a href="#h5-0-101" id="h5-0-101" class="d">-		return false
</a><a href="#h5-0-102" id="h5-0-102" class="d">-
</a><a href="#h5-0-103" id="h5-0-103" class="d">-
</a><a href="#h5-0-104" id="h5-0-104" class="d">-	cancelEdit: =&gt;
</a><a href="#h5-0-105" id="h5-0-105" class="d">-		@stopEdit()
</a><a href="#h5-0-106" id="h5-0-106" class="d">-		@elem.html @content_before
</a><a href="#h5-0-107" id="h5-0-107" class="d">-
</a><a href="#h5-0-108" id="h5-0-108" class="d">-		$(&apos;pre code&apos;).each (i, block) -&gt; # Higlight code blocks
</a><a href="#h5-0-109" id="h5-0-109" class="d">-			hljs.highlightBlock(block)
</a><a href="#h5-0-110" id="h5-0-110" class="d">-
</a><a href="#h5-0-111" id="h5-0-111" class="d">-		return false
</a><a href="#h5-0-112" id="h5-0-112" class="d">-
</a><a href="#h5-0-113" id="h5-0-113" class="d">-
</a><a href="#h5-0-114" id="h5-0-114" class="d">-	copyStyle: (elem_from, elem_to) -&gt;
</a><a href="#h5-0-115" id="h5-0-115" class="d">-		elem_to.addClass(elem_from[0].className)
</a><a href="#h5-0-116" id="h5-0-116" class="d">-		from_style = getComputedStyle(elem_from[0])
</a><a href="#h5-0-117" id="h5-0-117" class="d">-
</a><a href="#h5-0-118" id="h5-0-118" class="d">-		elem_to.css
</a><a href="#h5-0-119" id="h5-0-119" class="d">-			fontFamily: 	from_style.fontFamily
</a><a href="#h5-0-120" id="h5-0-120" class="d">-			fontSize: 		from_style.fontSize
</a><a href="#h5-0-121" id="h5-0-121" class="d">-			fontWeight: 	from_style.fontWeight
</a><a href="#h5-0-122" id="h5-0-122" class="d">-			marginTop: 		from_style.marginTop
</a><a href="#h5-0-123" id="h5-0-123" class="d">-			marginRight: 	from_style.marginRight
</a><a href="#h5-0-124" id="h5-0-124" class="d">-			marginBottom: 	from_style.marginBottom
</a><a href="#h5-0-125" id="h5-0-125" class="d">-			marginLeft: 	from_style.marginLeft
</a><a href="#h5-0-126" id="h5-0-126" class="d">-			paddingTop: 	from_style.paddingTop
</a><a href="#h5-0-127" id="h5-0-127" class="d">-			paddingRight: 	from_style.paddingRight
</a><a href="#h5-0-128" id="h5-0-128" class="d">-			paddingBottom: 	from_style.paddingBottom
</a><a href="#h5-0-129" id="h5-0-129" class="d">-			paddingLeft: 	from_style.paddingLeft
</a><a href="#h5-0-130" id="h5-0-130" class="d">-			lineHeight: 	from_style.lineHeight
</a><a href="#h5-0-131" id="h5-0-131" class="d">-			textAlign: 		from_style.textAlign
</a><a href="#h5-0-132" id="h5-0-132" class="d">-			color: 			from_style.color
</a><a href="#h5-0-133" id="h5-0-133" class="d">-			letterSpacing: 	from_style.letterSpacing
</a><a href="#h5-0-134" id="h5-0-134" class="d">-
</a><a href="#h5-0-135" id="h5-0-135" class="d">-		if elem_from.innerWidth() &lt; 1000 # inline elems fix
</a><a href="#h5-0-136" id="h5-0-136" class="d">-			elem_to.css &quot;minWidth&quot;, elem_from.innerWidth()
</a><a href="#h5-0-137" id="h5-0-137" class="d">-
</a><a href="#h5-0-138" id="h5-0-138" class="d">-
</a><a href="#h5-0-139" id="h5-0-139" class="d">-	autoExpand: (elem) -&gt;
</a><a href="#h5-0-140" id="h5-0-140" class="d">-		editor = elem[0]
</a><a href="#h5-0-141" id="h5-0-141" class="d">-		# Autoexpand
</a><a href="#h5-0-142" id="h5-0-142" class="d">-		elem.height(1)
</a><a href="#h5-0-143" id="h5-0-143" class="d">-		elem.on &quot;input&quot;, -&gt;
</a><a href="#h5-0-144" id="h5-0-144" class="d">-			if editor.scrollHeight &gt; elem.height()
</a><a href="#h5-0-145" id="h5-0-145" class="d">-				elem.height(1).height(editor.scrollHeight + parseFloat(elem.css(&quot;borderTopWidth&quot;)) + parseFloat(elem.css(&quot;borderBottomWidth&quot;)))
</a><a href="#h5-0-146" id="h5-0-146" class="d">-		elem.trigger &quot;input&quot;
</a><a href="#h5-0-147" id="h5-0-147" class="d">-
</a><a href="#h5-0-148" id="h5-0-148" class="d">-		# Tab key support
</a><a href="#h5-0-149" id="h5-0-149" class="d">-		elem.on &apos;keydown&apos;, (e) -&gt;
</a><a href="#h5-0-150" id="h5-0-150" class="d">-			if e.which == 9
</a><a href="#h5-0-151" id="h5-0-151" class="d">-				e.preventDefault()
</a><a href="#h5-0-152" id="h5-0-152" class="d">-				s = this.selectionStart
</a><a href="#h5-0-153" id="h5-0-153" class="d">-				val = elem.val()
</a><a href="#h5-0-154" id="h5-0-154" class="d">-				elem.val(val.substring(0,this.selectionStart) + &quot;\t&quot; + val.substring(this.selectionEnd))
</a><a href="#h5-0-155" id="h5-0-155" class="d">-				this.selectionEnd = s+1; 
</a><a href="#h5-0-156" id="h5-0-156" class="d">-
</a><a href="#h5-0-157" id="h5-0-157" class="d">- 
</a><a href="#h5-0-158" id="h5-0-158" class="d">-window.InlineEditor = InlineEditor</a><a href="#h5-0-159" id="h5-0-159" class="d">-
\ No newline at end of file
</a><b>diff --git a/<a id="h6" href="../file/js/TopicList.coffee.html">js/TopicList.coffee</a> b/<a href="../file/js/TopicList.coffee.html">js/TopicList.coffee</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -15,33 +15,30 @@ class TopicList extends Class
</a> 
 		# Create new topic
 		$(&quot;.topic-new .button-submit&quot;).on &quot;click&quot;, =&gt;
<a href="#h6-0-3" id="h6-0-3" class="d">-			if Page.user_name_db[Page.site_info.auth_address] # Check if user exits
</a><a href="#h6-0-4" id="h6-0-4" class="d">-				@buttonCreateTopic()
</a><a href="#h6-0-5" id="h6-0-5" class="i">+			if Users.to_name[Users.my_address] # Check if user exits
</a><a href="#h6-0-6" id="h6-0-6" class="i">+				@submitCreateTopic()
</a> 			else
 				Page.cmd &quot;wrapperNotification&quot;, [&quot;info&quot;, &quot;Please, request access before posting.&quot;]
 			return false
 
 
 	loadTopics: (type=&quot;normal&quot;, cb=false) -&gt;
<a href="#h6-0-13" id="h6-0-13" class="d">-		@logStart &quot;Loadtopics&quot;
</a><a href="#h6-0-14" id="h6-0-14" class="i">+		@logStart &quot;Load topics...&quot;
</a> 		Page.cmd &quot;fileQuery&quot;, [&quot;data/users/*/data.json&quot;, &quot;topics&quot;], (topics) =&gt;
 			topics.sort (a, b) -&gt; # Sort by date
 				return a.added - b.added
 			last_elem = null
 
 			for topic in topics
<a href="#h6-0-21" id="h6-0-21" class="d">-				topic_address = topic.topic_id + &quot;_&quot; + Page.user_id_db[topic.inner_path]
</a><a href="#h6-0-22" id="h6-0-22" class="i">+				topic_address = topic.topic_id + &quot;_&quot; + Users.to_id[topic.inner_path]
</a> 				elem = $(&quot;#topic_&quot;+topic_address)
 				if elem.length == 0 # Create if not exits yet
 					elem = $(&quot;.topics-list .topic.template&quot;).clone().removeClass(&quot;template&quot;).attr(&quot;id&quot;, &quot;topic_&quot;+topic_address)
 					if type != &quot;noanim&quot;
 						elem.cssSlideDown()
<a href="#h6-0-28" id="h6-0-28" class="i">+					elem.appendTo(&quot;.topics&quot;)
</a> 				@applyTopicData(elem, topic)
 
<a href="#h6-0-31" id="h6-0-31" class="d">-				if last_elem # Add after last elem
</a><a href="#h6-0-32" id="h6-0-32" class="d">-					last_elem.after(elem)
</a><a href="#h6-0-33" id="h6-0-33" class="d">-				else # Add to top
</a><a href="#h6-0-34" id="h6-0-34" class="d">-					elem.prependTo(&quot;.topics&quot;)
</a> 			$(&quot;body&quot;).css({&quot;overflow&quot;: &quot;auto&quot;, &quot;height&quot;: &quot;auto&quot;}) # Auto height body
 
 			# Hide loading
<a href="#h6-1" id="h6-1" class="h">@@ -51,7 +48,7 @@ class TopicList extends Class
</a> 			else
 				$(&quot;.topics-loading&quot;).remove()
 
<a href="#h6-1-3" id="h6-1-3" class="d">-			@logEnd &quot;Loadtopics&quot;
</a><a href="#h6-1-4" id="h6-1-4" class="i">+			@logEnd &quot;Load topics...&quot;
</a> 
 			Page.addInlineEditors()
 
<a href="#h6-2" id="h6-2" class="h">@@ -69,22 +66,34 @@ class TopicList extends Class
</a> 
 	# Load all user data to fill last comments
 	loadTopicsStat: (type=&quot;normal&quot;) =&gt;
<a href="#h6-2-3" id="h6-2-3" class="d">-		s = (+ new Date)
</a><a href="#h6-2-4" id="h6-2-4" class="i">+		@logStart &quot;Load topics stats...&quot;
</a> 		Page.cmd &quot;fileQuery&quot;, [&quot;data/users/*/data.json&quot;, &quot;&quot;], (users) =&gt;
 			$(&quot;.topics&quot;).css(&quot;opacity&quot;, 1)
 			stats = []
<a href="#h6-2-8" id="h6-2-8" class="i">+			my_topic_votes = {}
</a> 			# Analyze user data files
 			for user in users
<a href="#h6-2-11" id="h6-2-11" class="i">+				user_id = Users.to_id[user.inner_path]
</a> 				for topic in user.topics
<a href="#h6-2-13" id="h6-2-13" class="d">-					user_id = Page.user_id_db[user.inner_path]
</a> 					topic_address = &quot;#{topic.topic_id}_#{user_id}&quot;
 					if not stats[topic_address]?
<a href="#h6-2-16" id="h6-2-16" class="d">-						stats[topic_address] = {&quot;comments&quot;: 0, &quot;last&quot;: {&quot;added&quot;: topic.added}}
</a><a href="#h6-2-17" id="h6-2-17" class="i">+						stats[topic_address] = {&quot;comments&quot;: 0, &quot;last&quot;: {&quot;added&quot;: topic.added}, &quot;votes&quot;: 1}
</a> 
<a href="#h6-2-19" id="h6-2-19" class="i">+				# Topic votes
</a><a href="#h6-2-20" id="h6-2-20" class="i">+				for topic_address, vote of user[&quot;topic_votes&quot;]
</a><a href="#h6-2-21" id="h6-2-21" class="i">+					topic_address = topic_address.replace(&quot;@&quot;, &quot;_&quot;)
</a><a href="#h6-2-22" id="h6-2-22" class="i">+					stats[topic_address] ?= {&quot;comments&quot;: 0, &quot;last&quot;: null, &quot;votes&quot;: 1}
</a><a href="#h6-2-23" id="h6-2-23" class="i">+					if vote == 1 then stats[topic_address][&quot;votes&quot;] += 1
</a><a href="#h6-2-24" id="h6-2-24" class="i">+
</a><a href="#h6-2-25" id="h6-2-25" class="i">+				# My votes
</a><a href="#h6-2-26" id="h6-2-26" class="i">+				if user_id == Users.my_id
</a><a href="#h6-2-27" id="h6-2-27" class="i">+					my_topic_votes = user[&quot;topic_votes&quot;]
</a><a href="#h6-2-28" id="h6-2-28" class="i">+
</a><a href="#h6-2-29" id="h6-2-29" class="i">+				# Get latest comment and count of topic
</a> 				for topic_address, comments of user[&quot;comments&quot;]
 					topic_address = topic_address.replace(&quot;@&quot;, &quot;_&quot;)
 					for comment in comments
<a href="#h6-2-33" id="h6-2-33" class="d">-						stats[topic_address] ?= {&quot;comments&quot;: 0, &quot;last&quot;: null}
</a><a href="#h6-2-34" id="h6-2-34" class="i">+						stats[topic_address] ?= {&quot;comments&quot;: 0, &quot;last&quot;: null, &quot;votes&quot;: 1}
</a> 						last = stats[topic_address][&quot;last&quot;]
 						stats[topic_address][&quot;comments&quot;] += 1
 						if not last or comment[&quot;added&quot;] &gt; last[&quot;added&quot;]
<a href="#h6-3" id="h6-3" class="h">@@ -93,35 +102,49 @@ class TopicList extends Class
</a> 
 			# Set html elements
 			for topic_address, stat of stats
<a href="#h6-3-3" id="h6-3-3" class="d">-				if stat.comments &gt; 0
</a><a href="#h6-3-4" id="h6-3-4" class="d">-					$(&quot;#topic_#{topic_address} .comment-num&quot;).text &quot;#{stat.comments} comment&quot;
</a><a href="#h6-3-5" id="h6-3-5" class="d">-					$(&quot;#topic_#{topic_address} .added&quot;).text &quot;last &quot;+Time.since(stat[&quot;last&quot;][&quot;added&quot;])
</a><a href="#h6-3-6" id="h6-3-6" class="i">+				elem = $(&quot;#topic_#{topic_address}&quot;)
</a><a href="#h6-3-7" id="h6-3-7" class="i">+				# Comments
</a><a href="#h6-3-8" id="h6-3-8" class="i">+				if stat.comments &gt; 0 and type != &quot;full&quot;
</a><a href="#h6-3-9" id="h6-3-9" class="i">+					$(&quot;.comment-num&quot;, elem).text &quot;#{stat.comments} comment&quot;
</a><a href="#h6-3-10" id="h6-3-10" class="i">+					$(&quot;.added&quot;, elem).text &quot;last &quot;+Time.since(stat[&quot;last&quot;][&quot;added&quot;])
</a><a href="#h6-3-11" id="h6-3-11" class="i">+				# Votes
</a><a href="#h6-3-12" id="h6-3-12" class="i">+				if my_topic_votes?[topic_address.replace(&quot;_&quot;, &quot;@&quot;)] # Voted on it
</a><a href="#h6-3-13" id="h6-3-13" class="i">+					$(&quot;.score-inactive .score-num&quot;, elem).text stat[&quot;votes&quot;]-1
</a><a href="#h6-3-14" id="h6-3-14" class="i">+					$(&quot;.score-active .score-num&quot;, elem).text stat[&quot;votes&quot;]
</a><a href="#h6-3-15" id="h6-3-15" class="i">+					$(&quot;.score&quot;, elem).addClass(&quot;active&quot;)
</a><a href="#h6-3-16" id="h6-3-16" class="i">+				else # Not voted on it
</a><a href="#h6-3-17" id="h6-3-17" class="i">+					$(&quot;.score-inactive .score-num&quot;, elem).text stat[&quot;votes&quot;]
</a><a href="#h6-3-18" id="h6-3-18" class="i">+					$(&quot;.score-active .score-num&quot;, elem).text stat[&quot;votes&quot;]+1
</a><a href="#h6-3-19" id="h6-3-19" class="i">+				$(&quot;.score&quot;, elem).off(&quot;click&quot;).on &quot;click&quot;, @submitTopicVote
</a> 
 
 			# Sort topics
<a href="#h6-3-23" id="h6-3-23" class="d">-			topics = ([topic_address, stat.last.added] for topic_address, stat of stats)
</a><a href="#h6-3-24" id="h6-3-24" class="d">-			topics.sort (a, b) -&gt; # Sort by date
</a><a href="#h6-3-25" id="h6-3-25" class="d">-				return a[1] - b[1]
</a><a href="#h6-3-26" id="h6-3-26" class="i">+			if type != &quot;full&quot;
</a><a href="#h6-3-27" id="h6-3-27" class="i">+				topics = ([topic_address, stat.last.added] for topic_address, stat of stats)
</a><a href="#h6-3-28" id="h6-3-28" class="i">+				topics.sort (a, b) -&gt; # Sort by date
</a><a href="#h6-3-29" id="h6-3-29" class="i">+					return a[1] - b[1]
</a> 
<a href="#h6-3-31" id="h6-3-31" class="d">-			for topic in topics
</a><a href="#h6-3-32" id="h6-3-32" class="d">-				topic_address = topic[0]
</a><a href="#h6-3-33" id="h6-3-33" class="d">-				elem = $(&quot;#topic_#{topic_address}&quot;)
</a><a href="#h6-3-34" id="h6-3-34" class="d">-				elem.prependTo &quot;.topics&quot;
</a><a href="#h6-3-35" id="h6-3-35" class="d">-				# Visited
</a><a href="#h6-3-36" id="h6-3-36" class="d">-				visited = Page.local_storage[&quot;topic.#{topic_address}.visited&quot;]
</a><a href="#h6-3-37" id="h6-3-37" class="d">-				if not visited
</a><a href="#h6-3-38" id="h6-3-38" class="d">-					elem.addClass(&quot;visit-none&quot;)
</a><a href="#h6-3-39" id="h6-3-39" class="d">-				else if visited &lt; topic[1]
</a><a href="#h6-3-40" id="h6-3-40" class="d">-					elem.addClass(&quot;visit-newcomment&quot;)
</a><a href="#h6-3-41" id="h6-3-41" class="i">+				for topic in topics
</a><a href="#h6-3-42" id="h6-3-42" class="i">+					topic_address = topic[0]
</a><a href="#h6-3-43" id="h6-3-43" class="i">+					elem = $(&quot;#topic_#{topic_address}&quot;)
</a><a href="#h6-3-44" id="h6-3-44" class="i">+					elem.prependTo &quot;.topics&quot;
</a><a href="#h6-3-45" id="h6-3-45" class="i">+					# Visited
</a><a href="#h6-3-46" id="h6-3-46" class="i">+					visited = Page.local_storage[&quot;topic.#{topic_address}.visited&quot;]
</a><a href="#h6-3-47" id="h6-3-47" class="i">+					if not visited
</a><a href="#h6-3-48" id="h6-3-48" class="i">+						elem.addClass(&quot;visit-none&quot;)
</a><a href="#h6-3-49" id="h6-3-49" class="i">+					else if visited &lt; topic[1]
</a><a href="#h6-3-50" id="h6-3-50" class="i">+						elem.addClass(&quot;visit-newcomment&quot;)
</a><a href="#h6-3-51" id="h6-3-51" class="i">+			@logEnd &quot;Load topics stats...&quot;
</a> 
<a href="#h6-3-53" id="h6-3-53" class="d">-			@log &quot;Topics stats loaded in&quot;, (+ new Date)-s
</a> 
 
 	applyTopicData: (elem, topic, type=&quot;normal&quot;) -&gt;
 		title_hash = topic.title.replace(/[#,&quot;&apos;?&amp; ]/g, &quot;+&quot;).replace(/[+]+/g, &quot;+&quot;).replace(/[+]+$/, &quot;&quot;)
<a href="#h6-3-58" id="h6-3-58" class="d">-		user_id = Page.user_id_db[topic.inner_path]
</a><a href="#h6-3-59" id="h6-3-59" class="i">+		user_id = Users.to_id[topic.inner_path]
</a><a href="#h6-3-60" id="h6-3-60" class="i">+		topic_address = topic.topic_id+&quot;@&quot;+user_id
</a> 		$(&quot;.title .title-link&quot;, elem).text(topic.title)
<a href="#h6-3-62" id="h6-3-62" class="d">-		$(&quot;.title .title-link, a.image, .comment-num&quot;, elem).attr(&quot;href&quot;, &quot;?Topic:#{topic.topic_id}@#{user_id}/#{title_hash}&quot;)
</a><a href="#h6-3-63" id="h6-3-63" class="i">+		$(&quot;.title .title-link, a.image, .comment-num&quot;, elem).attr(&quot;href&quot;, &quot;?Topic:#{topic_address}/#{title_hash}&quot;)
</a><a href="#h6-3-64" id="h6-3-64" class="i">+		elem.data &quot;topic_address&quot;, topic_address
</a> 
 		# Get links in body
 		body = topic.body
<a href="#h6-4" id="h6-4" class="h">@@ -141,18 +164,18 @@ class TopicList extends Class
</a> 		else
 			$(&quot;.body&quot;, elem).text body
 
<a href="#h6-4-3" id="h6-4-3" class="d">-		username = Page.user_name_db[topic.inner_path]
</a><a href="#h6-4-4" id="h6-4-4" class="d">-		$(&quot;.username&quot;, elem).text(username)
</a><a href="#h6-4-5" id="h6-4-5" class="d">-		$(&quot;.added&quot;, elem).text Time.since(topic.added)
</a><a href="#h6-4-6" id="h6-4-6" class="i">+		user_name = Users.to_name[topic.inner_path]
</a><a href="#h6-4-7" id="h6-4-7" class="i">+		$(&quot;.user_name&quot;, elem).text(user_name)
</a><a href="#h6-4-8" id="h6-4-8" class="i">+		if type == &quot;full&quot; then $(&quot;.added&quot;, elem).text Time.since(topic.added)
</a> 
 		# My topic
<a href="#h6-4-11" id="h6-4-11" class="d">-		if topic.inner_path == Page.site_info.auth_address
</a><a href="#h6-4-12" id="h6-4-12" class="d">-			$(elem).attr(&quot;data-object&quot;, &quot;Topic:#{topic.topic_id}@#{user_id}&quot;).attr(&quot;data-deletable&quot;, &quot;yes&quot;)
</a><a href="#h6-4-13" id="h6-4-13" class="i">+		if topic.inner_path == Users.my_address
</a><a href="#h6-4-14" id="h6-4-14" class="i">+			$(elem).attr(&quot;data-object&quot;, &quot;Topic:#{topic_address}&quot;).attr(&quot;data-deletable&quot;, &quot;yes&quot;)
</a> 			$(&quot;.title .title-link&quot;, elem).attr(&quot;data-editable&quot;, &quot;title&quot;).data(&quot;content&quot;, topic.title)
 			$(&quot;.body&quot;, elem).attr(&quot;data-editable&quot;, &quot;body&quot;).data(&quot;content&quot;, topic.body)
 
 
<a href="#h6-4-19" id="h6-4-19" class="d">-	buttonCreateTopic: -&gt;
</a><a href="#h6-4-20" id="h6-4-20" class="i">+	submitCreateTopic: -&gt;
</a> 		if not Page.hasOpenPort() then return false
 
 		title = $(&quot;.topic-new #topic_title&quot;).val()
<a href="#h6-5" id="h6-5" class="h">@@ -161,7 +184,7 @@ class TopicList extends Class
</a> 		if not title then return $(&quot;.topic-new #topic_title&quot;).focus()
 
 		$(&quot;.topic-new .button-submit&quot;).addClass(&quot;loading&quot;)
<a href="#h6-5-3" id="h6-5-3" class="d">-		inner_path = &quot;data/users/#{Page.site_info.auth_address}/data.json&quot;
</a><a href="#h6-5-4" id="h6-5-4" class="i">+		inner_path = &quot;data/users/#{Users.my_address}/data.json&quot;
</a> 		Page.cmd &quot;fileGet&quot;, [inner_path], (data) =&gt;
 			data = JSON.parse(data)
 			data.topics.push {
<a href="#h6-6" id="h6-6" class="h">@@ -187,5 +210,30 @@ class TopicList extends Class
</a> 					Page.cmd &quot;wrapperNotification&quot;, [&quot;error&quot;, &quot;File write error: #{res}&quot;]
 
 
<a href="#h6-6-3" id="h6-6-3" class="i">+	submitTopicVote: (e) =&gt;
</a><a href="#h6-6-4" id="h6-6-4" class="i">+		if not Users.my_name # Not registered
</a><a href="#h6-6-5" id="h6-6-5" class="i">+			Page.cmd &quot;wrapperNotification&quot;, [&quot;info&quot;, &quot;Please, request access before posting.&quot;]
</a><a href="#h6-6-6" id="h6-6-6" class="i">+			return false
</a><a href="#h6-6-7" id="h6-6-7" class="i">+		elem = $(e.currentTarget)
</a><a href="#h6-6-8" id="h6-6-8" class="i">+		elem.toggleClass(&quot;active&quot;).addClass(&quot;loading&quot;)
</a><a href="#h6-6-9" id="h6-6-9" class="i">+		inner_path = &quot;data/users/#{Users.my_address}/data.json&quot;
</a><a href="#h6-6-10" id="h6-6-10" class="i">+		Page.cmd &quot;fileGet&quot;, [inner_path], (data) =&gt;
</a><a href="#h6-6-11" id="h6-6-11" class="i">+			data = JSON.parse(data)
</a><a href="#h6-6-12" id="h6-6-12" class="i">+			data.topic_votes ?= {}
</a><a href="#h6-6-13" id="h6-6-13" class="i">+			topic_address = elem.parents(&quot;.topic&quot;).data(&quot;topic_address&quot;)
</a><a href="#h6-6-14" id="h6-6-14" class="i">+			if elem.hasClass(&quot;active&quot;)
</a><a href="#h6-6-15" id="h6-6-15" class="i">+				data.topic_votes[topic_address] = 1
</a><a href="#h6-6-16" id="h6-6-16" class="i">+			else
</a><a href="#h6-6-17" id="h6-6-17" class="i">+				delete data.topic_votes[topic_address]
</a><a href="#h6-6-18" id="h6-6-18" class="i">+			Page.writePublish inner_path, Page.jsonEncode(data), (res) =&gt;
</a><a href="#h6-6-19" id="h6-6-19" class="i">+				elem.removeClass(&quot;loading&quot;)
</a><a href="#h6-6-20" id="h6-6-20" class="i">+				if res == true
</a><a href="#h6-6-21" id="h6-6-21" class="i">+					@log &quot;File written&quot;
</a><a href="#h6-6-22" id="h6-6-22" class="i">+				else
</a><a href="#h6-6-23" id="h6-6-23" class="i">+					elem.toggleClass(&quot;active&quot;) # Change back
</a><a href="#h6-6-24" id="h6-6-24" class="i">+					#Page.cmd &quot;wrapperNotification&quot;, [&quot;error&quot;, &quot;File write error: #{res}&quot;]
</a><a href="#h6-6-25" id="h6-6-25" class="i">+		
</a><a href="#h6-6-26" id="h6-6-26" class="i">+		return false
</a><a href="#h6-6-27" id="h6-6-27" class="i">+			
</a> 
 window.TopicList = new TopicList() 
\ No newline at end of file
<b>diff --git a/<a id="h7" href="../file/js/TopicShow.coffee.html">js/TopicShow.coffee</a> b/<a href="../file/js/TopicShow.coffee.html">js/TopicShow.coffee</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -7,7 +7,7 @@ class TopicShow extends Class
</a> 		@loadComments(&quot;noanim&quot;)
 
 		$(&quot;.comment-new .button-submit&quot;).on &quot;click&quot;, =&gt;
<a href="#h7-0-3" id="h7-0-3" class="d">-			if Page.user_name_db[Page.site_info.auth_address] # Check if user exits
</a><a href="#h7-0-4" id="h7-0-4" class="i">+			if Users.to_name[Users.my_address] # Check if user exits
</a> 				@buttonComment()
 			else
 				Page.cmd &quot;wrapperNotification&quot;, [&quot;info&quot;, &quot;Please, request access before posting.&quot;]
<a href="#h7-1" id="h7-1" class="h">@@ -15,7 +15,9 @@ class TopicShow extends Class
</a> 
 
 	loadTopic: (cb=false)-&gt;
<a href="#h7-1-3" id="h7-1-3" class="d">-		topic_user_address = Page.user_address_db[@topic_user_id]
</a><a href="#h7-1-4" id="h7-1-4" class="i">+		@logStart &quot;Loading topic...&quot;
</a><a href="#h7-1-5" id="h7-1-5" class="i">+		topic_user_address = Users.to_address[@topic_user_id]
</a><a href="#h7-1-6" id="h7-1-6" class="i">+		$(&quot;.topic-full&quot;).attr(&quot;id&quot;, &quot;topic_#{@topic_id}_#{@topic_user_id}&quot;)
</a> 		# Load topic data
 		Page.cmd &quot;fileQuery&quot;, [&quot;data/users/#{topic_user_address}/data.json&quot;, &quot;topics.topic_id=#{@topic_id}&quot;], (topic) =&gt;
 			topic = topic[0]
<a href="#h7-2" id="h7-2" class="h">@@ -24,11 +26,14 @@ class TopicShow extends Class
</a> 			$(&quot;.topic-full&quot;).css(&quot;opacity&quot;, 1)
 			#$(&quot;.username-my&quot;).text(@user_name_db[user_address])
 			$(&quot;body&quot;).addClass(&quot;page-topic&quot;)
<a href="#h7-2-3" id="h7-2-3" class="i">+			@logEnd &quot;Loading topic...&quot;
</a> 
<a href="#h7-2-5" id="h7-2-5" class="i">+			TopicList.loadTopicsStat(&quot;full&quot;)
</a> 			if cb then cb()
 
 
 	loadComments: (type=&quot;normal&quot;, cb=false) -&gt;
<a href="#h7-2-10" id="h7-2-10" class="i">+		@logStart &quot;Loading comments...&quot;
</a> 		topic_address = @topic_id+&quot;@&quot;+@topic_user_id
 
 		# Update visited info
<a href="#h7-3" id="h7-3" class="h">@@ -41,7 +46,7 @@ class TopicShow extends Class
</a> 				return b.added - a.added
 
 			for comment in comments
<a href="#h7-3-3" id="h7-3-3" class="d">-				user_id = Page.user_id_db[comment.inner_path]
</a><a href="#h7-3-4" id="h7-3-4" class="i">+				user_id = Users.to_id[comment.inner_path]
</a> 				comment_address = &quot;#{comment.comment_id}_#{user_id}&quot;
 				elem = $(&quot;#comment_&quot;+comment_address)
 				if elem.length == 0 # Create if not exits
<a href="#h7-4" id="h7-4" class="h">@@ -56,22 +61,23 @@ class TopicShow extends Class
</a> 			$(&quot;body&quot;).css({&quot;overflow&quot;: &quot;auto&quot;, &quot;height&quot;: &quot;auto&quot;})
 
 			Page.addInlineEditors()
<a href="#h7-4-3" id="h7-4-3" class="i">+			@logEnd &quot;Loading comments...&quot;
</a> 
 			if cb then cb()
 
 
 	# Update elem based on data of comment dict
 	applyCommentData: (elem, comment) -&gt;
<a href="#h7-4-10" id="h7-4-10" class="d">-		username = Page.user_name_db[comment.inner_path]
</a><a href="#h7-4-11" id="h7-4-11" class="i">+		user_name = Users.to_name[comment.inner_path]
</a> 		$(&quot;.body&quot;, elem).html Text.toMarked(comment.body, {&quot;sanitize&quot;: true})
<a href="#h7-4-13" id="h7-4-13" class="d">-		$(&quot;.username&quot;, elem).text(username).css(&quot;color&quot;: Text.toColor(username))
</a><a href="#h7-4-14" id="h7-4-14" class="i">+		$(&quot;.user_name&quot;, elem).text(user_name).css(&quot;color&quot;: Text.toColor(user_name))
</a> 		$(&quot;.added&quot;, elem).text(Time.since(comment.added))
<a href="#h7-4-16" id="h7-4-16" class="d">-		# elem.css(&quot;border-left&quot;, &quot;2px solid #{@textToColor(username)}&quot;)
</a><a href="#h7-4-17" id="h7-4-17" class="i">+		# elem.css(&quot;border-left&quot;, &quot;2px solid #{@textToColor(user_name)}&quot;)
</a> 
 
 		# My comment
 		if comment.inner_path == Page.site_info.auth_address
<a href="#h7-4-22" id="h7-4-22" class="d">-			user_id = Page.user_id_db[comment.inner_path]
</a><a href="#h7-4-23" id="h7-4-23" class="i">+			user_id = Users.to_id[comment.inner_path]
</a> 			comment_id = elem.attr(&quot;id&quot;).replace(&quot;comment_&quot;, &quot;&quot;).replace(/_.*$/, &quot;&quot;)
 			topic_address = elem.data(&quot;topic_address&quot;)
 			$(elem).attr(&quot;data-object&quot;, &quot;Comment:#{comment_id}@#{topic_address}&quot;).attr(&quot;data-deletable&quot;, &quot;yes&quot;)
<a href="#h7-5" id="h7-5" class="h">@@ -106,9 +112,9 @@ class TopicShow extends Class
</a> 
 	buttonReply: (elem) -&gt;
 		@log &quot;Reply to&quot;, elem
<a href="#h7-5-3" id="h7-5-3" class="d">-		username = $(&quot;.username&quot;, elem).text()
</a><a href="#h7-5-4" id="h7-5-4" class="i">+		user_name = $(&quot;.user_name&quot;, elem).text()
</a> 		post_id = elem.attr(&quot;id&quot;)
<a href="#h7-5-6" id="h7-5-6" class="d">-		body_add = &quot;&gt; [#{username}](\##{post_id}): &quot;
</a><a href="#h7-5-7" id="h7-5-7" class="i">+		body_add = &quot;&gt; [#{user_name}](\##{post_id}): &quot;
</a> 		body_add+= $(&quot;.body&quot;, elem).text().trim(&quot;\n&quot;).replace(/\n/g, &quot;\n&gt; &quot;)
 		body_add+= &quot;\n\n&quot;
 
<b>diff --git a/<a id="h8" href="../file/js/Users.coffee.html">js/Users.coffee</a> b/<a href="../file/js/Users.coffee.html">js/Users.coffee</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -0,0 +1,58 @@
</a><a href="#h8-0-0" id="h8-0-0" class="i">+class Users extends Class
</a><a href="#h8-0-1" id="h8-0-1" class="i">+	constructor: -&gt;
</a><a href="#h8-0-2" id="h8-0-2" class="i">+		@to_id = {} # { &quot;address&quot;: 1 }
</a><a href="#h8-0-3" id="h8-0-3" class="i">+		@to_address = {} # { 1: &quot;address&quot; }
</a><a href="#h8-0-4" id="h8-0-4" class="i">+		@to_name = {} # { &quot;address&quot;: &quot;user_name&quot; }
</a><a href="#h8-0-5" id="h8-0-5" class="i">+
</a><a href="#h8-0-6" id="h8-0-6" class="i">+		@my_address = null
</a><a href="#h8-0-7" id="h8-0-7" class="i">+		@my_id = null
</a><a href="#h8-0-8" id="h8-0-8" class="i">+		@my_name = null
</a><a href="#h8-0-9" id="h8-0-9" class="i">+		@my_max_size = null # Max total file size allowed to user
</a><a href="#h8-0-10" id="h8-0-10" class="i">+
</a><a href="#h8-0-11" id="h8-0-11" class="i">+
</a><a href="#h8-0-12" id="h8-0-12" class="i">+	# Load userdb
</a><a href="#h8-0-13" id="h8-0-13" class="i">+	loadDb: (cb = null) -&gt;
</a><a href="#h8-0-14" id="h8-0-14" class="i">+		@logStart &quot;Loading userDB&quot;
</a><a href="#h8-0-15" id="h8-0-15" class="i">+		Page.cmd &quot;fileGet&quot;, [&quot;data/users/content.json&quot;], (data) =&gt;
</a><a href="#h8-0-16" id="h8-0-16" class="i">+			data = JSON.parse(data)
</a><a href="#h8-0-17" id="h8-0-17" class="i">+			for path, user of data[&quot;includes&quot;]
</a><a href="#h8-0-18" id="h8-0-18" class="i">+				address = user.signers[0]
</a><a href="#h8-0-19" id="h8-0-19" class="i">+				@to_id[address] = user.user_id
</a><a href="#h8-0-20" id="h8-0-20" class="i">+				@to_address[user.user_id] = address
</a><a href="#h8-0-21" id="h8-0-21" class="i">+				@to_name[address] = user.user_name
</a><a href="#h8-0-22" id="h8-0-22" class="i">+				if address == @my_address # Current user
</a><a href="#h8-0-23" id="h8-0-23" class="i">+					@my_max_size = user.max_size
</a><a href="#h8-0-24" id="h8-0-24" class="i">+			@logEnd &quot;Loading userDB&quot;
</a><a href="#h8-0-25" id="h8-0-25" class="i">+			if cb then cb()
</a><a href="#h8-0-26" id="h8-0-26" class="i">+
</a><a href="#h8-0-27" id="h8-0-27" class="i">+
</a><a href="#h8-0-28" id="h8-0-28" class="i">+	# Update user info
</a><a href="#h8-0-29" id="h8-0-29" class="i">+	updateMyInfo: -&gt;
</a><a href="#h8-0-30" id="h8-0-30" class="i">+		@log &quot;Updating user info...&quot;, @my_address
</a><a href="#h8-0-31" id="h8-0-31" class="i">+		address = @my_address
</a><a href="#h8-0-32" id="h8-0-32" class="i">+		user_name = @to_name[address] # Set my info
</a><a href="#h8-0-33" id="h8-0-33" class="i">+		if user_name # Registered user
</a><a href="#h8-0-34" id="h8-0-34" class="i">+			@my_name = user_name
</a><a href="#h8-0-35" id="h8-0-35" class="i">+			@my_id = @to_id[address]
</a><a href="#h8-0-36" id="h8-0-36" class="i">+			if $(&quot;.head-user.visitor&quot;).css(&quot;display&quot;) != &quot;none&quot; # Just registered successfuly
</a><a href="#h8-0-37" id="h8-0-37" class="i">+				$(&quot;.head-user.visitor&quot;).css(&quot;display&quot;, &quot;none&quot;)
</a><a href="#h8-0-38" id="h8-0-38" class="i">+				Page.cmd &quot;wrapperNotification&quot;, [&quot;done&quot;, &quot;Hello &lt;b&gt;#{user_name}&lt;/b&gt;!&lt;br&gt;Congratulations, your registration is done!&quot;, 10000]
</a><a href="#h8-0-39" id="h8-0-39" class="i">+				$(&quot;.button.signup&quot;).removeClass(&quot;loading&quot;) 
</a><a href="#h8-0-40" id="h8-0-40" class="i">+
</a><a href="#h8-0-41" id="h8-0-41" class="i">+			$(&quot;.head-user.registered&quot;).css(&quot;display&quot;, &quot;&quot;)
</a><a href="#h8-0-42" id="h8-0-42" class="i">+			$(&quot;.user_name-my&quot;).text(user_name).css(&quot;color&quot;, Text.toColor(user_name)).attr(&quot;title&quot;, address)
</a><a href="#h8-0-43" id="h8-0-43" class="i">+			Page.cmd &quot;fileGet&quot;, [&quot;data/users/#{address}/content.json&quot;], (content) =&gt;
</a><a href="#h8-0-44" id="h8-0-44" class="i">+				content = JSON.parse(content)
</a><a href="#h8-0-45" id="h8-0-45" class="i">+				sum = 0
</a><a href="#h8-0-46" id="h8-0-46" class="i">+				for relative_path, details of content.files
</a><a href="#h8-0-47" id="h8-0-47" class="i">+					sum += details.size
</a><a href="#h8-0-48" id="h8-0-48" class="i">+				$(&quot;.head-user .size&quot;).text(&quot;Used: #{(sum/1000).toFixed(1)}k / #{parseInt(@my_max_size/1000)}k&quot;)
</a><a href="#h8-0-49" id="h8-0-49" class="i">+				$(&quot;.head-user .size-used&quot;).width(parseFloat(sum/@my_max_size)*100)
</a><a href="#h8-0-50" id="h8-0-50" class="i">+
</a><a href="#h8-0-51" id="h8-0-51" class="i">+
</a><a href="#h8-0-52" id="h8-0-52" class="i">+		else # Not registered yet
</a><a href="#h8-0-53" id="h8-0-53" class="i">+			$(&quot;.head-user.visitor&quot;).css(&quot;display&quot;, &quot;&quot;)
</a><a href="#h8-0-54" id="h8-0-54" class="i">+			$(&quot;.user_name-my&quot;).text(&quot;Visitor&quot;)
</a><a href="#h8-0-55" id="h8-0-55" class="i">+
</a><a href="#h8-0-56" id="h8-0-56" class="i">+
</a><a href="#h8-0-57" id="h8-0-57" class="i">+window.Users = new Users()</a><a href="#h8-0-58" id="h8-0-58" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h9" href="../file/js/ZeroTalk.coffee.html">js/ZeroTalk.coffee</a> b/<a href="../file/js/ZeroTalk.coffee.html">js/ZeroTalk.coffee</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -4,12 +4,13 @@ class ZeroTalk extends ZeroFrame
</a> 		@site_info = null
 		@server_info = null
 		@local_storage = {}
<a href="#h9-0-3" id="h9-0-3" class="i">+		@publishing = false
</a> 
<a href="#h9-0-5" id="h9-0-5" class="d">-		@user_id_db = {} # { &quot;address&quot;: 1 }
</a><a href="#h9-0-6" id="h9-0-6" class="d">-		@user_address_db = {} # { 1: &quot;address&quot; }
</a><a href="#h9-0-7" id="h9-0-7" class="d">-		@user_name_db = {} # { &quot;address&quot;: &quot;username&quot; }
</a><a href="#h9-0-8" id="h9-0-8" class="i">+		#@user_id_db = {} # { &quot;address&quot;: 1 }
</a><a href="#h9-0-9" id="h9-0-9" class="i">+		#@user_address_db = {} # { 1: &quot;address&quot; }
</a><a href="#h9-0-10" id="h9-0-10" class="i">+		#@user_name_db = {} # { &quot;address&quot;: &quot;username&quot; }
</a> 
<a href="#h9-0-12" id="h9-0-12" class="d">-		@user_max_size = null # Max total file size allowed to user
</a><a href="#h9-0-13" id="h9-0-13" class="i">+		#@user_max_size = null # Max total file size allowed to user
</a> 
 		# Autoexpand
 		for textarea in $(&quot;textarea&quot;)
<a href="#h9-1" id="h9-1" class="h">@@ -37,8 +38,8 @@ class ZeroTalk extends ZeroFrame
</a> 
 		@cmd &quot;siteInfo&quot;, {}, (site) =&gt;
 			@setSiteinfo(site)
<a href="#h9-1-3" id="h9-1-3" class="d">-			@loadUserDb =&gt; # Load user DB then route url
</a><a href="#h9-1-4" id="h9-1-4" class="d">-				@updateUserInfo()
</a><a href="#h9-1-5" id="h9-1-5" class="i">+			Users.loadDb =&gt; # Load user DB then route url
</a><a href="#h9-1-6" id="h9-1-6" class="i">+				Users.updateMyInfo()
</a> 				@routeUrl(window.location.search.substring(1))
 
 		@cmd &quot;serverInfo&quot;, {}, (ret) =&gt; # Get server info
<a href="#h9-2" id="h9-2" class="h">@@ -95,7 +96,7 @@ class ZeroTalk extends ZeroFrame
</a> 		object = @getObject(elem)
 		[type, id] = object.data(&quot;object&quot;).split(&quot;:&quot;) 
 
<a href="#h9-2-3" id="h9-2-3" class="d">-		inner_path = &quot;data/users/#{@site_info.auth_address}/data.json&quot;
</a><a href="#h9-2-4" id="h9-2-4" class="i">+		inner_path = &quot;data/users/#{Users.my_address}/data.json&quot;
</a> 		@cmd &quot;fileGet&quot;, [inner_path], (data) =&gt;
 			data = JSON.parse(data)
 
<a href="#h9-3" id="h9-3" class="h">@@ -138,51 +139,13 @@ class ZeroTalk extends ZeroFrame
</a> 					if cb then cb(false)
 
 
<a href="#h9-3-3" id="h9-3-3" class="d">-	loadUserDb: (cb = null) -&gt;
</a><a href="#h9-3-4" id="h9-3-4" class="d">-		@log &quot;Loading userdb&quot;
</a><a href="#h9-3-5" id="h9-3-5" class="d">-		@cmd &quot;fileGet&quot;, [&quot;data/users/content.json&quot;], (data) =&gt;
</a><a href="#h9-3-6" id="h9-3-6" class="d">-			data = JSON.parse(data)
</a><a href="#h9-3-7" id="h9-3-7" class="d">-			for path, user of data[&quot;includes&quot;]
</a><a href="#h9-3-8" id="h9-3-8" class="d">-				address = user.signers[0]
</a><a href="#h9-3-9" id="h9-3-9" class="d">-				@user_id_db[address] = user.user_id
</a><a href="#h9-3-10" id="h9-3-10" class="d">-				@user_address_db[user.user_id] = address
</a><a href="#h9-3-11" id="h9-3-11" class="d">-				@user_name_db[address] = user.user_name
</a><a href="#h9-3-12" id="h9-3-12" class="d">-				if address == @site_info[&quot;auth_address&quot;] # Current user
</a><a href="#h9-3-13" id="h9-3-13" class="d">-					@user_max_size = user.max_size
</a><a href="#h9-3-14" id="h9-3-14" class="d">-			if cb then cb()
</a><a href="#h9-3-15" id="h9-3-15" class="d">-
</a><a href="#h9-3-16" id="h9-3-16" class="d">-
</a><a href="#h9-3-17" id="h9-3-17" class="d">-	updateUserInfo: -&gt;
</a><a href="#h9-3-18" id="h9-3-18" class="d">-		address = @site_info[&quot;auth_address&quot;]
</a><a href="#h9-3-19" id="h9-3-19" class="d">-		user_name = @user_name_db[address] # Set my info
</a><a href="#h9-3-20" id="h9-3-20" class="d">-		if user_name # Registered user
</a><a href="#h9-3-21" id="h9-3-21" class="d">-			if $(&quot;.head-user.visitor&quot;).css(&quot;display&quot;) != &quot;none&quot; # Just registered successfuly
</a><a href="#h9-3-22" id="h9-3-22" class="d">-				$(&quot;.head-user.visitor&quot;).css(&quot;display&quot;, &quot;none&quot;)
</a><a href="#h9-3-23" id="h9-3-23" class="d">-				@cmd &quot;wrapperNotification&quot;, [&quot;done&quot;, &quot;Hello &lt;b&gt;#{user_name}&lt;/b&gt;!&lt;br&gt;Congratulations, your registration is done!&quot;, 10000]
</a><a href="#h9-3-24" id="h9-3-24" class="d">-				$(&quot;.button.signup&quot;).removeClass(&quot;loading&quot;) 
</a><a href="#h9-3-25" id="h9-3-25" class="d">-
</a><a href="#h9-3-26" id="h9-3-26" class="d">-			$(&quot;.head-user.registered&quot;).css(&quot;display&quot;, &quot;&quot;)
</a><a href="#h9-3-27" id="h9-3-27" class="d">-			$(&quot;.username-my&quot;).text(user_name).css(&quot;color&quot;, Text.toColor(user_name))
</a><a href="#h9-3-28" id="h9-3-28" class="d">-			@cmd &quot;fileGet&quot;, [&quot;data/users/#{address}/content.json&quot;], (content) =&gt;
</a><a href="#h9-3-29" id="h9-3-29" class="d">-				content = JSON.parse(content)
</a><a href="#h9-3-30" id="h9-3-30" class="d">-				sum = 0
</a><a href="#h9-3-31" id="h9-3-31" class="d">-				for relative_path, details of content.files
</a><a href="#h9-3-32" id="h9-3-32" class="d">-					sum += details.size
</a><a href="#h9-3-33" id="h9-3-33" class="d">-				$(&quot;.head-user .size&quot;).text(&quot;Used: #{(sum/1000).toFixed(1)}k / #{parseInt(@user_max_size/1000)}k&quot;)
</a><a href="#h9-3-34" id="h9-3-34" class="d">-				$(&quot;.head-user .size-used&quot;).width(parseFloat(sum/@user_max_size)*100)
</a><a href="#h9-3-35" id="h9-3-35" class="d">-
</a><a href="#h9-3-36" id="h9-3-36" class="d">-
</a><a href="#h9-3-37" id="h9-3-37" class="d">-		else # Not registered yet
</a><a href="#h9-3-38" id="h9-3-38" class="d">-			$(&quot;.head-user.visitor&quot;).css(&quot;display&quot;, &quot;&quot;)
</a><a href="#h9-3-39" id="h9-3-39" class="d">-			$(&quot;.username-my&quot;).text(&quot;Visitor&quot;)
</a><a href="#h9-3-40" id="h9-3-40" class="d">-
</a> 
 	buttonSignup: -&gt;
 		if not @hasOpenPort() then return false
 
 		@cmd &quot;wrapperPrompt&quot;, [&quot;Username you want to register:&quot;], (user_name) =&gt; # Prompt the username
 			$(&quot;.button.signup&quot;).addClass(&quot;loading&quot;) 
<a href="#h9-3-47" id="h9-3-47" class="d">-			$.post(&quot;http://demo.zeronet.io/ZeroTalk/signup.php&quot;, {&quot;user_name&quot;: user_name, &quot;auth_address&quot;: @site_info.auth_address}).always (res) =&gt;
</a><a href="#h9-3-48" id="h9-3-48" class="i">+			$.post(&quot;http://demo.zeronet.io/ZeroTalk/signup.php&quot;, {&quot;user_name&quot;: user_name, &quot;auth_address&quot;: Users.my_address}).always (res) =&gt;
</a> 				if res == &quot;OK&quot;
 					@cmd &quot;wrapperNotification&quot;, [&quot;done&quot;, &quot;Your registration has been sent!&quot;, 10000]
 				else
<a href="#h9-4" id="h9-4" class="h">@@ -195,13 +158,20 @@ class ZeroTalk extends ZeroFrame
</a> 
 
 	writePublish: (inner_path, data, cb) -&gt;
<a href="#h9-4-3" id="h9-4-3" class="i">+		if @publishing
</a><a href="#h9-4-4" id="h9-4-4" class="i">+			@cmd &quot;wrapperNotification&quot;, [&quot;error&quot;, &quot;Publishing in progress, please wait until its finished.&quot;]
</a><a href="#h9-4-5" id="h9-4-5" class="i">+			cb(false)
</a><a href="#h9-4-6" id="h9-4-6" class="i">+			return false
</a><a href="#h9-4-7" id="h9-4-7" class="i">+		@publishing = true
</a> 		@cmd &quot;fileWrite&quot;, [inner_path, data], (res) =&gt;
 			if res != &quot;ok&quot; # fileWrite failed
 				@cmd &quot;wrapperNotification&quot;, [&quot;error&quot;, &quot;File write error: #{res}&quot;]
 				cb(false)
<a href="#h9-4-12" id="h9-4-12" class="i">+				@publishing = false
</a> 				return false
 
 			@cmd &quot;sitePublish&quot;, {&quot;inner_path&quot;: inner_path}, (res) =&gt;
<a href="#h9-4-16" id="h9-4-16" class="i">+				@publishing = false
</a> 				if res == &quot;ok&quot;
 					cb(true)
 				else
<a href="#h9-5" id="h9-5" class="h">@@ -226,12 +196,13 @@ class ZeroTalk extends ZeroFrame
</a> 
 	# Siteinfo changed
 	actionSetSiteInfo: (res) =&gt;
<a href="#h9-5-3" id="h9-5-3" class="d">-		@setSiteinfo(res.params)
</a><a href="#h9-5-4" id="h9-5-4" class="d">-		if res.params.event and res.params.event[0] == &quot;file_done&quot; and res.params.event[1] == &quot;data/users/#{@site_info.auth_address}/data.json&quot; # Registration successful
</a><a href="#h9-5-5" id="h9-5-5" class="d">-			@updateUserInfo() # Set my info
</a><a href="#h9-5-6" id="h9-5-6" class="d">-		if res.params.event and res.params.event[0] == &quot;file_done&quot; and res.params.event[1] == &quot;data/users/content.json&quot; # New user
</a><a href="#h9-5-7" id="h9-5-7" class="d">-			@loadUserDb() # Reload userdb
</a><a href="#h9-5-8" id="h9-5-8" class="d">-		if res.params.event and res.params.event[0] == &quot;file_done&quot; and res.params.event[1].match /.*users.*data.json$/  # Data changed
</a><a href="#h9-5-9" id="h9-5-9" class="i">+		site_info = res.params
</a><a href="#h9-5-10" id="h9-5-10" class="i">+		@setSiteinfo(site_info)
</a><a href="#h9-5-11" id="h9-5-11" class="i">+		if site_info.event and site_info.event[0] == &quot;file_done&quot; and site_info.event[1] == &quot;data/users/#{Users.my_address}/data.json&quot; # Registration successful
</a><a href="#h9-5-12" id="h9-5-12" class="i">+			Users.updateMyInfo() # Set my info
</a><a href="#h9-5-13" id="h9-5-13" class="i">+		if site_info.event and site_info.event[0] == &quot;file_done&quot; and site_info.event[1] == &quot;data/users/content.json&quot; # New user
</a><a href="#h9-5-14" id="h9-5-14" class="i">+			Users.loadDb() # Reload userdb
</a><a href="#h9-5-15" id="h9-5-15" class="i">+		if site_info.event and site_info.event[0] == &quot;file_done&quot; and site_info.event[1].match /.*users.*data.json$/  # Data changed
</a> 			LimitRate (=&gt;
 				if $(&quot;body&quot;).hasClass(&quot;page-topic&quot;)
 					TopicShow.loadTopic()
<a href="#h9-6" id="h9-6" class="h">@@ -244,6 +215,7 @@ class ZeroTalk extends ZeroFrame
</a> 
 	setSiteinfo: (site_info) =&gt;
 		@site_info = site_info
<a href="#h9-6-3" id="h9-6-3" class="i">+		Users.my_address = site_info.auth_address
</a> 
 
 	autoExpand: (elem) -&gt;
<b>diff --git a/<a id="h10" href="../file/js/all.js.html">js/all.js</a> b/<a href="../file/js/all.js.html">js/all.js</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -182,7 +182,6 @@
</a> }).call(this);
 
 
<a href="#h10-0-3" id="h10-0-3" class="d">-
</a> /* ---- data/1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ/js/lib/jquery.cssanim.js ---- */
 
 
<a href="#h10-1" id="h10-1" class="h">@@ -304,7 +303,6 @@ jQuery.fx.step.scale = function(fx) {
</a> }).call(this);
 
 
<a href="#h10-1-3" id="h10-1-3" class="d">-
</a> /* ---- data/1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ/js/lib/jquery.easing.1.3.js ---- */
 
 
<a href="#h10-2" id="h10-2" class="h">@@ -774,7 +772,7 @@ jQuery.extend( jQuery.easing,
</a>       this.logtimers || (this.logtimers = {});
       this.logtimers[name] = +(new Date);
       if (args.length &gt; 0) {
<a href="#h10-2-3" id="h10-2-3" class="d">-        this.log.apply(this, [&quot;[&quot; + name + &quot;]&quot;].concat(__slice.call(args), [&quot;(started)&quot;]));
</a><a href="#h10-2-4" id="h10-2-4" class="i">+        this.log.apply(this, [&quot;&quot; + name].concat(__slice.call(args), [&quot;(started)&quot;]));
</a>       }
       return this;
     };
<a href="#h10-3" id="h10-3" class="h">@@ -783,7 +781,7 @@ jQuery.extend( jQuery.easing,
</a>       var args, ms, name;
       name = arguments[0], args = 2 &lt;= arguments.length ? __slice.call(arguments, 1) : [];
       ms = +(new Date) - this.logtimers[name];
<a href="#h10-3-3" id="h10-3-3" class="d">-      this.log.apply(this, [&quot;[&quot; + name + &quot;]&quot;].concat(__slice.call(args), [&quot;(Done in &quot; + ms + &quot;ms)&quot;]));
</a><a href="#h10-3-4" id="h10-3-4" class="i">+      this.log.apply(this, [&quot;&quot; + name].concat(__slice.call(args), [&quot;(Done in &quot; + ms + &quot;ms)&quot;]));
</a>       return this;
     };
 
<a href="#h10-4" id="h10-4" class="h">@@ -796,7 +794,6 @@ jQuery.extend( jQuery.easing,
</a> }).call(this);
 
 
<a href="#h10-4-3" id="h10-4-3" class="d">-
</a> /* ---- data/1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ/js/utils/InlineEditor.coffee ---- */
 
 
<a href="#h10-5" id="h10-5" class="h">@@ -994,7 +991,6 @@ jQuery.extend( jQuery.easing,
</a> }).call(this);
 
 
<a href="#h10-5-3" id="h10-5-3" class="d">-
</a> /* ---- data/1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ/js/utils/LimitRate.coffee ---- */
 
 
<a href="#h10-6" id="h10-6" class="h">@@ -1015,7 +1011,6 @@ jQuery.extend( jQuery.easing,
</a> }).call(this);
 
 
<a href="#h10-6-3" id="h10-6-3" class="d">-
</a> /* ---- data/1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ/js/utils/Text.coffee ---- */
 
 
<a href="#h10-7" id="h10-7" class="h">@@ -1061,7 +1056,6 @@ jQuery.extend( jQuery.easing,
</a> }).call(this);
 
 
<a href="#h10-7-3" id="h10-7-3" class="d">-
</a> /* ---- data/1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ/js/utils/Time.coffee ---- */
 
 
<a href="#h10-8" id="h10-8" class="h">@@ -1124,16 +1118,19 @@ jQuery.extend( jQuery.easing,
</a> }).call(this);
 
 
<a href="#h10-8-3" id="h10-8-3" class="d">-
</a> /* ---- data/1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ/js/utils/ZeroFrame.coffee ---- */
 
 
 (function() {
   var ZeroFrame,
     __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
<a href="#h10-8-10" id="h10-8-10" class="i">+    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
</a><a href="#h10-8-11" id="h10-8-11" class="i">+    __hasProp = {}.hasOwnProperty,
</a>     __slice = [].slice;
 
<a href="#h10-8-14" id="h10-8-14" class="d">-  ZeroFrame = (function() {
</a><a href="#h10-8-15" id="h10-8-15" class="i">+  ZeroFrame = (function(_super) {
</a><a href="#h10-8-16" id="h10-8-16" class="i">+    __extends(ZeroFrame, _super);
</a><a href="#h10-8-17" id="h10-8-17" class="i">+
</a>     function ZeroFrame(url) {
       this.onCloseWebsocket = __bind(this.onCloseWebsocket, this);
       this.onOpenWebsocket = __bind(this.onOpenWebsocket, this);
<a href="#h10-9" id="h10-9" class="h">@@ -1232,14 +1229,13 @@ jQuery.extend( jQuery.easing,
</a> 
     return ZeroFrame;
 
<a href="#h10-9-3" id="h10-9-3" class="d">-  })();
</a><a href="#h10-9-4" id="h10-9-4" class="i">+  })(Class);
</a> 
   window.ZeroFrame = ZeroFrame;
 
 }).call(this);
 
 
<a href="#h10-9-11" id="h10-9-11" class="d">-
</a> /* ---- data/1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ/js/TopicList.coffee ---- */
 
 
<a href="#h10-10" id="h10-10" class="h">@@ -1253,6 +1249,7 @@ jQuery.extend( jQuery.easing,
</a>     __extends(TopicList, _super);
 
     function TopicList() {
<a href="#h10-10-3" id="h10-10-3" class="i">+      this.submitTopicVote = __bind(this.submitTopicVote, this);
</a>       this.loadTopicsStat = __bind(this.loadTopicsStat, this);
       this.thread_sorter = null;
     }
<a href="#h10-11" id="h10-11" class="h">@@ -1269,8 +1266,8 @@ jQuery.extend( jQuery.easing,
</a>       })(this));
       return $(&quot;.topic-new .button-submit&quot;).on(&quot;click&quot;, (function(_this) {
         return function() {
<a href="#h10-11-3" id="h10-11-3" class="d">-          if (Page.user_name_db[Page.site_info.auth_address]) {
</a><a href="#h10-11-4" id="h10-11-4" class="d">-            _this.buttonCreateTopic();
</a><a href="#h10-11-5" id="h10-11-5" class="i">+          if (Users.to_name[Users.my_address]) {
</a><a href="#h10-11-6" id="h10-11-6" class="i">+            _this.submitCreateTopic();
</a>           } else {
             Page.cmd(&quot;wrapperNotification&quot;, [&quot;info&quot;, &quot;Please, request access before posting.&quot;]);
           }
<a href="#h10-12" id="h10-12" class="h">@@ -1286,7 +1283,7 @@ jQuery.extend( jQuery.easing,
</a>       if (cb == null) {
         cb = false;
       }
<a href="#h10-12-3" id="h10-12-3" class="d">-      this.logStart(&quot;Loadtopics&quot;);
</a><a href="#h10-12-4" id="h10-12-4" class="i">+      this.logStart(&quot;Load topics...&quot;);
</a>       return Page.cmd(&quot;fileQuery&quot;, [&quot;data/users/*/data.json&quot;, &quot;topics&quot;], (function(_this) {
         return function(topics) {
           var elem, last_elem, topic, topic_address, _i, _len;
<a href="#h10-13" id="h10-13" class="h">@@ -1296,20 +1293,16 @@ jQuery.extend( jQuery.easing,
</a>           last_elem = null;
           for (_i = 0, _len = topics.length; _i &lt; _len; _i++) {
             topic = topics[_i];
<a href="#h10-13-3" id="h10-13-3" class="d">-            topic_address = topic.topic_id + &quot;_&quot; + Page.user_id_db[topic.inner_path];
</a><a href="#h10-13-4" id="h10-13-4" class="i">+            topic_address = topic.topic_id + &quot;_&quot; + Users.to_id[topic.inner_path];
</a>             elem = $(&quot;#topic_&quot; + topic_address);
             if (elem.length === 0) {
               elem = $(&quot;.topics-list .topic.template&quot;).clone().removeClass(&quot;template&quot;).attr(&quot;id&quot;, &quot;topic_&quot; + topic_address);
               if (type !== &quot;noanim&quot;) {
                 elem.cssSlideDown();
               }
<a href="#h10-13-11" id="h10-13-11" class="i">+              elem.appendTo(&quot;.topics&quot;);
</a>             }
             _this.applyTopicData(elem, topic);
<a href="#h10-13-14" id="h10-13-14" class="d">-            if (last_elem) {
</a><a href="#h10-13-15" id="h10-13-15" class="d">-              last_elem.after(elem);
</a><a href="#h10-13-16" id="h10-13-16" class="d">-            } else {
</a><a href="#h10-13-17" id="h10-13-17" class="d">-              elem.prependTo(&quot;.topics&quot;);
</a><a href="#h10-13-18" id="h10-13-18" class="d">-            }
</a>           }
           $(&quot;body&quot;).css({
             &quot;overflow&quot;: &quot;auto&quot;,
<a href="#h10-14" id="h10-14" class="h">@@ -1320,7 +1313,7 @@ jQuery.extend( jQuery.easing,
</a>           } else {
             $(&quot;.topics-loading&quot;).remove();
           }
<a href="#h10-14-3" id="h10-14-3" class="d">-          _this.logEnd(&quot;Loadtopics&quot;);
</a><a href="#h10-14-4" id="h10-14-4" class="i">+          _this.logEnd(&quot;Load topics...&quot;);
</a>           Page.addInlineEditors();
           if (Page.site_info.tasks === 0) {
             _this.loadTopicsStat(type);
<a href="#h10-15" id="h10-15" class="h">@@ -1338,42 +1331,62 @@ jQuery.extend( jQuery.easing,
</a>     };
 
     TopicList.prototype.loadTopicsStat = function(type) {
<a href="#h10-15-3" id="h10-15-3" class="d">-      var s;
</a>       if (type == null) {
         type = &quot;normal&quot;;
       }
<a href="#h10-15-7" id="h10-15-7" class="d">-      s = +(new Date);
</a><a href="#h10-15-8" id="h10-15-8" class="i">+      this.logStart(&quot;Load topics stats...&quot;);
</a>       return Page.cmd(&quot;fileQuery&quot;, [&quot;data/users/*/data.json&quot;, &quot;&quot;], (function(_this) {
         return function(users) {
<a href="#h10-15-11" id="h10-15-11" class="d">-          var comment, comments, elem, last, stat, stats, topic, topic_address, topics, user, user_id, visited, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref, _ref1;
</a><a href="#h10-15-12" id="h10-15-12" class="i">+          var comment, comments, elem, last, my_topic_votes, stat, stats, topic, topic_address, topics, user, user_id, visited, vote, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref, _ref1, _ref2;
</a>           $(&quot;.topics&quot;).css(&quot;opacity&quot;, 1);
           stats = [];
<a href="#h10-15-15" id="h10-15-15" class="i">+          my_topic_votes = {};
</a>           for (_i = 0, _len = users.length; _i &lt; _len; _i++) {
             user = users[_i];
<a href="#h10-15-18" id="h10-15-18" class="i">+            user_id = Users.to_id[user.inner_path];
</a>             _ref = user.topics;
             for (_j = 0, _len1 = _ref.length; _j &lt; _len1; _j++) {
               topic = _ref[_j];
<a href="#h10-15-22" id="h10-15-22" class="d">-              user_id = Page.user_id_db[user.inner_path];
</a>               topic_address = topic.topic_id + &quot;_&quot; + user_id;
               if (stats[topic_address] == null) {
                 stats[topic_address] = {
                   &quot;comments&quot;: 0,
                   &quot;last&quot;: {
                     &quot;added&quot;: topic.added
<a href="#h10-15-29" id="h10-15-29" class="d">-                  }
</a><a href="#h10-15-30" id="h10-15-30" class="i">+                  },
</a><a href="#h10-15-31" id="h10-15-31" class="i">+                  &quot;votes&quot;: 1
</a>                 };
               }
             }
<a href="#h10-15-35" id="h10-15-35" class="d">-            _ref1 = user[&quot;comments&quot;];
</a><a href="#h10-15-36" id="h10-15-36" class="i">+            _ref1 = user[&quot;topic_votes&quot;];
</a>             for (topic_address in _ref1) {
<a href="#h10-15-38" id="h10-15-38" class="d">-              comments = _ref1[topic_address];
</a><a href="#h10-15-39" id="h10-15-39" class="i">+              vote = _ref1[topic_address];
</a><a href="#h10-15-40" id="h10-15-40" class="i">+              topic_address = topic_address.replace(&quot;@&quot;, &quot;_&quot;);
</a><a href="#h10-15-41" id="h10-15-41" class="i">+              if (stats[topic_address] == null) {
</a><a href="#h10-15-42" id="h10-15-42" class="i">+                stats[topic_address] = {
</a><a href="#h10-15-43" id="h10-15-43" class="i">+                  &quot;comments&quot;: 0,
</a><a href="#h10-15-44" id="h10-15-44" class="i">+                  &quot;last&quot;: null,
</a><a href="#h10-15-45" id="h10-15-45" class="i">+                  &quot;votes&quot;: 1
</a><a href="#h10-15-46" id="h10-15-46" class="i">+                };
</a><a href="#h10-15-47" id="h10-15-47" class="i">+              }
</a><a href="#h10-15-48" id="h10-15-48" class="i">+              if (vote === 1) {
</a><a href="#h10-15-49" id="h10-15-49" class="i">+                stats[topic_address][&quot;votes&quot;] += 1;
</a><a href="#h10-15-50" id="h10-15-50" class="i">+              }
</a><a href="#h10-15-51" id="h10-15-51" class="i">+            }
</a><a href="#h10-15-52" id="h10-15-52" class="i">+            if (user_id === Users.my_id) {
</a><a href="#h10-15-53" id="h10-15-53" class="i">+              my_topic_votes = user[&quot;topic_votes&quot;];
</a><a href="#h10-15-54" id="h10-15-54" class="i">+            }
</a><a href="#h10-15-55" id="h10-15-55" class="i">+            _ref2 = user[&quot;comments&quot;];
</a><a href="#h10-15-56" id="h10-15-56" class="i">+            for (topic_address in _ref2) {
</a><a href="#h10-15-57" id="h10-15-57" class="i">+              comments = _ref2[topic_address];
</a>               topic_address = topic_address.replace(&quot;@&quot;, &quot;_&quot;);
               for (_k = 0, _len2 = comments.length; _k &lt; _len2; _k++) {
                 comment = comments[_k];
                 if (stats[topic_address] == null) {
                   stats[topic_address] = {
                     &quot;comments&quot;: 0,
<a href="#h10-15-64" id="h10-15-64" class="d">-                    &quot;last&quot;: null
</a><a href="#h10-15-65" id="h10-15-65" class="i">+                    &quot;last&quot;: null,
</a><a href="#h10-15-66" id="h10-15-66" class="i">+                    &quot;votes&quot;: 1
</a>                   };
                 }
                 last = stats[topic_address][&quot;last&quot;];
<a href="#h10-16" id="h10-16" class="h">@@ -1387,49 +1400,63 @@ jQuery.extend( jQuery.easing,
</a>           }
           for (topic_address in stats) {
             stat = stats[topic_address];
<a href="#h10-16-3" id="h10-16-3" class="d">-            if (stat.comments &gt; 0) {
</a><a href="#h10-16-4" id="h10-16-4" class="d">-              $(&quot;#topic_&quot; + topic_address + &quot; .comment-num&quot;).text(stat.comments + &quot; comment&quot;);
</a><a href="#h10-16-5" id="h10-16-5" class="d">-              $(&quot;#topic_&quot; + topic_address + &quot; .added&quot;).text(&quot;last &quot; + Time.since(stat[&quot;last&quot;][&quot;added&quot;]));
</a><a href="#h10-16-6" id="h10-16-6" class="i">+            elem = $(&quot;#topic_&quot; + topic_address);
</a><a href="#h10-16-7" id="h10-16-7" class="i">+            if (stat.comments &gt; 0 &amp;&amp; type !== &quot;full&quot;) {
</a><a href="#h10-16-8" id="h10-16-8" class="i">+              $(&quot;.comment-num&quot;, elem).text(stat.comments + &quot; comment&quot;);
</a><a href="#h10-16-9" id="h10-16-9" class="i">+              $(&quot;.added&quot;, elem).text(&quot;last &quot; + Time.since(stat[&quot;last&quot;][&quot;added&quot;]));
</a>             }
<a href="#h10-16-11" id="h10-16-11" class="d">-          }
</a><a href="#h10-16-12" id="h10-16-12" class="d">-          topics = (function() {
</a><a href="#h10-16-13" id="h10-16-13" class="d">-            var _results;
</a><a href="#h10-16-14" id="h10-16-14" class="d">-            _results = [];
</a><a href="#h10-16-15" id="h10-16-15" class="d">-            for (topic_address in stats) {
</a><a href="#h10-16-16" id="h10-16-16" class="d">-              stat = stats[topic_address];
</a><a href="#h10-16-17" id="h10-16-17" class="d">-              _results.push([topic_address, stat.last.added]);
</a><a href="#h10-16-18" id="h10-16-18" class="i">+            if (my_topic_votes != null ? my_topic_votes[topic_address.replace(&quot;_&quot;, &quot;@&quot;)] : void 0) {
</a><a href="#h10-16-19" id="h10-16-19" class="i">+              $(&quot;.score-inactive .score-num&quot;, elem).text(stat[&quot;votes&quot;] - 1);
</a><a href="#h10-16-20" id="h10-16-20" class="i">+              $(&quot;.score-active .score-num&quot;, elem).text(stat[&quot;votes&quot;]);
</a><a href="#h10-16-21" id="h10-16-21" class="i">+              $(&quot;.score&quot;, elem).addClass(&quot;active&quot;);
</a><a href="#h10-16-22" id="h10-16-22" class="i">+            } else {
</a><a href="#h10-16-23" id="h10-16-23" class="i">+              $(&quot;.score-inactive .score-num&quot;, elem).text(stat[&quot;votes&quot;]);
</a><a href="#h10-16-24" id="h10-16-24" class="i">+              $(&quot;.score-active .score-num&quot;, elem).text(stat[&quot;votes&quot;] + 1);
</a>             }
<a href="#h10-16-26" id="h10-16-26" class="d">-            return _results;
</a><a href="#h10-16-27" id="h10-16-27" class="d">-          })();
</a><a href="#h10-16-28" id="h10-16-28" class="d">-          topics.sort(function(a, b) {
</a><a href="#h10-16-29" id="h10-16-29" class="d">-            return a[1] - b[1];
</a><a href="#h10-16-30" id="h10-16-30" class="d">-          });
</a><a href="#h10-16-31" id="h10-16-31" class="d">-          for (_l = 0, _len3 = topics.length; _l &lt; _len3; _l++) {
</a><a href="#h10-16-32" id="h10-16-32" class="d">-            topic = topics[_l];
</a><a href="#h10-16-33" id="h10-16-33" class="d">-            topic_address = topic[0];
</a><a href="#h10-16-34" id="h10-16-34" class="d">-            elem = $(&quot;#topic_&quot; + topic_address);
</a><a href="#h10-16-35" id="h10-16-35" class="d">-            elem.prependTo(&quot;.topics&quot;);
</a><a href="#h10-16-36" id="h10-16-36" class="d">-            visited = Page.local_storage[&quot;topic.&quot; + topic_address + &quot;.visited&quot;];
</a><a href="#h10-16-37" id="h10-16-37" class="d">-            if (!visited) {
</a><a href="#h10-16-38" id="h10-16-38" class="d">-              elem.addClass(&quot;visit-none&quot;);
</a><a href="#h10-16-39" id="h10-16-39" class="d">-            } else if (visited &lt; topic[1]) {
</a><a href="#h10-16-40" id="h10-16-40" class="d">-              elem.addClass(&quot;visit-newcomment&quot;);
</a><a href="#h10-16-41" id="h10-16-41" class="i">+            $(&quot;.score&quot;, elem).off(&quot;click&quot;).on(&quot;click&quot;, _this.submitTopicVote);
</a><a href="#h10-16-42" id="h10-16-42" class="i">+          }
</a><a href="#h10-16-43" id="h10-16-43" class="i">+          if (type !== &quot;full&quot;) {
</a><a href="#h10-16-44" id="h10-16-44" class="i">+            topics = (function() {
</a><a href="#h10-16-45" id="h10-16-45" class="i">+              var _results;
</a><a href="#h10-16-46" id="h10-16-46" class="i">+              _results = [];
</a><a href="#h10-16-47" id="h10-16-47" class="i">+              for (topic_address in stats) {
</a><a href="#h10-16-48" id="h10-16-48" class="i">+                stat = stats[topic_address];
</a><a href="#h10-16-49" id="h10-16-49" class="i">+                _results.push([topic_address, stat.last.added]);
</a><a href="#h10-16-50" id="h10-16-50" class="i">+              }
</a><a href="#h10-16-51" id="h10-16-51" class="i">+              return _results;
</a><a href="#h10-16-52" id="h10-16-52" class="i">+            })();
</a><a href="#h10-16-53" id="h10-16-53" class="i">+            topics.sort(function(a, b) {
</a><a href="#h10-16-54" id="h10-16-54" class="i">+              return a[1] - b[1];
</a><a href="#h10-16-55" id="h10-16-55" class="i">+            });
</a><a href="#h10-16-56" id="h10-16-56" class="i">+            for (_l = 0, _len3 = topics.length; _l &lt; _len3; _l++) {
</a><a href="#h10-16-57" id="h10-16-57" class="i">+              topic = topics[_l];
</a><a href="#h10-16-58" id="h10-16-58" class="i">+              topic_address = topic[0];
</a><a href="#h10-16-59" id="h10-16-59" class="i">+              elem = $(&quot;#topic_&quot; + topic_address);
</a><a href="#h10-16-60" id="h10-16-60" class="i">+              elem.prependTo(&quot;.topics&quot;);
</a><a href="#h10-16-61" id="h10-16-61" class="i">+              visited = Page.local_storage[&quot;topic.&quot; + topic_address + &quot;.visited&quot;];
</a><a href="#h10-16-62" id="h10-16-62" class="i">+              if (!visited) {
</a><a href="#h10-16-63" id="h10-16-63" class="i">+                elem.addClass(&quot;visit-none&quot;);
</a><a href="#h10-16-64" id="h10-16-64" class="i">+              } else if (visited &lt; topic[1]) {
</a><a href="#h10-16-65" id="h10-16-65" class="i">+                elem.addClass(&quot;visit-newcomment&quot;);
</a><a href="#h10-16-66" id="h10-16-66" class="i">+              }
</a>             }
           }
<a href="#h10-16-69" id="h10-16-69" class="d">-          return _this.log(&quot;Topics stats loaded in&quot;, (+(new Date)) - s);
</a><a href="#h10-16-70" id="h10-16-70" class="i">+          return _this.logEnd(&quot;Load topics stats...&quot;);
</a>         };
       })(this));
     };
 
     TopicList.prototype.applyTopicData = function(elem, topic, type) {
<a href="#h10-16-76" id="h10-16-76" class="d">-      var body, match, title_hash, url, user_id, username;
</a><a href="#h10-16-77" id="h10-16-77" class="i">+      var body, match, title_hash, topic_address, url, user_id, user_name;
</a>       if (type == null) {
         type = &quot;normal&quot;;
       }
       title_hash = topic.title.replace(/[#,&quot;&apos;?&amp; ]/g, &quot;+&quot;).replace(/[+]+/g, &quot;+&quot;).replace(/[+]+$/, &quot;&quot;);
<a href="#h10-16-82" id="h10-16-82" class="d">-      user_id = Page.user_id_db[topic.inner_path];
</a><a href="#h10-16-83" id="h10-16-83" class="i">+      user_id = Users.to_id[topic.inner_path];
</a><a href="#h10-16-84" id="h10-16-84" class="i">+      topic_address = topic.topic_id + &quot;@&quot; + user_id;
</a>       $(&quot;.title .title-link&quot;, elem).text(topic.title);
<a href="#h10-16-86" id="h10-16-86" class="d">-      $(&quot;.title .title-link, a.image, .comment-num&quot;, elem).attr(&quot;href&quot;, &quot;?Topic:&quot; + topic.topic_id + &quot;@&quot; + user_id + &quot;/&quot; + title_hash);
</a><a href="#h10-16-87" id="h10-16-87" class="i">+      $(&quot;.title .title-link, a.image, .comment-num&quot;, elem).attr(&quot;href&quot;, &quot;?Topic:&quot; + topic_address + &quot;/&quot; + title_hash);
</a><a href="#h10-16-88" id="h10-16-88" class="i">+      elem.data(&quot;topic_address&quot;, topic_address);
</a>       body = topic.body;
       match = topic.body.match(/http[s]{0,1}:\/\/[^&quot;&apos;, $]+/);
       if (match) {
<a href="#h10-17" id="h10-17" class="h">@@ -1451,17 +1478,19 @@ jQuery.extend( jQuery.easing,
</a>       } else {
         $(&quot;.body&quot;, elem).text(body);
       }
<a href="#h10-17-3" id="h10-17-3" class="d">-      username = Page.user_name_db[topic.inner_path];
</a><a href="#h10-17-4" id="h10-17-4" class="d">-      $(&quot;.username&quot;, elem).text(username);
</a><a href="#h10-17-5" id="h10-17-5" class="d">-      $(&quot;.added&quot;, elem).text(Time.since(topic.added));
</a><a href="#h10-17-6" id="h10-17-6" class="d">-      if (topic.inner_path === Page.site_info.auth_address) {
</a><a href="#h10-17-7" id="h10-17-7" class="d">-        $(elem).attr(&quot;data-object&quot;, &quot;Topic:&quot; + topic.topic_id + &quot;@&quot; + user_id).attr(&quot;data-deletable&quot;, &quot;yes&quot;);
</a><a href="#h10-17-8" id="h10-17-8" class="i">+      user_name = Users.to_name[topic.inner_path];
</a><a href="#h10-17-9" id="h10-17-9" class="i">+      $(&quot;.user_name&quot;, elem).text(user_name);
</a><a href="#h10-17-10" id="h10-17-10" class="i">+      if (type === &quot;full&quot;) {
</a><a href="#h10-17-11" id="h10-17-11" class="i">+        $(&quot;.added&quot;, elem).text(Time.since(topic.added));
</a><a href="#h10-17-12" id="h10-17-12" class="i">+      }
</a><a href="#h10-17-13" id="h10-17-13" class="i">+      if (topic.inner_path === Users.my_address) {
</a><a href="#h10-17-14" id="h10-17-14" class="i">+        $(elem).attr(&quot;data-object&quot;, &quot;Topic:&quot; + topic_address).attr(&quot;data-deletable&quot;, &quot;yes&quot;);
</a>         $(&quot;.title .title-link&quot;, elem).attr(&quot;data-editable&quot;, &quot;title&quot;).data(&quot;content&quot;, topic.title);
         return $(&quot;.body&quot;, elem).attr(&quot;data-editable&quot;, &quot;body&quot;).data(&quot;content&quot;, topic.body);
       }
     };
 
<a href="#h10-17-20" id="h10-17-20" class="d">-    TopicList.prototype.buttonCreateTopic = function() {
</a><a href="#h10-17-21" id="h10-17-21" class="i">+    TopicList.prototype.submitCreateTopic = function() {
</a>       var body, inner_path, title;
       if (!Page.hasOpenPort()) {
         return false;
<a href="#h10-18" id="h10-18" class="h">@@ -1472,7 +1501,7 @@ jQuery.extend( jQuery.easing,
</a>         return $(&quot;.topic-new #topic_title&quot;).focus();
       }
       $(&quot;.topic-new .button-submit&quot;).addClass(&quot;loading&quot;);
<a href="#h10-18-3" id="h10-18-3" class="d">-      inner_path = &quot;data/users/&quot; + Page.site_info.auth_address + &quot;/data.json&quot;;
</a><a href="#h10-18-4" id="h10-18-4" class="i">+      inner_path = &quot;data/users/&quot; + Users.my_address + &quot;/data.json&quot;;
</a>       return Page.cmd(&quot;fileGet&quot;, [inner_path], (function(_this) {
         return function(data) {
           data = JSON.parse(data);
<a href="#h10-19" id="h10-19" class="h">@@ -1502,6 +1531,41 @@ jQuery.extend( jQuery.easing,
</a>       })(this));
     };
 
<a href="#h10-19-3" id="h10-19-3" class="i">+    TopicList.prototype.submitTopicVote = function(e) {
</a><a href="#h10-19-4" id="h10-19-4" class="i">+      var elem, inner_path;
</a><a href="#h10-19-5" id="h10-19-5" class="i">+      if (!Users.my_name) {
</a><a href="#h10-19-6" id="h10-19-6" class="i">+        Page.cmd(&quot;wrapperNotification&quot;, [&quot;info&quot;, &quot;Please, request access before posting.&quot;]);
</a><a href="#h10-19-7" id="h10-19-7" class="i">+        return false;
</a><a href="#h10-19-8" id="h10-19-8" class="i">+      }
</a><a href="#h10-19-9" id="h10-19-9" class="i">+      elem = $(e.currentTarget);
</a><a href="#h10-19-10" id="h10-19-10" class="i">+      elem.toggleClass(&quot;active&quot;).addClass(&quot;loading&quot;);
</a><a href="#h10-19-11" id="h10-19-11" class="i">+      inner_path = &quot;data/users/&quot; + Users.my_address + &quot;/data.json&quot;;
</a><a href="#h10-19-12" id="h10-19-12" class="i">+      Page.cmd(&quot;fileGet&quot;, [inner_path], (function(_this) {
</a><a href="#h10-19-13" id="h10-19-13" class="i">+        return function(data) {
</a><a href="#h10-19-14" id="h10-19-14" class="i">+          var topic_address;
</a><a href="#h10-19-15" id="h10-19-15" class="i">+          data = JSON.parse(data);
</a><a href="#h10-19-16" id="h10-19-16" class="i">+          if (data.topic_votes == null) {
</a><a href="#h10-19-17" id="h10-19-17" class="i">+            data.topic_votes = {};
</a><a href="#h10-19-18" id="h10-19-18" class="i">+          }
</a><a href="#h10-19-19" id="h10-19-19" class="i">+          topic_address = elem.parents(&quot;.topic&quot;).data(&quot;topic_address&quot;);
</a><a href="#h10-19-20" id="h10-19-20" class="i">+          if (elem.hasClass(&quot;active&quot;)) {
</a><a href="#h10-19-21" id="h10-19-21" class="i">+            data.topic_votes[topic_address] = 1;
</a><a href="#h10-19-22" id="h10-19-22" class="i">+          } else {
</a><a href="#h10-19-23" id="h10-19-23" class="i">+            delete data.topic_votes[topic_address];
</a><a href="#h10-19-24" id="h10-19-24" class="i">+          }
</a><a href="#h10-19-25" id="h10-19-25" class="i">+          return Page.writePublish(inner_path, Page.jsonEncode(data), function(res) {
</a><a href="#h10-19-26" id="h10-19-26" class="i">+            elem.removeClass(&quot;loading&quot;);
</a><a href="#h10-19-27" id="h10-19-27" class="i">+            if (res === true) {
</a><a href="#h10-19-28" id="h10-19-28" class="i">+              return _this.log(&quot;File written&quot;);
</a><a href="#h10-19-29" id="h10-19-29" class="i">+            } else {
</a><a href="#h10-19-30" id="h10-19-30" class="i">+              return elem.toggleClass(&quot;active&quot;);
</a><a href="#h10-19-31" id="h10-19-31" class="i">+            }
</a><a href="#h10-19-32" id="h10-19-32" class="i">+          });
</a><a href="#h10-19-33" id="h10-19-33" class="i">+        };
</a><a href="#h10-19-34" id="h10-19-34" class="i">+      })(this));
</a><a href="#h10-19-35" id="h10-19-35" class="i">+      return false;
</a><a href="#h10-19-36" id="h10-19-36" class="i">+    };
</a><a href="#h10-19-37" id="h10-19-37" class="i">+
</a>     return TopicList;
 
   })(Class);
<a href="#h10-20" id="h10-20" class="h">@@ -1511,7 +1575,6 @@ jQuery.extend( jQuery.easing,
</a> }).call(this);
 
 
<a href="#h10-20-3" id="h10-20-3" class="d">-
</a> /* ---- data/1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ/js/TopicShow.coffee ---- */
 
 
<a href="#h10-21" id="h10-21" class="h">@@ -1534,7 +1597,7 @@ jQuery.extend( jQuery.easing,
</a>       this.loadComments(&quot;noanim&quot;);
       return $(&quot;.comment-new .button-submit&quot;).on(&quot;click&quot;, (function(_this) {
         return function() {
<a href="#h10-21-3" id="h10-21-3" class="d">-          if (Page.user_name_db[Page.site_info.auth_address]) {
</a><a href="#h10-21-4" id="h10-21-4" class="i">+          if (Users.to_name[Users.my_address]) {
</a>             _this.buttonComment();
           } else {
             Page.cmd(&quot;wrapperNotification&quot;, [&quot;info&quot;, &quot;Please, request access before posting.&quot;]);
<a href="#h10-22" id="h10-22" class="h">@@ -1549,7 +1612,9 @@ jQuery.extend( jQuery.easing,
</a>       if (cb == null) {
         cb = false;
       }
<a href="#h10-22-3" id="h10-22-3" class="d">-      topic_user_address = Page.user_address_db[this.topic_user_id];
</a><a href="#h10-22-4" id="h10-22-4" class="i">+      this.logStart(&quot;Loading topic...&quot;);
</a><a href="#h10-22-5" id="h10-22-5" class="i">+      topic_user_address = Users.to_address[this.topic_user_id];
</a><a href="#h10-22-6" id="h10-22-6" class="i">+      $(&quot;.topic-full&quot;).attr(&quot;id&quot;, &quot;topic_&quot; + this.topic_id + &quot;_&quot; + this.topic_user_id);
</a>       return Page.cmd(&quot;fileQuery&quot;, [&quot;data/users/&quot; + topic_user_address + &quot;/data.json&quot;, &quot;topics.topic_id=&quot; + this.topic_id], (function(_this) {
         return function(topic) {
           topic = topic[0];
<a href="#h10-23" id="h10-23" class="h">@@ -1557,6 +1622,8 @@ jQuery.extend( jQuery.easing,
</a>           TopicList.applyTopicData($(&quot;.topic-full&quot;), topic, &quot;full&quot;);
           $(&quot;.topic-full&quot;).css(&quot;opacity&quot;, 1);
           $(&quot;body&quot;).addClass(&quot;page-topic&quot;);
<a href="#h10-23-3" id="h10-23-3" class="i">+          _this.logEnd(&quot;Loading topic...&quot;);
</a><a href="#h10-23-4" id="h10-23-4" class="i">+          TopicList.loadTopicsStat(&quot;full&quot;);
</a>           if (cb) {
             return cb();
           }
<a href="#h10-24" id="h10-24" class="h">@@ -1572,6 +1639,7 @@ jQuery.extend( jQuery.easing,
</a>       if (cb == null) {
         cb = false;
       }
<a href="#h10-24-3" id="h10-24-3" class="i">+      this.logStart(&quot;Loading comments...&quot;);
</a>       topic_address = this.topic_id + &quot;@&quot; + this.topic_user_id;
       Page.local_storage[&quot;topic.&quot; + this.topic_id + &quot;_&quot; + this.topic_user_id + &quot;.visited&quot;] = Time.timestamp();
       Page.cmd(&quot;wrapperSetLocalStorage&quot;, Page.local_storage);
<a href="#h10-25" id="h10-25" class="h">@@ -1583,7 +1651,7 @@ jQuery.extend( jQuery.easing,
</a>           });
           for (_i = 0, _len = comments.length; _i &lt; _len; _i++) {
             comment = comments[_i];
<a href="#h10-25-3" id="h10-25-3" class="d">-            user_id = Page.user_id_db[comment.inner_path];
</a><a href="#h10-25-4" id="h10-25-4" class="i">+            user_id = Users.to_id[comment.inner_path];
</a>             comment_address = comment.comment_id + &quot;_&quot; + user_id;
             elem = $(&quot;#comment_&quot; + comment_address);
             if (elem.length === 0) {
<a href="#h10-26" id="h10-26" class="h">@@ -1603,6 +1671,7 @@ jQuery.extend( jQuery.easing,
</a>             &quot;height&quot;: &quot;auto&quot;
           });
           Page.addInlineEditors();
<a href="#h10-26-3" id="h10-26-3" class="i">+          _this.logEnd(&quot;Loading comments...&quot;);
</a>           if (cb) {
             return cb();
           }
<a href="#h10-27" id="h10-27" class="h">@@ -1611,17 +1680,17 @@ jQuery.extend( jQuery.easing,
</a>     };
 
     TopicShow.prototype.applyCommentData = function(elem, comment) {
<a href="#h10-27-3" id="h10-27-3" class="d">-      var comment_id, topic_address, user_id, username;
</a><a href="#h10-27-4" id="h10-27-4" class="d">-      username = Page.user_name_db[comment.inner_path];
</a><a href="#h10-27-5" id="h10-27-5" class="i">+      var comment_id, topic_address, user_id, user_name;
</a><a href="#h10-27-6" id="h10-27-6" class="i">+      user_name = Users.to_name[comment.inner_path];
</a>       $(&quot;.body&quot;, elem).html(Text.toMarked(comment.body, {
         &quot;sanitize&quot;: true
       }));
<a href="#h10-27-10" id="h10-27-10" class="d">-      $(&quot;.username&quot;, elem).text(username).css({
</a><a href="#h10-27-11" id="h10-27-11" class="d">-        &quot;color&quot;: Text.toColor(username)
</a><a href="#h10-27-12" id="h10-27-12" class="i">+      $(&quot;.user_name&quot;, elem).text(user_name).css({
</a><a href="#h10-27-13" id="h10-27-13" class="i">+        &quot;color&quot;: Text.toColor(user_name)
</a>       });
       $(&quot;.added&quot;, elem).text(Time.since(comment.added));
       if (comment.inner_path === Page.site_info.auth_address) {
<a href="#h10-27-17" id="h10-27-17" class="d">-        user_id = Page.user_id_db[comment.inner_path];
</a><a href="#h10-27-18" id="h10-27-18" class="i">+        user_id = Users.to_id[comment.inner_path];
</a>         comment_id = elem.attr(&quot;id&quot;).replace(&quot;comment_&quot;, &quot;&quot;).replace(/_.*$/, &quot;&quot;);
         topic_address = elem.data(&quot;topic_address&quot;);
         $(elem).attr(&quot;data-object&quot;, &quot;Comment:&quot; + comment_id + &quot;@&quot; + topic_address).attr(&quot;data-deletable&quot;, &quot;yes&quot;);
<a href="#h10-28" id="h10-28" class="h">@@ -1667,11 +1736,11 @@ jQuery.extend( jQuery.easing,
</a>     };
 
     TopicShow.prototype.buttonReply = function(elem) {
<a href="#h10-28-3" id="h10-28-3" class="d">-      var body_add, post_id, username;
</a><a href="#h10-28-4" id="h10-28-4" class="i">+      var body_add, post_id, user_name;
</a>       this.log(&quot;Reply to&quot;, elem);
<a href="#h10-28-6" id="h10-28-6" class="d">-      username = $(&quot;.username&quot;, elem).text();
</a><a href="#h10-28-7" id="h10-28-7" class="i">+      user_name = $(&quot;.user_name&quot;, elem).text();
</a>       post_id = elem.attr(&quot;id&quot;);
<a href="#h10-28-9" id="h10-28-9" class="d">-      body_add = &quot;&gt; [&quot; + username + &quot;](\#&quot; + post_id + &quot;): &quot;;
</a><a href="#h10-28-10" id="h10-28-10" class="i">+      body_add = &quot;&gt; [&quot; + user_name + &quot;](\#&quot; + post_id + &quot;): &quot;;
</a>       body_add += $(&quot;.body&quot;, elem).text().trim(&quot;\n&quot;).replace(/\n/g, &quot;\n&gt; &quot;);
       body_add += &quot;\n\n&quot;;
       $(&quot;.comment-new #comment_body&quot;).val($(&quot;.comment-new #comment_body&quot;).val() + body_add);
<a href="#h10-29" id="h10-29" class="h">@@ -1688,6 +1757,98 @@ jQuery.extend( jQuery.easing,
</a> }).call(this);
 
 
<a href="#h10-29-3" id="h10-29-3" class="i">+/* ---- data/1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ/js/Users.coffee ---- */
</a><a href="#h10-29-4" id="h10-29-4" class="i">+
</a><a href="#h10-29-5" id="h10-29-5" class="i">+
</a><a href="#h10-29-6" id="h10-29-6" class="i">+(function() {
</a><a href="#h10-29-7" id="h10-29-7" class="i">+  var Users,
</a><a href="#h10-29-8" id="h10-29-8" class="i">+    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
</a><a href="#h10-29-9" id="h10-29-9" class="i">+    __hasProp = {}.hasOwnProperty;
</a><a href="#h10-29-10" id="h10-29-10" class="i">+
</a><a href="#h10-29-11" id="h10-29-11" class="i">+  Users = (function(_super) {
</a><a href="#h10-29-12" id="h10-29-12" class="i">+    __extends(Users, _super);
</a><a href="#h10-29-13" id="h10-29-13" class="i">+
</a><a href="#h10-29-14" id="h10-29-14" class="i">+    function Users() {
</a><a href="#h10-29-15" id="h10-29-15" class="i">+      this.to_id = {};
</a><a href="#h10-29-16" id="h10-29-16" class="i">+      this.to_address = {};
</a><a href="#h10-29-17" id="h10-29-17" class="i">+      this.to_name = {};
</a><a href="#h10-29-18" id="h10-29-18" class="i">+      this.my_address = null;
</a><a href="#h10-29-19" id="h10-29-19" class="i">+      this.my_id = null;
</a><a href="#h10-29-20" id="h10-29-20" class="i">+      this.my_name = null;
</a><a href="#h10-29-21" id="h10-29-21" class="i">+      this.my_max_size = null;
</a><a href="#h10-29-22" id="h10-29-22" class="i">+    }
</a><a href="#h10-29-23" id="h10-29-23" class="i">+
</a><a href="#h10-29-24" id="h10-29-24" class="i">+    Users.prototype.loadDb = function(cb) {
</a><a href="#h10-29-25" id="h10-29-25" class="i">+      if (cb == null) {
</a><a href="#h10-29-26" id="h10-29-26" class="i">+        cb = null;
</a><a href="#h10-29-27" id="h10-29-27" class="i">+      }
</a><a href="#h10-29-28" id="h10-29-28" class="i">+      this.logStart(&quot;Loading userDB&quot;);
</a><a href="#h10-29-29" id="h10-29-29" class="i">+      return Page.cmd(&quot;fileGet&quot;, [&quot;data/users/content.json&quot;], (function(_this) {
</a><a href="#h10-29-30" id="h10-29-30" class="i">+        return function(data) {
</a><a href="#h10-29-31" id="h10-29-31" class="i">+          var address, path, user, _ref;
</a><a href="#h10-29-32" id="h10-29-32" class="i">+          data = JSON.parse(data);
</a><a href="#h10-29-33" id="h10-29-33" class="i">+          _ref = data[&quot;includes&quot;];
</a><a href="#h10-29-34" id="h10-29-34" class="i">+          for (path in _ref) {
</a><a href="#h10-29-35" id="h10-29-35" class="i">+            user = _ref[path];
</a><a href="#h10-29-36" id="h10-29-36" class="i">+            address = user.signers[0];
</a><a href="#h10-29-37" id="h10-29-37" class="i">+            _this.to_id[address] = user.user_id;
</a><a href="#h10-29-38" id="h10-29-38" class="i">+            _this.to_address[user.user_id] = address;
</a><a href="#h10-29-39" id="h10-29-39" class="i">+            _this.to_name[address] = user.user_name;
</a><a href="#h10-29-40" id="h10-29-40" class="i">+            if (address === _this.my_address) {
</a><a href="#h10-29-41" id="h10-29-41" class="i">+              _this.my_max_size = user.max_size;
</a><a href="#h10-29-42" id="h10-29-42" class="i">+            }
</a><a href="#h10-29-43" id="h10-29-43" class="i">+          }
</a><a href="#h10-29-44" id="h10-29-44" class="i">+          _this.logEnd(&quot;Loading userDB&quot;);
</a><a href="#h10-29-45" id="h10-29-45" class="i">+          if (cb) {
</a><a href="#h10-29-46" id="h10-29-46" class="i">+            return cb();
</a><a href="#h10-29-47" id="h10-29-47" class="i">+          }
</a><a href="#h10-29-48" id="h10-29-48" class="i">+        };
</a><a href="#h10-29-49" id="h10-29-49" class="i">+      })(this));
</a><a href="#h10-29-50" id="h10-29-50" class="i">+    };
</a><a href="#h10-29-51" id="h10-29-51" class="i">+
</a><a href="#h10-29-52" id="h10-29-52" class="i">+    Users.prototype.updateMyInfo = function() {
</a><a href="#h10-29-53" id="h10-29-53" class="i">+      var address, user_name;
</a><a href="#h10-29-54" id="h10-29-54" class="i">+      this.log(&quot;Updating user info...&quot;, this.my_address);
</a><a href="#h10-29-55" id="h10-29-55" class="i">+      address = this.my_address;
</a><a href="#h10-29-56" id="h10-29-56" class="i">+      user_name = this.to_name[address];
</a><a href="#h10-29-57" id="h10-29-57" class="i">+      if (user_name) {
</a><a href="#h10-29-58" id="h10-29-58" class="i">+        this.my_name = user_name;
</a><a href="#h10-29-59" id="h10-29-59" class="i">+        this.my_id = this.to_id[address];
</a><a href="#h10-29-60" id="h10-29-60" class="i">+        if ($(&quot;.head-user.visitor&quot;).css(&quot;display&quot;) !== &quot;none&quot;) {
</a><a href="#h10-29-61" id="h10-29-61" class="i">+          $(&quot;.head-user.visitor&quot;).css(&quot;display&quot;, &quot;none&quot;);
</a><a href="#h10-29-62" id="h10-29-62" class="i">+          Page.cmd(&quot;wrapperNotification&quot;, [&quot;done&quot;, &quot;Hello &lt;b&gt;&quot; + user_name + &quot;&lt;/b&gt;!&lt;br&gt;Congratulations, your registration is done!&quot;, 10000]);
</a><a href="#h10-29-63" id="h10-29-63" class="i">+          $(&quot;.button.signup&quot;).removeClass(&quot;loading&quot;);
</a><a href="#h10-29-64" id="h10-29-64" class="i">+        }
</a><a href="#h10-29-65" id="h10-29-65" class="i">+        $(&quot;.head-user.registered&quot;).css(&quot;display&quot;, &quot;&quot;);
</a><a href="#h10-29-66" id="h10-29-66" class="i">+        $(&quot;.user_name-my&quot;).text(user_name).css(&quot;color&quot;, Text.toColor(user_name)).attr(&quot;title&quot;, address);
</a><a href="#h10-29-67" id="h10-29-67" class="i">+        return Page.cmd(&quot;fileGet&quot;, [&quot;data/users/&quot; + address + &quot;/content.json&quot;], (function(_this) {
</a><a href="#h10-29-68" id="h10-29-68" class="i">+          return function(content) {
</a><a href="#h10-29-69" id="h10-29-69" class="i">+            var details, relative_path, sum, _ref;
</a><a href="#h10-29-70" id="h10-29-70" class="i">+            content = JSON.parse(content);
</a><a href="#h10-29-71" id="h10-29-71" class="i">+            sum = 0;
</a><a href="#h10-29-72" id="h10-29-72" class="i">+            _ref = content.files;
</a><a href="#h10-29-73" id="h10-29-73" class="i">+            for (relative_path in _ref) {
</a><a href="#h10-29-74" id="h10-29-74" class="i">+              details = _ref[relative_path];
</a><a href="#h10-29-75" id="h10-29-75" class="i">+              sum += details.size;
</a><a href="#h10-29-76" id="h10-29-76" class="i">+            }
</a><a href="#h10-29-77" id="h10-29-77" class="i">+            $(&quot;.head-user .size&quot;).text(&quot;Used: &quot; + ((sum / 1000).toFixed(1)) + &quot;k / &quot; + (parseInt(_this.my_max_size / 1000)) + &quot;k&quot;);
</a><a href="#h10-29-78" id="h10-29-78" class="i">+            return $(&quot;.head-user .size-used&quot;).width(parseFloat(sum / _this.my_max_size) * 100);
</a><a href="#h10-29-79" id="h10-29-79" class="i">+          };
</a><a href="#h10-29-80" id="h10-29-80" class="i">+        })(this));
</a><a href="#h10-29-81" id="h10-29-81" class="i">+      } else {
</a><a href="#h10-29-82" id="h10-29-82" class="i">+        $(&quot;.head-user.visitor&quot;).css(&quot;display&quot;, &quot;&quot;);
</a><a href="#h10-29-83" id="h10-29-83" class="i">+        return $(&quot;.user_name-my&quot;).text(&quot;Visitor&quot;);
</a><a href="#h10-29-84" id="h10-29-84" class="i">+      }
</a><a href="#h10-29-85" id="h10-29-85" class="i">+    };
</a><a href="#h10-29-86" id="h10-29-86" class="i">+
</a><a href="#h10-29-87" id="h10-29-87" class="i">+    return Users;
</a><a href="#h10-29-88" id="h10-29-88" class="i">+
</a><a href="#h10-29-89" id="h10-29-89" class="i">+  })(Class);
</a><a href="#h10-29-90" id="h10-29-90" class="i">+
</a><a href="#h10-29-91" id="h10-29-91" class="i">+  window.Users = new Users();
</a><a href="#h10-29-92" id="h10-29-92" class="i">+
</a><a href="#h10-29-93" id="h10-29-93" class="i">+}).call(this);
</a><a href="#h10-29-94" id="h10-29-94" class="i">+
</a> 
 /* ---- data/1TaLk3zM7ZRskJvrh3ZNCDVGXvkJusPKQ/js/ZeroTalk.coffee ---- */
 
<a href="#h10-30" id="h10-30" class="h">@@ -1717,10 +1878,7 @@ jQuery.extend( jQuery.easing,
</a>       this.site_info = null;
       this.server_info = null;
       this.local_storage = {};
<a href="#h10-30-3" id="h10-30-3" class="d">-      this.user_id_db = {};
</a><a href="#h10-30-4" id="h10-30-4" class="d">-      this.user_address_db = {};
</a><a href="#h10-30-5" id="h10-30-5" class="d">-      this.user_name_db = {};
</a><a href="#h10-30-6" id="h10-30-6" class="d">-      this.user_max_size = null;
</a><a href="#h10-30-7" id="h10-30-7" class="i">+      this.publishing = false;
</a>       _ref = $(&quot;textarea&quot;);
       for (_i = 0, _len = _ref.length; _i &lt; _len; _i++) {
         textarea = _ref[_i];
<a href="#h10-31" id="h10-31" class="h">@@ -1755,8 +1913,8 @@ jQuery.extend( jQuery.easing,
</a>       this.cmd(&quot;siteInfo&quot;, {}, (function(_this) {
         return function(site) {
           _this.setSiteinfo(site);
<a href="#h10-31-3" id="h10-31-3" class="d">-          return _this.loadUserDb(function() {
</a><a href="#h10-31-4" id="h10-31-4" class="d">-            _this.updateUserInfo();
</a><a href="#h10-31-5" id="h10-31-5" class="i">+          return Users.loadDb(function() {
</a><a href="#h10-31-6" id="h10-31-6" class="i">+            Users.updateMyInfo();
</a>             return _this.routeUrl(window.location.search.substring(1));
           });
         };
<a href="#h10-32" id="h10-32" class="h">@@ -1833,7 +1991,7 @@ jQuery.extend( jQuery.easing,
</a>       }
       object = this.getObject(elem);
       _ref = object.data(&quot;object&quot;).split(&quot;:&quot;), type = _ref[0], id = _ref[1];
<a href="#h10-32-3" id="h10-32-3" class="d">-      inner_path = &quot;data/users/&quot; + this.site_info.auth_address + &quot;/data.json&quot;;
</a><a href="#h10-32-4" id="h10-32-4" class="i">+      inner_path = &quot;data/users/&quot; + Users.my_address + &quot;/data.json&quot;;
</a>       return this.cmd(&quot;fileGet&quot;, [inner_path], (function(_this) {
         return function(data) {
           var comment, comment_id, topic, topic_address, topic_id, topic_user_id, user_id, _ref1, _ref2;
<a href="#h10-33" id="h10-33" class="h">@@ -1923,65 +2081,6 @@ jQuery.extend( jQuery.easing,
</a>       })(this));
     };
 
<a href="#h10-33-3" id="h10-33-3" class="d">-    ZeroTalk.prototype.loadUserDb = function(cb) {
</a><a href="#h10-33-4" id="h10-33-4" class="d">-      if (cb == null) {
</a><a href="#h10-33-5" id="h10-33-5" class="d">-        cb = null;
</a><a href="#h10-33-6" id="h10-33-6" class="d">-      }
</a><a href="#h10-33-7" id="h10-33-7" class="d">-      this.log(&quot;Loading userdb&quot;);
</a><a href="#h10-33-8" id="h10-33-8" class="d">-      return this.cmd(&quot;fileGet&quot;, [&quot;data/users/content.json&quot;], (function(_this) {
</a><a href="#h10-33-9" id="h10-33-9" class="d">-        return function(data) {
</a><a href="#h10-33-10" id="h10-33-10" class="d">-          var address, path, user, _ref;
</a><a href="#h10-33-11" id="h10-33-11" class="d">-          data = JSON.parse(data);
</a><a href="#h10-33-12" id="h10-33-12" class="d">-          _ref = data[&quot;includes&quot;];
</a><a href="#h10-33-13" id="h10-33-13" class="d">-          for (path in _ref) {
</a><a href="#h10-33-14" id="h10-33-14" class="d">-            user = _ref[path];
</a><a href="#h10-33-15" id="h10-33-15" class="d">-            address = user.signers[0];
</a><a href="#h10-33-16" id="h10-33-16" class="d">-            _this.user_id_db[address] = user.user_id;
</a><a href="#h10-33-17" id="h10-33-17" class="d">-            _this.user_address_db[user.user_id] = address;
</a><a href="#h10-33-18" id="h10-33-18" class="d">-            _this.user_name_db[address] = user.user_name;
</a><a href="#h10-33-19" id="h10-33-19" class="d">-            if (address === _this.site_info[&quot;auth_address&quot;]) {
</a><a href="#h10-33-20" id="h10-33-20" class="d">-              _this.user_max_size = user.max_size;
</a><a href="#h10-33-21" id="h10-33-21" class="d">-            }
</a><a href="#h10-33-22" id="h10-33-22" class="d">-          }
</a><a href="#h10-33-23" id="h10-33-23" class="d">-          if (cb) {
</a><a href="#h10-33-24" id="h10-33-24" class="d">-            return cb();
</a><a href="#h10-33-25" id="h10-33-25" class="d">-          }
</a><a href="#h10-33-26" id="h10-33-26" class="d">-        };
</a><a href="#h10-33-27" id="h10-33-27" class="d">-      })(this));
</a><a href="#h10-33-28" id="h10-33-28" class="d">-    };
</a><a href="#h10-33-29" id="h10-33-29" class="d">-
</a><a href="#h10-33-30" id="h10-33-30" class="d">-    ZeroTalk.prototype.updateUserInfo = function() {
</a><a href="#h10-33-31" id="h10-33-31" class="d">-      var address, user_name;
</a><a href="#h10-33-32" id="h10-33-32" class="d">-      address = this.site_info[&quot;auth_address&quot;];
</a><a href="#h10-33-33" id="h10-33-33" class="d">-      user_name = this.user_name_db[address];
</a><a href="#h10-33-34" id="h10-33-34" class="d">-      if (user_name) {
</a><a href="#h10-33-35" id="h10-33-35" class="d">-        if ($(&quot;.head-user.visitor&quot;).css(&quot;display&quot;) !== &quot;none&quot;) {
</a><a href="#h10-33-36" id="h10-33-36" class="d">-          $(&quot;.head-user.visitor&quot;).css(&quot;display&quot;, &quot;none&quot;);
</a><a href="#h10-33-37" id="h10-33-37" class="d">-          this.cmd(&quot;wrapperNotification&quot;, [&quot;done&quot;, &quot;Hello &lt;b&gt;&quot; + user_name + &quot;&lt;/b&gt;!&lt;br&gt;Congratulations, your registration is done!&quot;, 10000]);
</a><a href="#h10-33-38" id="h10-33-38" class="d">-          $(&quot;.button.signup&quot;).removeClass(&quot;loading&quot;);
</a><a href="#h10-33-39" id="h10-33-39" class="d">-        }
</a><a href="#h10-33-40" id="h10-33-40" class="d">-        $(&quot;.head-user.registered&quot;).css(&quot;display&quot;, &quot;&quot;);
</a><a href="#h10-33-41" id="h10-33-41" class="d">-        $(&quot;.username-my&quot;).text(user_name).css(&quot;color&quot;, Text.toColor(user_name));
</a><a href="#h10-33-42" id="h10-33-42" class="d">-        return this.cmd(&quot;fileGet&quot;, [&quot;data/users/&quot; + address + &quot;/content.json&quot;], (function(_this) {
</a><a href="#h10-33-43" id="h10-33-43" class="d">-          return function(content) {
</a><a href="#h10-33-44" id="h10-33-44" class="d">-            var details, relative_path, sum, _ref;
</a><a href="#h10-33-45" id="h10-33-45" class="d">-            content = JSON.parse(content);
</a><a href="#h10-33-46" id="h10-33-46" class="d">-            sum = 0;
</a><a href="#h10-33-47" id="h10-33-47" class="d">-            _ref = content.files;
</a><a href="#h10-33-48" id="h10-33-48" class="d">-            for (relative_path in _ref) {
</a><a href="#h10-33-49" id="h10-33-49" class="d">-              details = _ref[relative_path];
</a><a href="#h10-33-50" id="h10-33-50" class="d">-              sum += details.size;
</a><a href="#h10-33-51" id="h10-33-51" class="d">-            }
</a><a href="#h10-33-52" id="h10-33-52" class="d">-            $(&quot;.head-user .size&quot;).text(&quot;Used: &quot; + ((sum / 1000).toFixed(1)) + &quot;k / &quot; + (parseInt(_this.user_max_size / 1000)) + &quot;k&quot;);
</a><a href="#h10-33-53" id="h10-33-53" class="d">-            return $(&quot;.head-user .size-used&quot;).width(parseFloat(sum / _this.user_max_size) * 100);
</a><a href="#h10-33-54" id="h10-33-54" class="d">-          };
</a><a href="#h10-33-55" id="h10-33-55" class="d">-        })(this));
</a><a href="#h10-33-56" id="h10-33-56" class="d">-      } else {
</a><a href="#h10-33-57" id="h10-33-57" class="d">-        $(&quot;.head-user.visitor&quot;).css(&quot;display&quot;, &quot;&quot;);
</a><a href="#h10-33-58" id="h10-33-58" class="d">-        return $(&quot;.username-my&quot;).text(&quot;Visitor&quot;);
</a><a href="#h10-33-59" id="h10-33-59" class="d">-      }
</a><a href="#h10-33-60" id="h10-33-60" class="d">-    };
</a><a href="#h10-33-61" id="h10-33-61" class="d">-
</a>     ZeroTalk.prototype.buttonSignup = function() {
       if (!this.hasOpenPort()) {
         return false;
<a href="#h10-34" id="h10-34" class="h">@@ -1991,7 +2090,7 @@ jQuery.extend( jQuery.easing,
</a>           $(&quot;.button.signup&quot;).addClass(&quot;loading&quot;);
           return $.post(&quot;http://demo.zeronet.io/ZeroTalk/signup.php&quot;, {
             &quot;user_name&quot;: user_name,
<a href="#h10-34-3" id="h10-34-3" class="d">-            &quot;auth_address&quot;: _this.site_info.auth_address
</a><a href="#h10-34-4" id="h10-34-4" class="i">+            &quot;auth_address&quot;: Users.my_address
</a>           }).always(function(res) {
             if (res === &quot;OK&quot;) {
               return _this.cmd(&quot;wrapperNotification&quot;, [&quot;done&quot;, &quot;Your registration has been sent!&quot;, 10000]);
<a href="#h10-35" id="h10-35" class="h">@@ -2009,16 +2108,24 @@ jQuery.extend( jQuery.easing,
</a>     };
 
     ZeroTalk.prototype.writePublish = function(inner_path, data, cb) {
<a href="#h10-35-3" id="h10-35-3" class="i">+      if (this.publishing) {
</a><a href="#h10-35-4" id="h10-35-4" class="i">+        this.cmd(&quot;wrapperNotification&quot;, [&quot;error&quot;, &quot;Publishing in progress, please wait until its finished.&quot;]);
</a><a href="#h10-35-5" id="h10-35-5" class="i">+        cb(false);
</a><a href="#h10-35-6" id="h10-35-6" class="i">+        return false;
</a><a href="#h10-35-7" id="h10-35-7" class="i">+      }
</a><a href="#h10-35-8" id="h10-35-8" class="i">+      this.publishing = true;
</a>       return this.cmd(&quot;fileWrite&quot;, [inner_path, data], (function(_this) {
         return function(res) {
           if (res !== &quot;ok&quot;) {
             _this.cmd(&quot;wrapperNotification&quot;, [&quot;error&quot;, &quot;File write error: &quot; + res]);
             cb(false);
<a href="#h10-35-14" id="h10-35-14" class="i">+            _this.publishing = false;
</a>             return false;
           }
           return _this.cmd(&quot;sitePublish&quot;, {
             &quot;inner_path&quot;: inner_path
           }, function(res) {
<a href="#h10-35-20" id="h10-35-20" class="i">+            _this.publishing = false;
</a>             if (res === &quot;ok&quot;) {
               return cb(true);
             } else {
<a href="#h10-36" id="h10-36" class="h">@@ -2047,14 +2154,16 @@ jQuery.extend( jQuery.easing,
</a>     };
 
     ZeroTalk.prototype.actionSetSiteInfo = function(res) {
<a href="#h10-36-3" id="h10-36-3" class="d">-      this.setSiteinfo(res.params);
</a><a href="#h10-36-4" id="h10-36-4" class="d">-      if (res.params.event &amp;&amp; res.params.event[0] === &quot;file_done&quot; &amp;&amp; res.params.event[1] === (&quot;data/users/&quot; + this.site_info.auth_address + &quot;/data.json&quot;)) {
</a><a href="#h10-36-5" id="h10-36-5" class="d">-        this.updateUserInfo();
</a><a href="#h10-36-6" id="h10-36-6" class="i">+      var site_info;
</a><a href="#h10-36-7" id="h10-36-7" class="i">+      site_info = res.params;
</a><a href="#h10-36-8" id="h10-36-8" class="i">+      this.setSiteinfo(site_info);
</a><a href="#h10-36-9" id="h10-36-9" class="i">+      if (site_info.event &amp;&amp; site_info.event[0] === &quot;file_done&quot; &amp;&amp; site_info.event[1] === (&quot;data/users/&quot; + Users.my_address + &quot;/data.json&quot;)) {
</a><a href="#h10-36-10" id="h10-36-10" class="i">+        Users.updateMyInfo();
</a>       }
<a href="#h10-36-12" id="h10-36-12" class="d">-      if (res.params.event &amp;&amp; res.params.event[0] === &quot;file_done&quot; &amp;&amp; res.params.event[1] === &quot;data/users/content.json&quot;) {
</a><a href="#h10-36-13" id="h10-36-13" class="d">-        this.loadUserDb();
</a><a href="#h10-36-14" id="h10-36-14" class="i">+      if (site_info.event &amp;&amp; site_info.event[0] === &quot;file_done&quot; &amp;&amp; site_info.event[1] === &quot;data/users/content.json&quot;) {
</a><a href="#h10-36-15" id="h10-36-15" class="i">+        Users.loadDb();
</a>       }
<a href="#h10-36-17" id="h10-36-17" class="d">-      if (res.params.event &amp;&amp; res.params.event[0] === &quot;file_done&quot; &amp;&amp; res.params.event[1].match(/.*users.*data.json$/)) {
</a><a href="#h10-36-18" id="h10-36-18" class="i">+      if (site_info.event &amp;&amp; site_info.event[0] === &quot;file_done&quot; &amp;&amp; site_info.event[1].match(/.*users.*data.json$/)) {
</a>         return LimitRate(((function(_this) {
           return function() {
             if ($(&quot;body&quot;).hasClass(&quot;page-topic&quot;)) {
<a href="#h10-37" id="h10-37" class="h">@@ -2070,7 +2179,8 @@ jQuery.extend( jQuery.easing,
</a>     };
 
     ZeroTalk.prototype.setSiteinfo = function(site_info) {
<a href="#h10-37-3" id="h10-37-3" class="d">-      return this.site_info = site_info;
</a><a href="#h10-37-4" id="h10-37-4" class="i">+      this.site_info = site_info;
</a><a href="#h10-37-5" id="h10-37-5" class="i">+      return Users.my_address = site_info.auth_address;
</a>     };
 
     ZeroTalk.prototype.autoExpand = function(elem) {
<b>diff --git a/<a id="h11" href="../file/js/utils/Class.coffee.html">js/utils/Class.coffee</a> b/<a href="../file/js/utils/Class.coffee.html">js/utils/Class.coffee</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -12,12 +12,12 @@ class Class
</a> 		return unless @trace
 		@logtimers or= {}
 		@logtimers[name] = +(new Date)
<a href="#h11-0-3" id="h11-0-3" class="d">-		@log &quot;[#{name}]&quot;, args..., &quot;(started)&quot; if args.length &gt; 0
</a><a href="#h11-0-4" id="h11-0-4" class="i">+		@log &quot;#{name}&quot;, args..., &quot;(started)&quot; if args.length &gt; 0
</a> 		@
 		
 	logEnd: (name, args...) -&gt;
 		ms = +(new Date)-@logtimers[name]
<a href="#h11-0-9" id="h11-0-9" class="d">-		@log &quot;[#{name}]&quot;, args..., &quot;(Done in #{ms}ms)&quot;
</a><a href="#h11-0-10" id="h11-0-10" class="i">+		@log &quot;#{name}&quot;, args..., &quot;(Done in #{ms}ms)&quot;
</a> 		@ 
 
 window.Class = Class 
\ No newline at end of file
<b>diff --git a/<a id="h12" href="../file/js/utils/ZeroFrame.coffee.html">js/utils/ZeroFrame.coffee</a> b/<a href="../file/js/utils/ZeroFrame.coffee.html">js/utils/ZeroFrame.coffee</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -1,4 +1,4 @@
</a><a href="#h12-0-0" id="h12-0-0" class="d">-class ZeroFrame
</a><a href="#h12-0-1" id="h12-0-1" class="i">+class ZeroFrame extends Class
</a> 	constructor: (url) -&gt;
 		@url = url
 		@waiting_cb = {}
</pre>
</div>
</body>
</html>
