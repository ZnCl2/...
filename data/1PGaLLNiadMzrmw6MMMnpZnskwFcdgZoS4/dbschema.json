{
  "db_name": "ZeroGallery",
  "db_file": "merged-ZeroGallery/ZeroGallery.db",
  "version": 3,
  "maps": {
    ".+/galleries/.+/manifest.json": {
      "to_json_table": [ "title", "added", "type", "lang", "cover", "description", "size"],
      "to_table": [ {"node": "tags", "table": "tags"} ]
    },
    ".+/user/.+/data.json": {
      "to_table": [
        { "node": "comments", "table": "comments" },
        { "node": "gallery_vote", "table": "gallery_vote", "key_col": "gallery", "val_col": "vote" }
      ]
    },
    ".+/user/.+/content.json": {
      "to_keyvalue": [ "cert_user_id" ]
    }
  },
  "tables": {
    "json": {
      "cols": [
        ["json_id", "INTEGER PRIMARY KEY AUTOINCREMENT"],
        ["site", "TEXT"],
        ["directory", "TEXT"],
        ["file_name", "TEXT"],
        ["title", "TEXT"],
        ["type", "TEXT"],
        ["lang", "TEXT"],
        ["cover", "TEXT"],
        ["description", "TEXT"],
        ["added", "INTEGER"],
        ["size", "INTEGER"]
      ],
      "indexes": ["CREATE UNIQUE INDEX path ON json (directory, site, file_name)", "CREATE INDEX added ON json (added)"],
      "schema_changed": 16
    },
    "tags": {
      "cols": [
        ["id", "INTEGER PRIMARY KEY AUTOINCREMENT"],
        ["namespace", "TEXT"],
        ["name", "TEXT"],
        ["json_id", "INTEGER REFERENCES json (json_id)"]
      ],
      "indexes": ["CREATE INDEX json_id ON tags (json_id)", "CREATE INDEX name ON tags (name)", "CREATE INDEX q_name ON tags (namespace, name)"],
      "schema_changed": 9
    },
    "comments": {
      "cols": [
        ["comment_id", "INTEGER"],
        ["gallery", "TEXT"],
        ["body", "TEXT"],
        ["added", "INTEGER"],
        ["json_id", "INTEGER REFERENCES json (json_id)"]
      ],
      "indexes": ["CREATE INDEX gallery ON comments(gallery)"],
      "schema_changed": 5
    },
    "gallery_vote": {
      "cols": [
        ["gallery", "TEXT"],
        ["vote", "INTEGER"],
        ["json_id", "INTEGER REFERENCES json (json_id)"]
      ],
      "indexes": ["CREATE UNIQUE INDEX gallery_vote_key ON gallery_vote(gallery, json_id)", "CREATE INDEX gallery_vote_uri ON gallery_vote(gallery)"],
      "schema_changed": 3
    }
  }
}
