{
	"next_paste_id": 1,
	"next_comment_id": 0,
	"paste": [
		{
			"paste_id": 0,
			"description": "",
			"body": "$ ls\nZeroChat.coffee  ZeroFrame.coffee\n$ cat *.coffee | coffee --compile --stdio >  all.js\n\n\nThe connection to ws://127.0.0.1:43110/Websocket?wrapper_key=f9c0e8b769f1ebe971fde2cefbb32e107650d4d3536ce9c0c3cac42b8c0941af was interrupted while the page was loading. all.js:40:16\n[ZeroWebsocket] Closed close { target: WebSocket, isTrusted: true, wasClean: true, code: 1001, reason: \"\", currentTarget: WebSocket, eventPhase: 2, bubbles: false, cancelable: false, defaultPrevented: false, timeStamp: 1457734469100947 } all.js:106:14\n[Wrapper] Created! all.js:1295:14\nTypeError: parent is undefined\nextend()\n all.js:5\nZeroChat<()\n all.js:10\n<anonymous>\n all.js:9\n<anonymous>\n all.js:2\n all.js:5:171\n[ZeroWebsocket] Open all.js:106:14\nhideProgress all.js:544:7\n[Wrapper] Setting title to 1Cec5T5m7woi3xdEWHZ9eV66j6BEmrE5xx - ZeroNet_ - ZeroNet all.js:1295:14\nUse of getPreventDefault() is deprecated.  Use defaultPrevented instead. 1Cec5T5m7woi3xdEWHZ9eV66j6BEmrE5xx\n\n\n// Generated by CoffeeScript 1.10.0\n(function() {\n  var ZeroChat, ZeroFrame,\n    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty,\n    slice = [].slice;\n\n  ZeroChat = (function(superClass) {\n    extend(ZeroChat, superClass);\n\n    function ZeroChat() {\n      this.onOpenWebsocket = bind(this.onOpenWebsocket, this);\n      return ZeroChat.__super__.constructor.apply(this, arguments);\n    }\n\n    ZeroChat.prototype.init = function() {\n      return this.addLine(\"inited!\");\n    };\n\n    ZeroChat.prototype.addLine = function(line) {\n      var messages;\n      messages = document.getElementById(\"messages\");\n      return messages.innerHTML = (\"<li>\" + line + \"</li>\") + messages.innerHTML;\n    };\n\n    ZeroChat.prototype.onOpenWebsocket = function(e) {\n      this.cmd(\"serverInfo\", {}, (function(_this) {\n        return function(server_info) {\n          return _this.addLine(\"serverInfo response: <pre>\" + JSON.stringify(server_info, null, 2) + \"</pre>\");\n        };\n      })(this));\n      return this.cmd(\"siteInfo\", {}, (function(_this) {\n        return function(site_info) {\n          return _this.addLine(\"siteInfo response: <pre>\" + JSON.stringify(site_info, null, 2) + \"</pre>\");\n        };\n      })(this));\n    };\n\n    return ZeroChat;\n\n  })(ZeroFrame);\n\n  window.Page = new ZeroChat();\n\n  ZeroFrame = (function() {\n    function ZeroFrame(url) {\n      this.onCloseWebsocket = bind(this.onCloseWebsocket, this);\n      this.onOpenWebsocket = bind(this.onOpenWebsocket, this);\n      this.route = bind(this.route, this);\n      this.onMessage = bind(this.onMessage, this);\n      this.url = url;\n      this.waiting_cb = {};\n      this.wrapper_nonce = document.location.href.replace(/.*wrapper_nonce=([A-Za-z0-9]+).*/, \"$1\");\n      this.connect();\n      this.next_message_id = 1;\n      this.init();\n    }\n\n    ZeroFrame.prototype.init = function() {\n      return this;\n    };\n\n    ZeroFrame.prototype.connect = function() {\n      this.target = window.parent;\n      window.addEventListener(\"message\", this.onMessage, false);\n      return this.cmd(\"innerReady\");\n    };\n\n    ZeroFrame.prototype.onMessage = function(e) {\n      var cmd, message;\n      message = e.data;\n      cmd = message.cmd;\n      if (cmd === \"response\") {\n        if (this.waiting_cb[message.to] != null) {\n          return this.waiting_cb[message.to](message.result);\n        } else {\n          return this.log(\"Websocket callback not found:\", message);\n        }\n      } else if (cmd === \"wrapperReady\") {\n        return this.cmd(\"innerReady\");\n      } else if (cmd === \"ping\") {\n        return this.response(message.id, \"pong\");\n      } else if (cmd === \"wrapperOpenedWebsocket\") {\n        return this.onOpenWebsocket();\n      } else if (cmd === \"wrapperClosedWebsocket\") {\n        return this.onCloseWebsocket();\n      } else {\n        return this.route(cmd, message);\n      }\n    };\n\n    ZeroFrame.prototype.route = function(cmd, message) {\n      return this.log(\"Unknown command\", message);\n    };\n\n    ZeroFrame.prototype.response = function(to, result) {\n      return this.send({\n        \"cmd\": \"response\",\n        \"to\": to,\n        \"result\": result\n      });\n    };\n\n    ZeroFrame.prototype.cmd = function(cmd, params, cb) {\n      if (params == null) {\n        params = {};\n      }\n      if (cb == null) {\n        cb = null;\n      }\n      return this.send({\n        \"cmd\": cmd,\n        \"params\": params\n      }, cb);\n    };\n\n    ZeroFrame.prototype.send = function(message, cb) {\n      if (cb == null) {\n        cb = null;\n      }\n      message.wrapper_nonce = this.wrapper_nonce;\n      message.id = this.next_message_id;\n      this.next_message_id += 1;\n      this.target.postMessage(message, \"*\");\n      if (cb) {\n        return this.waiting_cb[message.id] = cb;\n      }\n    };\n\n    ZeroFrame.prototype.log = function() {\n      var args;\n      args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n      return console.log.apply(console, [\"[ZeroFrame]\"].concat(slice.call(args)));\n    };\n\n    ZeroFrame.prototype.onOpenWebsocket = function() {\n      return this.log(\"Websocket open\");\n    };\n\n    ZeroFrame.prototype.onCloseWebsocket = function() {\n      return this.log(\"Websocket close\");\n    };\n\n    return ZeroFrame;\n\n  })();\n\n  window.ZeroFrame = ZeroFrame;\n\n}).call(this);\n",
			"language": "text/plain",
			"encrypted": false,
			"added": 1457734738
		}
	],
	"comment": []
}