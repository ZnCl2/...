{"next_paste_id":6,"next_comment_id":0,"paste":[{"paste_id":4,"description":"syncronite.sh","body":"#! /bin/sh\nUSERNAME=\"styromaniac\"\nZERONET_ROOT_DIR=\"/home/${USERNAME}/ZeroNet\"\nSITE_ADDRESS=\"15CEFKBRHFfAP9rmL6hhLmHoXrrgmw4B5o\"\nSH_DIR=\"${ZERONET_ROOT_DIR}/data/${SITE_ADDRESS}/cache/1/\"\nV3_TRACKERS=\"127.0.0.1:43110/raw/13hNAdge5ntxJmcnKzAxeLCuyowJkdvFxF/trackers/v3_trackers.html\"\nCLEARNET_TRACKERS=\"https://newtrackon.com/api/100\"\nOUTFILE1=\"${SH_DIR}_h_.html\"\nOUTFILE2=\"${SH_DIR}v3_trackers.html\"\nTEMPFILE1=\"${OUTFILE1}.new\"\nTEMPFILE2=\"${OUTFILE2}.new\"\n# 1. Start cURL to get trackers\n# 2. Use pipe operator `|` to work with cURL output\n#    It will only work if matched anything, so no need to check http response code\n# 3. Use `awk` to match for needed lines (you can add or remove protocols)\n# 4. Use `grep` to remove lines that contain nothing\n# 5. Use `sort` to get trackers in order\n# 6. Write everything to file, that will be the checkpoint\ncurl $CLEARNET_TRACKERS | awk '/udp/,/http/' | grep . | sort > $TEMPFILE1\n\nif cmp --silent -- \"$TEMPFILE1\" \"$OUTFILE1\"; then\n  echo \"Clearnet trackers: nothing to update, files are similar.\"\n  rm -f \"${TEMPFILE1}\"\nelse\n  # Replace the old clearnet trackers file with the new one if they differ and if tempfile is not empty\n  [ -s $TEMPFILE1 ] && mv \"${TEMPFILE1}\" \"${OUTFILE1}\" || rm -f \"${TEMPFILE1}\"\nfi\n\n\n# Make another cURL request for TORv3 trackers list\ncurl $V3_TRACKERS | awk '/zero/' | grep . | sort > $TEMPFILE2\n\nif cmp --silent -- \"$TEMPFILE2\" \"$OUTFILE2\"; then\n  echo \"TORv3 trackers: nothing to update, files are similar.\"\n  rm -f \"${TEMPFILE2}\"\nelse\n  # Replace the old v3 trackers file with the new one if they differ and if tempfile is not empty\n  [ -s $TEMPFILE2 ] && mv \"${TEMPFILE2}\" \"${OUTFILE2}\" || rm -f \"${TEMPFILE2}\"\nfi\n\n\n# Now, if we have no temp files, that means we have nothing to sign, so exit :)\nif [ ! -f \"$TEMPFILE1\" ] && [ ! -f \"$TEMPFILE2\" ]; then\n  echo \"Files are up to date\"\n  exit 1\nfi\n\n\n# Combine trackers files into Syncronite.html\ncat \"${SH_DIR}v3_trackers.html\" \"${SH_DIR}_h_.html\" > \"${SH_DIR}Syncronite.html\"\n\n# Sign and publish\n${ZERONET_ROOT_DIR}/zeronet.py siteSign \"${SITE_ADDRESS}\" --publish\n","language":"text/x-sh","encrypted":false,"added":1636155331},{"paste_id":5,"description":"","body":"#! /bin/sh\nUSERNAME=\"styromaniac\"\nZERONET_ROOT_DIR=\"/home/${USERNAME}/ZeroNet\"\nSITE_ADDRESS=\"15CEFKBRHFfAP9rmL6hhLmHoXrrgmw4B5o\"\nSH_DIR=\"${ZERONET_ROOT_DIR}/data/${SITE_ADDRESS}/cache/1/\"\nV3_TRACKERS=\"127.0.0.1:43110/raw/13hNAdge5ntxJmcnKzAxeLCuyowJkdvFxF/trackers/v3_trackers.html\"\nCLEARNET_TRACKERS=\"https://newtrackon.com/api/100\"\nOUTFILE1=\"${SH_DIR}_h_.html\"\nOUTFILE2=\"${SH_DIR}v3_trackers.html\"\nTEMPFILE1=\"${OUTFILE1}.new\"\nTEMPFILE2=\"${OUTFILE2}.new\"\n# 1. Start cURL to get trackers\n# 2. Use pipe operator `|` to work with cURL output\n#    It will only work if matched anything, so no need to check http response code\n# 3. Use `awk` to match for needed lines (you can add or remove protocols)\n# 4. Use `grep` to remove lines that contain nothing\n# 5. Use `sort` to get trackers in order\n# 6. Write everything to file, that will be the checkpoint\ncurl $CLEARNET_TRACKERS | awk '/udp/,/http/' | grep . | sort > $TEMPFILE1\n\nif [ ! -s $TEMPFILE1 ]; then\n  echo \"Clearnet trackers: cURL returned empty result, aborting...\"\n  rm -f \"${TEMPFILE1}\"\n  exit 1;\nfi\n\nif cmp --silent -- \"$TEMPFILE1\" \"$OUTFILE1\"; then\n  echo \"Clearnet trackers: nothing to update, files are similar.\"\n  rm -f \"${TEMPFILE1}\"\nelse\n  cat \"${TEMPFILE1}\" > \"${OUTFILE1}\"\nfi\n\n\n# Make another cURL request for TORv3 trackers list\ncurl $V3_TRACKERS | awk '/zero/' | grep . | sort > $TEMPFILE2\n\nif [ ! -s $TEMPFILE2 ]; then\n  echo \"TORv3 trackers: cURL returned empty result, aborting...\"\n  rm -f \"${TEMPFILE2}\"\n  exit 1;\nfi\n\nif cmp --silent -- \"$TEMPFILE2\" \"$OUTFILE2\"; then\n  echo \"TORv3 trackers: nothing to update, files are similar.\"\n  rm -f \"${TEMPFILE2}\"\nelse\n  # Replace the old v3 trackers file with the new one if they differ and if tempfile is not empty\n  cat \"${TEMPFILE2}\" > \"${OUTFILE2}\"\nfi\n\n\n# Combine trackers files into Syncronite.html\ncat \"${SH_DIR}v3_trackers.html\" \"${SH_DIR}_h_.html\" > \"${SH_DIR}Syncronite.html\"\n\n# Now, if we have no temp files, that means we have nothing to sign, so exit :)\nif [ ! -f \"$TEMPFILE1\" ] && [ ! -f \"$TEMPFILE2\" ]; then\n  echo \"Files are up to date\"\n  exit 1\nelse\n  rm -f \"${TEMPFILE1}\"\n  rm -f \"${TEMPFILE2}\"\nfi\n\n# Sign and publish\n${ZERONET_ROOT_DIR}/zeronet.py siteSign \"${SITE_ADDRESS}\" --publish\n","language":"text/x-sh","encrypted":false,"added":1636486532}],"comment":[]}