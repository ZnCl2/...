<section class="content-header">
    <h1>
        视频分类分配
        <small>
            <a href="{{ url('app/manage') }}">应用管理</a>
        </small>
    </h1>
</section>
<!-- Main content -->
<section class="content">
    <div class="box box-primary">
        <form id="tab" 
              ENCTYPE="multipart/form-data"
        >
            <div class="box-body">
                <div class="form-group">
                    <label> 分类名称： </label>
                    <input name="name" class="form-control input-lg" type="text" placeholder=".input-lg" for="out">
                </div>
                <div class="form-group">
                    <label> 上级分类:</label>
                    <select class="form-control" name="parent_id" for="out">
                        <option value="0">
                            无
                        </option>

                    </select>
                </div>
                <div class="form-group">
                    <label>显示</label>
                    <input type="checkbox" name="enable" for="out">
                    </select>
                </div>

            </div><!-- /.box-body -->
            <div class="box-footer">
                <button type="submit" class="btn btn-primary">Submit</button>
            </div>
        </form>
    </div><!-- /.box -->
</section>
<script>
 window.admin.getcategory(function(category) {
     $.each(category, function(i, one) {
         $("select[name='parent_id']").append($("<option/>").attr({value:one.category_id}).text(one.name));
     });
 });
 $("form").submit(function(e) {
     e.preventDefault();
     var obj = {};
     $.each($("input[for='out']"), function(i, one) {
         var $one = $(one);
         var value = $one.val();
         var key = $one.attr("name");
         var type = $one.attr("type");
         if (type == "checkbox") {
             value = $one.is(":checked")?1:0;
         }
         obj[key] = value;
     });
     $.each($("select[for='out']"), function(i, one) {
         var $one = $(one);
         var value = $one.val();
         var key = $one.attr("name");
         obj[key] = value;
     });

     console.log(obj);
     //delete(obj['parent']);
     //delete(obj['enable']);
     window.admin.addcategory(obj, function(res) {
         if (res != "ok") {
             alert("error"+res);
         } else {
             $("#category-manage").trigger('click');
         }
     });
 });
</script>
