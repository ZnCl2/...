{
	"next_topic_id": 1,
	"topic": [],
	"topic_vote": {},
	"next_comment_id": 3,
	"comment": {
		"1587280399_1L4dZcDF2maSKHDy788yhxpYnBWnXadUtS": [
			{
				"comment_id": 1,
				"body": "# Installs Iptables\n  apt install iptables-persistent\n  \n   # Flushes existing iptable rules\n  iptables -F\n  \n  # Logs and drops packets\n  iptables -A INPUT -i eth1 -s 10.0.0.0/8 -j LOG --log-prefix \"IP_SPOOF A: \"\n  iptables -A INPUT -i eth1 -s 10.0.0.0/8 -j DROP\n  \n  # Maintains a list of recent connections to match against\n  iptables -A FORWARD -m recent --name portscan --rcheck --seconds 100 -j DROP\n  iptables -A FORWARD -p tcp -i eth0 --dport 443 -m recent --name portscan --set -j DROP\n  \n  # Matching against a string in a packet's data payload\n  iptables -A FORWARD -m string --string '.com' -j DROP\n  iptables -A FORWARD -m string --string '.exe' -j DROP\n  \n  # Time-based rules\n  iptables -A FORWARD -p tcp -m multiport --dport http,https -o eth0 -i eth1 -m time --timestart 21:30 --timestop 22:30 --days Mon,Tue,Wed,Thu,Fri -j ACCEPT\n  \n  # Packet matching based on TTL values\n  iptables -A INPUT -s 1.2.3.4 -m ttl --ttl-lt 40 -j REJECT\n \n  # Configures Iptable Defaults\n  iptables -P INPUT DROP\n  iptables -P OUTPUT ACCEPT\n  iptables -P FORWARD DROP\n  \n  # Drops Spoofing attacks\n  iptables -A INPUT -s 10.0.0.0/8 -j DROP\n  iptables -A INPUT -s 169.254.0.0/16 -j DROP\n  iptables -A INPUT -s 172.16.0.0/12 -j DROP\n  iptables -A INPUT -s 127.0.0.0/8 -j DROP\n  iptables -A INPUT -s 192.168.0.0/24 -j DROP\n  iptables -A INPUT -s 224.0.0.0/4 -j DROP\n  iptables -A INPUT -d 224.0.0.0/4 -j DROP\n  iptables -A INPUT -s 240.0.0.0/5 -j DROP\n  iptables -A INPUT -d 240.0.0.0/5 -j DROP\n  iptables -A INPUT -s 0.0.0.0/8 -j DROP\n  iptables -A INPUT -d 0.0.0.0/8 -j DROP\n  iptables -A INPUT -d 239.255.255.0/24 -j DROP\n  iptables -A INPUT -d 255.255.255.255 -j DROP\n  \n  # Accepts loopback input\n  iptables -A INPUT -i lo -p all -j ACCEPT\n  \n  # Allows a three-way Handshake\n  iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n  \n  # Drops packets with excessive RST to avoid Masked attacks\n  iptables -A INPUT -p tcp -m tcp --tcp-flags RST RST -m limit --limit 2/second --limit-burst 2 -j ACCEPT\n  \n  # Stops Masked Attacks\n  iptables -A INPUT -p icmp --icmp-type 13 -j DROP\n  iptables -A INPUT -p icmp --icmp-type 14 -j DROP\n  iptables -A INPUT -p icmp --icmp-type 17 -j DROP\n  iptables -A INPUT -p icmp -m limit --limit 1/second -j ACCEPT\n  \n  # Discards Invalid Packets\n  iptables -A INPUT -m state --state INVALID -j DROP\n  iptables -A FORWARD -m state --state INVALID -j DROP\n  iptables -A OUTPUT -m state --state INVALID -j DROP\n  \n  # Allows ssh\n  iptables -A INPUT -p tcp -m tcp --dport 652 -j ACCEPT\n   \n   # Allow one ssh connection at a time\n  iptables -A INPUT -p tcp --syn --dport 652 -m connlimit --connlimit-above 2 -j REJECT\n  \n  # Allows Ping\n  iptables -A INPUT -p icmp --icmp-type 0 -j ACCEPT\n  \n  # Protection against port scanning\n  iptables -N port-scanning\n  iptables -A port-scanning -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s --limit-burst 2 -j RETURN\n  iptables -A port-scanning -j DROP\n \n  # SSH brute-force protection\n  iptables -A INPUT -p tcp --dport ssh -m conntrack --ctstate NEW -m recent --set\n  iptables -A INPUT -p tcp --dport ssh -m conntrack --ctstate NEW -m recent --update --seconds 60 --hitcount 10 -j DROP\n  \n  # Syn-flood protection\n  iptables -N syn_flood\n  iptables -A INPUT -p tcp --syn -j syn_flood\n  iptables -A syn_flood -m limit --limit 1/s --limit-burst 3 -j RETURN\n  iptables -A syn_flood -j DROP\n  iptables -A INPUT -p icmp -m limit --limit  1/s --limit-burst 1 -j ACCEPT\n  iptables -A INPUT -p icmp -m limit --limit 1/s --limit-burst 1 -j LOG --log-prefix PING-DROP:\n  iptables -A INPUT -p icmp -j DROP\n  iptables -A OUTPUT -p icmp -j ACCEPT\n  \n  # Mitigating SYN floods with SYNPROXY\n  iptables -t raw -A PREROUTING -p tcp -m tcp --syn -j CT --notrack\n  iptables -A INPUT -p tcp -m tcp -m conntrack --ctstate INVALID,UNTRACKED -j SYNPROXY --sack-perm --timestamp --wscale 7 --mss 1460\n  iptables -A INPUT -m conntrack --ctstate INVALID -j DROP\n  \n  # Block new packets that aren't SYN packets\n  iptables -A INPUT -p tcp ! --syn -m state --state NEW -j DROP\n  \n  # Force fragments packets check\n  iptables -A INPUT -f -j DROP\n  \n  # XMAS packets\n  iptables -A INPUT -p tcp --tcp-flags ALL ALL -j DROP\n  \n  # Drop all null packets\n  iptables -A INPUT -p tcp --tcp-flags ALL NONE -j DROP\n\n  # Block uncommon MSS values\n  iptables -t mangle -A PREROUTING -p tcp -m conntrack --ctstate NEW -m tcpmss ! --mss 536:65535 -j DROP\n\n  # Block packets with bogus TCP flags\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN FIN,SYN -j DROP\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags SYN,RST SYN,RST -j DROP\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,RST FIN,RST -j DROP\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,ACK FIN -j DROP\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,URG URG -j DROP\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,FIN FIN -j DROP\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,PSH PSH -j DROP\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL ALL -j DROP\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL NONE -j DROP\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL FIN,PSH,URG -j DROP\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,FIN,PSH,URG -j DROP\n  iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,RST,ACK,FIN,URG -j DROP\n  \n  # Drops connections if the ip address makes more than 5 connection attempts to port 80 within 50 seconds\n  $IPT -I INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -m recent --set\n  $IPT -I INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -m recent --update --seconds 50 --hitcount 5 -j DROP\n  \n  # Saves iptables rules\n  iptables-save > /etc/iptables/rules.v4\n  ip6tables-save > /etc/iptables/rules.v6",
				"added": 1597464992
			}
		],
		"1594553128_1L4dZcDF2maSKHDy788yhxpYnBWnXadUtS": [
			{
				"comment_id": 2,
				"body": "try  https://tutanota.com",
				"added": 1597526492
			}
		]
	},
	"comment_vote": {}
}