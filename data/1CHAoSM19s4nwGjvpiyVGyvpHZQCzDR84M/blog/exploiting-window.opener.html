<!DOCTYPE HTML>
<html>
<head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Kevin Froman's blog - Exploiting Window.opener</title>
  <meta name='description' content='Kevin Froman's blog on security, programming, and other musings'>
  <meta name='author' content='Kevin Froman'>
  <link rel='icon' type='image/x-icon' href='/favicon.ico'>
  <link rel='stylesheet' href='theme.css'>
  <script src="https://widget.battleforthenet.com/widget.js" integrity="sha384-OzmvdVOIBjM9YAUmPdrxpGclC0fg2bTYlwv12prMWoF1y4osMdsZ1UvH1ufTqAQ3" crossorigin="anonymous"></script>
</head>
<body>
  <div id="wrapper">
    <h1 id='siteTitle'><a href='index.html'>Kevin Froman's blog</a></h1>
    
<div id='myIntro' class='center'>Blog on security, programming, & other musings</div>
    <div id='mainContent'><h2 id='postTitle'>Exploiting Window.opener</h2>
        <div id='postDate' class='center'>2016-09-08</div><h2>The Problem</h2>
<p>One of the most common security oversights in web development is using <code>target='_blank'</code> on links, or <code>window.open()</code> in JavaScript for 3rd party links.</p>
<p>Not using <code>rel="noopener noreferrer"</code> (or otherwise nulling the opener), makes any opened tabs - even cross origin - able to control the URL location of the opener tab, and since a user’s attention immediately jumps to the new tab, they probably will not notice that their first tab is now a <strong>phishing page</strong>.</p>
<p>In my opinion, intentionally ignoring this issue isn’t a big deal, but it is a simple fix in most cases, and should be done in order to provide some protection for users against potential phishing attacks that use this vector.</p>
<p><img alt="browser icons" src="./images/browsers.png" /></p>
<h2>Popular Search Engines Are Vulnerable</h2>
<p>Although I am definitely not <a href="https://www.jitbit.com/alexblog/256-targetblank---the-most-underestimated-vulnerability-ever/">the first</a> to check search engines, many popular ones are/were vulnerable, including Google, <a href="https://sites.google.com/site/bughunteruniversity/nonvuln/phishing-with-window-opener">who won’t fix it</a>.</p>
<p>As of writing this, if someone searches ‘ChaosWebs.net’ on Google, and they have ‘open links in a new tab’ set in their search settings, their Google tab will <strong>also</strong> be redirected to my website. If I was malicious, I could take them to a phishing page.</p>
<p>However, some other search engines, specifically <a href="https://duckduckgo.com/">DuckDuckGo</a> and <a href="https://startpage.com/">StartPage</a> recognized this as a security oversight. DuckDuckGo has since deployed a fix, and StartPage even paid out a $75 reward.</p>
<p>StartPage asked me to clarify that they <strong>do not</strong> consider it a vulnerability, especially in their case.</p>
<h2>Email Clients Are Vulnerable</h2>
<p>Unsurprisingly, many web based email clients are vulnerable (although strangely GMail protects against it - make up your mind, Google!).</p>
<p>I reported the issue to <a href="https://tutanota.com">Tutanota</a> who quickly fixed the issue, and even made a <a href="https://tutanota.com/blog/posts/browser-bug">public statement</a> about it, thanking me. (Thanks!)</p>
<h2>Instant Messengers Are Vulnerable</h2>
<p>My first thought was to test web.telegram.org, Telegram's web client, since I use Telegram for messaging daily. Of course, it too was vulnerable. I sent a report to Telegram, they thanked me and, very surprisingly, paid out ~$1600. (Thanks!)</p>
<p>I also tested the web app version of instant messenger <a href="https://wire.com/">Wire</a>, and it too was vulnerable. They sent me a nice goodie bag. (Thanks!)</p>
<p><img alt="wire goodies" src="./images/wire-gift.jpg" /></p>
<h2>Conclusion</h2>
<p>Countless websites have this problem, even this very blog did (as it was running Hexo). This is probably up there with SQL injection in terms of frequently ignored best programming practices.</p>
<p>I don’t understand why companies like Google are choosing to ignore it, I don’t think it is necessarily worth paying bug bounties over (Not that I’m complaining about the ones I received!), but I do think that it is irresponsible to flat out ignore the problem, especially on somewhat sensitive websites.</p>
<p><img alt="cat meme" src="./images/scriptkitty.jpg" /></p><div class="center" style="margin-bottom: -25%; margin-top: 2em; border-radius: 5px; padding: 5px;"><span>Written by anonymous</span><br><br></div>
    </div>
  </div>
  <div id="footer">
    <footer>Powered by TinyGen<div id='socialLinks'><a class="socialLink" href="https://twitter.com/@beardog108"><img src="../images/twitter.png" alt="TWITTER"></a><a class="socialLink" href="https://github.com/beardog108"><img src="../images/github.png" alt="GITHUB"></a><a class="socialLink" href="beardog@firemail.cc"><img src="../images/email.png" alt="EMAIL"></a><a class="socialLink" href="https://keybase.io/beardog"><img src="../images/keybase.png" alt="KEYBASE"></a><a class="socialLink" href="feed.rss"><img src="../images/feed.png" alt="RSS feed"></a></div></footer>
  </div>
</body>
</html>
