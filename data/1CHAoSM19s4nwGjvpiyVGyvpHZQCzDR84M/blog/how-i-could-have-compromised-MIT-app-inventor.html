<!DOCTYPE HTML>
<html>
<head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Kevin Froman's blog - How I Could Have Compromised MIT App Inventor</title>
  <meta name='description' content='Kevin Froman's blog on security, programming, and other musings'>
  <meta name='author' content='Kevin Froman'>
  <link rel='icon' type='image/x-icon' href='/favicon.ico'>
  <link rel='stylesheet' href='theme.css'>
  <script src="https://widget.battleforthenet.com/widget.js" integrity="sha384-OzmvdVOIBjM9YAUmPdrxpGclC0fg2bTYlwv12prMWoF1y4osMdsZ1UvH1ufTqAQ3" crossorigin="anonymous"></script>
</head>
<body>
  <div id="wrapper">
    <h1 id='siteTitle'><a href='index.html'>Kevin Froman's blog</a></h1>
    
<div id='myIntro' class='center'>Blog on security, programming, & other musings</div>
    <div id='mainContent'><h2 id='postTitle'>How I Could Have Compromised MIT App Inventor</h2>
        <div id='postDate' class='center'>2016-07-27</div><h2>Not Just a Learning Tool</h2>
<p>MIT App Inventor is primarily an educational block-based programming tool used to introduce young people to programming and app design, using a web interface and companion app for live testing.</p>
<p><img alt="ai2 screenshot" src="./images/ai1.png" /></p>
<p>However, due to its powerful design and low learning curve, it is also used by anyone who wants to simplify the app creation process, and many apps currently on Google Play have been created using AI.</p>
<h2>New Features Bring New Exploits</h2>
<p>The AI team recently implemented a ‘gallery’ system, where people can share their app source and clone others, their gallery system is not (as of writing this) compatible with their Java extension system, which allows users to insert Java code to facilitate custom programming features.</p>
<h2>Testing for XSS</h2>
<p>I remembered that the AI team had also somewhat recently added HTML formatting to label elements, I got curious to see how they handle HTML tags.</p>
<p>As it turns out, AI <strong>did nothing to filter tags</strong>, and they were rendered directly to the browser!</p>
<p>From there, I tested if script HTML tags were filtered, and they were not!</p>
<p>However, since that part of the editor is dynamically rendered after page load, I could not immediately trigger scripts.</p>
<p>I remembered that some inline event triggers can work even if loaded after the immediate page load, such as ‘onMouseOver’.</p>
<p><strong>It worked, I was able to trigger any JavaScript I want in the editor using the onMouseOver event!</strong></p>
<p><img alt="ai2 screenshot" src="./images/ai2.png" /></p>
<p>The full code was simply:
<pre>&lt;h1 onMouseOver=”alert(‘XSS Vuln!’);” style=”width: 1000px; height: 1000px; color: white;”&gt;test&lt;/h1&gt;</pre></p>
<p>The styling made it so that when mousing over any part of the app preview, my script would trigger.</p>
<h2>Implications of XSS</h2>
<p>A malicious user could have abused this to embed malicious scripts inside project files (.aia) and then share them via the Gallery or elsewhere.</p>
<p>These scripts could have, among other things:</p>
<ul>
<li>
<p>Compromised user sessions</p>
</li>
<li>
<p>Automatically inserted Java extensions that would have resulted in malicious APk files that may have then been shared to Google Play.</p>
</li>
<li>
<p>Spread malware</p>
</li>
<li>
<p>Phished user Google account passwords (AI uses Google accounts to login)</p>
</li>
<li>
<p>Injected its self into the user’s other projects, essentially becoming a virus.</p>
</li>
<li>
<p>Even if the user didn’t generate APK files, the Companion App (for testing apps in real time) has a lot of permissions, some being SMS, file access, and camera access.</p>
</li>
</ul>
<h2>Reporting the Issue</h2>
<p>After I discovered this issue, I reported it to one of the MIT developers, Jeff Schiller, who got it fixed within a week.</p><div class="center" style="margin-bottom: -25%; margin-top: 2em; border-radius: 5px; padding: 5px;"><span>Written by anonymous</span><br><br></div>
    </div>
  </div>
  <div id="footer">
    <footer>Powered by TinyGen<div id='socialLinks'><a class="socialLink" href="https://twitter.com/@beardog108"><img src="../images/twitter.png" alt="TWITTER"></a><a class="socialLink" href="https://github.com/beardog108"><img src="../images/github.png" alt="GITHUB"></a><a class="socialLink" href="beardog@firemail.cc"><img src="../images/email.png" alt="EMAIL"></a><a class="socialLink" href="https://keybase.io/beardog"><img src="../images/keybase.png" alt="KEYBASE"></a><a class="socialLink" href="feed.rss"><img src="../images/feed.png" alt="RSS feed"></a></div></footer>
  </div>
</body>
</html>
