<!DOCTYPE HTML>
<html>
<head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Kevin Froman's blog - Do Not Trust X Forwarded For</title>
  <meta name='description' content='Kevin Froman's blog on security, programming, and other musings'>
  <meta name='author' content='Kevin Froman'>
  <link rel='icon' type='image/x-icon' href='/favicon.ico'>
  <link rel='stylesheet' href='theme.css'>
  <script src="https://widget.battleforthenet.com/widget.js" integrity="sha384-OzmvdVOIBjM9YAUmPdrxpGclC0fg2bTYlwv12prMWoF1y4osMdsZ1UvH1ufTqAQ3" crossorigin="anonymous"></script>
</head>
<body>
  <div id="wrapper">
    <h1 id='siteTitle'><a href='index.html'>Kevin Froman's blog</a></h1>
    
<div id='myIntro' class='center'>Blog on security, programming, & other musings</div>
    <div id='mainContent'><h2 id='postTitle'>Do Not Trust X Forwarded For</h2>
        <div id='postDate' class='center'>2016-08-24</div><h2>What Is X-Forwarded-For?</h2>
<p>X-Forwarded-For and similar headers are not official, but they are the de-facto standard client HTTP request header for non-transparent proxies. It is usually sent in HTTP requests.</p>
<h2>The Problem</h2>
<p>Since X-Forwarded-For is just an HTTP header, it can very easily be spoofed with browser addons.</p>
<p>This means that when developing an application, X-Forwarded-For should not be taken as ‘proof’ of a user’s IP address in any circumstance, and should not be trusted.</p>
<h2>Example of Inappopriate Use</h2>
<p><a href="https://guerrillamail.com">guerrillamail.com</a> was using X-Forwarded-For by setting a sent email’s “X-Originating-IP” as the X-Forwarded-For. This allowed me to make an email appear as if it was coming from any IP address I wanted.</p>
<p><img alt="guerrilla mail screenshot" src="./images/gmail.png" /></p>
<p>This could have been used to frame other people for crimes such as bomb threats, in fact if the <a href="http://www.theverge.com/2013/12/18/5224130/fbi-agents-tracked-harvard-bomb-threats-across-tor">Harvard student</a> that used GM to send a bomb threat would have done that, someone else could have been falsely accused.</p>
<p>I reported this vulnerability almost 2 months ago, and it was quickly fixed.</p><div class="center" style="margin-bottom: -25%; margin-top: 2em; border-radius: 5px; padding: 5px;"><span>Written by anonymous</span><br><br></div>
    </div>
  </div>
  <div id="footer">
    <footer>Powered by TinyGen<div id='socialLinks'><a class="socialLink" href="https://twitter.com/@beardog108"><img src="../images/twitter.png" alt="TWITTER"></a><a class="socialLink" href="https://github.com/beardog108"><img src="../images/github.png" alt="GITHUB"></a><a class="socialLink" href="beardog@firemail.cc"><img src="../images/email.png" alt="EMAIL"></a><a class="socialLink" href="https://keybase.io/beardog"><img src="../images/keybase.png" alt="KEYBASE"></a><a class="socialLink" href="feed.rss"><img src="../images/feed.png" alt="RSS feed"></a></div></footer>
  </div>
</body>
</html>
