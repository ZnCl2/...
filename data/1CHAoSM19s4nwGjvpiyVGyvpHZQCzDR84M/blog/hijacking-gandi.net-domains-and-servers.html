<!DOCTYPE HTML>
<html>
<head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Kevin Froman's blog - Hijacking Gandi.net Domains And Servers</title>
  <meta name='description' content='Kevin Froman's blog on security, programming, and other musings'>
  <meta name='author' content='Kevin Froman'>
  <link rel='icon' type='image/x-icon' href='/favicon.ico'>
  <link rel='stylesheet' href='theme.css'>
  <script src="https://widget.battleforthenet.com/widget.js" integrity="sha384-OzmvdVOIBjM9YAUmPdrxpGclC0fg2bTYlwv12prMWoF1y4osMdsZ1UvH1ufTqAQ3" crossorigin="anonymous"></script>
</head>
<body>
  <div id="wrapper">
    <h1 id='siteTitle'><a href='index.html'>Kevin Froman's blog</a></h1>
    
<div id='myIntro' class='center'>Blog on security, programming, & other musings</div>
    <div id='mainContent'><h2 id='postTitle'>Hijacking Gandi.net Domains And Servers</h2>
        <div id='postDate' class='center'>2017-07-24</div><p><a href="https://www.gandi.net/">Gandi.net</a>, a popular domain registrar and hosting provider used by somewhat high profile organizations, such as the <a href="https://eff.org">EFF</a> and <a href="https://fsf.org/">Free Software Foundation</a>, had an XSS vulnerability on its main domain name (www.gandi.net).</p>
<p>This also happens to be where domain DNS settings are managed, along with other account settings and server hosting.</p>
<p><img alt="Gandi logo" src="./images/gandi-logo.jpg" /></p>
<h2>The vulnerability</h2>
<p>Specifically, the password reset form, which is accessible even if you are logged in, did not have any protection against <a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery">CSRF</a> which allowed for other websites to submit requests to the page on behalf of the user.</p>
<p>The page also echoed back your Gandi ID if it was incorrect, which I found was vulnerable to XSS. It was not a completely obvious vulnerability, as the echoed back ID was in all uppercase, which required me to use <a href="http://jsfuck.com">JSFuck</a> to encode my payload.</p>
<p>This issue is unrelated to the <a href="https://news.gandi.net/en/2017/07/detailed-incident-report/">Gandi hack</a> that also happened recently.</p>
<h2>Impact</h2>
<p>Using the vulnerability, I could have potentially hijacked domains or hosting instances by modifying DNS settings, by having users click malicious links or visit a malicious page with the payload, which would be substainally worse than social engineering alone, as the attack would not be obvious or noticeable at first.</p>
<h2>Reporting the issue &amp; Conclusion</h2>
<p>I reported the issue to Gandi, who had a fix in production within 48 hours, and rewarded me a t-shirt. I will add a photo of the shirt once I obtain it.</p>
<p>Gandi is not the cheapest registrar or hosting provider, but they are a well established and ethical company. I would recommend them to anyone who wants an ethical host or registrar.</p><div class="center" style="margin-bottom: -25%; margin-top: 2em; border-radius: 5px; padding: 5px;"><span>Written by anonymous</span><br><br></div>
    </div>
  </div>
  <div id="footer">
    <footer>Powered by TinyGen<div id='socialLinks'><a class="socialLink" href="https://twitter.com/@beardog108"><img src="../images/twitter.png" alt="TWITTER"></a><a class="socialLink" href="https://github.com/beardog108"><img src="../images/github.png" alt="GITHUB"></a><a class="socialLink" href="beardog@firemail.cc"><img src="../images/email.png" alt="EMAIL"></a><a class="socialLink" href="https://keybase.io/beardog"><img src="../images/keybase.png" alt="KEYBASE"></a><a class="socialLink" href="feed.rss"><img src="../images/feed.png" alt="RSS feed"></a></div></footer>
  </div>
</body>
</html>
