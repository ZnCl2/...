



<!DOCTYPE html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.1.0">
    
    
      
        <title>静态站点 - 零网事实</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.11e41852.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.20ef595d.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#introduction" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="零网事实" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                零网事实
              </span>
              <span class="md-header-nav__topic">
                静态站点
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="零网事实" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    零网事实
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="前言" class="md-nav__link">
      前言
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../security/" title="安全" class="md-nav__link">
      安全
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../cloning-zites/" title="站点克隆" class="md-nav__link">
      站点克隆
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../creating-static-zite/" title="静态站点" class="md-nav__link">
      静态站点
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../zeroframe/" title="站点框架" class="md-nav__link">
      站点框架
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../databases/" title="数据库" class="md-nav__link">
      数据库
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../changing-tables/" title="操作数据库" class="md-nav__link">
      操作数据库
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../dbschema/" title="数据库模式" class="md-nav__link">
      数据库模式
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../user-content/" title="用户数据" class="md-nav__link">
      用户数据
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../editing-user-data/" title="编辑用户数据" class="md-nav__link">
      编辑用户数据
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../merger-sites/" title="聚合站" class="md-nav__link">
      聚合站
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../mergxed-sites/" title="聚合后的数据" class="md-nav__link">
      聚合后的数据
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../ugly-things/" title="补充" class="md-nav__link">
      补充
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14" checked>
    
    <label class="md-nav__link" for="nav-14">
      高阶教程
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        高阶教程
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../TheBasics/" title="基础" class="md-nav__link">
      基础
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        静态站点
      </label>
    
    <a href="./" title="静态站点" class="md-nav__link md-nav__link--active">
      静态站点
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-an-empty-zite" title="Creating An Empty Zite" class="md-nav__link">
    Creating An Empty Zite
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-are-the-zites-files-located" title="Where Are The Zite's Files Located?" class="md-nav__link">
    Where Are The Zite's Files Located?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-contentjson-file" title="The content.json File" class="md-nav__link">
    The content.json File
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-and-title" title="Description and Title" class="md-nav__link">
    Description and Title
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignore-field-and-regexes" title="Ignore Field and Regexes" class="md-nav__link">
    Ignore Field and Regexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewport" title="Viewport" class="md-nav__link">
    Viewport
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contentjson-docs" title="content.json Docs" class="md-nav__link">
    content.json Docs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-index-file" title="The Index File" class="md-nav__link">
    The Index File
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-zeroframe-class" title="The ZeroFrame Class" class="md-nav__link">
    The ZeroFrame Class
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defining-our-own-class" title="Defining Our Own Class" class="md-nav__link">
    Defining Our Own Class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#onopenwebsocket" title="onOpenWebsocket" class="md-nav__link">
    onOpenWebsocket
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#onrequest" title="onRequest" class="md-nav__link">
    onRequest
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirement-of-the-zeroframe-class" title="Requirement of the ZeroFrame Class" class="md-nav__link">
    Requirement of the ZeroFrame Class
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signing-and-publishing-your-zite" title="Signing and Publishing Your Zite" class="md-nav__link">
    Signing and Publishing Your Zite
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../TipsAndTricks/" title="一些技巧" class="md-nav__link">
      一些技巧
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../UsersAndDatabasesInZeroNet/" title="用户和数据库" class="md-nav__link">
      用户和数据库
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../WriteAPlugin/" title="写个插件" class="md-nav__link">
      写个插件
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-an-empty-zite" title="Creating An Empty Zite" class="md-nav__link">
    Creating An Empty Zite
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-are-the-zites-files-located" title="Where Are The Zite's Files Located?" class="md-nav__link">
    Where Are The Zite's Files Located?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-contentjson-file" title="The content.json File" class="md-nav__link">
    The content.json File
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-and-title" title="Description and Title" class="md-nav__link">
    Description and Title
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignore-field-and-regexes" title="Ignore Field and Regexes" class="md-nav__link">
    Ignore Field and Regexes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewport" title="Viewport" class="md-nav__link">
    Viewport
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contentjson-docs" title="content.json Docs" class="md-nav__link">
    content.json Docs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-index-file" title="The Index File" class="md-nav__link">
    The Index File
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-zeroframe-class" title="The ZeroFrame Class" class="md-nav__link">
    The ZeroFrame Class
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defining-our-own-class" title="Defining Our Own Class" class="md-nav__link">
    Defining Our Own Class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#onopenwebsocket" title="onOpenWebsocket" class="md-nav__link">
    onOpenWebsocket
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#onrequest" title="onRequest" class="md-nav__link">
    onRequest
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirement-of-the-zeroframe-class" title="Requirement of the ZeroFrame Class" class="md-nav__link">
    Requirement of the ZeroFrame Class
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signing-and-publishing-your-zite" title="Signing and Publishing Your Zite" class="md-nav__link">
    Signing and Publishing Your Zite
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>静态站点</h1>
                
                <h2 id="introduction">Introduction</h2>
<p>In this tutorial, we are going to be making a very simple static zite, go through the different options in the <code>content.json</code> file, and talk about the ZeroFrame class that is auto-generated when you create an empty zite, what it is used for, and why it is important.</p>
<blockquote>
<p><strong>Note:</strong> It is recommended to read <a href="./?/tutorials/the_basics">The Basics</a> tutorial first. It provides useful information on how zites are kept secure, updated, how to keep your zite online, and other important information.</p>
</blockquote>
<h2 id="creating-an-empty-zite">Creating An Empty Zite</h2>
<p>In order to create a zite, first we need to create an empty zite that will generate an address for us. You can very easily do this in the ZeroHello page by going to the menu (denoted by the 3 dots beside the ZeroHello Logo) and clicking <code>Create new, empty site</code>. It will create an address for you, along with a directory where you zite's files will be stored and a default <code>index.html</code> page. Do not delete this page, because it generates some code for us that will be talked about later in the tutorial. You will be redirected to your new zite by ZeroHello.</p>
<h2 id="where-are-the-zites-files-located">Where Are The Zite's Files Located?</h2>
<p>When ZeroHello created your empty zite, it created a new directory for it. This directory is located in the <code>zeronetroot/data</code> directory under a folder named by your zite's address. You can find where the ZeroNet root directory is by pressing <code>show data directory</code> in ZeroHello's menu.</p>
<h2 id="the-contentjson-file">The content.json File</h2>
<p>The first file we are going to open is the zite's <code>content.json</code> file. This file is used to keep your zite secure, and provide options for your zite. <a href="./?/tutorials/the_basics">The Basics</a> tutorial covers how this file is used to keep your zite secure and from being tampered with. However, this tutorial will cover the options that you can set in this file for your zite. If you are unfamiliar with JSON, you should learn it before going forward with zite development. Trust me, JSON is pretty easy.</p>
<h3 id="description-and-title">Description and Title</h3>
<p>The first thing we are going to do is change the zite's description and title. Look for the description and title fields and change them to what you want. The Title field is what is shown in the title/tab bar and in ZeroHello. The description is used for Search Engines, among other things.</p>
<h3 id="ignore-field-and-regexes">Ignore Field and Regexes</h3>
<p>Next, we are going to modify the <code>ignore</code> field. The ignore field is used to tell ZeroNet which files you do not want seeded and sent to peers. Any files/folders that match this ignore field will stay on your computer only, and will not be sent to other peers. This is useful for the git directory, an admin directory, and database files.</p>
<p>Database files (ending in <code>.db</code>) are ignored because the database is generated from the json files per client. Clients do not share database files. More information is provided about this in the Database Basics tutorial.</p>
<p>The <code>ignore</code> field uses a regular expression to match any folders and files against it. Because of this, it is recommended to learn a little bit about regular expressions. However, here is a simple list of things most used in regular expressions and what they mean:
<em> <code>.</code> - any character
</em> <code>*</code> - zero or more of the character or group that comes before it
<em> <code>+</code> - </em>one<em> or more of the character or group that comes before it.
</em> Putting a letter that isn't a special symbol in regexes means it is a required character.
<em> <code>(</code> and <code>)</code> - Creates a group, useful for saying you want zero or more of a word (for example: <code>(and)*</code> means zero or more <code>and</code> words)
</em> <code>|</code> used in a group to mean <em>or</em>. For eample: <code>(and|or)</code> means it will match anything that is the word <code>and</code> <em>or</em> the word <code>or</code>.
* <code>\.</code> - the dot character. You are escaping the dot. This also works for <code>\*</code>, <code>\|</code>, <code>\\</code> and any other special symbols.</p>
<blockquote>
<p><strong>NOTE:</strong> It should be noted that a recent update to ZeroNet requires that you must place <code>.</code> before <code>*</code>, <code>+</code>, and <code>{</code>. You also cannot have more than 9 of these repetition characters. To fix this, if you are using <code>.*</code> for each <em>or branch</em> in a group, you can easily put it outside of the group (for example: change <code>(.*.epub|.*.jpg|.*.jpeg|.*.png)</code> to <code>.*(epub|jpg|jpeg|png)</code>).
This change was made for security and performance reasons.</p>
</blockquote>
<p>Here are some useful patterns used in regular expressions. We will be using some of these in our <code>ignore</code> regex.
<em> To ignore a folder, put <code>foldername</code>.
</em> To ignore a file with a certain extension, put <code>.*db</code>
<em> To ignore files of many extensions, you can use a group like this: <code>.*(ext1|ext2|ext3)</code>
</em> To ignore files, directories, and sub-directories in a folder, use this: <code>folder/.*/.*</code></p>
<p>For our ignore regex, we are going to use this:</p>
<div class="codehilite"><pre><span></span>&quot;ignore&quot;: &quot;(data/.*db|data/users/.*/.*|.git|admin)&quot;,
</pre></div>


<p>This will ignore the <code>.git</code> folder, the <code>admin</code> folder, any database files, and the <code>data/users</code> folder and its subdirectories. The reason for the last two will be covered in the Database Basics tutorial.</p>
<h3 id="viewport">Viewport</h3>
<p>The final thing we are going to do is add a <code>viewport</code> field. This is equivalent to adding the viewport meta tag.</p>
<ul>
<li>For mobile-supported zites, set the viewport to <code>width=device-width, initial-scale=1.0, shrink-to-fit=no</code></li>
<li>For non-mobile-supported zites, you can leave it off.</li>
</ul>
<h3 id="contentjson-docs">content.json Docs</h3>
<p>You can find more information about the different options in the <code>content.json</code> file from the <a href="/1Docsfk5uLvuXkL4U13eYDxCm2gzi1fNQq/site_development/content_json/index.html">ZeroNet Docs</a>.</p>
<h2 id="the-index-file">The Index File</h2>
<p>We are now done with the <code>content.json</code> file. Next, open up the <code>index.html</code> file. This is what the index file should look like:</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>New ZeroNet site!<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;content-type&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;text/html; charset=utf-8&quot;</span> <span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">base</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="na">target</span><span class="o">=</span><span class="s">&quot;_top&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;base&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nx">base</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;/media&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;index.html&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[&amp;?]wrapper=False/</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[&amp;?]wrapper_nonce=[A-Za-z0-9]+/</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;out&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;js/ZeroFrame.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="kr">class</span> <span class="nx">Page</span> <span class="kr">extends</span> <span class="nx">ZeroFrame</span> <span class="p">{</span>
    <span class="nx">setSiteInfo</span><span class="p">(</span><span class="nx">site_info</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">out</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>
        <span class="nx">out</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span>
            <span class="s2">&quot;Page address: &quot;</span> <span class="o">+</span> <span class="nx">site_info</span><span class="p">.</span><span class="nx">address</span> <span class="o">+</span>
            <span class="s2">&quot;&lt;br&gt;- Peers: &quot;</span> <span class="o">+</span> <span class="nx">site_info</span><span class="p">.</span><span class="nx">peers</span> <span class="o">+</span>
            <span class="s2">&quot;&lt;br&gt;- Size: &quot;</span> <span class="o">+</span> <span class="nx">site_info</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">size</span> <span class="o">+</span>
            <span class="s2">&quot;&lt;br&gt;- Modified: &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">site_info</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">modified</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
    <span class="p">}</span>

    <span class="nx">onOpenWebsocket</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">cmd</span><span class="p">(</span><span class="s2">&quot;siteInfo&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">site_info</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">page</span><span class="p">.</span><span class="nx">setSiteInfo</span><span class="p">(</span><span class="nx">site_info</span><span class="p">)</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="nx">onRequest</span><span class="p">(</span><span class="nx">cmd</span><span class="p">,</span> <span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">cmd</span> <span class="o">==</span> <span class="s2">&quot;setSiteInfo&quot;</span><span class="p">)</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setSiteInfo</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">params</span><span class="p">)</span>
        <span class="k">else</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Unknown incoming message:&quot;</span><span class="p">,</span> <span class="nx">cmd</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">page</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Page</span><span class="p">()</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>


<p>You can see that most of it is just simple html. However, there is the javascript that has the <code>ZeroFrame</code> class. This is what we are going to be talking about next.</p>
<h3 id="the-zeroframe-class">The ZeroFrame Class</h3>
<p>The ZeroFrame class is used to talk to the ZeroFrame client via an API. There are many things you can do with ZeroFrame, including talking to ZeroNet Plugins<sup id="fnref:1"><a class="footnote-ref" href="#fn:1" rel="footnote">1</a></sup>. A few of the most common things that you can do with ZeroFrame are:
<em> Open Link in New Tab
</em> Show Notifications and Prompts to the User
<em> Read and Write to Files
</em> Query the Database
<em> Sign and Publish files
</em> Show notifications to the User's ZeroHello NewsFeed (via the NewsFeed plugin)</p>
<p>In this lesson, we are only going to talk about the <code>onOpenWebsocket</code> and <code>onRequest</code> methods <em>and</em> getting the Site Info.</p>
<h4 id="defining-our-own-class">Defining Our Own Class</h4>
<p>In order to use ZeroFrame and provide our own methods and properties, we create our own class that extends the ZeroFrame class. Before we can do this though, we must first include the <code>ZeroFrame.js</code> file.</p>
<div class="codehilite"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;js/ZeroFrame.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>


<p>The class is then defined:</p>
<div class="codehilite"><pre><span></span><span class="kr">class</span> <span class="nx">Page</span> <span class="kr">extends</span> <span class="nx">ZeroFrame</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>


<p>Afterwards, we Instantiate our class so we can access the methods and properties outside of the class:</p>
<div class="codehilite"><pre><span></span><span class="nx">page</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Page</span><span class="p">();</span>
</pre></div>


<p>Inside this class, we have three methods. The first is called <code>onOpenWebsocket</code>, and is what we will be talking about next.</p>
<h4 id="onopenwebsocket">onOpenWebsocket</h4>
<p>The <code>onOpenWebsocket</code> method is called when your page has been loaded. This method is useful for getting site information and initializing everything on startup. Notice that ZeroHello generated code inside of this method.</p>
<div class="codehilite"><pre><span></span><span class="nx">onOpenWebsocket</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">cmd</span><span class="p">(</span><span class="s2">&quot;siteInfo&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">site_info</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">page</span><span class="p">.</span><span class="nx">setSiteInfo</span><span class="p">(</span><span class="nx">site_info</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">}</span>
</pre></div>


<p>The <code>cmd</code> method is called whenever you want to communicate with the ZeroNet Client. You pass in the command name as the first argument. In this case, it's <code>siteInfo</code>. This command returns information on our site - including who is currently logged in and peer count.</p>
<p>The second argument passed in are the parameters for the command. In this case, <code>siteInfo</code> doesn't take any parameters, so we pass in an empty array.</p>
<p>The next argument is a callback function. This is needed because <em>ZeroFrame commands run asynchronously</em> - which means the things called after the <code>cmd</code> method <strong>don't</strong> wait until the command is finished. This is what the third argument is for. Once the command has been run, the function will be called with the return information as the arguments. In this case, the command returns the site information.</p>
<p>In this case, once the command has finished, the callback function is ran, and calls the <code>setSiteInfo</code> method with the site information passed in. This method simply displays the site information onto the page:</p>
<div class="codehilite"><pre><span></span><span class="nx">setSiteInfo</span><span class="p">(</span><span class="nx">site_info</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">out</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>
    <span class="nx">out</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span>
        <span class="s2">&quot;Page address: &quot;</span> <span class="o">+</span> <span class="nx">site_info</span><span class="p">.</span><span class="nx">address</span> <span class="o">+</span>
        <span class="s2">&quot;&lt;br&gt;- Peers: &quot;</span> <span class="o">+</span> <span class="nx">site_info</span><span class="p">.</span><span class="nx">peers</span> <span class="o">+</span>
        <span class="s2">&quot;&lt;br&gt;- Size: &quot;</span> <span class="o">+</span> <span class="nx">site_info</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">size</span> <span class="o">+</span>
        <span class="s2">&quot;&lt;br&gt;- Modified: &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">site_info</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">modified</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>


<p>Notice that we call this <em>inside</em> of the callback function. If you need to do anything that requires reading from <code>site_info</code>, you <em>must</em> put it <em>inside</em> of this callback function - otherwise there's a great chance it will run while <code>site_info</code> is still <code>null</code> or <code>undefined</code> - or whatever default value you may have set it to.</p>
<blockquote>
<p><em>TIP:</em> You can easily see everything that <code>site_info</code> gives you by simply printing it out to the console.</p>
</blockquote>
<h4 id="onrequest">onRequest</h4>
<p>The next method is called <code>onRequest</code>. This method is called by ZeroNet everytime something has happened to your zite. For example, if the site information has been changed (peer count changed, zite has been updated, logged in user has changed, etc).</p>
<div class="codehilite"><pre><span></span><span class="nx">onRequest</span><span class="p">(</span><span class="nx">cmd</span><span class="p">,</span> <span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">cmd</span> <span class="o">==</span> <span class="s2">&quot;setSiteInfo&quot;</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setSiteInfo</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">params</span><span class="p">)</span>
    <span class="k">else</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Unknown incoming message:&quot;</span><span class="p">,</span> <span class="nx">cmd</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>


<p>In this case, whenever the site information has been changed, we are calling <code>setSiteInfo</code>, which shows the new information on the page. Notice that we are using the <code>message.params</code> variable.</p>
<p><code>onRequest</code> also sends messages with the command. This message contains a <code>params</code> property. This is what we are using to get the site information. The <code>params</code> property can also contain the <code>event</code> property, which gives you the event that happened. This is useful for doing an action on the <code>file_done</code> event. This event is called whenever a file has been updated and downloaded and is very useful for checking whether the database was updated in order to dynamically change the content on the zite.</p>
<h3 id="requirement-of-the-zeroframe-class">Requirement of the ZeroFrame Class</h3>
<p>If you want your zite completely static, and not change based on the user logged in, a database, site information, etc. then there might not be a need for you to include the ZeroFrame class - <strong>unless</strong> you are using any of the ZeroFrame API calls.</p>
<p>There are some API calls that are useful even for static zites. For example, notifications, prompts, reading files (e.g. json files), opening a link in a new tab, client-side routing, and more. You can find more information about these and other ZeroFrame API commands in the <a href="/1Docsfk5uLvuXkL4U13eYDxCm2gzi1fNQq/site_development/zeroframe_api_reference/index.html">ZeroFrame API Docs</a>.</p>
<blockquote>
<p><em>TIP:</em> All of the commands listed in the <a href="/1Docsfk5uLvuXkL4U13eYDxCm2gzi1fNQq/site_development/zeroframe_api_reference/index.html">ZeroFrame API Docs</a> are always called using the <code>cmd()</code> method.</p>
</blockquote>
<h2 id="signing-and-publishing-your-zite">Signing and Publishing Your Zite</h2>
<p>You can start adding to your zite now by modifying the index page, creating new pages, etc. However, after your zite is done, you need to be sure to sign and publish it. <em>Signing</em> your zite will do a few things:
<em> Create a Digital Signature that is stored in the <code>content.json</code> file
</em> Update the <code>content.json</code> file to include the new hashes of all the non-ignored files in your zite
* Change the <code>modified</code> field in the <code>content.json</code> file</p>
<p>All of these are done to ensure the security of your zite. They are used so peers can reject changes to your zite that weren't made by you. The <code>modified</code> field is used by clients to ensure they are only downloading a <code>content.json</code> file that is newer than the one they have.</p>
<p>If you have peers, you need to send your updated zite's files to other peers so they can then send it to more peers until everyone has the updated zite. You can do this by <em>publishing</em> your zite. However, if you have no peers yet, there is no need to do this because any new visitors to your zite will just download these updated files from your client.</p>
<p>In order to publish and sign your zite, drag the <code>0</code> button in the top right corner to the left, scroll all the way down to the <code>This is my site</code> section. Click <code>Sign</code>, then <code>Publish</code>. This is also where you can more easily change the zite's title and description.</p>
<hr />
<p>Previous Tutorial: <a href="./?/tutorials/the_basics">The Basics</a><br>
Next Tutorial: <a href="./?/tutorials/users_databases_in_zeronet">Users and Databases In ZeroNet</a></p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>To learn how to write a ZeroNet plugin, you can read the <a href="./?/write-a-plugin">Writing A Plugin tutorial</a>.&#160;<a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../TheBasics/" title="基础" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                基础
              </span>
            </div>
          </a>
        
        
          <a href="../TipsAndTricks/" title="一些技巧" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                一些技巧
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.9e1f3b71.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>