<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>A Short Borg Tutorial mmap.page</title>
    <link rel="stylesheet" href="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/assets/css/style.css">
    <link rel="alternate" type="application/rss+xml" href="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/rss.xml">
    <link rel="alternate" type="application/git+http" href="https://github.com/weakish/weakish.github.com.git"/>
</head>
<body>
  <div class="container-lg px-3 my-5 markdown-body">

    <h1><a href="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/">mmap.page</a></h1>
    <h1 id="a-short-borg-tutorial">
        
        
          A Short Borg Tutorial
        
        
      </h1>
<p><a href="https://www.borgbackup.org/">Borg</a> is the new generation of <a href="https://attic-backup.org/">attic</a>.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>borg init <span class="nt">--encryption</span><span class="o">=</span>keyfile /path/to/repo
borg create <span class="nt">-C</span> lz4 /path/to/repo::NAME-YOUR-BACKUP ~/Documents
</code></pre></div></div>
    
      <h2 id="free-space">
        
        
          Free space <a href="#free-space" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h2>
<p>Before you start creating backups,
please make sure that there is always a good amount of free space
on the filesystem that has your backup repository (and also on ~/.cache).</p>
    
      <h2 id="encryption">
        
        
          Encryption <a href="#encryption" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h2>
<p>Default enabled with <code>repokey</code> method.</p>
<pre><code>borg init --encryption=none|repokey|keyfile PATH
</code></pre>
<p>When repository encryption is enabled,
all data is encrypted using 256-bit AES encryption
and the integrity and authenticity is verified using HMAC-SHA256.</p>
<ul>
<li><code>repokey</code>: key is stored inside the repository (<code>config</code>);</li>
<li><code>keyfile</code>: key is stored under <code>~/.config/borg/keys/</code>;</li>
</ul>
<p>In both modes, the key is stored in encrypted form
and can be only decrypted by providing the correct passphrase.</p>
<p>Do not forget to backup the key (e.g. via <code>borg key export</code>).</p>
<p>For automated backups the passphrase can be specified
using the BORG_PASSPHRASE environment variable.</p>
<p>Be careful how you set the environment;
using the env command, a <code>system()</code> call or using inline shell scripts
might expose the credentials in the process list directly
and they will be readable to all users on a system.
Using <code>export</code> in a shell script file should be safe, however,
as the environment of a process is accessible only to that user.
Also, using a shell command may leak the passphrase in shell history file.</p>
<p>For server backup, have a look at <a href="https://torsion.org/borgmatic/">borgmatic</a>.</p>
    
      <h2 id="compression">
        
        
          Compression <a href="#compression" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h2>
<pre><code>borg create --compression TYPE
</code></pre>
<p>Default is no compression.</p>
<ul>
<li>fast repo storage and some compression: <code>lz4</code></li>
<li>less fast repo storage and a bit more compression: <code>zlib</code></li>
<li>very slow repo storage and high compression: <code>lzma</code></li>
</ul>
<p><code>lz4</code> is very fast thus preferred.
<code>lzma</code> is preferred when the repository is on a remote host with slow (dial-up) connection.</p>
    
      <h2 id="upgrade-from-attic">
        
        
          Upgrade from attic <a href="#upgrade-from-attic" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h2>
<pre><code>borg upgrade --inplace REPOSITORY
</code></pre>
<p>If a backup copy is required, omit the <code>--inplace</code> option.</p>
    
      <h2 id="hosted-services">
        
        
          Hosted Services <a href="#hosted-services" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h2>
<ul>
<li><a href="https://www.rsync.net/products/borg.html">rsync.net</a> also works with scp, rsync, git, etc. Nodes available globally.</li>
<li><a href="https://www.borgbase.com/">BorgBase</a> dedicated borg repository hosting with specific APIs. It also offers a free plan (5 GB and 2 repos), and paid plans are cheaper than rsync.net. Nodes available in US and EU.</li>
</ul>
    <div class="footer border-top border-gray-light mt-5 pt-3 text-gray">
      <div style="display: flex; justify-content: space-between; align-items: flex-start">
        <form id="site-search" action="https://duckduckgo.com/html/" method="get">
          <input name="q" type="search" value="site:mmap.page " required pattern="site:mmap\.page\s.+">
          <input type="submit" value="&#x1F50D;" title="search through site content via DuckDuckGo">
        </form>
        <p>
          <a href="mailto:weakish@gmail.com" title="weakish@gmail.com"><img src="https://icongr.am/feather/mail.svg" alt="Feather Icon Mail"></a>
          <a href="https://savannah.nongnu.org/people/viewgpg.php?user_id=65699" title="2414 AEA0 EA48 5263 9697  F1BA 55F6 EEC2 EA3F 0A87"><img src="https://icongr.am/feather/key.svg" alt="Feather Icon Key"></a>
          <a href="https://github.com/weakish/" title="GitHub"><img src="https://icongr.am/feather/github.svg" alt="Feather Icon Github"></a>
          <a href="https://www.instagram.com/jakukyo/" title="Instagram"><img src="https://icongr.am/feather/instagram.svg" alt="Feather Icon Instagram"></a>
          <a href="https://twitter.com/weakish" title="Twitter"><img src="https://icongr.am/feather/twitter.svg" alt="Feather Icon Twitter"></a>
          <a href="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/rss.xml" title="RSS 2.0 Feed"><img src="https://icongr.am/feather/rss.svg" alt="Feather Icon RSS"></a>
          <a href="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/uses/" title="uses"><img src="https://icongr.am/feather/book-open.svg" alt="Feather Icon Book Open"></a>
          
          
          <a href="/Me.ZeroNetwork.bit/?Profile/12h51ug6CcntU2aiBjhP8Ns2e5VypbWWtv/1GnJD7CXskmG8GywMbTvbP12wneCFW9XzR/weakish@zeroid.bit" title="ZeroMe"><img src="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/assets/images/zeronet_logo.svg" alt="ZeroNet Logo" width="32" height="32"></a>
        </p>
      </div>
        <p>
        Permission to use, copy, modify, and/or distribute this site for any purpose with or without fee is hereby granted.
        This site is provided "as is" without express or implied warranty.
        </p>
        <p>
        This site does not use cookies or tracking codes.
        The hosting service provider (<a href="https://pages.github.com/">GitHub Pages</a>) probably collects server logs,
        but I do not have access to them.
        </p>
        <p>
        Site source is <a href="https://github.com/weakish/weakish.github.com/">available</a>
        and feedback is <a href="https://github.com/weakish/weakish.github.com/issues">welcome</a>.
        </p>
        <noscript>
        <p>
        This site does not use JavaScript.
        </p>
        </noscript>
    </div>
  </div>
</body>
</html>
