<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dive into Ruby mmap.page</title>
    <link rel="stylesheet" href="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/assets/css/style.css">
    <link rel="alternate" type="application/rss+xml" href="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/rss.xml">
    <link rel="alternate" type="application/git+http" href="https://github.com/weakish/weakish.github.com.git"/>
</head>
<body>
  <div class="container-lg px-3 my-5 markdown-body">

    <h1><a href="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/">mmap.page</a></h1>
    <h1 id="dive-into-ruby">
        
        
          Dive into Ruby
        
        
      </h1>
    
      <h2 id="features">
        
        
          Features <a href="#features" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h2>
<ul>
<li><code>?</code> and <code>!</code> in method names.</li>
<li><code>1_000_000</code>.</li>
<li><code>local</code>, <code>Readonly</code>, <code>$global</code>, <code>@instance</code> and <code>@@class</code>.</li>
<li>Structs as light weight classes.</li>
<li><code>class SameName</code> merges, including core classes.</li>
<li><code>missing_method</code>, <code>define_method</code> and other meta-programming.</li>
</ul>
    
      <h2 id="quirks">
        
        
          Quirks <a href="#quirks" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h2>
    
      <h3 id="codebegin--end-whilecode">
        
        
          <code>begin ... end while</code> <a href="#codebegin--end-whilecode" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h3>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">begin</span> <span class="s2">"code executed"</span> <span class="k">end</span> <span class="k">while</span> <span class="kp">false</span>
<span class="s2">"code not executed"</span> <span class="k">while</span> <span class="kp">false</span>
</code></pre></div></div>
<p>This is really anti-intuitive.
And the creator of Ruby said not use it.</p>
<blockquote>
<p>Don't use it please.  I'm regretting this feature, and I'd like to remove it in the future if it's possible.</p>
</blockquote>
<blockquote>
<p>Because it's hard for users to tell
begin [code] end while [cond]
works differently from
[code] while [cond]</p>
</blockquote>
<blockquote>
<pre><code>loop do
  ...
  break if [cond]
  end
</code></pre></blockquote>
<p>-- <a href="http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-core/6745">matz.</a></p>
    
      <h3 id="codeprocnewcode">
        
        
          <code>Proc.new</code> <a href="#codeprocnewcode" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h3>
<p>The <code>return</code> statement in proc created by <code>Proc.new</code> will not only returns control just from itself, but <strong>also from the method enclosing it</strong>.</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">some_method</span>
	<span class="n">myproc</span> <span class="o">=</span> <span class="no">Proc</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span><span class="k">return</span> <span class="s2">"End."</span><span class="p">}</span>
	<span class="n">myproc</span><span class="p">.</span><span class="nf">call</span>

	<span class="c1"># Any code below will not get executed!</span>
	<span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></div></div>
<p>Well, you can argue that <code>Proc.new</code> inserts code into the enclosing method, just like block.
But <code>Proc.new</code> creates an object, while block are <em>part of</em> an object.</p>
<p>And there is another difference between lambda and <code>Proc.new</code>.
That is their handling of (wrong) arguments.
lambda complains about it, while <code>Proc.new</code> ignores extra arguments or considers absence of arguments as nil.</p>
<pre><code>irb(main):021:0&gt; l = -&gt; (x) { x.to_s }
=&gt; #&lt;Proc:0x8b63750@(irb):21 (lambda)&gt;
irb(main):022:0&gt; p = Proc.new { |x| x.to_s}
=&gt; #&lt;Proc:0x8b59494@(irb):22&gt;
irb(main):025:0&gt; l.call
ArgumentError: wrong number of arguments (0 for 1)
        from (irb):21:in `block in irb_binding'
        from (irb):25:in `call'
        from (irb):25
        from /usr/bin/irb:11:in `&lt;main&gt;'
irb(main):026:0&gt; p.call
=&gt; &quot;&quot;
irb(main):049:0&gt; l.call 1, 2
ArgumentError: wrong number of arguments (2 for 1)
        from (irb):47:in `block in irb_binding'
        from (irb):49:in `call'
        from (irb):49
        from /usr/bin/irb:11:in `&lt;main&gt;'
irb(main):050:0&gt; p.call 1, 2
=&gt; &quot;1&quot;
</code></pre>
<p>BTW, <code>proc</code> in Ruby 1.8 creates a lambda, while in Ruby 1.9+ behaves like <code>Proc.new</code>, really confusing.</p>
    
      <h3 id="codedefcode-does-not-create-closures">
        
        
          <code>def</code> does not create closures. <a href="#codedefcode-does-not-create-closures" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h3>
<p>Closures are simple in Python:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">b</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">x</span>
  <span class="n">b</span><span class="p">()</span>
</code></pre></div></div>
<p>This won't work in Ruby.</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">b</span>
    <span class="n">x</span>
  <span class="n">b</span>
<span class="k">end</span>
</code></pre></div></div>
<p>In Ruby, <code>def</code> starts a new scope, without access to outer variables.
Only <code>@var</code> and <code>$var</code> can be accessed.
And no <code>extern</code> keyword like in C.
In Ruby, lambda creates closure:</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">b</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">{</span> <span class="n">x</span> <span class="p">}</span>
  <span class="n">b</span><span class="p">.</span><span class="nf">call</span>
<span class="k">end</span>
</code></pre></div></div>
<p>Or <code>define_method</code>:</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">define_method</span><span class="p">(</span><span class="ss">:b</span><span class="p">)</span> <span class="p">{</span> <span class="n">x</span> <span class="p">}</span>
  <span class="n">b</span>
<span class="k">end</span>
</code></pre></div></div>
<p>In Ruby 1.9, <code>define_method</code> is not availabel in main Object, you can
use <code>define_singleton_method</code> instead.</p>
    
      <h2 id="tutorial">
        
        
          Tutorial <a href="#tutorial" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h2>
<p>Ruby advertises its &quot;Least Surprise&quot; principle,
thus I hope a basic understanding of the above features and quirks
is enough to dive into Ruby.
If you are unsure about something on Ruby,
you can guess and try, and it usually works,
except for quirks mentioned above.</p>
<p>If you prefer reading a tutorial before diving into Ruby,
I would recommend <a href="http://poignant.guide">why's guide to Ruby</a>,
a poignant introduction to a shiny language.</p>
    
      <h2 id="repl">
        
        
          REPL <a href="#repl" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h2>
<p>Use <a href="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/dive-into/pry/">pry</a>.</p>
    
      <h2 id="make">
        
        
          Make <a href="#make" class="anchor-hash" title="link to this heading">#</a>
        
        
      </h2>
<p>Use <code>rake</code>.</p>
<p><code>rake</code> is a popular choice in Ruby.</p>
<p><code>rake</code> is generally nice. But <code>pathmap</code> in <code>rake</code> uses rules hard to remember:</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">SOURCE_FILES</span><span class="p">.</span><span class="nf">pathmap</span><span class="p">(</span><span class="s2">"%{^sources/,outputs/}X.html"</span><span class="p">)</span>
</code></pre></div></div>
<p>WTF is <code>%{^sources/,outputs/}X</code>? And what is the difference if we replace <code>X</code> with one of <code>p</code>, <code>f</code>, <code>n</code>, <code>d</code>, <code>x</code>?</p>
    <div class="footer border-top border-gray-light mt-5 pt-3 text-gray">
      <div style="display: flex; justify-content: space-between; align-items: flex-start">
        <form id="site-search" action="https://duckduckgo.com/html/" method="get">
          <input name="q" type="search" value="site:mmap.page " required pattern="site:mmap\.page\s.+">
          <input type="submit" value="&#x1F50D;" title="search through site content via DuckDuckGo">
        </form>
        <p>
          <a href="mailto:weakish@gmail.com" title="weakish@gmail.com"><img src="https://icongr.am/feather/mail.svg" alt="Feather Icon Mail"></a>
          <a href="https://savannah.nongnu.org/people/viewgpg.php?user_id=65699" title="2414 AEA0 EA48 5263 9697  F1BA 55F6 EEC2 EA3F 0A87"><img src="https://icongr.am/feather/key.svg" alt="Feather Icon Key"></a>
          <a href="https://github.com/weakish/" title="GitHub"><img src="https://icongr.am/feather/github.svg" alt="Feather Icon Github"></a>
          <a href="https://www.instagram.com/jakukyo/" title="Instagram"><img src="https://icongr.am/feather/instagram.svg" alt="Feather Icon Instagram"></a>
          <a href="https://twitter.com/weakish" title="Twitter"><img src="https://icongr.am/feather/twitter.svg" alt="Feather Icon Twitter"></a>
          <a href="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/rss.xml" title="RSS 2.0 Feed"><img src="https://icongr.am/feather/rss.svg" alt="Feather Icon RSS"></a>
          <a href="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/uses/" title="uses"><img src="https://icongr.am/feather/book-open.svg" alt="Feather Icon Book Open"></a>
          
          
          <a href="/Me.ZeroNetwork.bit/?Profile/12h51ug6CcntU2aiBjhP8Ns2e5VypbWWtv/1GnJD7CXskmG8GywMbTvbP12wneCFW9XzR/weakish@zeroid.bit" title="ZeroMe"><img src="/16XMwj6YRNqRHWbmSD8oxYUZCKfM1uzwP9/assets/images/zeronet_logo.svg" alt="ZeroNet Logo" width="32" height="32"></a>
        </p>
      </div>
        <p>
        Permission to use, copy, modify, and/or distribute this site for any purpose with or without fee is hereby granted.
        This site is provided "as is" without express or implied warranty.
        </p>
        <p>
        This site does not use cookies or tracking codes.
        The hosting service provider (<a href="https://pages.github.com/">GitHub Pages</a>) probably collects server logs,
        but I do not have access to them.
        </p>
        <p>
        Site source is <a href="https://github.com/weakish/weakish.github.com/">available</a>
        and feedback is <a href="https://github.com/weakish/weakish.github.com/issues">welcome</a>.
        </p>
        <noscript>
        <p>
        This site does not use JavaScript.
        </p>
        </noscript>
    </div>
  </div>
</body>
</html>
