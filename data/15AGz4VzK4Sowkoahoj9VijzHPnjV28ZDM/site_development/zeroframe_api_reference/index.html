<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ZeroFrame API 参考 - ZeroNet 中文文档</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  

  <link rel="stylesheet" href="../../css/fonts.css" type="text/css" />

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../docs.css" rel="stylesheet">

  
  <script>
    // Current page data
    var mkdocs_page_name = "ZeroFrame API 参考";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 
  <script src="../../bitcoinbar/bitcoinbar.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> ZeroNet 中文文档</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">介绍</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../faq/">常见问题</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>开始使用 ZeroNet</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../using_zeronet/installing/">安装</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../using_zeronet/sample_sites/">示例站点</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../using_zeronet/create_new_site/">创建新站点</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>站点开发</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../getting_started/">入门</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">ZeroFrame API 参考</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#zeroframe-api">ZeroFrame API 参考</a></li>
                
            
                <li class="toctree-l3"><a href="#wrapper">Wrapper</a></li>
                
                    <li><a class="toctree-l4" href="#wrapperconfirm-message-button_caption">wrapperConfirm message, [button_caption]</a></li>
                
                    <li><a class="toctree-l4" href="#wrappergetlocalstorage">wrapperGetLocalStorage</a></li>
                
                    <li><a class="toctree-l4" href="#wrapperpermissionadd-permission">wrapperPermissionAdd permission</a></li>
                
                    <li><a class="toctree-l4" href="#wrappersetlocalstorage-data">wrapperSetLocalStorage data</a></li>
                
                    <li><a class="toctree-l4" href="#wrappernotification-type-message-timeout">wrapperNotification type, message, [timeout]</a></li>
                
                    <li><a class="toctree-l4" href="#wrapperprompt-message-type">wrapperPrompt message, [type]</a></li>
                
                    <li><a class="toctree-l4" href="#wrappersetviewport-viewport">wrapperSetViewport viewport</a></li>
                
            
                <li class="toctree-l3"><a href="#uiserver">UiServer</a></li>
                
                    <li><a class="toctree-l4" href="#certadd-domain-auth_type-auth_user_name-cert">certAdd domain, auth_type, auth_user_name, cert</a></li>
                
                    <li><a class="toctree-l4" href="#certselect-accepted_domains">certSelect accepted_domains</a></li>
                
                    <li><a class="toctree-l4" href="#channeljoin-channel">channelJoin channel</a></li>
                
                    <li><a class="toctree-l4" href="#dbquery-query">dbQuery query</a></li>
                
                    <li><a class="toctree-l4" href="#fileget-inner_path-required">fileGet inner_path, [required]</a></li>
                
                    <li><a class="toctree-l4" href="#filedelete-inner_path">fileDelete inner_path</a></li>
                
                    <li><a class="toctree-l4" href="#filequery-dir_inner_path-query">fileQuery dir_inner_path, query</a></li>
                
                    <li><a class="toctree-l4" href="#filerules-inner_path">fileRules inner_path</a></li>
                
                    <li><a class="toctree-l4" href="#filewrite-inner_path-content">fileWrite inner_path, content</a></li>
                
                    <li><a class="toctree-l4" href="#serverinfo">serverInfo</a></li>
                
                    <li><a class="toctree-l4" href="#siteinfo">siteInfo</a></li>
                
                    <li><a class="toctree-l4" href="#sitepublish-privatekey-inner_path-sign">sitePublish [privatekey], [inner_path], [sign]</a></li>
                
                    <li><a class="toctree-l4" href="#sitesign-privatekey-inner_path">siteSign [privatekey], [inner_path]</a></li>
                
                    <li><a class="toctree-l4" href="#siteupdate-address">siteUpdate address</a></li>
                
            
                <li class="toctree-l3"><a href="#cryptmessage">插件：CryptMessage</a></li>
                
                    <li><a class="toctree-l4" href="#userpublickey-index">userPublickey [index]</a></li>
                
                    <li><a class="toctree-l4" href="#eciesencrypt-text-publickey-return_aes_key">eciesEncrypt text, [publickey], [return_aes_key]</a></li>
                
                    <li><a class="toctree-l4" href="#eciesdecrypt-params-privatekey">eciesDecrypt params, [privatekey]</a></li>
                
                    <li><a class="toctree-l4" href="#aesencrypt-text-key-iv">aesEncrypt text, [key], [iv]</a></li>
                
                    <li><a class="toctree-l4" href="#aesdecrypt-iv-encrypted_text-key">aesDecrypt iv, encrypted_text, key</a></li>
                
                    <li><a class="toctree-l4" href="#aesdecrypt-encrypted_texts-keys">aesDecrypt encrypted_texts, keys</a></li>
                
            
                <li class="toctree-l3"><a href="#plugin-newsfeed">Plugin: Newsfeed</a></li>
                
                    <li><a class="toctree-l4" href="#feedfollow-feeds">feedFollow feeds</a></li>
                
                    <li><a class="toctree-l4" href="#feedlistfollow">feedListFollow</a></li>
                
                    <li><a class="toctree-l4" href="#feedquery">feedQuery</a></li>
                
            
                <li class="toctree-l3"><a href="#plugin-mergersite">Plugin: MergerSite</a></li>
                
                    <li><a class="toctree-l4" href="#mergersiteadd-addresses">mergerSiteAdd addresses</a></li>
                
                    <li><a class="toctree-l4" href="#mergersitedelete-address">mergerSiteDelete address</a></li>
                
                    <li><a class="toctree-l4" href="#mergersitelist-query_site_info">mergerSiteList [query_site_info]</a></li>
                
            
                <li class="toctree-l3"><a href="#optionalmanager">插件：OptionalManager</a></li>
                
                    <li><a class="toctree-l4" href="#optionalfilelist-address-orderby-limit">optionalFileList [address], [orderby], [limit]</a></li>
                
                    <li><a class="toctree-l4" href="#optionalfileinfo-inner_path">optionalFileInfo inner_path</a></li>
                
                    <li><a class="toctree-l4" href="#optionalfilepin-inner_path-address">optionalFilePin inner_path, [address]</a></li>
                
                    <li><a class="toctree-l4" href="#optionalfileunpin-inner_path-address">optionalFileUnpin inner_path, [address]</a></li>
                
                    <li><a class="toctree-l4" href="#optionalfiledelete-inner_path-address">optionalFileDelete inner_path, [address]</a></li>
                
                    <li><a class="toctree-l4" href="#optionallimitstats">optionalLimitStats</a></li>
                
                    <li><a class="toctree-l4" href="#actionoptionallimitset-limit">actionOptionalLimitSet limit</a></li>
                
                    <li><a class="toctree-l4" href="#actionoptionalhelplist-address">actionOptionalHelpList [address]</a></li>
                
                    <li><a class="toctree-l4" href="#actionoptionalhelp-directory-title-address">actionOptionalHelp directory, title, [address]</a></li>
                
                    <li><a class="toctree-l4" href="#actionoptionalhelpremove-directory-address">actionOptionalHelpRemove directory, [address]</a></li>
                
                    <li><a class="toctree-l4" href="#actionoptionalhelpall-value-address">actionOptionalHelpAll value, [address]</a></li>
                
            
                <li class="toctree-l3"><a href="#_1">管理命令</a></li>
                
                    <li><a class="toctree-l4" href="#configset-key-value">configSet key, value</a></li>
                
                    <li><a class="toctree-l4" href="#certset-domain">certSet domain</a></li>
                
                    <li><a class="toctree-l4" href="#channeljoinallsite-channel">channelJoinAllsite channel</a></li>
                
                    <li><a class="toctree-l4" href="#serverportcheck">serverPortcheck</a></li>
                
                    <li><a class="toctree-l4" href="#servershutdown">serverShutdown</a></li>
                
                    <li><a class="toctree-l4" href="#serverupdate">serverUpdate</a></li>
                
                    <li><a class="toctree-l4" href="#siteclone-address">siteClone address</a></li>
                
                    <li><a class="toctree-l4" href="#sitelist">siteList</a></li>
                
                    <li><a class="toctree-l4" href="#sitepause-address">sitePause address</a></li>
                
                    <li><a class="toctree-l4" href="#siteresume-address">siteResume address</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../content_json/">content.json 文件结构</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../dbschema_json/">dbschema.json 文件结构</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>帮助 ZeroNet 开发</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../help_zeronet/contributing/">为 ZeroNet 做贡献</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../help_zeronet/network_protocol/">网络协议</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../help_zeronet/donate/">捐赠</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">ZeroNet 中文文档</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">文档</a> &raquo;</li>
    
      
        
          <li>站点开发 &raquo;</li>
        
      
    
    <li>ZeroFrame API 参考</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/ysc3839/Documentation-zh" class="icon icon-github"> 在 GitHub 编辑</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="zeroframe-api">ZeroFrame API 参考</h1>
<h1 id="wrapper">Wrapper</h1>
<p><em>这些命令由封装框架处理，不会使用 websocket 发送到 UiServer</em></p>
<h4 id="wrapperconfirm-message-button_caption">wrapperConfirm <em>message, [button_caption]</em></h4>
<p>显示一条带有确认按钮的通知</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>message</strong></td>
<td>你想要显示的消息</td>
</tr>
<tr>
<td><strong>button_caption</strong> （可选）</td>
<td>确认按钮的标题 (默认：OK)</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: True 如果你点了按钮</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript"># Delete site
siteDelete: (address) -&gt;
    site = @sites[address]
    title = site.content.title
    if title.length &gt; 40
        title = title.substring(0, 15)+&quot;...&quot;+title.substring(title.length-10)
    @cmd &quot;wrapperConfirm&quot;, [&quot;Are you sure you sure? &lt;b&gt;#{title}&lt;/b&gt;&quot;, &quot;Delete&quot;], (confirmed) =&gt;
        @log &quot;Deleting #{site.address}...&quot;, confirmed
        if confirmed
            $(&quot;.site-#{site.address}&quot;).addClass(&quot;deleted&quot;)
            @cmd &quot;siteDelete&quot;, {&quot;address&quot;: address}
</code></pre>

<hr />
<h4 id="wrappergetlocalstorage">wrapperGetLocalStorage</h4>
<p><strong>返回值</strong>: 浏览器对站点的本地存储</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript">@cmd &quot;wrapperGetLocalStorage&quot;, [], (res) =&gt;
    res ?= {}
    @log &quot;Local storage value:&quot;, res
</code></pre>

<hr />
<h4 id="wrapperpermissionadd-permission">wrapperPermissionAdd <em>permission</em></h4>
<p>为站点请求新权限</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>permission</strong></td>
<td>权限名称 (eg. Merger:ZeroMe)</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="wrappersetlocalstorage-data">wrapperSetLocalStorage <em>data</em></h4>
<p>设置浏览器对站点的本地存储</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>data</strong></td>
<td>你想要存储在站点的任何结构</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: None</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript">Page.local_storage[&quot;topic.#{@topic_id}_#{@topic_user_id}.visited&quot;] = Time.timestamp()
Page.cmd &quot;wrapperSetLocalStorage&quot;, Page.local_storage
</code></pre>

<hr />
<h4 id="wrappernotification-type-message-timeout">wrapperNotification <em>type, message, [timeout]</em></h4>
<p>显示一个通知</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>type</strong></td>
<td>可能的值：info, error, done</td>
</tr>
<tr>
<td><strong>message</strong></td>
<td>你想要显示的消息</td>
</tr>
<tr>
<td><strong>timeout</strong> （可选）</td>
<td>在这个间隔后隐藏显示 （毫秒）</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: None</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript">@cmd &quot;wrapperNotification&quot;, [&quot;done&quot;, &quot;Your registration has been sent!&quot;, 10000]
</code></pre>

<hr />
<h4 id="wrapperprompt-message-type">wrapperPrompt <em>message, [type]</em></h4>
<p>确认用户的文本输入</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>message</strong></td>
<td>你想要显示的消息</td>
</tr>
<tr>
<td><strong>type</strong> （可选）</td>
<td>输入的类型 (默认：text)</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: 输入的文本</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript"># Prompt the private key
@cmd &quot;wrapperPrompt&quot;, [&quot;Enter your private key:&quot;, &quot;password&quot;], (privatekey) =&gt;
    $(&quot;.publishbar .button&quot;).addClass(&quot;loading&quot;)
    # Send sign content.json and publish request to server
    @cmd &quot;sitePublish&quot;, [privatekey], (res) =&gt;
        $(&quot;.publishbar .button&quot;).removeClass(&quot;loading&quot;)
        @log &quot;Publish result:&quot;, res
</code></pre>

<h4 id="wrappersetviewport-viewport">wrapperSetViewport <em>viewport</em></h4>
<p>设置站点的 viewport 元标记内容 （移动站点需要）</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>viewport</strong></td>
<td>viewport 元标记内容</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: None</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript"># Prompt the private key
@cmd &quot;wrapperSetViewport&quot;, &quot;width=device-width, initial-scale=1.0&quot;
</code></pre>

<hr />
<h1 id="uiserver">UiServer</h1>
<p>The UiServer is for ZeroNet what the LAMP setup is for normal websites.</p>
<p>The UiServer will do all the 'backend' work (eg: querying the DB, accessing files, etc). This are the API calls you will need to make your site dynamic.</p>
<h4 id="certadd-domain-auth_type-auth_user_name-cert">certAdd <em>domain, auth_type, auth_user_name, cert</em></h4>
<p>为当前用户添加一个新证书</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>domain</strong></td>
<td>证书颁发者域名</td>
</tr>
<tr>
<td><strong>auth_type</strong></td>
<td>注册使用的验证方式</td>
</tr>
<tr>
<td><strong>auth_user_name</strong></td>
<td>注册使用的用户名</td>
</tr>
<tr>
<td><strong>cert</strong></td>
<td>The cert itself: <code>auth_address#auth_type/auth_user_name</code> string signed by the cert site owner</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: "ok", "Not changed" or {"error": error_message}</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript">@cmd &quot;certAdd&quot;, [&quot;zeroid.bit&quot;, auth_type, user_name, cert_sign], (res) =&gt;
    $(&quot;.ui&quot;).removeClass(&quot;flipped&quot;)
    if res.error
        @cmd &quot;wrapperNotification&quot;, [&quot;error&quot;, &quot;#{res.error}&quot;]
</code></pre>

<hr />
<h4 id="certselect-accepted_domains">certSelect <em>accepted_domains</em></h4>
<p>显示证书选择器</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>accepted_domains</strong></td>
<td>List of domains that accepted by site as authorization provider</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: None</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript">@cmd &quot;certSelect&quot;, {&quot;accepted_domains&quot;: [&quot;zeroid.bit&quot;]}
</code></pre>

<hr />
<h4 id="channeljoin-channel">channelJoin <em>channel</em></h4>
<p>请求站点的事件通知</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>channel</strong></td>
<td>加入的通道</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: None</p>
<p><strong>Channels</strong>:</p>
<ul>
<li><strong>siteChanged</strong> (joined by default)<br>Events: peers_added, file_started, file_done, file_failed</li>
</ul>
<p><strong>Example</strong>:</p>
<pre><code class="coffeescript"># Wrapper websocket connection ready
onOpenWebsocket: (e) =&gt;
    @cmd &quot;channelJoinAllsite&quot;, {&quot;channel&quot;: &quot;siteChanged&quot;}

# Route incoming requests and messages
route: (cmd, data) -&gt;
    if cmd == &quot;setSiteInfo&quot;
        @log &quot;Site changed&quot;, data
    else
        @log &quot;Unknown command&quot;, cmd, data
</code></pre>

<p><strong>Example event data</strong></p>
<pre><code class="json">{
    &quot;tasks&quot;:0,
    &quot;size_limit&quot;:10,
    &quot;address&quot;:&quot;1RivERqttrjFqwp9YH1FviduBosQPtdBN&quot;,
    &quot;next_size_limit&quot;:10,
    &quot;event&quot;:[ &quot;file_done&quot;, &quot;index.html&quot; ],
    [...] # Same as siteInfo return dict
}

</code></pre>

<hr />
<h4 id="dbquery-query">dbQuery <em>query</em></h4>
<p>在 sql 缓存中执行一个查询</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>query</strong></td>
<td>Sql 请求命令</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: <list> 请求的结果</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript">@log &quot;Updating user info...&quot;, @my_address
Page.cmd &quot;dbQuery&quot;, [&quot;SELECT user.*, json.json_id AS data_json_id FROM user LEFT JOIN json USING(path) WHERE path='#{@my_address}/data.json'&quot;], (res) =&gt;
    if res.error or res.length == 0 # Db not ready yet or No user found
        $(&quot;.head-user.visitor&quot;).css(&quot;display&quot;, &quot;&quot;)
        $(&quot;.user_name-my&quot;).text(&quot;Visitor&quot;)
        if cb then cb()
        return

    @my_row = res[0]
    @my_id = @my_row[&quot;user_id&quot;]
    @my_name = @my_row[&quot;user_name&quot;]
    @my_max_size = @my_row[&quot;max_size&quot;]
</code></pre>

<hr />
<h4 id="fileget-inner_path-required">fileGet <em>inner_path, [required]</em></h4>
<p>获得文件内容</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>inner_path</strong></td>
<td>你想要获得的文件</td>
</tr>
<tr>
<td><strong>required</strong> （可选）</td>
<td>如果不存在的话，尝试并等待文件。(默认：True)</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: <string> 文件的内容</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript"># Upvote a topic on ZeroTalk
submitTopicVote: (e) =&gt;
    if not Users.my_name # Not registered
        Page.cmd &quot;wrapperNotification&quot;, [&quot;info&quot;, &quot;Please, request access before posting.&quot;]
        return false

    elem = $(e.currentTarget)
    elem.toggleClass(&quot;active&quot;).addClass(&quot;loading&quot;)
    inner_path = &quot;data/users/#{Users.my_address}/data.json&quot;

    Page.cmd &quot;fileGet&quot;, [inner_path], (data) =&gt;
        data = JSON.parse(data)
        data.topic_votes ?= {} # Create if not exits
        topic_address = elem.parents(&quot;.topic&quot;).data(&quot;topic_address&quot;)

        if elem.hasClass(&quot;active&quot;) # Add upvote to topic
            data.topic_votes[topic_address] = 1
        else # Remove upvote from topic
            delete data.topic_votes[topic_address]

        # Write file and publish to other peers
        Page.writePublish inner_path, Page.jsonEncode(data), (res) =&gt;
            elem.removeClass(&quot;loading&quot;)
            if res == true
                @log &quot;File written&quot;
            else # Failed
                elem.toggleClass(&quot;active&quot;) # Change back

    return false
</code></pre>

<hr />
<h4 id="filedelete-inner_path">fileDelete <em>inner_path</em></h4>
<p>删除一个文件</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>inner_path</strong></td>
<td>你想要删除的文件</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: 成功时返回 "ok" ，否则返回错误信息</p>
<hr />
<h4 id="filequery-dir_inner_path-query">fileQuery <em>dir_inner_path, query</em></h4>
<p>简单的 json 文件请求命令</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>dir_inner_path</strong></td>
<td>请求文件的模式</td>
</tr>
<tr>
<td><strong>query</strong></td>
<td>请求命令</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: <list> 匹配的内容</p>
<p><strong>Query examples:</strong></p>
<ul>
<li><code>["data/users/*/data.json", "topics"]</code>: Returns all topics node from all user files</li>
<li><code>["data/users/*/data.json", "comments.1@2"]</code>: Returns <code>user_data["comments"]["1@2"]</code> value from all user files</li>
<li><code>["data/users/*/data.json", ""]</code>: Returns all data from users files</li>
</ul>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript">@cmd &quot;fileQuery&quot;, [&quot;data/users/*/data.json&quot;, &quot;topics&quot;], (topics) =&gt;
    topics.sort (a, b) -&gt; # Sort by date
        return a.added - b.added
    for topic in topics
        @log topic.topic_id, topic.inner_path, topic.title
</code></pre>

<hr />
<h4 id="filerules-inner_path">fileRules <em>inner_path</em></h4>
<p>返回文件的规则。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>inner_path</strong></td>
<td>文件内部路径</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: <list> 匹配的内容</p>
<p><strong>Example result:</strong></p>
<pre><code class="json">{
    &quot;current_size&quot;: 2485,
    &quot;cert_signers&quot;: {&quot;zeroid.bit&quot;: [&quot;1iD5ZQJMNXu43w1qLB8sfdHVKppVMduGz&quot;]},
    &quot;files_allowed&quot;: &quot;data.json&quot;,
    &quot;signers&quot;: [&quot;1J3rJ8ecnwH2EPYa6MrgZttBNc61ACFiCj&quot;],
    &quot;user_address&quot;: &quot;1J3rJ8ecnwH2EPYa6MrgZttBNc61ACFiCj&quot;,
    &quot;max_size&quot;: 100000
}
</code></pre>

<p><strong>例子：</strong></p>
<pre><code class="coffeescript">@cmd &quot;fileRules&quot;, &quot;data/users/1J3rJ8ecnwH2EPYa6MrgZttBNc61ACFiCj/content.json&quot;, (rules) =&gt;
    @log rules
</code></pre>

<hr />
<h4 id="filewrite-inner_path-content">fileWrite <em>inner_path, content</em></h4>
<p>写入文件内容</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>inner_path</strong></td>
<td>你想要写入的文件的内部路径</td>
</tr>
<tr>
<td><strong>content_base64</strong></td>
<td>你想要写入的文件内容 （base64 编码）</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: 成功时返回 "ok" ，否则返回错误信息</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript">writeData: (cb=null) -&gt;
    # Encode to json, encode utf8
    json_raw = unescape(encodeURIComponent(JSON.stringify({&quot;hello&quot;: &quot;ZeroNet&quot;}, undefined, '\t')))
    # Convert to to base64 and send
    @cmd &quot;fileWrite&quot;, [&quot;data.json&quot;, btoa(json_raw)], (res) =&gt;
        if res == &quot;ok&quot;
            if cb then cb(true)
        else
            @cmd &quot;wrapperNotification&quot;, [&quot;error&quot;, &quot;File write error: #{res}&quot;]
            if cb then cb(false)
</code></pre>

<p><em>Note:</em> to write files that not in content.json yet, you must have <code>"own": true</code> in <code>data/sites.json</code> at the site you want to write</p>
<hr />
<h4 id="serverinfo">serverInfo</h4>
<p><strong>Return:</strong> <dict> 服务器上的所有信息</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript">@cmd &quot;serverInfo&quot;, {}, (server_info) =&gt;
    @log &quot;Server info:&quot;, server_info
</code></pre>

<p><strong>Example return value:</strong></p>
<pre><code class="json">{
    &quot;debug&quot;: true, # 运行在调试模式
    &quot;fileserver_ip&quot;: &quot;*&quot;, # 绑定的文件服务器
    &quot;fileserver_port&quot;: 15441, # 文件服务器的端口
    &quot;ip_external&quot;: true, # Active of passive mode
    &quot;platform&quot;: &quot;win32&quot;, # Operating system
    &quot;ui_ip&quot;: &quot;127.0.0.1&quot;, # UiServer binded to
    &quot;ui_port&quot;: 43110, # UiServer port (Web)
    &quot;version&quot;: &quot;0.2.5&quot; # 版本
}
</code></pre>

<hr />
<h4 id="siteinfo">siteInfo</h4>
<p><strong>返回值</strong>: <dict> 站点上的所有信息</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript">@cmd &quot;siteInfo&quot;, {}, (site_info) =&gt;
    @log &quot;Site info:&quot;, site_info
</code></pre>

<p><strong>实例返回值：</strong></p>
<pre><code class="json">{
    &quot;tasks&quot;: 0, # Number of files currently under download
    &quot;size_limit&quot;: 10, # Current site size limit in MB
    &quot;address&quot;: &quot;1EU1tbG9oC1A8jz2ouVwGZyQ5asrNsE4Vr&quot;, # Site address
    &quot;next_size_limit&quot;: 10, # Size limit required by sum of site's files
    &quot;auth_address&quot;: &quot;2D6xXUmCVAXGrbVUGRRJdS4j1hif1EMfae&quot;, # Current user's bitcoin address
    &quot;auth_key_sha512&quot;: &quot;269a0f4c1e0c697b9d56ccffd9a9748098e51acc5d2807adc15a587779be13cf&quot;, # Deprecated, dont use
    &quot;peers&quot;: 14, # Peers of site
    &quot;auth_key&quot;: &quot;pOBdl00EJ29Ad8OmVIc763k4&quot;, # Deprecated, dont use
    &quot;settings&quot;:  {
        &quot;peers&quot;: 13, # Saved peers num for sorting
        &quot;serving&quot;: true, # Site enabled
        &quot;modified&quot;: 1425344149.365, # Last modification time of all site's files
        &quot;own&quot;: true, # Own site
        &quot;permissions&quot;: [&quot;ADMIN&quot;], # Site's permission
        &quot;size&quot;: 342165 # Site total size in bytes
    },
    &quot;bad_files&quot;: 0, # Files that needs to be download
    &quot;workers&quot;: 0, # Current concurent downloads
    &quot;content&quot;: { # Root content.json
        &quot;files&quot;: 12, # Number of file, detailed file info removed to reduce data transfer and parse time
        &quot;描述&quot;: &quot;This site&quot;,
        &quot;title&quot;: &quot;ZeroHello&quot;,
        &quot;signs_required&quot;: 1,
        &quot;modified&quot;: 1425344149.365,
        &quot;ignore&quot;: &quot;(js|css)/(?!all.(js|css))&quot;,
        &quot;signers_sign&quot;: null,
        &quot;address&quot;: &quot;1EU1tbG9oC1A8jz2ouVwGZyQ5asrNsE4Vr&quot;,
        &quot;zeronet_version&quot;: &quot;0.2.5&quot;,
        &quot;includes&quot;: 0
    },
    &quot;cert_user_id&quot;: &quot;zeronetuser@zeroid.bit&quot;, # Currently selected certificate for the site
    &quot;started_task_num&quot;: 1, # Last number of files downloaded
    &quot;content_updated&quot;: 1426008289.71 # Content.json update time
}
</code></pre>

<hr />
<h4 id="sitepublish-privatekey-inner_path-sign">sitePublish <em>[privatekey], [inner_path], [sign]</em></h4>
<p>发布站点的 content.json</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>privatekey</strong> （可选）</td>
<td>用于签名的私钥 （默认：当前的用户私钥）</td>
</tr>
<tr>
<td><strong>inner_path</strong> （可选）</td>
<td>你想要发布的内容 json 的内部路径 （默认：content.json）</td>
</tr>
<tr>
<td><strong>sign</strong> （可选）</td>
<td>如果填 True 在发布前给 content.json 签名 （默认：True）</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: 成功时返回 "ok" ，否则返回错误信息</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript"># Prompt the private key
@cmd &quot;wrapperPrompt&quot;, [&quot;Enter your private key:&quot;, &quot;password&quot;], (privatekey) =&gt;
    $(&quot;.publishbar .button&quot;).addClass(&quot;loading&quot;)
    # Send sign content.json and publish request to server
    @cmd &quot;sitePublish&quot;, [privatekey], (res) =&gt;
        $(&quot;.publishbar .button&quot;).removeClass(&quot;loading&quot;)
        @log &quot;Publish result:&quot;, res
</code></pre>

<hr />
<h4 id="sitesign-privatekey-inner_path">siteSign <em>[privatekey], [inner_path]</em></h4>
<p>签名站点的 content.json</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>privatekey</strong> （可选）</td>
<td>用于签名的私钥 (默认：current user's privatekey)</td>
</tr>
<tr>
<td><strong>inner_path</strong> （可选）</td>
<td>你想要发布的内容 json 的内部路径 （默认：content.json）</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: 成功时返回 "ok" ，否则返回错误信息</p>
<blockquote>
<p><strong>Note:</strong>
Use "stored" as privatekey if its definied in users.json (eg. cloned sites)</p>
</blockquote>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript">if @site_info[&quot;privatekey&quot;] # Private key stored in users.json
    @cmd &quot;siteSign&quot;, [&quot;stored&quot;, &quot;content.json&quot;], (res) =&gt;
        @log &quot;Sign result&quot;, res
</code></pre>

<hr />
<h4 id="siteupdate-address">siteUpdate <em>address</em></h4>
<p>从其他节点强制检查和下载更改的内容 （只有用户在被动模式和使用老版本的 Zeronet 才必要）</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>address</strong></td>
<td>想要更新的站点地址 （没有站点的 ADMIN 权限只有当前的站点被允许）</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong> 没有</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript"># Manual site update for passive connections
updateSite: =&gt;
    $(&quot;#passive_error a&quot;).addClass(&quot;loading&quot;).removeClassLater(&quot;loading&quot;, 1000)
    @log &quot;Updating site...&quot;
    @cmd &quot;siteUpdate&quot;, {&quot;address&quot;: @site_info.address}
</code></pre>

<hr />
<h1 id="cryptmessage">插件：CryptMessage</h1>
<h4 id="userpublickey-index">userPublickey <em>[index]</em></h4>
<p>获取用户在网站特定的公钥</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>index</strong> （可选）</td>
<td>站点的子公钥 （默认：0）</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: base64 编码的公钥</p>
<hr />
<h4 id="eciesencrypt-text-publickey-return_aes_key">eciesEncrypt <em>text, [publickey], [return_aes_key]</em></h4>
<p>用公钥加密一段文本</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>text</strong></td>
<td>想要加密的文本</td>
</tr>
<tr>
<td><strong>publickey</strong> （可选）</td>
<td>用户的私钥索引 (int) 或 base64 编码的私钥 （默认：0）</td>
</tr>
<tr>
<td><strong>return_aes_key</strong> （可选）</td>
<td>获取用于加密的 AES 密钥 （默认：False）</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: base64 格式的加密后的文本或 [base64 格式的加密后的文本, base64 格式的 AES 密钥]</p>
<hr />
<h4 id="eciesdecrypt-params-privatekey">eciesDecrypt <em>params, [privatekey]</em></h4>
<p>尝试解密文本列表</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>params</strong></td>
<td>文本或加密的文本列表</td>
</tr>
<tr>
<td><strong>privatekey</strong> （可选）</td>
<td>用户的私钥索引 (int) 或 base64 编码的私钥 （默认：0）</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: 解密的文本或解密的文本列表 （解密失败时返回 null）</p>
<hr />
<h4 id="aesencrypt-text-key-iv">aesEncrypt <em>text, [key], [iv]</em></h4>
<p>使用指定的 key 和 iv 加密文本</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>text</strong></td>
<td>一条 AES 加密的文本</td>
</tr>
<tr>
<td><strong>key</strong> （可选）</td>
<td>Base64 编码的密码 (默认：generate new)</td>
</tr>
<tr>
<td><strong>iv</strong> （可选）</td>
<td>Base64 编码的 iv (默认：generate new)</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: [base64 编码的密钥, base64 编码的 iv, base64 编码的加密文本]</p>
<hr />
<h4 id="aesdecrypt-iv-encrypted_text-key">aesDecrypt <em>iv, encrypted_text, key</em></h4>
<h4 id="aesdecrypt-encrypted_texts-keys">aesDecrypt <em>encrypted_texts, keys</em></h4>
<p>使用指定的 key 和 iv 解密文本</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>iv</strong></td>
<td>Base64 格式编码的 IV</td>
</tr>
<tr>
<td><strong>encrypted_text</strong></td>
<td>base64 编码的加密文本</td>
</tr>
<tr>
<td><strong>encrypted_texts</strong></td>
<td>[base64 编码的 iv, base64 编码的加密文本] 列表对</td>
</tr>
<tr>
<td><strong>key</strong></td>
<td>用于文本加密的 Base64 编码的密码</td>
</tr>
<tr>
<td><strong>keys</strong></td>
<td>用于解密的密钥 (tries every one for every pairs)</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: Decoded text or list of decoded texts</p>
<hr />
<h1 id="plugin-newsfeed">Plugin: Newsfeed</h1>
<h4 id="feedfollow-feeds">feedFollow <em>feeds</em></h4>
<p>设置订阅的 sql 请求。</p>
<p>SQL 请求应该返回列与行的结果：</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>type</strong></td>
<td>类型：post, article, comment, mention</td>
</tr>
<tr>
<td><strong>date_added</strong></td>
<td>事件时间</td>
</tr>
<tr>
<td><strong>title</strong></td>
<td>显示的事件的第一行</td>
</tr>
<tr>
<td><strong>body</strong></td>
<td>事件的第二行和第三行</td>
</tr>
<tr>
<td><strong>url</strong></td>
<td>链接到事件页面</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>feeds</strong></td>
<td>格式：{"query name": [SQL query, [param1, param2, ...], ...}, 参数s will be escaped, joined by <code>,</code> inserted in place of <code>:params</code> in the Sql query.</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: ok</p>
<p><strong>例子：</strong></p>
<pre><code class="coffeescript"># Follow ZeroBlog posts
query = &quot;
    SELECT
     post_id AS event_uri,
     'post' AS type,
     date_published AS date_added,
     title AS title,
     body AS body,
     '?Post:' || post_id AS url
    FROM post
&quot;
params = [&quot;&quot;]
Page.cmd feedFollow [{&quot;Posts&quot;: [query, params]}]
</code></pre>

<hr />
<h4 id="feedlistfollow">feedListFollow</h4>
<p>返回当前订阅的消息来源</p>
<p><strong>返回值</strong>: 与 feedFollow 命令相同格式的订阅的消息来源</p>
<hr />
<h4 id="feedquery">feedQuery</h4>
<p>执行所有消息来源的 sql 请求</p>
<p><strong>返回值</strong>: 消息来源的 Sql 请求的结果</p>
<hr />
<h1 id="plugin-mergersite">Plugin: MergerSite</h1>
<h4 id="mergersiteadd-addresses">mergerSiteAdd <em>addresses</em></h4>
<p>开始下载新的合并站点</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>addresses</strong></td>
<td>站点地址或站点地址列表</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="mergersitedelete-address">mergerSiteDelete <em>address</em></h4>
<p>停止做种并删除一个合并站点</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>address</strong></td>
<td>站点地址</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="mergersitelist-query_site_info">mergerSiteList <em>[query_site_info]</em></h4>
<p>返回合并站点。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>query_site_info</strong></td>
<td>如果设为 True , 返回合并站点的详细站点信息</td>
</tr>
</tbody>
</table>
<hr />
<h1 id="optionalmanager">插件：OptionalManager</h1>
<h4 id="optionalfilelist-address-orderby-limit">optionalFileList <em>[address]</em>, <em>[orderby]</em>, <em>[limit]</em></h4>
<p>返回可选文件列表</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>address</strong></td>
<td>你想要列出可选文件的站点地址 （默认：当前站点）</td>
</tr>
<tr>
<td><strong>orderby</strong></td>
<td>返回可选文件的顺序 （默认：time_downloaded DESC）</td>
</tr>
<tr>
<td><strong>limit</strong></td>
<td>返回可选文件的最大数量 （默认：10）</td>
</tr>
</tbody>
</table>
<p><strong>Return</strong>: Database row of optional files: file_id, site_id, inner_path, hash_id, size, peer, uploaded, is_downloaded, is_pinned, time_added, time_downlaoded, time_accessed</p>
<hr />
<h4 id="optionalfileinfo-inner_path">optionalFileInfo <em>inner_path</em></h4>
<p>从数据库请求可选文件</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>inner_path</strong></td>
<td>文件的路径</td>
</tr>
</tbody>
</table>
<p><strong>Return</strong>: Database row of optional file: file_id, site_id, inner_path, hash_id, size, peer, uploaded, is_downloaded, is_pinned, time_added, time_downlaoded, time_accessed</p>
<hr />
<h4 id="optionalfilepin-inner_path-address">optionalFilePin <em>inner_path</em>, <em>[address]</em></h4>
<p>固定 （从自动可选文件清理中排除） 已下载的文件</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>inner_path</strong></td>
<td>文件的路径</td>
</tr>
<tr>
<td><strong>address</strong></td>
<td>文件的地址 （默认：当前站点）</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="optionalfileunpin-inner_path-address">optionalFileUnpin <em>inner_path</em>, <em>[address]</em></h4>
<p>解除固定 （包含入自动可选文件清理） 已下载的文件</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>inner_path</strong></td>
<td>文件的路径</td>
</tr>
<tr>
<td><strong>address</strong></td>
<td>文件的地址 （默认：当前站点）</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="optionalfiledelete-inner_path-address">optionalFileDelete <em>inner_path</em>, <em>[address]</em></h4>
<p>请求一个已下载的可选文件</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>inner_path</strong></td>
<td>文件的路径</td>
</tr>
<tr>
<td><strong>address</strong></td>
<td>文件的地址 （默认：当前站点）</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="optionallimitstats">optionalLimitStats</h4>
<p>返回当前可选文件的已使用空间</p>
<p><strong>Return</strong>: 限制、已使用和可用空间统计</p>
<hr />
<h4 id="actionoptionallimitset-limit">actionOptionalLimitSet <em>limit</em></h4>
<p>设置可选文件限制</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>limit</strong></td>
<td>用 gb 或百分比表示的最大可以被可选文件使用的空间</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="actionoptionalhelplist-address">actionOptionalHelpList <em>[address]</em></h4>
<p>列出可选文件的自动下载目录</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>address</strong></td>
<td>你想要列出帮助做种目录的站点地址 （默认：当前站点）</td>
</tr>
</tbody>
</table>
<p><strong>Return</strong>: 自动下载目录和描述的 Dict</p>
<hr />
<h4 id="actionoptionalhelp-directory-title-address">actionOptionalHelp directory, title, <em>[address]</em></h4>
<p>添加目录到自动下载列表</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>directory</strong></td>
<td>你想要添加到自动下载列表的目录</td>
</tr>
<tr>
<td><strong>title</strong></td>
<td>条目的标题 （在 ZeroHello 显示）</td>
</tr>
<tr>
<td><strong>address</strong></td>
<td>你想要添加自动下载目录的站点地址 （默认：当前站点）</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="actionoptionalhelpremove-directory-address">actionOptionalHelpRemove directory, <em>[address]</em></h4>
<p>移除一个自动下载条目</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>directory</strong></td>
<td>你想要从自动下载列表移除的目录</td>
</tr>
<tr>
<td><strong>address</strong></td>
<td>受影响的站点地址 （默认：当前站点）</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="actionoptionalhelpall-value-address">actionOptionalHelpAll value, <em>[address]</em></h4>
<p>帮助下在该站点的每个新上传的可选文件</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>value</strong></td>
<td>启用或禁用自动下载</td>
</tr>
<tr>
<td><strong>address</strong></td>
<td>受影响的站点地址 （默认：当前站点）</td>
</tr>
</tbody>
</table>
<hr />
<h1 id="_1">管理命令</h1>
<p><em>(requires ADMIN permission in data/sites.json)</em></p>
<hr />
<h4 id="configset-key-value">configSet <em>key, value</em></h4>
<p>在 ZeroNet 配置文件中创建或更新一个条目。 (zeronet.conf by default)</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>key</strong></td>
<td>配置条目名</td>
</tr>
<tr>
<td><strong>value</strong></td>
<td>配置条目新的值</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: ok</p>
<hr />
<h4 id="certset-domain">certSet <em>domain</em></h4>
<p>设置当前站点使用的证书</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>domain</strong></td>
<td>证书颁发者的域名</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: None</p>
<hr />
<h4 id="channeljoinallsite-channel">channelJoinAllsite <em>channel</em></h4>
<p>请求每个站点的通知</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>channel</strong></td>
<td>加入的通道 （参见 channelJoin）</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: None</p>
<hr />
<h4 id="serverportcheck">serverPortcheck</h4>
<p>开始检查端口是否打开</p>
<p><strong>返回值</strong>: True （端口打开） 或 False （端口关闭）</p>
<hr />
<h4 id="servershutdown">serverShutdown</h4>
<p>停止运行 ZeroNet 客户端</p>
<p><strong>返回值</strong>: None</p>
<hr />
<h4 id="serverupdate">serverUpdate</h4>
<p>从 github 上重新下载 ZeroNet</p>
<p><strong>返回值</strong>: None</p>
<hr />
<h4 id="siteclone-address">siteClone <em>address</em></h4>
<p>复制站点文件到一个新的站点</p>
<p>如果文件和目录有带 <code>-default</code> 后缀的版本，那些文件会被跳过，带后缀的版本会替代它被复制。</p>
<p>例如，如果你有一个 <code>data</code> 和一个 <code>data-default</code> 目录：<code>data</code>  目录将不会被复制，<code>data-default</code> 将被重命名成 <code>data</code> 。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>address</strong></td>
<td>想要克隆的站点地址</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: 没有，自动重定向到完成的新站点中</p>
<hr />
<h4 id="sitelist">siteList</h4>
<p><strong>返回值</strong>: <list> 所有已下载的站点信息列表</p>
<hr />
<h4 id="sitepause-address">sitePause <em>address</em></h4>
<p>暂停站点服务</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>address</strong></td>
<td>想要暂停的站点地址</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: 没有</p>
<hr />
<h4 id="siteresume-address">siteResume <em>address</em></h4>
<p>恢复站点服务</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>address</strong></td>
<td>想要恢复的站点地址</td>
</tr>
</tbody>
</table>
<p><strong>返回值</strong>: 没有</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../content_json/" class="btn btn-neutral float-right" title="content.json 文件结构"/>下一页 <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../getting_started/" class="btn btn-neutral" title="入门"><span class="icon icon-circle-arrow-left"></span> 上一页</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../getting_started/" style="color: #fcfcfc;">&laquo; 上一页</a></span>
      
      
        <span style="margin-left: 15px"><a href="../content_json/" style="color: #fcfcfc">下一页 &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
