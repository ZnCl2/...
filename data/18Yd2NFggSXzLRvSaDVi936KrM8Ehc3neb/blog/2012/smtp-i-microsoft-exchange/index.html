<!DOCTYPE HTML>
<html lang="ru">
    <head>
      <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>18Yd2NFggSXzLRvSaDVi936KrM8Ehc3neb</title>
      <link rel="stylesheet" href="/18Yd2NFggSXzLRvSaDVi936KrM8Ehc3neb/css/main.css"/>
      <link rel="shortcut icon" type="image/x-icon" href="/18Yd2NFggSXzLRvSaDVi936KrM8Ehc3neb/i/favicon.ico"/>
      <link href="/18Yd2NFggSXzLRvSaDVi936KrM8Ehc3neb/rss.xml" title="Akademic's blog" type="application/rss+xml" rel="alternate"/>
    </head>
    <body>
        <header><h1><a href="/18Yd2NFggSXzLRvSaDVi936KrM8Ehc3neb" rel="home">akademic.name</a></h1></header>
        <main class="content">
            
<article>
    <h1>smtp и microsoft exchange</h1> <time>18.07.2012</time>
	<p>Есть у меня скриптик на PHP, который рассылает почту через указанный smtp сервер.
Через какой-то фряшный сервер он работал.
Через яндексовый сервер он работал.
А вот понадобилось слать через microsoft exchange так перестал работать.</p>

<p>Долго я мучал авторизацию, прикручивал разные логи и прочее.
В логах увидел, что сервер отвечает что-то вроде Client Timeout.
Типа &ldquo;я ждал-ждал, а клиент, редиска такой, ничего не прислал мне&rdquo;.</p>

<p>Открыл я тогда telnet и скопировал то, что скрипт посылает серверу, из лога.
И о чудо! Письмо прошло.</p>

<p>Перебрал несколько догадок навроде: &ldquo;это же винда, может ему не только \n, а ещё и \r надобно?&rdquo;
Ничего этим не добился.</p>

<p>И тут меня осенило: Микрософт птица гордая и очень обидчивая, а значит&hellip;
Значит, что сервер ничего не будет делать пока не прочитаешь из сокета, что он там тебе отвечает.
Вставил после каждой посылки команды функцию чтения и привет, всё заработало.</p>

    
    <span class="next_blog_post">
    <a href="/18Yd2NFggSXzLRvSaDVi936KrM8Ehc3neb/blog/2012/array-rublej/index.html" rel="next">Array рублей</a>
    </span>
	
	
    <span class="prev_blog_post">
    <a href="/18Yd2NFggSXzLRvSaDVi936KrM8Ehc3neb/blog/2012/konfiguraciya-ethernet-interfejsa-iz-skripta-v-openwrt/index.html" rel="previous">Конфигурация ethernet интерфейса из скрипта в openwrt</a>
    </span>
	
</article>

        </main>
        <footer>
        Будьте внимательны, многое из того, что написано в этом блоге, является личным мнением автора и не претендует на истину.
        <img src="/18Yd2NFggSXzLRvSaDVi936KrM8Ehc3neb/i/yopiright.jpg" width="12" height="12"/> 2008
        </footer>
    </body>
</html>
