(function(e){function t(t){for(var o,i,a=t[0],c=t[1],u=t[2],d=0,v=[];d<a.length;d++)i=a[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&v.push(r[i][0]),r[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);l&&l(t);while(v.length)v.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],o=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(o=!1)}o&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={app:0},s=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/1LdeDdtifLpRwizQkzYmWWVuUpuDhrGz4f/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"1d87":function(e,t,n){"use strict";var o=n("a8a2"),r=n.n(o);r.a},2253:function(e,t){e.exports={publicPath:"/1LdeDdtifLpRwizQkzYmWWVuUpuDhrGz4f/"}},"3fa7":function(e,t,n){"use strict";n.r(t);n("8e6e"),n("ac6a"),n("456d");var o=n("75fc"),r=n("768b"),s=n("bd86"),i=(n("7f7f"),n("7618")),a=n("d225"),c=n("b0b4"),u=n("308d"),l=n("6bb5"),d=n("4e2b"),v=n("a026"),p=n("5934"),f=n.n(p),g=n("2f62"),m=n("c1df"),h=n.n(m),b=n("6ba3"),y=n.n(b),O=n("ad94");function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(n,!0).forEach((function(t){Object(s["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=!1,P=null;try{P=n("2253")}catch(N){P=n("4233")}var _="4198df1b-c8ac-44a3-9240-c76de38f80b2";JSON.parseS=function(e){var t=null;try{t=JSON.parse(e)}catch(n){t=null}return t},JSON.copy=function(e){var t=JSON.stringify(e);return JSON.parseS(t)};var k=null,I=function(e){function t(){return Object(a["a"])(this,t),Object(u["a"])(this,Object(l["a"])(t).apply(this,arguments))}return Object(d["a"])(t,e),Object(c["a"])(t,[{key:"sendMessage",value:function(e,t){var n=this;if("#Lobby"===e)this.cmd("peerBroadcast",{message:{conversationId:e,body:t,dateAdded:h()().format("x")},privatekey:!1});else{var o=y()(e,_),r=btoa(o);this.cmd("aesEncrypt",[JSON.stringify({conversationId:e,body:t,dateAdded:h()().format("x")}),r],(function(e){var t=e[1],o=e[2];n.cmd("peerBroadcast",{message:{iv:t,encMsg:o},privatekey:!1})}))}}},{key:"setSiteInfo",value:function(e){if(e&&"object"===Object(i["a"])(e)){this.log("setting siteInfo",e),k=e;var t=document.getElementById("out"),n=null;k&&k.hasOwnProperty("auth_address")&&k.auth_address&&(n={userId:k.auth_address,userName:k.cert_user_id}),n?window.VueApp.$store.commit("ConversationProviders/provider_"+M.name+"/logIn",n):window.VueApp.$store.commit("ConversationProviders/provider_"+M.name+"/logOut"),t&&(t.innerHTML="Page address: "+e.address+"<br>- Peers: "+e.peers+"<br>- Size: "+e.settings.size+"<br>- Modified: "+new Date(1e3*e.content.modified))}}},{key:"onOpenWebsocket",value:function(){this.cmd("siteInfo",[],(function(e){x.setSiteInfo(e)}))}},{key:"onRequest",value:function(e,t){if("setSiteInfo"===e)this.setSiteInfo(t.params);else if("peerReceive"===e){if(this.log("onRequest::peerReceive",t),t.params.message.encMsg)for(var n in M.conversations){var o=y()(n,_),r=btoa(o);this.cmd("aesDecrypt",[t.params.message.iv,t.params.message.encMsg,r],(function(e){if(e){var n=JSON.parseS(e);if(n){var o=n.conversationId,r=decodeURIComponent(n.body),s=n.dateAdded,i=t.params.signed_by,a=t.params.cert,c=y()(s,y()(i,y()(o,_)));window.VueApp.$store.dispatch("ConversationProviders/provider_"+M.name+"/addMessage",[o,i,a,c,s,r])}}}))}else{var s=t.params.message,i=s.conversationId,a=decodeURIComponent(s.body),c=s.dateAdded,u=t.params.signed_by,l=t.params.cert,d=y()(c,y()(u,y()(i,_)));window.VueApp.$store.dispatch("ConversationProviders/provider_"+M.name+"/addMessage",[i,u,l,d,c,a])}this.cmd("peerValid",[t.params.hash])}else this.log("Unknown incoming message:",e)}}]),t}(O["default"]),x=new I;f.a.config={hues:[251],lightness:{color:[.4,.8],grayscale:[.3,.9]},saturation:{color:.5,grayscale:0},backColor:"#a5212100"};var M={name:"zn",curUser:null,conversations:{"#Lobby":{providerName:"zn",id:"#Lobby",name:"#Lobby",messagekeys:[],lastMessage:null}},messages:{}},A={isAvailable:function(){return!0},isReady:function(e,t){return t.isLoggedIn},conversationExists:function(e){var t=e.conversations;return function(e){return t.hasOwnProperty(e)}},getCurUser:function(e){var t=e.curUser;return t},isLoggedIn:function(e){var t=e.curUser;return!!t},getUserAvatar:function(){return function(e){return[3,f.a.toSvg(y()(e,y()("userId",_)),48)]}},getConversationAvatar:function(){return function(e){return"#Lobby"===e?[3,'<img src="'+(w?"/public":P.publicPath)+'/mstile-144x144.png" />']:[3,f.a.toSvg(y()(e,y()("conversationId",_)),48)]}},validateMessage:function(){return function(e){return!!e.trim()}},managerComponent:function(e,t){return v["a"].component(e.name+"-joinComponent",{data:function(){return{conversationId:""}},computed:j({isLoggedIn:function(){return t.isLoggedIn},user:function(){return t.getCurUser},alreadyInConversation:function(){return t.conversationExists(this.conversationId)}},Object(g["c"])({state_curConversation:"ConversationProviders/state_curConversation"})),methods:j({changeCert:function(){x.cmd("certSelect",[["zeroid.bit","kaffie.bit","cryptoid.bit","peak.id","zeroverse.bit","kxoid.bit"]])},joinConversation:function(){this.conversationId&&this.joinConversationInProvider([this.conversationId])},leaveConversation:function(){this.conversationId&&this.leaveConversationInProvider(this.conversationId)}},Object(g["d"])({joinConversationInProvider:"ConversationProviders/provider_"+e.name+"/joinConversation",leaveConversationInProvider:"ConversationProviders/provider_"+e.name+"/leaveConversation",changeConversation:"ConversationProviders/changeConversation"})),template:'\n            <div class="manager-component">\n                <template v-if="isLoggedIn">\n                    <div class="input-group">\n                        <span class="input-group-addon">auth address</span>\n                        <input class="auth-address input" v-model="user.userId" readonly="true" placeholder="auth address" title="auth address" />\n                    </div>\n                    <div class="input-group" style="margin-top: .4rem; margin-bottom: .4rem;">\n                        <span class="input-group-addon">user name</span>\n                        <input class="user-name input" v-model="user.userName" readonly="true" placeholder="user name" title="user name" />\n                    </div>\n                </template>\n                <div class="btn-group">\n                    <button v-if="!isLoggedIn" type="submit" @click="changeCert()" class="btn rounded lg primary">Choose a cert</button>\n                    <button v-else type="submit" @click="changeCert()" class="btn rounded primary">Change cert</button>\n                </div>\n                <br />\n                <p id="out"></p>\n                <div v-if="isLoggedIn">\n                    <h4>Join and leave conversations</h4>\n                    <input class="conversation-id input" v-model="conversationId" placeholder="conversation id" title="conversation id" />\n                    <div class="btn-group" style="margin-top: .4rem;">\n                        <button v-if="!alreadyInConversation" type="submit" @click="joinConversation()" :disabled="!conversationId" class="btn rounded lg primary">Join Conversation</button>\n                        <button v-else type="submit" @click="leaveConversation()" class="btn flat outline rounded secondary">Leave Conversation</button>\n                    </div>\n                </div>\n            </div>\n            '})},conversationListItemActions:function(e,t){return function(n,o){var r=o.commit;return t.conversationExists(n)?[{name:"Leave conversation",onclick:function(){r("ConversationProviders/provider_"+e.name+"/leaveConversation",n)},classes:"link secondary",conversationId:n}]:null}},messageActions:function(e,t){return function(n,o){var r=o.commit,s=n.conversationId;return t.conversationExists(s)?[{name:"Delete message",onclick:function(){r("ConversationProviders/provider_"+e.name+"/deleteMessage",[s,n.key])},classes:"link",conversationId:s}]:null}}},D={logIn:function(e,t){e.curUser=t},logOut:function(e){e.curUser=null},addMessage:function(e,t){var n=Object(r["a"])(t,2),i=n[0],a=n[1];return e.messages=j({},e.messages,Object(s["a"])({},a.key,a)),e.conversations=j({},e.conversations,Object(s["a"])({},i,j({},e.conversations[i],{messagekeys:[].concat(Object(o["a"])(e.conversations[i].messagekeys),[a.key]),lastMessage:a}))),null},deleteMessage:function(e,t){var n=Object(r["a"])(t,2),o=n[0],i=n[1];if(delete e.messages[i],e.messages=j({},e.messages),e.conversations[o]){var a=e.conversations[o].messagekeys.indexOf(i);if(-1!==a){var c=JSON.copy(e.conversations[o].messagekeys);c.splice(a,1),e.conversations=j({},e.conversations,Object(s["a"])({},o,j({},e.conversations[o],{messagekeys:c,lastMessage:c.length>0?e.messages[c[c.length-1]]:null})))}}},joinConversation:function(e,t){var n=Object(r["a"])(t,2),o=n[0],i=n[1];i=i||o,e.conversations=j({},e.conversations,Object(s["a"])({},o,{providerName:e.name,id:o,name:i,messagekeys:[],lastMessage:null}))},leaveConversation:function(e,t){delete e.conversations[t],e.conversations=j({},e.conversations)}},E={init:function(e){var t=e.state;console.debug("initted conversation provider",t.name)},addMessage:function(e,t){var n=e.state,o=e.getters,s=e.commit,i=Object(r["a"])(t,6),a=i[0],c=i[1],u=i[2],l=i[3],d=i[4],v=i[5];if(o.conversationExists(a)){var p={providerName:n.name,conversationId:a,key:l,userId:c,userName:u,dateAdded:d,body:v};return s("addMessage",[a,p]),p}return console.debug("provider",n.name,"has no conversation with id",a),null},sendMessage:function(e,t){var n=e.getters,o=Object(r["a"])(t,2),s=o[0],i=o[1];if(n.isLoggedIn){if(n.validateMessage(i))return console.debug("provider sending message..",s,i),x.sendMessage(s,i),!0;throw new Error("Message invalid!")}throw new Error("Not logged in!")},fetchMessages:function(e,t){var n=e.getters;return new Promise((function(e,o){n.conversationExists(t)&&e({conversationId:t})}))}};t["default"]={namespaced:!0,state:M,getters:A,mutations:D,actions:E}},4233:function(e,t){e.exports={publicPath:"/"}},4678:function(e,t,n){var o={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function r(e){var t=s(e);return n(t)}function s(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=s,e.exports=r,r.id="4678"},"56d7":function(e,t,n){"use strict";n.r(t);var o={};n.r(o),n.d(o,"curView",(function(){return An})),n.d(o,"curConversation",(function(){return Dn})),n.d(o,"isPluginInstalled",(function(){return En})),n.d(o,"isPluginReady",(function(){return Nn})),n.d(o,"pluginFunctionality",(function(){return Sn})),n.d(o,"pluginFunctionalityRenderMsgBody",(function(){return $n})),n.d(o,"renderMsgBody",(function(){return Tn})),n.d(o,"resourceExtComponents",(function(){return Bn})),n.d(o,"inputExtComponents",(function(){return Hn}));var r={};n.r(r),n.d(r,"openConversation",(function(){return Un})),n.d(r,"closeConversation",(function(){return Yn})),n.d(r,"newMsg",(function(){return zn})),n.d(r,"displayNotification",(function(){return Fn}));var s=n("7618"),i=(n("cadf"),n("551c"),n("f751"),n("097d"),n("a026")),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"shadow",attrs:{id:"app"}},[n("Viewpage"),n("div",{staticClass:"dropdown-inners"},[n("div",{ref:"dropdownOverlays"}),n("div",{ref:"dropdownMenus"})])],1)},c=[],u=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"viewpage",attrs:{"cur-view":e.curView}},[n(e.curView,{key:e.curView,tag:"component"})],1)},d=[],v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"view-conversation"},[n("div",{staticClass:"conversation-list-container",attrs:{inconversation:e.isInConversation,conversationinfo:e.isInConversation&&e.conversationInfoOpen}},[n("ConversationListNavbar"),0===e.anyProviderAvailable.length?[e._m(0)]:e.oneProviderMode&&!e.isReady(e.getAllConversationProviders[0].name)||0===e.anyProviderReady.length?[n("div",{staticClass:"one-provider-mode-container"},[n("ConversationProviderManager",{staticClass:"card shadow"})],1)]:[n("ConversationList",{on:{"update:conversationInfoOpen":function(t){return e.toggleConversationInfoOpen(t)}}})]],2),e.isInConversation?n("div",{key:e.isInConversation?"conversation_"+e.getCurConversation.providerName+"_"+e.getCurConversation.id:null,staticClass:"conversation-container",attrs:{inconversation:e.isInConversation,conversationinfo:e.isInConversation&&e.conversationInfoOpen}},[n("ConversationNavbar",{on:{"update:conversationInfoOpen":function(t){return e.toggleConversationInfoOpen(t)}}}),n("Conversation")],1):e._e(),e.isInConversation&&e.conversationInfoOpen?n("div",{key:e.isInConversation&&e.conversationInfoOpen?"conversation-info_"+e.getCurConversation.providerName+"_"+e.getCurConversation.id:null,staticClass:"conversation-info-container",attrs:{conversationinfo:e.isInConversation&&e.conversationInfoOpen}},[n("ConversationInfoNavbar",{on:{"update:conversationInfoOpen":function(t){return e.toggleConversationInfoOpen(t)}}}),n("ConversationInfo")],1):e._e()])},p=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"no-provider-available-container"},[n("div",{staticClass:"card shadow"},[n("span",{staticClass:"card-title clr-bg bgclr-secondary"},[e._v("\n\t\t\t\t\t\t\tNo providers currently available!\n\t\t\t\t\t\t")])])])}],f=(n("7f7f"),function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)}),g=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-list-navbar navbar card"},[n("div",{staticClass:"navbar-section"}),n("div",{staticClass:"navbar-section navbar-center"},[n("span",{staticClass:"navbar-brand"},[e._v("ThunderWave X")])]),n("div",{staticClass:"navbar-section"})])}],m={name:"ConversationListNavbar",data:function(){return{}}},h=m,b=n("2877"),y=Object(b["a"])(h,f,g,!1,null,null,null),O=y.exports,C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-list",attrs:{"open-dialog":e.openDialog}},[0===e.getAllConversations.length?e._l(3,(function(t){return n("div",{key:"conversation-sample_"+t,staticClass:"conversation-list-item conversation-list-item-sample card"},[e._m(0,!0),e._m(1,!0)])})):e._l(e.getAllConversations,(function(t){return n("ConversationListItem",{key:"conversation_"+t.providerName+"_"+t.id,attrs:{conversation:t,active:!!e.getCurConversation&&t.providerName==e.getCurConversation.providerName&&t.id==e.getCurConversation.id},on:{"update:conversationInfoOpen":function(t){return e.updateConversationInfoOpen(t)}}})})),n("ConversationListActions",{attrs:{scrolledToBottom:e.scrolledToBottom},on:{"update:openDialog":e.setOpenDialog}})],2)},j=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-avatar-container"},[n("button",{staticClass:"conversation-avatar btn action flat rounded"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content"},[n("span",{staticClass:"title_timestamp"},[n("span",{staticClass:"title clr-secondary"},[n("div",{staticClass:"sampletext bgclr-secondary",staticStyle:{width:"128px"}})]),n("span",{staticClass:"timestamp"},[n("div",{staticClass:"sampletext bgclr-light",staticStyle:{width:"64px"}})])]),n("span",{staticClass:"last-message_conversation-action"},[n("span",{staticClass:"last-message"},[n("span",{staticClass:"username"},[n("div",{staticClass:"sampletext bgclr-dark",staticStyle:{width:"96px"}}),e._v("\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t")]),n("span",{staticClass:"body"},[n("div",{staticClass:"sampletext bgclr-dark",staticStyle:{width:"128px"}})])]),n("span",{staticClass:"conversation-action"})])])}],w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:"conversation-list-item card "+(e.dropdownActive?"":"hovershadow ")+(e.active?"active secondary ":""),on:{click:e.handleClick,contextmenu:function(t){if(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)return null;t.preventDefault(),e.dropdownActive=!0}}},[n("div",{staticClass:"conversation-avatar-container"},[e.conversationProviderHasAvatarProvider(e.conversation.providerName)?n("ConversationAvatar",{key:e.conversation.id?"conversation_"+e.conversation.providerName+"_"+e.conversation.id:"conversation_"+e.conversation.providerName,staticClass:"flat rounded shadow lg",attrs:{providerName:e.conversation.providerName,conversationId:e.conversation.id}}):n("button",{staticClass:"conversation-avatar btn action flat rounded"})],1),n("div",{staticClass:"content"},[n("span",{staticClass:"title_timestamp_conversation-action-dropdown"},[n("span",{staticClass:"title clr-secondary"},[e._v(e._s(e.conversation.name)+"\n\t\t\t\t"),e.oneProviderMode?e._e():n("i",[e._v("("+e._s(e.conversation.providerName)+")")])]),n("span",{staticClass:"timestamp"},[e._v(e._s(e.conversation.lastMessage&&e.conversation.lastMessage.dateAdded?" "+e.timestamp:"")+" ")]),e.getConversationListItemActions?n("Dropdown",{staticClass:"conversation-action-dropdown",attrs:{items:e.getConversationListItemActions,align:"right",active:e.dropdownActive},on:{"update:active":function(t){e.dropdownActive=t}},scopedSlots:e._u([{key:"activator",fn:function(t){return[n("button",{class:"conversation-action-btn btn action link sm "+(t.active?"active ":""),on:{click:function(e){return e.stopPropagation(),t.on()}}},[n("icon",[e._v("dots-vertical")])],1)]}},{key:"item",fn:function(t){return[n("button",{class:"conversation-action-dropdown-menu-li btn "+(t.item.classes||"link"),attrs:{disabled:t.item.disabled},on:{click:function(n){return n.stopPropagation(),e.dropdownAction(t)}}},[e._v("\n\t\t\t\t\t\t"+e._s("function"===typeof t.item.name?t.item.name():t.item.name)+"\n\t\t\t\t\t")])]}}],null,!1,1106718548)}):e._e()],1),n("span",{staticClass:"last-message"},[n("span",{staticClass:"username"},[e._v(e._s(e.conversation.lastMessage&&e.conversation.lastMessage.userId?(e.conversation.lastMessage.userName||e.conversation.lastMessage.userId)+": ":""))]),n("span",{staticClass:"body"},[e._v(e._s(e.conversation.lastMessage&&decodeURIComponent(e.conversation.lastMessage.body)?decodeURIComponent(e.conversation.lastMessage.body):""))])])])])},P=[],_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("i",{class:e.classes})},k=[],I=(n("c5f6"),{name:"Icon",props:{size:{type:Number,validator:function(e){return"number"===typeof e&&e===parseInt(e)}}},computed:{classes:function(){return"icon mdi "+(this.size?"mdi-"+["18","24","36","48"][this.size]+"px":"")+" mdi-"+(this.$slots.default&&this.$slots.default.length>0?this.$slots.default[0].text:"")}}}),x=I,M=Object(b["a"])(x,_,k,!1,null,null,null),A=M.exports,D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dropdown",attrs:{active:e.sActive,align:e.align,"menu-type":e.menuType}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.sActive,expression:"sActive"}],ref:"overlay",staticClass:"overlay",on:{click:function(t){return t.stopPropagation(),e.setActive(!1)},contextmenu:function(t){return t.stopPropagation(),t.preventDefault(),e.setActive(!1)}}}),n("div",{ref:"activator",staticClass:"activator"},[e._t("activator",null,{on:e.setActive,active:e.sActive,align:e.align})],2),n("div",{ref:"menuContainer",staticClass:"menu-container",style:"top: "+e.y+"px; left: "+e.x+"px; ",attrs:{active:e.sActive,align:e.align,"menu-type":e.menuType}},[n("transition",{attrs:{name:"menu-active"}},[e.eager||e.sActive?n("div",{directives:[{name:"show",rawName:"v-show",value:!e.eager||e.sActive,expression:"eager ? sActive : true"}],ref:"menu",staticClass:"menu"},[e.$slots.content?e._t("content",null,{items:e.items,on:e.setActive,align:e.align}):[e._l(e.items,(function(t,n){return e._t("item",[e._v("\n\t\t\t\t\t\t"+e._s(t)+"\n\t\t\t\t\t")],{item:t,index:n,on:e.setActive,align:e.align})}))]],2):e._e()])],1)])},E=[],N={props:{active:!1,align:{default:"left",validator:function(e){return"string"===typeof e&&-1!==["left","right"].indexOf(e)}},menuType:{default:"list",validator:function(e){return"string"===typeof e&&-1!==["list","grid"].indexOf(e)}},eager:!1,items:{default:[],type:Array}},data:function(){return{sActive:this.active,x:0,y:0}},methods:{setActive:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.sActive;this.sActive=e,this.$emit("update:active",e)}},watch:{active:function(e){e&&(this.$root.$app.$refs.dropdownOverlays.innerHTML="",this.$root.$app.$refs.dropdownMenus.innerHTML="",this.$root.$app.$refs.dropdownOverlays.appendChild(this.$refs.overlay),this.$root.$app.$refs.dropdownMenus.appendChild(this.$refs.menuContainer)),this.sActive=e},sActive:function(e){var t=this;e&&this.$nextTick((function(){var e=t.$el.getBoundingClientRect(),n=t.$refs.activator.getBoundingClientRect(),o=t.$refs.menuContainer.getBoundingClientRect();t.x="left"===t.align?e.left:e.right-o.width,t.y=e.y+n.height}))}}},S=N,$=Object(b["a"])(S,D,E,!1,null,null,null),T=$.exports,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return 0!==e.useAvatar?n("button",{staticClass:"conversation-avatar btn action",attrs:{title:e.conversationId}},[1===e.useAvatar||2===e.useAvatar?n("canvas",{ref:"avatarCanvas",staticClass:"avatar-canvas",attrs:{width:"48",height:"48"}}):3===e.useAvatar?n("div",{staticClass:"avatar-html",domProps:{innerHTML:e._s(e.avatarHTML)}}):e._e()]):e._e()},H=[],R=n("5934"),L=n.n(R),U={props:["providerName","conversationId"],data:function(){return{useAvatar:0,avatarHTML:null}},mounted:function(){var e=this.$store.getters["ConversationProviders/provider_"+this.providerName+"/getConversationAvatar"];e&&(e=e(this.conversationId),1===e?(this.useAvatar=1,this.$nextTick((function(){var e=this.$refs.avatarCanvas.getContext("2d");L.a.drawIcon(e,this.conversationId,48)}))):"object"===Object(s["a"])(e)&&e.hasOwnProperty("length")&&(2===e[0]?(this.useAvatar=2,this.$nextTick((function(){var t=this.$refs.avatarCanvas.getContext("2d");t.drawImage(e[1],48,48)}))):3===e[0]&&(this.useAvatar=3,this.$nextTick((function(){this.avatarHTML=e[1]})))))}},Y=U,z=Object(b["a"])(Y,B,H,!1,null,null,null),F=z.exports,K=n("2f62"),W=n("c1df"),V=n.n(W);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G={name:"ConversationListItem",components:{Icon:A,Dropdown:T,ConversationAvatar:F},props:["conversation","active"],data:function(){return{dropdownActive:!1,lastId:null}},computed:J({curdate:function(){return V()().format("MMMM Do, YYYY")},timestamp:function(){if(this.conversation.lastMessage){var e=V()(this.conversation.lastMessage.dateAdded,"x").format("MMMM Do, YYYY");return this.curdate===e?V()(this.conversation.lastMessage.dateAdded,"x").format("HH:mm"):V()(e,"MMMM Do, YYYY").subtract(1,"d").format("MMMM Do, YYYY")===this.curdate?"Yesterday":V()(e,"MMMM Do, YYYY").format("M/D/Y")}return""},getConversationListItemActions:function(){if(!this.conversation)return null;var e=this.$store.getters["ConversationProviders/provider_"+this.conversation.providerName+"/conversationListItemActions"];if(!e)return null;var t=e(this.conversation.id,{commit:this.$store.commit,dispatch:this.$store.dispatch});return t?(t.unshift({name:(this.conversation.name||this.conversation.id)+(this.oneProviderMode?"":" ("+this.conversation.providerName+")"),disabled:!0}),t.push({name:"Close"}),t):null}},Object(K["c"])({oneProviderMode:"ConversationProviders/oneProviderMode"})),methods:J({handleClick:function(){this.active?(this.closeConversationInfo(),this.closeConversation()):this.openConversation([this.conversation.providerName,this.conversation.id])},conversationProviderHasAvatarProvider:function(e){return this.$store.getters["ConversationProviders/provider_"+e+"/getConversationAvatar"]},closeConversationInfo:function(){this.$emit("update:conversationInfoOpen",!1)},dropdownAction:function(e){e.item.keepOpen||e.on(),this.$nextTick((function(){e.item.onclick&&e.item.onclick()}))}},Object(K["b"])(["openConversation","closeConversation","newMsg"])),watch:{"conversation.lastMessage":function(e,t){e&&e.key!==this.lastKey?(this.lastKey=e.key,this.newMsg([this.conversation,e])):e||(this.lastKey=null)}}},X=G,Z=Object(b["a"])(X,w,P,!1,null,null,null),Q=Z.exports,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-list-actions",attrs:{"open-dialog":e.openDialog,"open-dialog-animation":e.openDialogAnimation},on:{click:function(t){return t.target!==t.currentTarget?null:e.setOpenDialog("")}}},[n("transition",{attrs:{name:"dialog"},on:{"before-enter":function(t){e.openDialogAnimation="open"},"before-leave":function(t){e.openDialogAnimation="closing"},"after-leave":function(t){e.openDialogAnimation="closed"}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.openDialog,expression:"openDialog"}],staticClass:"conversation-list-action card shadow"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"conversation-manager"==e.openDialog,expression:"openDialog == 'conversation-manager'"}],staticClass:"conversation-list-action-inner"},[n("ConversationProviderManager")],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"settings"==e.openDialog,expression:"openDialog == 'settings'"}],staticClass:"conversation-list-action-inner"},[n("Settings")],1)])]),n("div",{class:"openers "+(e.scrolledToBottom||e.openDialog?"":"hovering "),attrs:{"left-active":"conversation-manager"==e.openDialog,"right-active":"settings"==e.openDialog}},[n("button",{class:"conversation-manager-btn btn action lg primary "+(e.scrolledToBottom||"conversation-manager"==e.openDialog?"shadow ":"")+" "+("conversation-manager"!=e.openDialog?"rounded ":"")+(""!=e.openDialog&&"conversation-manager"!=e.openDialog?"flat ":""),on:{click:function(t){return e.setOpenDialog("conversation-manager"==e.openDialog?"":"conversation-manager")}}},[n("icon",[e._v("account")])],1),n("button",{class:"settings-btn btn action lg light "+(e.scrolledToBottom||"settings"==e.openDialog?"shadow ":"")+" "+("settings"!=e.openDialog?"rounded ":"")+(""!=e.openDialog&&"settings"!=e.openDialog?"flat ":""),on:{click:function(t){return e.setOpenDialog("settings"==e.openDialog?"":"settings")}}},[n("icon",[e._v("settings")])],1)])],1)},te=[],ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-provider-manager"},[e.oneProviderMode?n("span",{staticClass:"card-title clr-bg bgclr-secondary"},[e._v("ThunderWave X\n\t\t"),n("i",[e._v(e._s(e.getAllConversationProviders[0].name))])]):n("span",{staticClass:"card-title"},[e._v("Conversation provider manager")]),n("div",{staticClass:"conversation-provider-manager-outer"},[n("div",{staticClass:"conversation-provider-manager-inner"},[0==e.usableConversationProviders.length?n("div",[n("h4",[e._v("\n\t\t\t\t\tThere are no conversation providers currently available!\n\t\t\t\t")])]):e.oneProviderMode?e._e():n("div",{staticClass:"provider-selector input-group"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.providerName,expression:"providerName"}],staticClass:"provider-name input",attrs:{title:"provider name"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.providerName=t.target.multiple?n:n[0]}}},e._l(e.usableConversationProviders,(function(t){return n("option",{key:t.name?t.name:"",attrs:{disabled:t.name&&!e.isAvailableProvider(t.name)},domProps:{value:t.name?t.name:""}},[e._v("\n\t\t\t\t\t\t"+e._s(t.name?t.name:"Please select a provider")+"\n\t\t\t\t\t")])})),0)]),e.providerName?n("div",{staticClass:"provider-manager-component-container"},[e.curProviderManagerComponent?n(e.curProviderManagerComponent,{tag:"component"}):e._e()],1):n("div",[n("h4",{staticStyle:{padding:"0 .8rem"}},[e._v("\n\t\t\t\t\tPlease select a conversation provider to start chatting\n\t\t\t\t\t:)\n\t\t\t\t")])])])])])},oe=[];function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ie={name:"ConversationProviderManager",data:function(){return{providerName:""}},mounted:function(){var e=this;this.$nextTick((function(){e.oneProviderMode&&(e.providerName=e.usableConversationProviders[0].name)}))},computed:se({usableConversationProviders:function(){var e=this,t=this.getAllConversationProviders.filter((function(t){return e.providerManagerComponent(t.name)}));return this.oneProviderMode||t.unshift(""),t},curProviderManagerComponent:function(){return this.providerManagerComponent(this.providerName)}},Object(K["c"])({isAvailableProvider:"ConversationProviders/isAvailable",getAllConversationProviders:"ConversationProviders/getAllConversationProviders",oneProviderMode:"ConversationProviders/oneProviderMode"})),methods:{providerManagerComponent:function(e){if(e){var t=this.$store.getters["ConversationProviders/provider_"+e+"/managerComponent"];return t}return null}}},ae=ie,ce=Object(b["a"])(ae,ne,oe,!1,null,null,null),ue=ce.exports,le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"settings"},[n("span",{staticClass:"card-title"},[e._v("Settings")]),n("div",{staticClass:"settings-outer"},[n("div",{staticClass:"settings-inner"},[n("button",{staticClass:"btn link",on:{click:function(t){return e.toggleTheme()}}},[n("icon",[e._v("theme-light-dark")]),n("span",[e._v(" Switch to "+e._s(e.darkmode?"light":"dark")+" theme")])],1),n("h4",[e._v("Plugins")]),n("div",{staticClass:"plugin-selector input-group"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.ipluginName,expression:"ipluginName"}],staticClass:"input",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.ipluginName=t.target.multiple?n:n[0]}}},e._l(e.pluginNames,(function(t){return n("option",{key:t+"_"+(t?e.isPluginInstalled(t):""),domProps:{value:t||""}},[e._v("\n                        "+e._s(t||"Please select a plugin")+" "),t&&e.isPluginInstalled(t)?n("i",[e._v("(installed)")]):e._e()])})),0)]),n("div",{staticClass:"plugin-selector input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.ipluginName,expression:"ipluginName"}],staticClass:"input",attrs:{type:"text",placeholder:"pluginName"},domProps:{value:e.ipluginName},on:{input:function(t){t.target.composing||(e.ipluginName=t.target.value)}}})]),n("div",[n("button",{staticClass:"btn secondary",attrs:{type:"submit",disabled:!e.ipluginName||e.isPluginInstalled(e.ipluginName)},on:{click:e.install}},[e._v("Install plugin")])])])])])},de=[];function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe={name:"Settings",components:{Icon:A},data:function(){return{pluginNames:["","markdown","emojione","tempsaveMsginput","pushNotification"],ipluginName:"",darkmode:document.getElementById("html").classList.contains("darkmode")||!1}},computed:pe({},Object(K["c"])(["isPluginInstalled"])),methods:{install:function(){this.ipluginName&&(this.installPlugin(this.ipluginName),this.ipluginName="")},toggleTheme:function(){document.getElementById("html").classList.toggle("darkmode");var e=document.getElementById("html").classList.contains("darkmode")||!1;this.darkmode=e}}},ge=fe,me=Object(b["a"])(ge,le,de,!1,null,null,null),he=me.exports,be={name:"ConversationListActions",components:{Icon:A,ConversationProviderManager:ue,Settings:he},props:["scrolledToBottom"],data:function(){return{openDialog:"",openDialogAnimation:"closed"}},methods:{setOpenDialog:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.openDialog=e,this.$emit("update:openDialog",this.openDialog)}}},ye=be,Oe=Object(b["a"])(ye,ee,te,!1,null,null,null),Ce=Oe.exports;function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pe=!1,_e={name:"ConversationList",components:{ConversationListItem:Q,ConversationListActions:Ce},data:function(){return{openDialog:"",scrolledToBottom:!1}},mounted:function(){var e=this;this.$el.addEventListener("scroll",(function(){e.scrollUpdater()})),this.$nextTick((function(){e.scrollUpdater()}))},computed:we({},Object(K["c"])({getAllConversations:"ConversationProviders/getAllConversations",getCurConversation:"ConversationProviders/getCurConversation"})),methods:{setOpenDialog:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.openDialog=e,this.$emit("update:openDialog",this.openDialog)},scrollUpdater:function(){var e=this,t=this.$el.scrollTop;Pe||(window.requestAnimationFrame((function(){t>=e.$el.scrollHeight-e.$el.clientHeight-25?e.scrolledToBottom=!0:e.scrolledToBottom=!1,Pe=!1})),Pe=!0)},updateConversationInfoOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$emit("update:conversationInfoOpen",!!e)}}},ke=_e,Ie=Object(b["a"])(ke,C,j,!1,null,null,null),xe=Ie.exports,Me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-navbar navbar card"},[n("div",{staticClass:"navbar-section solo-navbar-section"},[n("button",{staticClass:"backbtn btn action link lg primary",on:{click:function(t){return e.closeConversationAndConversationInfo()}}},[n("icon",[e._v("arrow-left")])],1),n("div",{staticClass:"conversation-avatar-container"},[e.avatarVisible?n("ConversationAvatar",{key:e.getCurConversation.id?"conversation_"+e.getCurConversation.providerName+"_"+e.getCurConversation.id:"conversation_"+e.getCurConversation.providerName,staticClass:"flat rounded shadow lg",attrs:{providerName:e.getCurConversation.providerName,conversationId:e.getCurConversation.id}}):e._e()],1),n("div",{staticClass:"conversation-short-info input-group inline",attrs:{"avatar-visible":e.avatarVisible}},[n("button",{staticClass:"conversation-name btn flat rounded",attrs:{readonly:"true"},on:{click:function(t){return e.openConversationInfo()}}},[e._v("\n\t\t\t\t"+e._s(e.getCurConversation.name)+"\n\t\t\t")])])])])},Ae=[];function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ne={name:"ConversationNavbar",components:{Icon:A,ConversationAvatar:F},data:function(){return{}},computed:Ee({avatarVisible:function(){return this.getCurConversation.id&&this.conversationProviderHasAvatarProvider(this.getCurConversation.providerName)}},Object(K["c"])({getCurConversation:"ConversationProviders/getCurConversation"})),methods:Ee({conversationProviderHasAvatarProvider:function(e){return this.$store.getters["ConversationProviders/provider_"+e+"/getConversationAvatar"]},openConversationInfo:function(){this.$emit("update:conversationInfoOpen",!0)},closeConversationInfo:function(){this.$emit("update:conversationInfoOpen",!1)},closeConversationAndConversationInfo:function(){this.closeConversationInfo(),this.closeConversation()}},Object(K["b"])(["closeConversation"]))},Se=Ne,$e=Object(b["a"])(Se,Me,Ae,!1,null,null,null),Te=$e.exports,Be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation"},[n("ConversationHistory",{on:{"update:scrolledToBottom":function(t){return e.updateHistoryScrolledToBottom(t)}}}),e.historyScrolledToBottom&&e.curTyping.length>0?n("div",{staticClass:"typing-indicator"},[n("div",{staticClass:"typing-avatars"},e._l(e.curTyping,(function(t){return n("UserAvatar",{key:t.userId,staticClass:"rounded flat",attrs:{providerName:e.curConversation.providerName,userId:t.userId}})})),1),n("span",{staticClass:"typing-ids"},[e._l(e.curTypingShortened,(function(t,o){return n("span",{key:"string"===typeof t?t:t.userId,staticClass:"typer-id"},[n("span","string"===typeof t?[e._v(e._s(t)+" more")]:[e._v("\n\t\t\t\t\t"+e._s(t.hasOwnProperty("userName")?t.userName:t.userId)+e._s(e.curTyping.length>1&&o===e.curTyping.length-2?" and ":o!==e.curTyping.length-1?", ":"")+"\n\t\t\t\t")])])})),n("i",[e._v(" "+e._s(1===e.curTyping.length?"is":"are")+" typing\n\t\t\t\t...")])],2)]):e._e(),n("Actionbar",{attrs:{historyScrolledToBottom:e.historyScrolledToBottom}})],1)},He=[],Re=(n("6b54"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"ConversationHistory",staticClass:"conversation-history",attrs:{"infinite-wrapper":""}},[n("infinite-loading",{attrs:{direction:"top",spinner:"waveDots",forceUseInfiniteWrapper:!0,distance:50},on:{infinite:e.infiniteHandler}},[n("span",{attrs:{slot:"no-results"},slot:"no-results"},[e._v("Error while loading data :/")]),n("span",{attrs:{slot:"no-more"},slot:"no-more"},[e._v("You've reached the very top :o")])]),n("div",{staticClass:"sticky-date-separator divider text-center",attrs:{visible:e.showStickyDateSeparator,"data-content":e.stickyDateSeparator}}),e._l(e.loadedMessages,(function(t,o){return n("div",{key:"message_"+t.key,class:"message-container "+(e.isNewDay(o)?"isnewday ":"")+(e.isFollowUp(o)?"isfollowup ":"")+(e.isFollowUp(o+1)?"":"isfollowlast ")+(e.isOwn(o)?"isown ":""),attrs:{"date-added":t.dateAdded,"message-key":t.key}},[e.isNewDay(o)?n("div",{staticClass:"date-separator divider text-center",attrs:{"data-content":e.dateSeparator(t.dateAdded)}}):e._e(),n("div",{staticClass:"user-avatar_message"},[e.isFollowUp(o+1)?e._e():n("div",{staticClass:"user-avatar-action-dropdown"},[n("UserAvatar",{staticClass:"rounded",attrs:{providerName:t.providerName,userId:t.userId,userName:t.userName}})],1),n("Message",{attrs:{message:t,isFollowUp:e.isFollowUp(o),isOwn:e.isOwn(o)}})],1)])})),n("br"),n("button",{staticClass:"scroll2bottom-btn btn lg action rounded shadow secondary",attrs:{"scrolled-to-bottom":e.scrolledToBottom},on:{click:function(t){return e.scrollToBottom()}}},[n("icon",[e._v("arrow-down")])],1)],2)}),Le=[],Ue=(n("20d6"),n("75fc")),Ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:"message card "+(e.dropdownActive?"":"hovershadow ")+(e.isOwn?"secondary2 ":"")+(e.bodyRendered?"rendered":""),on:{contextmenu:function(t){if(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)return null;t.preventDefault(),e.dropdownActive=!0}}},[n("div",{staticClass:"username_message-action",on:{contextmenu:function(e){if(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)return null;e.stopPropagation()}}},[e.isFollowUp?e._e():n("button",{staticClass:"username text-break btn link sm secondary"},[n("span",[e._v(e._s(e.message.userName||e.message.userId))]),n("span",{staticClass:"invisible-text"},[e._v(": ")])]),e.getMessageActions?n("Dropdown",{staticClass:"message-action-dropdown",attrs:{items:e.getMessageActions,align:e.isOwn?"right":"left",active:e.dropdownActive},on:{"update:active":function(t){e.dropdownActive=t}},scopedSlots:e._u([{key:"activator",fn:function(t){return[n("button",{class:"message-action-btn btn action link sm "+(t.active?"active ":""),on:{click:function(e){return e.stopPropagation(),t.on()},contextmenu:function(e){return e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:(e.preventDefault(),e.stopPropagation(),t.on())}}},[n("icon",[e._v("dots-vertical")])],1)]}},{key:"item",fn:function(t){return[n("button",{class:"message-action-dropdown-menu-li btn "+(t.item.classes||"link"),attrs:{disabled:t.item.disabled},on:{click:function(n){return n.stopPropagation(),e.dropdownAction(t)}}},[e._v("\n\t\t\t\t\t"+e._s("function"===typeof t.item.name?t.item.name():t.item.name)+"\n\t\t\t\t")])]}}],null,!1,4275394175)}):e._e()],1),n("div",{staticClass:"body text-break",domProps:{innerHTML:e._s(e.rmsgbody)},on:{contextmenu:function(e){if(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)return null;e.stopPropagation()}}}),n("div",{staticClass:"timestamp-container",on:{contextmenu:function(e){if(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)return null;e.stopPropagation()}}},[n("button",{staticClass:"timestamp btn link sm"},[n("span",{staticClass:"invisible-text"},[e._v(" "+e._s(e.moment(e.message.dateAdded,"x").format("M/D/Y"))+" - ")]),n("span",[e._v(e._s(e.moment(e.message.dateAdded,"x").format("HH:mm:ss")))])])])])},ze=[];n("a481");function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var We=function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,(function(e){return t[e]}))},Ve={name:"Message",components:{Icon:A,Dropdown:T},props:["message","isFollowUp","isOwn"],data:function(){return{rmsgbody:"",dropdownActive:!1,bodyRendered:!1}},mounted:function(){this.renderMsg()},computed:Ke({getMessageActions:function(){if(!this.message)return null;var e=this.$store.getters["ConversationProviders/provider_"+this.message.providerName+"/messageActions"];if(!e)return null;var t=e(this.message,{commit:this.$store.commit,dispatch:this.$store.dispatch});return t?(t.push({name:"Close"}),t):null}},Object(K["c"])(["renderMsgBody","pluginFunctionalityRenderMsgBody"])),methods:{moment:V.a,renderMsg:function(){var e=this;this.rmsgbody=We(decodeURIComponent(this.message.body)),this.renderMsgBody(this.message)().then((function(t){e.rmsgbody!==t&&(e.bodyRendered=!0),e.rmsgbody=t}))},dropdownAction:function(e){e.item.keepOpen||e.on(),this.$nextTick((function(){e.item.onclick&&e.item.onclick()}))}},watch:{pluginFunctionalityRenderMsgBody:function(e,t){JSON.stringify(e)!==JSON.stringify(t)&&this.renderMsg()}}},qe=Ve,Je=(n("1d87"),Object(b["a"])(qe,Ye,ze,!1,null,"029235a4",null)),Ge=Je.exports,Xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return 0!==e.useAvatar?n("button",{staticClass:"user-avatar btn action",attrs:{title:e.userName||e.userId},on:{click:function(t){return e.$emit("click",t)},contextmenu:function(t){return e.$emit("contextmenu",t)}}},[1===e.useAvatar||2===e.useAvatar?n("canvas",{ref:"avatarCanvas",staticClass:"avatar-canvas",attrs:{width:"48",height:"48"}}):3===e.useAvatar?n("div",{staticClass:"avatar-html",domProps:{innerHTML:e._s(e.avatarHTML)}}):e._e()]):e._e()},Ze=[],Qe={props:["providerName","userId","userName"],data:function(){return{useAvatar:0,avatarHTML:null}},mounted:function(){var e=this.$store.getters["ConversationProviders/provider_"+this.providerName+"/getUserAvatar"];e&&(e=e(this.userId),1===e?(this.useAvatar=1,this.$nextTick((function(){var e=this.$refs.avatarCanvas.getContext("2d");L.a.drawIcon(e,this.userId,48)}))):"object"===Object(s["a"])(e)&&e.hasOwnProperty("length")&&(2===e[0]?(this.useAvatar=2,this.$nextTick((function(){var t=this.$refs.avatarCanvas.getContext("2d");t.drawImage(e[1],48,48)}))):3===e[0]&&(this.useAvatar=3,this.$nextTick((function(){this.avatarHTML=e[1]})))))}},et=Qe,tt=Object(b["a"])(et,Xe,Ze,!1,null,null,null),nt=tt.exports,ot=n("e166"),rt=n.n(ot);function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var at=!1,ct=null,ut={name:"ConversationHistory",components:{Icon:A,Message:Ge,UserAvatar:nt,InfiniteLoading:rt.a},data:function(){return{loadedMsgNr:0,loadedMessages:[],stickyDateSeparator:"",showStickyDateSeparator:!1,scrolledToBottom:!0}},mounted:function(){var e=this;this.loadMsgs(25,(function(){e.$nextTick((function(){e.$refs.ConversationHistory.scrollTop=e.$refs.ConversationHistory.scrollHeight}))})),this.$el.addEventListener("scroll",(function(){e.scrollUpdater()})),this.$nextTick((function(){e.scrollUpdater()}))},computed:it({curdate:function(){return V()().format("MMMM Do, YYYY")}},Object(K["c"])(["curConversation"]),{},Object(K["c"])({getCurConversationMessages:"ConversationProviders/getCurConversationMessages",getCurConversationUser:"ConversationProviders/getCurConversationUser"})),methods:{infiniteHandler:function(e){var t=this;this.$store.dispatch("ConversationProviders/provider_"+this.curConversation.providerName+"/fetchMessages",this.curConversation.conversationId).then((function(n){var o,r=n.conversationId,i=n.totalPages,a=n.page,c=n.slice;(console.debug("fetchMessages",r,i,a,c),"object"===Object(s["a"])(c)&&c.hasOwnProperty("length")&&c.length>0)?((o=t.loadedMessages).unshift.apply(o,Object(Ue["a"])(c)),0===a?(console.debug("infiniteHandler: complete"),e.complete()):a>0&&(console.debug("infiniteHandler: loaded"),e.loaded())):t.loadMsgs(10,(function(t,n){console.debug("loadMsgs",t,n),t?(console.debug("infiniteHandler: error"),e.error()):0===n?(console.debug("infiniteHandler: loaded"),e.loaded()):1===n?(console.debug("infiniteHandler: complete"),e.complete()):(console.debug("infiniteHandler: error 2"),e.error())}))})).catch((function(){console.debug("infiniteHandler: error"),e.error()}))},scrollUpdater:function(){var e=this,t=this.$el,n=t.scrollTop;ct&&clearTimeout(ct),at||(window.requestAnimationFrame((function(){n>=t.scrollHeight-t.clientHeight-128?e.scrolledToBottom=!0:e.scrolledToBottom=!1;var o=0,r=t.getElementsByClassName("message-container isnewday");e.stickyDateSeparator="",e.showStickyDateSeparator=!0;for(var s=0;s<r.length;s++){var i=r[s],a=i.offsetTop-34-n,c=n>=a,u=a>=o,l=a<=0;c&&(u||0===o)&&l&&(o=a,e.stickyDateSeparator=e.dateSeparator(i.getAttribute("date-added")))}at=!1,ct=setTimeout((function(){e.stickyDateSeparator="",e.showStickyDateSeparator=!1}),2500)})),at=!0)},loadMsgs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1?arguments[1]:void 0,n=this.getCurConversationMessages;if(this.loadedMsgNr<n.length){var o,r=0,s=[];while(this.loadedMsgNr<n.length&&r<e){var i=n[this.loadedMsgNr];s.unshift(i),r++,this.loadedMsgNr++}this.loadedMessages=this.loadedMessages.filter((function(e){return-1!==n.findIndex((function(t){return e.key===t.key}))})),(o=this.loadedMessages).unshift.apply(o,s),console.debug("loaded",r,"messages (total loaded",this.loadedMsgNr,"/",n.length,")",s),this.loadedMsgNr>=n.length?"function"===typeof t&&t(null,1):"function"===typeof t&&t(null,0,s)}else"function"===typeof t&&t(null,1)},dateSeparator:function(e){return V()(e,"x").format("MMMM Do, YYYY")===this.curdate?"Today":V()(this.curdate,"MMMM Do, YYYY").subtract(1,"d").format("MMMM Do, YYYY")===V()(e,"x").format("MMMM Do, YYYY")?"Yesterday":V()(e,"x").format("MMMM Do, YYYY")},isFollowUp:function(e){if(e<=0||e>this.loadedMessages.length-1)return!1;var t=this.loadedMessages[e-1],n=this.loadedMessages[e];return n.userId===t.userId&&V()(t.dateAdded,"x").add(15,"minutes").isSameOrAfter(V()(n.dateAdded,"x"))},isNewDay:function(e){if(e<=0)return!0;var t=this.loadedMessages[e-1],n=this.loadedMessages[e];return!V()(t.dateAdded,"x").isSame(V()(n.dateAdded,"x"),"day")},isOwn:function(e){var t=this.loadedMessages[e];return t.userId==this.getCurConversationUser.userId},scrollToBottom:function(){var e=this.$el;e.scroll({top:e.scrollHeight,behavior:"smooth"})}},watch:{getCurConversationMessages:function(e,t){var n;if(t.length>0&&e.length>0&&e[0].key===t[0].key)return!1;var o=this.$el,r=o.scrollTop,s=o.scrollHeight,i=o.clientHeight,a=e.length-t.length,c=0,u=[];while(c<a){var l=e[c];u.unshift(l),c++,this.loadedMsgNr++}this.loadedMessages=this.loadedMessages.filter((function(t){return-1!==e.findIndex((function(e){return t.key===e.key}))})),(n=this.loadedMessages).push.apply(n,u),console.debug("n-loaded",c,"messages (total loaded",this.loadedMsgNr,"/",e.length,")",u),this.$nextTick((function(){r>=s-i-128&&o.scroll({top:o.scrollHeight,behavior:"smooth"})}))},scrolledToBottom:function(e){this.$emit("update:scrolledToBottom",e)}}},lt=ut,dt=Object(b["a"])(lt,Re,Le,!1,null,null,null),vt=dt.exports,pt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"actionbar card",style:e.resourceExtsOpen?"height: 100%; ":e.inputExtsOpen?"height: auto; ":"height: "+e.actionbarInnerHeight+"px; ",attrs:{"exts-open":e.resourceExtsOpen,"history-scrolled-to-bottom":e.historyScrolledToBottom}},[n("transition",{attrs:{name:"exts-open"}},[n("div",{class:"exts-container "+(e.resourceExtsOpen||e.inputExtsOpen?"hardshadow":""),style:e.resourceExtsOpen?"height: calc(100% - "+e.actionbarInnerHeight+"px); ":e.inputExtsOpen?"height: auto; ":"height: 0; "},[n("ResourceExtUI",{directives:[{name:"show",rawName:"v-show",value:e.resourceExtsOpen,expression:"resourceExtsOpen"}],on:{"update:addSnippet":function(t){return e.updateAddSnippet(t)}}}),n("InputExtUI",{directives:[{name:"show",rawName:"v-show",value:e.inputExtsOpen,expression:"inputExtsOpen"}],staticClass:"shadow",attrs:{msgBody:e.msgBodyC,selectionStart:e.selectionStart,selectionEnd:e.selectionEnd,selection:e.selection},on:{"update:msgBody":function(t){return e.updateMsgBody(t)},"update:addSnippet":function(t){return e.updateAddSnippet(t)},"update:active":function(t){return e.updateInputExtsOpen(t)}}})],1)]),n("div",{ref:"actionbarInner",staticClass:"actionbar-inner input-group",style:"height: "+e.actionbarInnerHeight+"px; "},[n("button",{staticClass:"toggle-resource-exts-btn btn action lg shadow secondary",on:{click:function(t){return e.toggleResourceExts()}}},[n("icon",[e._v("dots-vertical")])],1),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.msgBody,expression:"msgBody"}],ref:"msginput",staticClass:"msginput input",attrs:{rows:e.rows,"max-rows":e.maxRows,placeholder:"Write a message"},domProps:{value:e.msgBody},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.send(t))},input:function(t){t.target.composing||(e.msgBody=t.target.value)}}}),n("button",e._b({staticClass:"sendbtn btn action lg shadow primary",on:{click:function(t){return e.send()}}},"button",e.sendBtnBinds,!1),[n("icon",[e._v("send")])],1),n("span",{ref:"msgBodyHeightTest",staticClass:"msginput input",staticStyle:{visibility:"hidden",position:"absolute","pointer-events":"none",width:"calc(100% - 6.4rem - .8rem + 2px)",left:"3.2rem",overflow:"hidden"}})])],1)},ft=[],gt=(n("28a5"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"resource-ext-ui"},e._l(e.resourceExtComponents(),(function(t){return n(t.component,{key:t.pluginName+"-"+t.componentName,tag:"component",on:{"update:addSnippet":function(t){return e.updateAddSnippet(t)}}})})),1)}),mt=[];function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yt={name:"ResourceExtUI",computed:bt({},Object(K["c"])(["resourceExtComponents"])),methods:{updateAddSnippet:function(e){this.$emit("update:addSnippet",e)}}},Ot=yt,Ct=Object(b["a"])(Ot,gt,mt,!1,null,null,null),jt=Ct.exports,wt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"input-ext-ui"},e._l(e.extendedInputExtComponents,(function(t,o){return n(t.component,{key:t.pluginName+"-"+t.componentName,tag:"component",attrs:{msgBody:e.msgBodyC,selectionStart:e.selectionStart,selectionEnd:e.selectionEnd,selection:e.selection},on:{"update:msgBody":function(t){return e.updateMsgBody(t)},"update:addSnippet":function(t){return e.updateAddSnippet(t)},"update:active":function(t){return e.updateActive(o,t)}}})})),1)},Pt=[];function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var It={name:"InputExtUI",props:{msgBody:{type:String,default:""},selectionStart:Number,selectionEnd:Number,selection:{type:String,default:""}},data:function(){return{activeComponents:[]}},computed:kt({msgBodyC:function(){return this.msgBody},extendedInputExtComponents:function(){var e=this.inputExtComponents();this.activeComponents=[];for(var t=0;t<e.length;t++)this.activeComponents.push(!1);return e},anyActiveComponent:function(){for(var e=!1,t=0;t<this.activeComponents.length;t++)if(this.activeComponents[t]){e=!0;break}return e}},Object(K["c"])(["inputExtComponents"])),methods:{updateMsgBody:function(e){this.$emit("update:msgBody",e)},updateAddSnippet:function(e){this.$emit("update:addSnippet",e)},updateActive:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.activeComponents[e]=!!t,this.$emit("update:active",!!t||this.anyActiveComponent)}}},xt=It,Mt=Object(b["a"])(xt,wt,Pt,!1,null,null,null),At=Mt.exports;function Dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dt(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nt(e,t,n){return e>n?n:e<t?t:e}var St=!1,$t=function e(t){St&&window.requestAnimationFrame((function(){t.selectionStart=t.$refs.msginput.selectionStart>=0?t.$refs.msginput.selectionStart:t.msgBody.length,t.selectionEnd=t.$refs.msginput.selectionEnd>=0?t.$refs.msginput.selectionEnd:t.msgBody.length,setTimeout((function(){e(t)}),400)}))},Tt=null,Bt={name:"Actionbar",components:{Icon:A,ResourceExtUI:jt,InputExtUI:At},props:["historyScrolledToBottom"],data:function(){return{selectionStart:0,selectionEnd:0,msgBody:"",rows:1,maxRows:10,resourceExtsOpen:!1,inputExtsOpen:!1,actionbarInnerHeight:0}},mounted:function(){var e=this;this.$nextTick((function(){e.selectionStart=e.$refs.msginput.selectionStart>=0?e.$refs.msginput.selectionStart:e.msgBody.length,e.selectionEnd=e.$refs.msginput.selectionEnd>=0?e.$refs.msginput.selectionEnd:e.msgBody.length,e.$refs.msginput.addEventListener("focus",(function(t){St||(St=!0,$t(e))})),e.$refs.msginput.addEventListener("blur",(function(t){e.selectionStart=t.target.selectionStart>=0?t.target.selectionStart:e.msgBody.length,e.selectionEnd=t.target.selectionEnd>=0?t.target.selectionEnd:e.msgBody.length,St=!1}))}))},computed:Et({msgBodyC:function(){return this.msgBody},selection:function(){var e=this.selectionStart,t=this.selectionEnd;if(e>t){var n=t;t=e,e=n}return this.msgBody.substring(e,t)},sendBtnBinds:function(){var e={};return this.validateMessage(this.msgBody)||(e.disabled="true"),e}},Object(K["c"])({validateMessage:"ConversationProviders/validateMessage"})),methods:Et({updateMsgBody:function(e){this.msgBody=e},updateAddSnippet:function(e){var t=this.selectionStart,n=this.selectionEnd;if(t>n){var o=n;n=t,t=o}var r=this.msgBody.substring(0,t),s=this.msgBody.substring(n,this.msgBody.length);this.msgBody=r+e+s,this.$refs.msginput.selectionStart=r+e.length,this.$refs.msginput.selectionEnd=r+e.length,this.selectionStart=r+e.length,this.selectionEnd=r+e.length},updateInputExtsOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.inputExtsOpen=e},send:function(){var e=this;this.sendMessage2Cur(this.msgBody).then((function(t){t&&e.$nextTick((function(){e.msgBody="",e.updateTyping(!1)}))})).catch((function(e){console.error(e)}))},toggleResourceExts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.resourceExtsOpen;this.resourceExtsOpen=!!e},toggleInputExts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.inputExtsOpen;this.inputExtsOpen=!!e},setActionbarInnerHeight:function(){var e=this,t=this.msgBody.split("\n").length;this.rows=Nt(t,1,this.maxRows);for(var n=document.createElement("span"),o=this.msgBody.split("\n"),r=0;r<o.length;r++){var s=o[r],i=document.createElement("span");i.innerText=s,n.appendChild(i),n.appendChild(document.createElement("br"))}this.$refs.msgBodyHeightTest.innerHTML="",this.$refs.msgBodyHeightTest.appendChild(n),this.$nextTick((function(){var t=e.$refs.msgBodyHeightTest.offsetHeight;e.$refs.msginput.style.height="calc("+t+"px - 2 * .225rem)",e.actionbarInnerHeight=t}))}},Object(K["b"])({sendMessage2Cur:"ConversationProviders/sendMessage2Cur",updateTyping:"ConversationProviders/updateTyping"})),watch:{msgBody:function(){var e=this;this.setActionbarInnerHeight(),this.toggleInputExts(this.msgBody.trim()&&this.$children[1].anyActiveComponent),this.msgBody.trim()&&(clearTimeout(Tt),this.updateTyping(!0)),Tt=setTimeout((function(){e.updateTyping(!1)}),2500)}}},Ht=Bt,Rt=Object(b["a"])(Ht,pt,ft,!1,null,null,null),Lt=Rt.exports;function Ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ut(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ut(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zt={name:"Conversation",components:{ConversationHistory:vt,UserAvatar:nt,Actionbar:Lt},data:function(){return{historyScrolledToBottom:!0}},computed:Yt({curTyping:function(){var e=this.$store.getters["ConversationProviders/provider_"+this.curConversation.providerName+"/getCurTyping"];if(e){var t=e(this.curConversation.conversationId);if(t&&"object"===Object(s["a"])(t)&&t.hasOwnProperty("length")&&"number"===typeof t.length&&t.length>0){t=JSON.parse(JSON.stringify(t));for(var n=0;n<t.length;n++){var o=t[n];if(o.userId===this.getCurConversationUser.userId){t.splice(n,1);break}}return t}}return[]},curTypingShortened:function(){var e=this.curTyping.slice(0,5);return this.curTyping.length>5&&e.push((this.curTyping.length-5).toString()),e}},Object(K["c"])({curConversation:"curConversation",getCurConversationUser:"ConversationProviders/getCurConversationUser"})),methods:{updateHistoryScrolledToBottom:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.historyScrolledToBottom=!!e}}},Ft=zt,Kt=Object(b["a"])(Ft,Be,He,!1,null,null,null),Wt=Kt.exports,Vt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-info-navbar navbar card"},[n("div",{staticClass:"navbar-section solo-navbar-section"},[n("button",{staticClass:"closebtn btn action link lg",on:{click:function(t){return e.closeConversationInfo()}}},[n("icon",[e._v("close")])],1)])])},qt=[],Jt={name:"ConversationInfoNavbar",components:{Icon:A},data:function(){return{}},methods:{closeConversationInfo:function(){this.$emit("update:conversationInfoOpen",!1)}}},Gt=Jt,Xt=Object(b["a"])(Gt,Vt,qt,!1,null,null,null),Zt=Xt.exports,Qt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-info"},[n("div",{staticClass:"conversation-avatar-container"},[e.conversationProviderHasAvatarProvider(e.getCurConversation.providerName)?n("ConversationAvatar",{key:e.getCurConversation.id?"conversation_"+e.getCurConversation.providerName+"_"+e.getCurConversation.id:"conversation_"+e.getCurConversation.providerName,staticClass:"rounded lg",attrs:{providerName:e.getCurConversation.providerName,conversationId:e.getCurConversation.id}}):e._e()],1),n("div",{staticClass:"conversation-info-inner"},[n("div",{staticClass:"conversation-name-container input-group"},[n("input",{staticClass:"conversation-name input rounded lg hardshadow",attrs:{readonly:"true"},domProps:{value:e.getCurConversation.name}})]),e.oneProviderMode?e._e():n("div",{staticClass:"card"},[n("b",{staticClass:"clr-secondary",staticStyle:{margin:"0"}},[e._v("Provider")]),n("p",{staticStyle:{"margin-bottom":"0"}},[e._v("\n\t\t\t\t"+e._s(e.getCurConversation.providerName)+"\n\t\t\t")])])]),e.curConversationInfoComponent?[n("hr"),n("div",{staticClass:"conversation-info-component-container"},[n(e.curConversationInfoComponent,{tag:"component"})],1)]:e._e()],2)},en=[];function tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tn(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var on={name:"ConversationInfo",components:{ConversationAvatar:F},data:function(){return{curConversationInfoComponent:null}},mounted:function(){var e=this;this.$nextTick((function(){e.curConversationInfoComponent=e.conversationInfoComponent(e.getCurConversation.providerName,e.getCurConversation.id)}))},computed:nn({},Object(K["c"])({getCurConversation:"ConversationProviders/getCurConversation",oneProviderMode:"ConversationProviders/oneProviderMode"})),methods:{conversationProviderHasAvatarProvider:function(e){return this.$store.getters["ConversationProviders/provider_"+e+"/getConversationAvatar"]},conversationInfoComponent:function(e,t){if(e&&t){var n=this.$store.getters["ConversationProviders/provider_"+e+"/conversationInfoComponent"];if(n&&"function"===typeof n)return n(t)}return null}}},rn=on,sn=Object(b["a"])(rn,Qt,en,!1,null,null,null),an=sn.exports;function cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cn(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ln={name:"ViewConversation",components:{ConversationListNavbar:O,ConversationList:xe,ConversationNavbar:Te,Conversation:Wt,ConversationInfoNavbar:Zt,ConversationInfo:an,ConversationProviderManager:ue},data:function(){return{conversationInfoOpen:!1}},computed:un({isInConversation:function(){return!!this.getCurConversation},anyProviderAvailable:function(){for(var e=[],t=0;t<this.getAllConversationProviders.length;t++){var n=this.getAllConversationProviders[t];if(this.isAvailable(n.name)){e.push(n);break}}return e},anyProviderReady:function(){for(var e=[],t=0;t<this.getAllConversationProviders.length;t++){var n=this.getAllConversationProviders[t];if(this.isReady(n.name)){e.push(n);break}}return e}},Object(K["c"])({getCurConversation:"ConversationProviders/getCurConversation",getAllConversationProviders:"ConversationProviders/getAllConversationProviders",oneProviderMode:"ConversationProviders/oneProviderMode",isAvailable:"ConversationProviders/isAvailable",isReady:"ConversationProviders/isReady"})),methods:{toggleConversationInfoOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.conversationInfoOpen=!!e}}},dn=ln,vn=Object(b["a"])(dn,v,p,!1,null,null,null),pn=vn.exports;function fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fn(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mn={name:"Viewpage",components:{Conversation:pn},computed:gn({},Object(K["c"])(["curView"]))},hn=mn,bn=Object(b["a"])(hn,l,d,!1,null,null,null),yn=bn.exports;function On(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Cn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?On(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):On(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var jn={name:"app",components:{Viewpage:yn},mounted:function(){this.$root.$app=this;for(var e=0;e<this.$store.state.loadDefaultProviders.length;e++){var t=this.$store.state.loadDefaultProviders[e];console.debug("loading provider",t);var o=n("f387")("./"+t).default;this.$store.registerModule(["ConversationProviders","provider_"+t],o),this.$store.dispatch("ConversationProviders/addConversationProvider",t)}for(var r=0;r<this.$store.state.loadDefaultPlugins.length;r++){var s=this.$store.state.loadDefaultPlugins[r];this.installPlugin(s)}},methods:Cn({},Object(K["b"])(["openConversation"]))},wn=jn,Pn=(n("5c0b"),Object(b["a"])(wn,a,c,!1,null,null,null)),_n=Pn.exports,kn=(n("96cf"),n("3b8d")),In=n("c64e"),xn=n.n(In),Mn=function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,(function(e){return t[e]}))},An=function(e){var t=e.views,n=e.curViewId;return t[n]},Dn=function(e){var t=e.ConversationProviders;return t.curConversation},En=function(e){var t=e.plugins;return function(e){return t.hasOwnProperty(e)}},Nn=function(e,t){var n=e.plugins;return function(e){return t.isPluginInstalled(e)&&n[e].ready}},Sn=function(e,t){var n=e.plugins;return function(e){var o=[];for(var r in n){var s=n[r];t.isPluginReady(r)&&-1!==s.functionalities.indexOf(e)&&o.push(r)}return o}},$n=function(e,t){return t.pluginFunctionality("renderMsgBody")},Tn=function(e,t){var n=e.plugins;return function(e){var o=t.pluginFunctionalityRenderMsgBody;return(Object(kn["a"])(regeneratorRuntime.mark((function t(){var r,s,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=decodeURIComponent(e.body),s=!1,i=regeneratorRuntime.mark((function t(i){var a,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=o[i],c=n[a],t.next=4,new Promise((function(t,n){var o=xn()();c.promise.addOnceId(o,(function(e){e.hasOwnProperty("renderMsgBody")&&t(e.renderMsgBody)})),c.worker.postMessage({renderMsgBody:{msgbody:r,msg:e},resolveId:o})}));case 4:u=t.sent,u!==r&&(s=!0),r=u;case 7:case"end":return t.stop()}}),t)})),a=0;case 4:if(!(a<o.length)){t.next=9;break}return t.delegateYield(i(a),"t0",6);case 6:a++,t.next=4;break;case 9:return s||(r=Mn(r)),t.abrupt("return",r);case 11:case"end":return t.stop()}}),t)}))))}},Bn=function(e,t){var n=e.plugins;return function(){var e=[];for(var o in n){var r=n[o];if(t.isPluginReady(o)&&r.hasOwnProperty("resourceExts"))for(var s=0;s<r.resourceExts.length;s++){var i=r.resourceExts[s];e.push({pluginName:o,componentName:i.name,component:i.component})}}return e}},Hn=function(e,t){var n=e.plugins;return function(){var e=[];for(var o in n){var r=n[o];if(t.isPluginReady(o)&&r.hasOwnProperty("inputExts"))for(var s=0;s<r.inputExts.length;s++){var i=r.inputExts[s];e.push({pluginName:o,componentName:i.name,component:i.component})}}return e}},Rn=n("768b"),Ln=function(){var e=null;return"undefined"!==typeof document.hidden?e="hidden":"undefined"!==typeof document.msHidden?e="msHidden":"undefined"!==typeof document.webkitHidden&&(e="webkitHidden"),e||console.warn("A feature which depends on the Page Visibility API can not be used due to the lack of it's support in this browser."),null!==e&&document[e]},Un=function(e,t){var n=e.commit,o=Object(Rn["a"])(t,2),r=o[0],s=o[1];n("changeView","Conversation"),n("ConversationProviders/changeConversation",[r,s])},Yn=function(e){var t=e.commit;t("ConversationProviders/changeConversation",[null,null])},zn=function(e,t){var n=e.state,o=e.getters,r=Object(Rn["a"])(t,2),s=r[0],i=r[1],a=o.pluginFunctionality("newMsg"),c=JSON.parse(JSON.stringify(s));delete c.messagekeys;for(var u=o["ConversationProviders/getConversationProviderUser"](s.providerName),l=0;l<a.length;l++){var d=a[l],v=n.plugins[d];v.worker.postMessage({newMsg:{curUser:u,conversation:c,msg:i}})}},Fn=function(e,t){e.state;var n=Object(Rn["a"])(t,2),o=n[0],r=n[1];console.log("displayNotification action",o,r);var s=function(){if(!r.title||!r.showAlways&&!Ln())return null;var e=Object.assign({},r.options);return new Notification(r.title,e)};"undefined"===typeof Notification?console.warn("This browser does not support notifications"):"granted"===Notification.permission?s():"denied"!==Notification.permission&&Notification.requestPermission().then((function(e){"granted"===e&&s()}))};function Kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kn(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Vn={changeView:function(e,t){qn(e,e.views.indexOf(t))},changeViewId:function(e,t){qn(e,t)},registerPlugin:function(e,t){var n=Object(Rn["a"])(t,3),o=n[0],r=n[1],s=n[2];o&&(e.plugins.hasOwnProperty(o)||(e.plugins=Wn({},e.plugins,Object(u["a"])({},o,{worker:r,promise:s,functionalities:[],ready:!1})),console.log("registered plugin with name",o,r)))},pluginPromise_addOn:function(e,t){var n=Object(Rn["a"])(t,3),o=n[0],r=n[1],s=n[2];o&&e.plugins.hasOwnProperty(o)&&e.plugins[o].promise.on.hasOwnProperty(r)&&(e.plugins[o].promise.on[r].push(s),e.plugins=Wn({},e.plugins))},pluginPromise_removeOn:function(e,t){var n=Object(Rn["a"])(t,3),o=n[0],r=n[1],s=n[2];o&&e.plugins.hasOwnProperty(o)&&e.plugins[o].promise.on.hasOwnProperty(r)&&(e.plugins[o].promise.on[r].splice(e.plugins[o].promise.on[r].indexOf(s),1),e.plugins=Wn({},e.plugins))},pluginPromise_addOnce:function(e,t){var n=Object(Rn["a"])(t,3),o=n[0],r=n[1],s=n[2];o&&e.plugins.hasOwnProperty(o)&&e.plugins[o].promise.once.hasOwnProperty(r)&&(e.plugins[o].promise.once[r].push(s),e.plugins=Wn({},e.plugins))},pluginPromise_removeOnce:function(e,t){var n=Object(Rn["a"])(t,3),o=n[0],r=n[1],s=n[2];o&&e.plugins.hasOwnProperty(o)&&e.plugins[o].promise.once.hasOwnProperty(r)&&(e.plugins[o].promise.once[r].splice(e.plugins[o].promise.once[r].indexOf(s),1),e.plugins=Wn({},e.plugins))},pluginPromise_addOnId:function(e,t){var n=Object(Rn["a"])(t,3),o=n[0],r=n[1],s=n[2];o&&e.plugins.hasOwnProperty(o)&&(e.plugins[o].promise.onId.hasOwnProperty(r)||(e.plugins[o].promise.onId[r]=[]),e.plugins[o].promise.onId[r].push(s),e.plugins=Wn({},e.plugins))},pluginPromise_removeOnId:function(e,t){var n=Object(Rn["a"])(t,3),o=n[0],r=n[1],s=n[2];o&&e.plugins.hasOwnProperty(o)&&e.plugins[o].promise.onId.hasOwnProperty(r)&&(e.plugins[o].promise.onId[r].splice(e.plugins[o].promise.onId[r].indexOf(s),1),e.plugins=Wn({},e.plugins))},pluginPromise_addOnceId:function(e,t){var n=Object(Rn["a"])(t,3),o=n[0],r=n[1],s=n[2];o&&e.plugins.hasOwnProperty(o)&&(e.plugins[o].promise.onceId.hasOwnProperty(r)||(e.plugins[o].promise.onceId[r]=[]),e.plugins[o].promise.onceId[r].push(s),e.plugins=Wn({},e.plugins))},pluginPromise_removeOnceId:function(e,t){var n=Object(Rn["a"])(t,3),o=n[0],r=n[1],s=n[2];o&&e.plugins.hasOwnProperty(o)&&e.plugins[o].promise.onceId.hasOwnProperty(r)&&(e.plugins[o].promise.onceId[r].splice(e.plugins[o].promise.onceId[r].indexOf(s),1),e.plugins=Wn({},e.plugins))},pluginSetDeclaredFunctionalities:function(e,t){for(var n=Object(Rn["a"])(t,2),o=n[0],r=n[1],s=[],i=0;i<r.length;i++){var a=r[i];"string"===typeof a&&-1!==["install","renderMsgBody","resourceExts","inputExts","newMsg","displayNotification"].indexOf(a)&&s.push(a)}console.log("setting declared functionalities",o,r,s),e.plugins=Wn({},e.plugins,Object(u["a"])({},o,Wn({},e.plugins[o],{functionalities:s})))},pluginReady:function(e,t){t&&(e.plugins=Wn({},e.plugins,Object(u["a"])({},t,Wn({},e.plugins[t],{ready:!0}))))},pluginSetResourceExts:function(e,t){for(var n=Object(Rn["a"])(t,2),o=n[0],r=n[1],a=[],c=0;c<r.length;c++){var l=r[c],d=new Function(l.component.args,l.component.body);console.log("componentObj",l,Object(s["a"])(d),d),a.push({name:l.name,component:i["a"].component(l.name,d(o,e.plugins[o]))})}console.log("setting resource exts",o,r,a),e.plugins=Wn({},e.plugins,Object(u["a"])({},o,Wn({},e.plugins[o],{resourceExts:a})))},pluginSetInputExts:function(e,t){for(var n=Object(Rn["a"])(t,2),o=n[0],r=n[1],a=[],c=0;c<r.length;c++){var l=r[c],d=new Function(l.component.args,l.component.body);console.log("componentObj",l,Object(s["a"])(d),d),a.push({name:l.name,component:i["a"].component(l.name,d(o,e.plugins[o]))})}console.log("setting input exts",o,r,a),e.plugins=Wn({},e.plugins,Object(u["a"])({},o,Wn({},e.plugins[o],{inputExts:a})))}};function qn(e,t){e.views[t]?e.curViewId=t:console.debug("viewId ",t," invalid!")}var Jn=n("d547"),Gn=n("b054"),Xn=n.n(Gn);function Zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Qn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zn(n,!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var eo=null;try{eo=n(!function(){var e=new Error("Cannot find module '../config.js'");throw e.code="MODULE_NOT_FOUND",e}()).default}catch(co){eo=n("c871").default}i["a"].use(K["a"]);var to=!1,no=Qn({},eo,{views:["Conversation"],curViewId:0,plugins:{}}),oo=new K["a"].Store({state:no,getters:o,actions:r,mutations:Vn,modules:{ConversationProviders:Jn["default"]},strict:to,plugins:to?[Xn()()]:[]}),ro=(n("2e69"),null);try{ro=n("997c")}catch(co){ro=n("c05e")}i["a"].config.productionTip=!1;var so=function(e){for(var t={pluginName:e,events:["getDepCode","ready","declareFunctionalities","install","renderMsgBody","resourceExts","inputExts","newMsg","displayNotification"],on:{},once:{},onId:{},onceId:{},init:function(e){var t=this;return new Promise((function(n,o){e.onmessage=function(e){var n=e.data;if(console.log("main received from",t.pluginName,n),"object"===Object(s["a"])(n)){if(n.hasOwnProperty("resolveId")){if(t.onceId.hasOwnProperty(n.resolveId)){for(var o=0;o<t.onceId[n.resolveId].length;o++)t.onceId[n.resolveId][o](n);for(var r=0;r<t.onceId[n.resolveId].length;r++)t.removeOnceId(n.resolveId,t.onceId[n.resolveId][r])}if(t.onId.hasOwnProperty(n.resolveId))for(var i=0;i<t.onId[n.resolveId].length;i++)t.onId[n.resolveId][i](n)}for(var a=0;a<t.events.length;a++){var c=t.events[a];if(n.hasOwnProperty(c)){for(var u=0;u<t.once[c].length;u++)t.once[c][u](n[c]);for(var l=0;l<t.once[c].length;l++)t.removeOnce(c,t.once[c][l]);for(var d=0;d<t.on[c].length;d++)t.on[c][d](n[c])}}}},console.log("initialized promiseClass",t.pluginName,e,t),n()}))},addOn:function(e,t){oo.commit("pluginPromise_addOn",[this.pluginName,e,t])},removeOn:function(e,t){oo.commit("pluginPromise_removeOn",[this.pluginName,e,t])},addOnce:function(e,t){oo.commit("pluginPromise_addOnce",[this.pluginName,e,t])},removeOnce:function(e,t){oo.commit("pluginPromise_removeOnce",[this.pluginName,e,t])},addOnId:function(e,t){oo.commit("pluginPromise_addOnId",[this.pluginName,e,t])},removeOnId:function(e,t){oo.commit("pluginPromise_removeOnId",[this.pluginName,e,t])},addOnceId:function(e,t){oo.commit("pluginPromise_addOnceId",[this.pluginName,e,t])},removeOnceId:function(e,t){oo.commit("pluginPromise_removeOnceId",[this.pluginName,e,t])}},n=0;n<t.events.length;n++){var o=t.events[n];t.on[o]=[],t.once[o]=[]}return t},io=function(e,t){return new Promise((function(n){var o=so(e);oo.commit("registerPlugin",[e,t,o]),o.init(t).then((function(){console.log("initted promise worker",e),o.addOn("getDepCode",(function(n){var r=n.depPath,s=n.depType;ro.getDepCode(e,o,t,r,s,oo)})),o.addOnce("ready",(function(t){oo.commit("pluginReady",e)})),o.addOn("declareFunctionalities",(function(t){oo.commit("pluginSetDeclaredFunctionalities",[e,t])})),o.addOn("install",(function(e){ao.installPlugin(e)})),o.addOn("resourceExts",(function(t){oo.commit("pluginSetResourceExts",[e,t])})),o.addOn("inputExts",(function(t){oo.commit("pluginSetInputExts",[e,t])})),o.addOn("displayNotification",(function(t){oo.dispatch("displayNotification",[e,t])})),n(o),t.postMessage("registered")}))}))};i["a"].prototype.installPlugin=function(e){ro.installPlugin(e,io,oo)};var ao=new i["a"]({store:oo,render:function(e){return e(_n)},mounted:function(){this.$nextTick((function(){setTimeout((function(){window.requestAnimationFrame((function(){document.getElementById("app-loader").setAttribute("loaded",!0)}))}),200)}))}}).$mount("#app");window.VueApp=ao},"5c0b":function(e,t,n){"use strict";var o=n("e332"),r=n.n(o);r.a},"997c":function(e,t,n){"use strict";n.r(t);n("8e6e"),n("ac6a"),n("456d");var o=n("bd86"),r=n("7618"),s=n("d225"),i=n("b0b4"),a=n("308d"),c=n("6bb5"),u=n("4e2b"),l=(n("a481"),"innerReady"),d="response",v="wrapperReady",p="ping",f="pong",g="wrapperOpenedWebsocket",m="wrapperClosedWebsocket",h=function(){function e(t){Object(s["a"])(this,e),this.url=t,this.waiting_cb={},this.wrapper_nonce=document.location.href.replace(/.*wrapper_nonce=([A-Za-z0-9]+).*/,"$1"),this.connect(),this.next_message_id=1,this.init()}return Object(i["a"])(e,[{key:"init",value:function(){return this}},{key:"connect",value:function(){var e=this;this.target=window.parent,window.addEventListener("message",(function(t){return e.onMessage(t)}),!1),this.cmd(l)}},{key:"onMessage",value:function(e){var t=e.data,n=t.cmd;n===d?void 0!==this.waiting_cb[t.to]?(this.waiting_cb[t.to](t.result),delete this.waiting_cb[t.to]):this.log("Websocket callback not found:",t):n===v?this.cmd(l):n===p?this.response(t.id,f):n===g?this.onOpenWebsocket():n===m?this.onCloseWebsocket():this.onRequest(n,t)}},{key:"onRequest",value:function(e,t){this.log("Unknown request",t)}},{key:"response",value:function(e,t){this.send({cmd:d,to:e,result:t})}},{key:"cmd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.send({cmd:e,params:t},n)}},{key:"cmdp",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(o,r){t.cmd(e,n,(function(e){e&&e.error?r(e.error):o(e)}))}))}},{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.wrapper_nonce=this.wrapper_nonce,e.id=this.next_message_id,this.next_message_id++,this.target.postMessage(e,"*"),t&&(this.waiting_cb[e.id]=t)}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log.apply(console,["[ZeroFrame]"].concat(t))}},{key:"onOpenWebsocket",value:function(){this.log("Websocket open")}},{key:"onCloseWebsocket",value:function(){this.log("Websocket close")}},{key:"monkeyPatchAjax",value:function(){var e=this,t=this;XMLHttpRequest.prototype.realOpen=XMLHttpRequest.prototype.open,this.cmd("wrapperGetAjaxKey",[],(function(t){e.ajax_key=t}));var n=function(e,n,o){return n+="?ajax_key="+t.ajax_key,this.realOpen(e,n,o)};XMLHttpRequest.prototype.open=n,window.realFetch=window.fetch;var o=function(e){return e+="?ajax_key="+t.ajax_key,window.realFetch(e)};window.fetch=o}}]),e}(),b=h,y=n("c64e"),O=n.n(y);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.d(t,"installPlugin",(function(){return E})),n.d(t,"getDepCode",(function(){return N}));var w=!1,P=[],_=null;try{_=n("2253")}catch(S){_=n("4233")}var k=function(){var e=null;return"undefined"!==typeof document.hidden?e="hidden":"undefined"!==typeof document.msHidden?e="msHidden":"undefined"!==typeof document.webkitHidden&&(e="webkitHidden"),e||console.warn("A feature which depends on the Page Visibility API can not be used due to the lack of it's support in this browser."),null!==e&&document[e]};function I(e,t,n){var o;"js"===t?(o=document.createElement("script"),o.setAttribute("type","text/javascript"),o.setAttribute("src",e)):"css"===t&&(o=document.createElement("link"),o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",e)),"undefined"!==typeof o&&(o.onload=function(o){"function"===typeof n&&n(void 0,e,t)},o.onerror=function(o){"function"===typeof n&&n(new Error('couldn"t load file',e,t),e,t)},document.getElementsByTagName("head")[0].appendChild(o))}function x(e,t,n){-1===P.indexOf(e)?(I(e,t,n),P.push(e)):"function"===typeof n&&n(null,e,t)}var M=function(e){function t(){return Object(s["a"])(this,t),Object(a["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(u["a"])(t,e),Object(i["a"])(t,[{key:"setSiteInfo",value:function(e){e&&"object"===Object(r["a"])(e)&&console.log("setting siteInfo",e)}},{key:"onOpenWebsocket",value:function(){var e=this;this.cmd("siteInfo",[],(function(t){e.setSiteInfo(t)}))}},{key:"onRequest",value:function(e,t){"setSiteInfo"===e?this.setSiteInfo(t.params):this.log("Unknown incoming message:",e)}}]),t}(b),A=new M,D=function(e,t,n){e(t,n).then((function(e){e.removeOn("displayNotification"),e.addOn("displayNotification",(function(e){if(!e.title||!e.showAlways&&!k())return null;var t=O()();A.cmd("wrapperWebNotification",[e.title,t,j({},e.options,{focus_tab:!0})])}))}))},E=function(e,t,n){if(w){var o=new Worker((w?"/public":_.publicPath)+"/plugins/"+e+"/index.js");D(t,e,o)}else A.cmd("fileGet",["plugins/"+e+"/index.js","text"],(function(n){var o=URL.createObjectURL(new Blob([n],{type:"text/javascript"})),r=new Worker(o);D(t,e,r)}))},N=function(e,t,n,o,r,s){if(w){var i=o;"css"===r&&x((w?"/public":_.publicPath)+"/plugins/"+e+"/"+o,r),n.postMessage({depPath:o,depType:r,depCode:i})}else A.cmd("fileGet",["plugins/"+e+"/"+o,"text"],(function(t){var s="data:text/javascript;base64;charset=utf8,"+btoa(unescape(encodeURIComponent(t)));"css"===r&&x((w?"/public":_.publicPath)+"/plugins/"+e+"/"+o,r),n.postMessage({depPath:o,depType:r,depCode:s})}))};t["default"]={installPlugin:E,getDepCode:N}},a8a2:function(e,t,n){},ad94:function(e,t,n){"use strict";n.r(t);n("a481");var o=n("d225"),r=n("b0b4"),s="innerReady",i="response",a="wrapperReady",c="ping",u="pong",l="wrapperOpenedWebsocket",d="wrapperClosedWebsocket",v=function(){function e(t){Object(o["a"])(this,e),this.url=t,this.waiting_cb={},this.wrapper_nonce=document.location.href.replace(/.*wrapper_nonce=([A-Za-z0-9]+).*/,"$1"),this.connect(),this.next_message_id=1,this.init()}return Object(r["a"])(e,[{key:"init",value:function(){return this}},{key:"connect",value:function(){var e=this;this.target=window.parent,window.addEventListener("message",(function(t){return e.onMessage(t)}),!1),this.cmd(s)}},{key:"onMessage",value:function(e){var t=e.data,n=t.cmd;n===i?void 0!==this.waiting_cb[t.to]?(this.waiting_cb[t.to](t.result),delete this.waiting_cb[t.to]):this.log("Websocket callback not found:",t):n===a?this.cmd(s):n===c?this.response(t.id,u):n===l?this.onOpenWebsocket():n===d?this.onCloseWebsocket():this.onRequest(n,t)}},{key:"onRequest",value:function(e,t){this.log("Unknown request",t)}},{key:"response",value:function(e,t){this.send({cmd:i,to:e,result:t})}},{key:"cmd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.send({cmd:e,params:t},n)}},{key:"cmdp",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(o,r){t.cmd(e,n,(function(e){e&&e.error?r(e.error):o(e)}))}))}},{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.wrapper_nonce=this.wrapper_nonce,e.id=this.next_message_id,this.next_message_id++,this.target.postMessage(e,"*"),t&&(this.waiting_cb[e.id]=t)}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log.apply(console,["[ZeroFrame]"].concat(t))}},{key:"onOpenWebsocket",value:function(){this.log("Websocket open")}},{key:"onCloseWebsocket",value:function(){this.log("Websocket close")}},{key:"monkeyPatchAjax",value:function(){var e=this,t=this;XMLHttpRequest.prototype.realOpen=XMLHttpRequest.prototype.open,this.cmd("wrapperGetAjaxKey",[],(function(t){e.ajax_key=t}));var n=function(e,n,o){return n+="?ajax_key="+t.ajax_key,this.realOpen(e,n,o)};XMLHttpRequest.prototype.open=n,window.realFetch=window.fetch;var o=function(e){return e+="?ajax_key="+t.ajax_key,window.realFetch(e)};window.fetch=o}}]),e}();t["default"]=v},c05e:function(e,t,n){"use strict";n.r(t),n.d(t,"installPlugin",(function(){return a})),n.d(t,"getDepCode",(function(){return c}));var o=!1,r=[];function s(e,t,n){var o;"js"===t?(o=document.createElement("script"),o.setAttribute("type","text/javascript"),o.setAttribute("src",e)):"css"===t&&(o=document.createElement("link"),o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",e)),"undefined"!==typeof o&&(o.onload=function(o){"function"===typeof n&&n(void 0,e,t)},o.onerror=function(o){"function"===typeof n&&n(new Error('couldn"t load file',e,t),e,t)},document.getElementsByTagName("head")[0].appendChild(o))}function i(e,t,n){-1===r.indexOf(e)?(s(e,t,n),r.push(e)):"function"===typeof n&&n(null,e,t)}var a=function(e,t,n){var r=new Worker((o?"/public":"")+"/plugins/"+e+"/index.js");t(e,r).then((function(e){}))},c=function(e,t,n,r,s,a){var c=r;"css"===s&&i((o?"/public":"")+"/plugins/"+e+"/"+r,s),n.postMessage({depPath:r,depType:s,depCode:c})};t["default"]={installPlugin:a,getDepCode:c}},c871:function(e,t,n){"use strict";n.r(t),t["default"]={loadDefaultProviders:["zn"],loadDefaultPlugins:["defaultPack"]}},d547:function(e,t,n){"use strict";n.r(t);var o=n("768b"),r=(n("55dd"),n("7f7f"),n("c1df")),s=n.n(r),i={conversationProviders:{},curConversation:{providerName:null,conversationId:null}},a={state_curConversation:function(e){var t=e.curConversation;return t},getAllConversationProviders:function(e){var t=[];for(var n in e.conversationProviders){var o=e.conversationProviders[n];t.push(o)}return t},getConversationProvider:function(e){return function(t){return e.conversationProviders.hasOwnProperty(t)?e.conversationProviders[t]:(console.debug("no such provider with name",t),null)}},getCurConversationProvider:function(e,t){var n=e.curConversation.providerName;return n?t.getConversationProvider(n):(console.debug("no current conversation"),null)},isAvailable:function(e,t){return function(e){return t["provider_"+e+"/isAvailable"]}},isReady:function(e,t){return function(e){return t["provider_"+e+"/isReady"]}},oneProviderMode:function(e,t){return console.debug("checking for oneProviderMode",t.getAllConversationProviders.length),1===t.getAllConversationProviders.length},getAllConversations:function(e,t){for(var n=[],o=0;o<t.getAllConversationProviders.length;o++){var r=t.getAllConversationProviders[o];if(t.isAvailable(r.name)&&t.isReady(r.name))for(var i in r.conversations){var a=r.conversations[i];n.push(a)}}return n.sort((function(e,t){return e.lastMessage?t.lastMessage&&s()(e.lastMessage.dateAdded,"x").isBefore(s()(t.lastMessage.dateAdded,"x"))?1:-1:1})),n},getConversation:function(e){return function(t,n){return e.conversationProviders.hasOwnProperty(t)&&e.conversationProviders[t].conversations.hasOwnProperty(n)?e.conversationProviders[t].conversations[n]:null}},getCurConversation:function(e,t){var n=e.curConversation.providerName,o=e.curConversation.conversationId;return n&&o?t.getConversation(n,o):(console.debug("no current conversation"),null)},getConversationMessages:function(e,t){return function(n,o){for(var r=t.getConversation(n,o),i=[],a=0;a<r.messagekeys.length;a++){var c=r.messagekeys[a],u=e.conversationProviders[n].messages[c];u&&i.unshift(u)}return i.sort((function(e,t){return s()(e.dateAdded,"x").isBefore(s()(t.dateAdded,"x"))?1:-1})),i}},getCurConversationMessages:function(e,t){var n=e.curConversation.providerName,o=e.curConversation.conversationId;return n&&o?t.getConversationMessages(n,o):(console.debug("no current conversation"),null)},getConversationProviderUser:function(e,t){return function(n){return e.conversationProviders.hasOwnProperty(n)?t["provider_"+n+"/getCurUser"]:null}},getCurConversationUser:function(e,t){var n=e.curConversation.providerName;return n?t.getConversationProviderUser(n):(console.debug("no current conversation"),null)},validateMessage:function(e,t){return function(n){var o=e.curConversation.providerName,r=e.curConversation.conversationId;if(o)return t["provider_"+o+"/validateMessage"](n,r)}}},c={registerConversationProvider:function(e,t){e.conversationProviders[t]=e["provider_"+t]},changeConversation:function(e,t){var n=Object(o["a"])(t,2),r=n[0],s=n[1];e.curConversation.providerName=r,e.curConversation.conversationId=s}},u={addConversationProvider:function(e,t){var n=e.commit,o=e.dispatch;n("registerConversationProvider",t),o("provider_"+t+"/init")},sendMessage:function(e,t){var n=e.dispatch,r=Object(o["a"])(t,3),s=r[0],i=r[1],a=r[2],c=n("provider_"+s+"/sendMessage",[i,a]);return c},sendMessage2Cur:function(e,t){var n=e.state,o=e.dispatch,r=n.curConversation.providerName,s=n.curConversation.conversationId;if(t=encodeURIComponent(t),r&&s){var i=o("sendMessage",[r,s,t]);return i}return console.debug("no current conversation"),null},updateTyping:function(e){var t=e.state,n=e.dispatch,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.curConversation.providerName,s=t.curConversation.conversationId;r&&s&&n("provider_"+r+"/updateTyping",[s,o])}};t["default"]={namespaced:!0,state:i,getters:a,mutations:c,actions:u}},e332:function(e,t,n){},f387:function(e,t,n){var o={"./":"d547","./index":"d547","./index.js":"d547","./zn":"3fa7","./zn/":"3fa7","./zn/ZeroFrame":"ad94","./zn/ZeroFrame.js":"ad94","./zn/index":"3fa7","./zn/index.js":"3fa7"};function r(e){var t=s(e);return n(t)}function s(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=s,e.exports=r,r.id="f387"}});
//# sourceMappingURL=app.05351539.js.map