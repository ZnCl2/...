(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[15],{

/***/ "./app/components/topic-list-item.js":
/*!*******************************************!*\
  !*** ./app/components/topic-list-item.js ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _context_provider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../context-provider */ \"./app/context-provider.js\");\n/* harmony import */ var _helpers_app_helpers_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../helpers/app-helpers.js */ \"./app/helpers/app-helpers.js\");\n/* harmony import */ var _helpers_follow_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../helpers/follow-helpers */ \"./app/helpers/follow-helpers.js\");\n/* harmony import */ var _helpers_topic_helpers_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../helpers/topic-helpers.js */ \"./app/helpers/topic-helpers.js\");\n/* harmony import */ var _helpers_file_helpers_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../helpers/file-helpers.js */ \"./app/helpers/file-helpers.js\");\n/* harmony import */ var _helpers_vote_helpers_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../helpers/vote-helpers.js */ \"./app/helpers/vote-helpers.js\");\n/* harmony import */ var _partials_item_media_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./partials/item-media.js */ \"./app/components/partials/item-media.js\");\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? Object(arguments[i]) : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n\n\n\n\n\n\n\n\nvar ItemHtmlBodyRender = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"lazy\"])(function () {\n  return __webpack_require__.e(/*! import() */ 5).then(__webpack_require__.bind(null, /*! ./partials/item-html-body-render */ \"./app/components/partials/item-html-body-render.js\"));\n});\n\nfunction TopicListItem(props) {\n  var _useContext = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useContext\"])(_context_provider__WEBPACK_IMPORTED_MODULE_1__[\"Context\"]),\n      appState = _useContext.appState,\n      zeroNetState = _useContext.zeroNetState;\n\n  var t = props.topic;\n\n  var _useState = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      showBody = _useState2[0],\n      setShowBody = _useState2[1]; // topic image\n\n\n  var topicListItemImageDisplay,\n      topicListItemBodyCssClass = \"\";\n\n  if (t.file_id || t.file_to_item_id || t.embed_url || t.added <= 1498441955800) {\n    topicListItemImageDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(TopicListItemImageContainer, {\n      topic: t\n    });\n    topicListItemBodyCssClass += \" w-file\";\n  } // edit tool bar\n\n  /*let topicEditToolbar;\n  if (t.user_id === zeroNetState.site_info.cert_user_id){\n    topicEditToolbar = (\n      <ItemEditToolBar\n        topic={t}\n        onDeleteTopic={this.props.onDeleteTopic}\n      />\n    );\n  }*/\n  // EDIT ITEM TOOL BAR TO DO!!!!!!!!!! BEFORE FOLLOW CONTAINER\n  // {topicEditToolbar}  \n  // topic item follow container\n  // topic item body display / topic item follow display\n\n\n  var topicBodyDisplay, topicItemFollowDisplay;\n\n  if (appState.route.view !== 'topic') {\n    if (t.body || t.file_id || t.file_to_item_id || t.embed_url || t.added <= 1498441955800) {\n      if (showBody) {\n        var topicBody, topicBodyMediaDisplay;\n\n        if (t.body) {\n          topicBody = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n            className: \"topic-view-body\"\n          }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__[\"Suspense\"], {\n            fallback: \"\"\n          }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(ItemHtmlBodyRender, {\n            content: t.body\n          })));\n        }\n\n        if (t.file_id || t.file_to_item_id || t.embed_url || t.added <= 1498441955800) topicBodyMediaDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n          className: \"topic-view-media\"\n        }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_partials_item_media_js__WEBPACK_IMPORTED_MODULE_7__[\"ItemMediaContainer\"], {\n          topic: t\n        }));\n        topicBodyDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n          className: \"topic-list-item-body-container ui segment\"\n        }, topicBodyMediaDisplay, topicBody);\n      }\n    }\n  } else topicItemFollowDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(TopicListItemFollowContainer, {\n    topic: t\n  });\n\n  return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"item ui segment topic-item\"\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(TopicVotesWrapper, {\n    topic: t\n  }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"topic-item-body \" + topicListItemBodyCssClass\n  }, topicListItemImageDisplay, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"topic-item-content\"\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"topic-item-header\"\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"h3\", null, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    href: \"index.html?v=topic+id=\" + t.topic_id\n  }, t.title)), topicItemFollowDisplay), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(TopicItemInfoDisplay, {\n    topic: t,\n    showBody: showBody,\n    showTopicBody: function showTopicBody() {\n      return setShowBody(showBody === true ? false : true);\n    }\n  }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"topic-item-comment-counter\"\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"b\", null, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    href: \"index.html?v=topic+id=\" + t.topic_id\n  }, t.comments_total - t.hidden_comments_total, \" comments\"), \" \"))), topicBodyDisplay));\n}\n\nfunction TopicVotesWrapper(props) {\n  var _React$useContext = react__WEBPACK_IMPORTED_MODULE_0___default.a.useContext(_context_provider__WEBPACK_IMPORTED_MODULE_1__[\"Context\"]),\n      appState = _React$useContext.appState,\n      zeroNetState = _React$useContext.zeroNetState;\n\n  var _useState3 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var _useState5 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      votes = _useState6[0],\n      setVotes = _useState6[1];\n\n  var topic = props.topic;\n  /* COMPONENT */\n\n  react__WEBPACK_IMPORTED_MODULE_0___default.a.useEffect(function () {\n    getTopicVotes();\n  }, []);\n\n  function getTopicVotes() {\n    var query = Object(_helpers_vote_helpers_js__WEBPACK_IMPORTED_MODULE_6__[\"getTopicVotesQuery\"])(topic.topic_id);\n    Page.cmd('dbQuery', [query], function (res) {\n      var votes = Object(_helpers_vote_helpers_js__WEBPACK_IMPORTED_MODULE_6__[\"renderItemVotes\"])(res, zeroNetState.site_info.cert_user_id);\n      setVotes(votes);\n      setLoading(false);\n    });\n  }\n\n  function onUpVoteClick() {\n    if (appState.user) {\n      var voteType = Object(_helpers_vote_helpers_js__WEBPACK_IMPORTED_MODULE_6__[\"configVoteActionType\"])(votes.user_vote, 'UP');\n      onVoteTopic(voteType);\n    } else {\n      Page.cmd(\"wrapperNotification\", [\"info\", \"Login to participate\", 4000]);\n    }\n  }\n\n  function onDownVoteClick() {\n    if (appState.user) {\n      var voteType = Object(_helpers_vote_helpers_js__WEBPACK_IMPORTED_MODULE_6__[\"configVoteActionType\"])(votes.user_vote, 'DOWN');\n      onVoteTopic(voteType);\n    } else {\n      Page.cmd(\"wrapperNotification\", [\"info\", \"Login to participate\", 4000]);\n    }\n  }\n\n  function onVoteTopic(voteType) {\n    setLoading(true);\n    var config = appState.config;\n\n    if (voteType === 'CHANGE' || voteType === 'DELETE') {\n      var query = \"SELECT * FROM json WHERE json_id='\" + votes.user_vote.json_id + \"'\";\n      Page.cmd('dbQuery', [query], function (res) {\n        var inner_path = \"merged-\" + config.merger_name + \"/\" + res[0].directory + \"/\" + res[0].file_name;\n        voteTopic(voteType, inner_path);\n      }.bind(this));\n    } else {\n      var auth_address = zeroNetState.site_info.auth_address;\n      var inner_path = \"merged-\" + config.merger_name + \"/\" + config.cluster + \"/data/users/\" + auth_address + \"/data.json\";\n      voteTopic(voteType, inner_path);\n    }\n  }\n\n  function voteTopic(voteType, inner_path) {\n    Page.cmd('fileGet', {\n      inner_path: inner_path\n    }, function (data) {\n      data = JSON.parse(data);\n\n      if (data) {\n        if (!data.topic_vote) {\n          data.topic_vote = [];\n          data.next_topic_vote_id = 1;\n        }\n      } else {\n        data = {\n          \"topic_vote\": [],\n          \"next_topic_vote_id\": 1\n        };\n      }\n\n      data = Object(_helpers_vote_helpers_js__WEBPACK_IMPORTED_MODULE_6__[\"renderDataJsonOnTopicVote\"])(data, zeroNetState.site_info, voteType, topic.topic_id, votes.user_vote, 'topic');\n      var json_raw = unescape(encodeURIComponent(JSON.stringify(data, void 0, '\\t')));\n      Page.cmd(\"fileWrite\", [inner_path, btoa(json_raw)], function (res) {\n        Page.cmd(\"sitePublish\", {\n          \"inner_path\": inner_path\n        }, function (res) {\n          Page.cmd(\"wrapperNotification\", [\"done\", \"Topic Voted!\", 4000]);\n          getTopicVotes();\n        });\n      });\n    });\n  }\n  /* RENDER */\n\n\n  var topicVotesDisplay,\n      topicVotesCounter,\n      topicVotesBar,\n      topicVotesDisplayCssClass = \"votes-display ui active inverted dimmer\";\n\n  if (loading) {\n    topicVotesDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: topicVotesDisplayCssClass\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"ui mini loader\"\n    }));\n  } else {\n    var topicVotesPercentage = Object(_helpers_vote_helpers_js__WEBPACK_IMPORTED_MODULE_6__[\"generateTopicVotesBar\"])(topic);\n    topicVotesBar = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"topic-votes-bar\"\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"topic-votes-up\",\n      style: {\n        height: topicVotesPercentage.uvp + \"%\"\n      }\n    }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"topic-votes-down\",\n      style: {\n        height: topicVotesPercentage.dvp + \"%\"\n      }\n    }));\n\n    if (votes) {\n      topicVotesCounter = votes.up.length - votes.down.length;\n\n      if (votes.user_vote) {\n        if (votes.user_vote.vote === 0) topicVotesDisplayCssClass += \" down-voted\";else if (votes.user_vote.vote === 1) topicVotesDisplayCssClass += \" up-voted\";\n      }\n    } else topicVotesCounter = topic.up_votes - topic.down_votes;\n\n    topicVotesDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: topicVotesDisplayCssClass\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n      className: \"arrow up\",\n      onClick: onUpVoteClick\n    }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, topicVotesCounter), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n      className: \"arrow down\",\n      onClick: onDownVoteClick\n    }));\n  }\n\n  return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"topic-item-votes\"\n  }, topicVotesDisplay, topicVotesBar);\n}\n\nfunction TopicListItemImageContainer(props) {\n  var _React$useContext2 = react__WEBPACK_IMPORTED_MODULE_0___default.a.useContext(_context_provider__WEBPACK_IMPORTED_MODULE_1__[\"Context\"]),\n      appState = _React$useContext2.appState;\n\n  var _useState7 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      loading = _useState8[0],\n      setLoading = _useState8[1];\n\n  var _useState9 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      isFile = _useState10[0],\n      setIsFile = _useState10[1];\n\n  var _useState11 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(''),\n      _useState12 = _slicedToArray(_useState11, 2),\n      filePath = _useState12[0],\n      setFilePath = _useState12[1];\n\n  var _useState13 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(''),\n      _useState14 = _slicedToArray(_useState13, 2),\n      mediaType = _useState14[0],\n      setMediaType = _useState14[1];\n\n  var _useState15 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(''),\n      _useState16 = _slicedToArray(_useState15, 2),\n      error = _useState16[0],\n      setError = _useState16[1];\n\n  var topic = props.topic;\n  /* COMPONENT */\n\n  react__WEBPACK_IMPORTED_MODULE_0___default.a.useEffect(function () {\n    if (topic.file_to_item_id) onGetFile();else getFile();\n  }, []);\n\n  function onGetFile() {\n    setIsFile(true);\n    var query = Object(_helpers_file_helpers_js__WEBPACK_IMPORTED_MODULE_5__[\"getFileToItemQuery\"])(topic.file_to_item_id);\n    Page.cmd('dbQuery', [query], function (res) {\n      getFile(res[0].file_id);\n    });\n  }\n\n  function getFile(fileId) {\n    var query;\n    if (!fileId) query = \"SELECT * FROM file WHERE item_id='\" + topic.topic_id + \"'\";else query = Object(_helpers_file_helpers_js__WEBPACK_IMPORTED_MODULE_5__[\"getFileQuery\"])(fileId);\n    Page.cmd('dbQuery', [query], function (res) {\n      if (res && res.length > 0) {\n        var file = res[0];\n\n        var _mediaType = Object(_helpers_file_helpers_js__WEBPACK_IMPORTED_MODULE_5__[\"determineFileMediaType\"])(file.file_type);\n\n        var _loading = true;\n        if (_mediaType === 'image') _loading = false;\n        var directory = file.directory;\n        if (!file.directory) directory = appState.config.cluster + \"/data/users/\" + file.user_id;\n        setFilePath(\"merged-\" + appState.config.merger_name + \"/\" + directory + \"/\" + file.file_name);\n        setIsFile(true);\n        setMediaType(_mediaType);\n        setLoading(_loading);\n      }\n    });\n  }\n\n  function onImageLoadError() {\n    setError(true);\n    setLoading(false);\n  }\n  /* RENDER */\n\n\n  if (loading && isFile) imageContainerCssClass += \" image-loading\";\n  var imageDisplay,\n      imageContainerCssClass = \"topic-item-image-container ui segment\";\n\n  if (isFile) {\n    if (mediaType === 'image') {\n      imageContainerCssClass += \" image-file\";\n      imageDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"img\", {\n        onLoad: function onLoad(e) {\n          return setLoading(true);\n        },\n        onError: onImageLoadError,\n        src: filePath\n      });\n    } else if (mediaType === 'video') {\n      imageContainerCssClass += \" video-file\";\n      imageDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"i\", {\n        className: \"file video outline icon big\"\n      });\n    } else if (mediaType === 'audio') {\n      imageContainerCssClass += \" audio-file\";\n      imageDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"i\", {\n        className: \"file audio outline icon big\"\n      });\n    }\n\n    if (error === true) imageDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"img\", {\n      src: \"assets/img/404-not-found.png\"\n    });\n  } else {\n    if (topic.embed_url) {\n      imageContainerCssClass += \" embeded-file\";\n      var embedUrl = topic.embed_url;\n      var lastDot = embedUrl.lastIndexOf('.');\n      var fileType = embedUrl.substring(lastDot + 1);\n      var embededMediaType = Object(_helpers_file_helpers_js__WEBPACK_IMPORTED_MODULE_5__[\"determineFileMediaType\"])(fileType);\n\n      if (embededMediaType === 'video') {\n        imageContainerCssClass += \" video-file\";\n        imageDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"i\", {\n          className: \"file video outline icon big\"\n        });\n      } else if (embededMediaType === 'audio') imageDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"i\", {\n        className: \"file audio outline icon big\"\n      });else if (embededMediaType === 'image') imageDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n        style: {\n          \"fontSize\": \"10px\"\n        }\n      }, \"external\");else if (!embededMediaType) imageDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"img\", {\n        src: \"assets/img/404-not-found.png\"\n      });\n    } else imageContainerCssClass += \" no-file\";\n  }\n\n  return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: imageContainerCssClass\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    href: \"index.html?v=topic+id=\" + topic.topic_id\n  }, imageDisplay));\n}\n\nfunction TopicListItemFollowContainer(props) {\n  var _React$useContext3 = react__WEBPACK_IMPORTED_MODULE_0___default.a.useContext(_context_provider__WEBPACK_IMPORTED_MODULE_1__[\"Context\"]),\n      zeroNetState = _React$useContext3.zeroNetState;\n\n  var topic = props.topic;\n  var isFollowingTopic = zeroNetState.user_feed[topic.topic_id + \" topic\"] ? true : false;\n\n  var _useState17 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(isFollowingTopic),\n      _useState18 = _slicedToArray(_useState17, 2),\n      followingTopic = _useState18[0],\n      setFollowingTopic = _useState18[1];\n\n  function toggleTopicFollow() {\n    if (followingTopic) unfollowTopic();else followTopic();\n  }\n\n  function followTopic() {\n    var params;\n    var query = Object(_helpers_follow_helpers__WEBPACK_IMPORTED_MODULE_3__[\"generateFollowTopicCommentsQuery\"])(topic.topic_id);\n    var feed = [query, params];\n\n    var feedFollow = _objectSpread({}, zeroNetState.user_feed);\n\n    feedFollow[topic.topic_id + \" topic\"] = feed;\n    Page.cmd(\"feedFollow\", [feedFollow]);\n    Page.cmd('feedListFollow', [], function (feed) {\n      setFollowingTopic(true);\n    });\n  }\n\n  function unfollowTopic() {\n    var feedFollow = _objectSpread({}, zeroNetState.user_feed);\n\n    delete feedFollow[topic.topic_id + \" topic\"];\n    Page.cmd(\"feedFollow\", [feedFollow]);\n    Page.cmd('feedListFollow', [], function (feed) {\n      setFollowingTopic(false);\n    });\n  }\n\n  return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    id: \"topic-follow-container\",\n    className: \"ui compact segment\"\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    onClick: toggleTopicFollow\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"i\", {\n    className: \"icon feed\"\n  }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, followingTopic ? \"unfollow\" : \"follow\")));\n}\n\nfunction TopicItemInfoDisplay(props) {\n  var topic = props.topic;\n  var initialLastActivityValue = topic.added;\n  if (topic.lastCommentDate) initialLastActivityValue = topic.lastCommentDate;\n\n  var _useState19 = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(initialLastActivityValue),\n      _useState20 = _slicedToArray(_useState19, 2),\n      lastActivity = _useState20[0],\n      setLastActivity = _useState20[1];\n\n  react__WEBPACK_IMPORTED_MODULE_0___default.a.useEffect(function () {\n    var query = Object(_helpers_topic_helpers_js__WEBPACK_IMPORTED_MODULE_4__[\"getTopicLastActivityDate\"])(topic.topic_id);\n    Page.cmd('dbQuery', [query], function (res) {\n      if (res && res.length) setLastActivity(res[0].added);\n    });\n  }, []);\n  if (topic.added < 1481025974864) topic.added = 1481025974864;\n  var shortenedUsername = topic.user_id.split('@')[0].substring(0, 10) + '...' + '@' + topic.user_id.split('@')[1];\n  var channelNameDisplay = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"b\", null, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    href: \"index.html?v=channel+id=\" + topic.channel_id\n  }, topic.name));\n  if (!topic.name) channelNameDisplay = \"no channel\";\n  var upDownVotesTotal;\n  if (topic.votes) upDownVotesTotal = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, \"(\", react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n    className: \"up-votes\"\n  }, \"+\", topic.votes.up.length), \"|\", react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n    className: \"down-votes\"\n  }, \"-\", topic.votes.down.length), \")\");\n  return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"topic-item-info\"\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    onClick: props.showTopicBody\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"i\", {\n    className: \"icon \" + (props.showBody ? \"minus\" : \"add\") + \" square\"\n  }))), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, \" created \", Object(_helpers_app_helpers_js__WEBPACK_IMPORTED_MODULE_2__[\"DateHelper\"])(topic.added), \" \\u2022 \"), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, \" last activity \", Object(_helpers_app_helpers_js__WEBPACK_IMPORTED_MODULE_2__[\"DateHelper\"])(lastActivity), \" \\u2022 \"), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, \" by \", react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    href: \"#\"\n  }, shortenedUsername), \" \\u2022 \"), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, \" to \", channelNameDisplay), upDownVotesTotal);\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (TopicListItem);\n\n//# sourceURL=webpack:///./app/components/topic-list-item.js?");

/***/ }),

/***/ "./app/helpers/vote-helpers.js":
/*!*************************************!*\
  !*** ./app/helpers/vote-helpers.js ***!
  \*************************************/
/*! exports provided: getTopicVotesQuery, getCommentVotesQuery, renderItemVotes, configVoteActionType, renderDataJsonOnTopicVote, generateTopicVotesBar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getTopicVotesQuery\", function() { return getTopicVotesQuery; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getCommentVotesQuery\", function() { return getCommentVotesQuery; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"renderItemVotes\", function() { return renderItemVotes; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configVoteActionType\", function() { return configVoteActionType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"renderDataJsonOnTopicVote\", function() { return renderDataJsonOnTopicVote; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"generateTopicVotesBar\", function() { return generateTopicVotesBar; });\nvar getTopicVotesQuery = function getTopicVotesQuery(topicId) {\n  var q = \"SELECT * FROM topic_vote WHERE topic_vote.topic_id='\" + topicId + \"'\";\n  return q;\n};\nvar getCommentVotesQuery = function getCommentVotesQuery(commentId) {\n  var q = \"SELECT * FROM comment_vote WHERE comment_vote.comment_id='\" + commentId + \"'\";\n  return q;\n};\nvar renderItemVotes = function renderItemVotes(res, user) {\n  var votes = {\n    up: res.filter(function (v) {\n      return v.vote === 1;\n    }),\n    down: res.filter(function (v) {\n      return v.vote === 0;\n    }),\n    user_vote: res.find(function (v) {\n      return v.user_id === user;\n    })\n  };\n  return votes;\n};\nvar configVoteActionType = function configVoteActionType(userVote, type) {\n  var vtype;\n\n  if (type === 'UP') {\n    if (userVote) {\n      if (userVote.vote === 1) vtype = 'DELETE';else if (userVote.vote === 0) vtype = 'CHANGE';\n    } else vtype = 'UP';\n  } else if (type === 'DOWN') {\n    if (userVote) {\n      if (userVote.vote === 1) vtype = 'CHANGE';else if (userVote.vote === 0) vtype = 'DELETE';\n    } else vtype = 'DOWN';\n  }\n\n  return vtype;\n};\nvar renderDataJsonOnTopicVote = function renderDataJsonOnTopicVote(data, siteInfo, voteType, itemId, userVote, itemType) {\n  var voteIndex;\n  if (userVote) voteIndex = data[itemType + '_vote'].findIndex(function (v) {\n    return v[itemType + '_vote_id'] === userVote[itemType + '_vote_id'];\n  });\n\n  if (voteType === 'UP' || voteType === 'DOWN') {\n    var vote = voteType === 'UP' ? 1 : 0;\n    var item_vote = {\n      user_id: siteInfo.cert_user_id,\n      vote: vote,\n      added: Date.now()\n    };\n    item_vote[itemType + '_vote_id'] = siteInfo.auth_address + \"vt\" + data['next_' + itemType + '_vote_id'];\n    item_vote[itemType + '_id'] = itemId;\n    data[itemType + '_vote'].push(item_vote);\n    data['next_' + itemType + '_vote_id'] += 1;\n  } else if (voteType === 'CHANGE') {\n    data[itemType + '_vote'][voteIndex].vote = data[itemType + '_vote'][voteIndex].vote === 1 ? 0 : 1;\n  } else if (voteType === 'DELETE') {\n    data[itemType + '_vote'].splice(voteIndex, 1);\n  }\n\n  return data;\n};\nvar generateTopicVotesBar = function generateTopicVotesBar(topic) {\n  var votesBar = {};\n\n  if (topic.votes) {\n    votesBar.total = topic.votes.up.length + topic.votes.down.length;\n    votesBar.uvp = topic.votes.up.length / votesBar.total * 100;\n    votesBar.dvp = topic.votes.down.length / votesBar.total * 100;\n  } else {\n    votesBar.total = topic.up_votes + topic.down_votes;\n    votesBar.uvp = topic.up_votes / votesBar.total * 100;\n    votesBar.dvp = topic.down_votes / votesBar.total * 100;\n  }\n\n  return votesBar;\n};\n\n//# sourceURL=webpack:///./app/helpers/vote-helpers.js?");

/***/ })

}]);