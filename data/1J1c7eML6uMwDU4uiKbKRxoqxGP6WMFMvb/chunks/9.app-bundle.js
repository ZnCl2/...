(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{107:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),r=n(1),o=n(42),l=n(2),c=n(29);function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,a=!1,r=void 0;try{for(var o,l=e[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){a=!0,r=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw r}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var f=Object(i.lazy)((function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,31))})),u=Object(i.lazy)((function(){return Promise.all([n.e(4),n.e(2)]).then(n.bind(null,74))}));t.default=function(e){var t,n,s=Object(i.useContext)(r.a),m=s.appState,p=s.zeroNetState,_=d(Object(i.useState)(!1),2),g=_[0],b=_[1],v=d(Object(i.useState)(),2),E=v[0],h=v[1],y=d(Object(i.useState)(),2),w=y[0],O=y[1],j=d(Object(i.useState)(),2),S=j[0],N=j[1],x=d(Object(i.useState)(),2),I=x[0],P=x[1],C=d(Object(i.useState)(),2),R=C[0],T=C[1],k=d(Object(i.useState)(),2),F=k[0],A=k[1],L=d(Object(i.useState)(m.channel.channel_id),2),U=L[0];function D(e){!function(e,t){var n=new FileReader;n.onload=function(){e.f.data=n.result,N(e)},n.readAsDataURL(t)}({f:e.target.files[0],file_name:generateValidFileName(e.target.files[0].name),file_type:e.target.files[0].type.split("/")[1],file_size:e.target.files[0].size,media_type:e.target.files[0].type.split("/")[0],item_type:"topic"},e.target.files[0])}function M(){var e=m.config,t={title:E,body:w,file:S,embedUrl:R,channelId:U};A(Object(o.b)(t,e)),0===F.length&&(b(!0),S?J():W())}function J(){!function(e){Page.cmd("bigfileUploadInit",[e,S.file_size],(function(e){var t=new FormData,n=new XMLHttpRequest;t.append(S.file_name,S.f),n.upload.addEventListener("progress",(function(e){P(parseInt(e.loaded/e.total*100))})),n.upload.addEventListener("loadend",(function(){var e=m.route.section;"new-topic"===e?W():"edit-topic"===e&&H()})),n.withCredentials=!0,n.open("POST",e.url),n.send(t)}))}("merged-"+m.config.merger_name+"/"+m.config.cluster+"/data/users/"+p.site_info.auth_address+"/"+S.file_name)}function W(){var e="merged-"+m.config.merger_name+"/"+m.config.cluster+"/data/users/"+p.site_info.auth_address+"/data.json";Page.cmd("fileGet",{inner_path:e},(function(t){(t=JSON.parse(t))?t.topic||(t.topic=[],t.next_topic_id=1):t={topic:[],next_topic_id:1};var n={topic_id:p.site_info.auth_address+"topic"+t.next_topic_id,channel_id:U,user_id:p.site_info.cert_user_id,title:E,body:w,embed_url:R,type:"topic",added:Date.now()};n.body_p=n.body?n.body.replace(/<\/?[^>]+(>|$)/g,""):"",t.topic.push(n),t.next_topic_id+=1;var i=unescape(encodeURIComponent(JSON.stringify(t,void 0,"\t")));Page.cmd("fileWrite",[e,btoa(i)],(function(t){Page.cmd("sitePublish",{inner_path:e},(function(t){Page.cmd("wrapperNotification",["done","Topic Created!",5e3]),S?z(e,n):window.top.location.href="index.html?v=topic+id="+n.topic_id}))}))}))}function z(e,t){Page.cmd("fileGet",{inner_path:e},(function(n){(n=JSON.parse(n))?(n.file||(n.file=[],n.next_file_id=1),n.file_to_item||(n.file_to_item=[],n.next_file_to_item_id=1)):n={file:[],next_file_id:1,file_to_item:[],next_file_to_item_id:1};var i={file_id:p.site_info.auth_address+"fl"+n.next_file_id,file_type:S.file_type,file_name:S.file_name,item_id:t.topic_id,item_type:"topic",user_id:p.site_info.auth_address,added:Date.now()};n.file.push(i),n.next_file_id+=1;var a={file_to_item_id:p.site_info.auth_address+"fti"+n.next_file_to_item_id,item_type:"topic",item_id:t.topic_id,file_id:i.file_id,cluster_id:m.config.cluster,user_id:i.user_id,added:Date.now()};n.file_to_item.push(a),n.next_file_to_item_id+=1;var r=unescape(encodeURIComponent(JSON.stringify(n,void 0,"\t")));Page.cmd("fileWrite",[e,btoa(r)],(function(n){Page.cmd("sitePublish",{inner_path:e},(function(e){Page.cmd("wrapperNotification",["done","File Created!",5e3]),window.top.location.href="index.html?v=topic+id="+t.topic_id}))}))}))}function G(e){e.preventDefault(),b(!0),S?J():H()}function H(){var t="SELECT * FROM json WHERE json.json_id='"+e.topic.json_id+"'";Page.cmd("dbQuery",[t],(function(t){var n="merged-"+m.config.merger_name+"/"+t[0].directory+"/"+t[0].file_name;Page.cmd("fileGet",{inner_path:n},(function(t){var i=(t=JSON.parse(t)).topic.findIndex((function(t){return t.topic_id===e.topic.topic_id})),a=t.topic[i];a.title=E,a.body=w,a.body_p=a.body.replace(/<\/?[^>]+(>|$)/g,""),a.embed_url=R,t.topic.splice(i,1),t.topic.push(a);var r=unescape(encodeURIComponent(JSON.stringify(t,void 0,"\t")));Page.cmd("fileWrite",[n,btoa(r)],(function(e){Page.cmd("sitePublish",{inner_path:n},(function(e){Page.cmd("wrapperNotification",["done","Topic Updated!",5e3]),S?z(n,a):window.top.location.href="index.html?v=topic+id="+a.topic_id}))}))}))}))}L[1],a.a.useEffect((function(){var e={title:E,body:w,embedUrl:R,channelId:U},t=Object(o.b)(e,m.config);A(t)}),[E,w,U,R]);var V,q,Q,$="",Y="",X="";if(F&&F.length>0){if(F.find((function(e){return"title"===e.field}))){var B=F.find((function(e){return"title"===e.field}));t=a.a.createElement("span",{className:"error-notice"},B.msg),$="error"}if(F.find((function(e){return"channelId"===e.field}))){var K=F.find((function(e){return"channelId"===e.field}));a.a.createElement("span",{className:"error-notice"},K.msg),Y="error"}if(F.find((function(e){return"embedUrl"===e.field}))){var Z=F.find((function(e){return"embedUrl"===e.field}));n=a.a.createElement("span",{className:"error-notice"},Z.msg),X="error"}}S&&("image"===S.media_type?V=a.a.createElement("div",{className:"ui segment item-file-display"},a.a.createElement("img",{src:S.f.data})):"video"!==S.media_type&&"audio"!==S.media_type||(V=a.a.createElement("div",{className:"ui segment item-file-display"},a.a.createElement(i.Suspense,{fallback:a.a.createElement(l.a,null)},a.a.createElement(f,{filePath:S.f.data,fileType:S.file_type,mediaType:S.media_type}))))),e.topic&&e.topic.file_id?q=a.a.createElement("div",{className:"form-row ui segment"},a.a.createElement("div",{className:"topic-file-menu"},a.a.createElement("button",{className:"native-btn",type:"button",onClick:function(){var t="SELECT * FROM json WHERE json_id='"+e.topic.json_id+"'";Page.cmd("dbQuery",[t],function(t){!function(t,n){Page.cmd("fileGet",{inner_path:t+"/data.json"},(function(i){var a=(i=JSON.parse(i)).file.findIndex((function(t){return t.file_id===e.topic.file_id})),r=i.file_to_item.findIndex((function(t){return t.file_to_item_id===e.topic.file_to_item_id}));i.file.splice(a,1),i.file_to_item.splice(r,1);var o=unescape(encodeURIComponent(JSON.stringify(i,void 0,"\t")));Page.cmd("fileWrite",[t+"/data.json",btoa(o)],(function(i){Page.cmd("sitePublish",{inner_path:t+"/data.json"},(function(i){!function(t,n){Page.cmd("fileDelete",{inner_path:t+"/"+n},(function(t){e.getTopic()}))}(t,n)}))}))}))}("merged-"+m.config.merger_name+"/"+t[0].directory,e.topic.file_name)}.bind(this))}},a.a.createElement("a",null,a.a.createElement("i",{className:"icon trash"})))),a.a.createElement(c.a,{topic:e.topic})):Q=a.a.createElement("input",{type:"file",onChange:D});var ee,te,ne,ie=a.a.createElement("div",{className:"editor-wrapper"},a.a.createElement(i.Suspense,{fallback:a.a.createElement(l.a,null)},a.a.createElement(u,{textAreaId:"editor",onTextUpdate:function(e){O(e)},placeholder:"topic description... ",rows:"8",initialValue:""})));m.channel&&(ee=m.channel.name);var ae,re,oe,le=m.route;if("new-topic"===le.section?(te=a.a.createElement("button",{type:"button",onClick:M,className:"native-btn submit-btn"},a.a.createElement("a",null,"create topic")),ne=a.a.createElement("div",{className:"form-row field "+Y},a.a.createElement("label",null,"Create new Topic in Channel: ",ee))):"edit-topic"===le.section&&(te=a.a.createElement("button",{type:"button",onClick:G,className:"native-btn submit-btn"},a.a.createElement("a",null,"update topic")),ne=a.a.createElement("div",{className:"form-row field "+Y},a.a.createElement("label",null,"Edit your Topic in Channel: ",ee))),F&&F.length>0){var ce=F.map((function(e,t){return a.a.createElement("li",{key:t},e.field," - ",e.msg)}));ae=a.a.createElement("ul",{id:"topic-form-errors-display"},ce)}if(I){var de="ui active progress",se="upload file";100===I&&(de+=" success",se="file uploaded!"),re=a.a.createElement("div",{className:de},a.a.createElement("div",{className:"bar",style:{width:I+"%"}},a.a.createElement("div",{className:"progress"})),a.a.createElement("div",{className:"label"},se))}if(g){var fe="creating topic";"edit-topic"===le.section&&(fe="updating topic"),oe=a.a.createElement("div",{className:"ui active inverted dimmer"},a.a.createElement("div",{className:"ui text loader"},fe,"..."))}return a.a.createElement("div",{id:"topic-form-container",className:"form-container"},a.a.createElement("form",{id:"topic-form",className:"ui segment form"},oe,ne,a.a.createElement("div",{className:"form-row field "+$},a.a.createElement("label",null,"Title"),a.a.createElement("input",{type:"text",onChange:function(e){h(e.target.value)},defaultValue:E}),t),a.a.createElement("div",{className:"form-row field "},a.a.createElement("label",null,"Text"),ie),a.a.createElement("hr",null),a.a.createElement("div",{className:"form-row field "+X},a.a.createElement("label",null,"Embed URL from ",a.a.createElement("a",{href:"/12MVkvYGcRW6u2NYbpfwVad1oQeyG4s9Er"},"IFS")),a.a.createElement("input",{type:"text",onChange:function(e){T(e.target.value)},defaultValue:R}),n),a.a.createElement("div",{className:"form-row field "},a.a.createElement("label",null,"File"),Q,V,q),re,a.a.createElement("div",{className:"form-row field"},ae,te)))}},27:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return c}));var i=function(e){return"SELECT * FROM file_to_item AS fti WHERE fti.file_to_item_id='"+e+"'"},a=function(e){var t="SELECT f.*, j.* ";return t+="FROM file f ",t+="LEFT JOIN json AS j ON f.json_id=j.json_id ",t+="WHERE f.file_id='"+e+"'"},r=function(e){var t;return"jpg"===e||"png"===e||"jpeg"===e||"gif"===e?t="image":"avi"===e||"mpeg"===e||"webm"===e||"ogg"===e||"mp4"===e?t="video":"mp3"!==e&&"wav"!==e||(t="audio"),t},o=function(e){return e.replace(/[^\x20-\x7E]+/g,l()).replace(/ /g,"_").replace(/[&\/\\#,+()$~%'":*?!<>|{}\[\]]/g,l())},l=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<1;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},c=function(e){for(var t=[],n=0;n<e.pieces;n++){var i={};i.index=n,i.start=1048576*i.index,i.end=1048576*(i.index+1),n<e.pieces_downloaded?i.state="complete":n===e.pieces_downloaded&&(i.state="downloading"),t.push(i)}return t}},29:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));var i=n(0),a=n.n(i),r=n(1),o=n(27),l=n(2);function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){d(e,t,n[t])}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,a=!1,r=void 0;try{for(var o,l=e[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){a=!0,r=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw r}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var u=Object(i.lazy)((function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,31))})),m=function(e){var t,n=Object(i.useContext)(r.a),d=n.appState,f=n.zeroNetState;e.topic?t=e.topic:e.comment?t=e.comment:e.profile&&(t=e.profile);var m=s(Object(i.useState)(t),2),p=m[0],g=(m[1],s(Object(i.useState)(!0),2)),b=g[0],v=g[1],E=s(Object(i.useState)(""),2),h=(E[0],E[1]),y=s(Object(i.useState)(""),2),w=y[0],O=y[1],j=s(Object(i.useState)(""),2),S=j[0],N=j[1],x=s(Object(i.useState)(""),2),I=x[0],P=x[1],C=s(Object(i.useState)(""),2),R=C[0],T=C[1],k=s(Object(i.useState)(""),2),F=k[0],A=k[1],L=s(Object(i.useState)(""),2),U=L[0],D=L[1],M=s(Object(i.useState)(!1),2),J=M[0],W=M[1],z=s(Object(i.useState)(""),2),G=z[0],H=z[1],V=s(Object(i.useState)(""),2),q=V[0],Q=V[1],$=s(Object(i.useState)(""),2),Y=$[0],X=$[1],B=s(Object(i.useState)(!1),2),K=B[0],Z=B[1];function ee(){if(p.file_to_item_id){h(!0);var e=Object(o.d)(p.file_to_item_id);Page.cmd("dbQuery",[e],(function(e){e.length>0?te(e[0].file_id):console.log("no file to item")}))}else te()}function te(e){var t;t=e?Object(o.c)(e):"SELECT * FROM file WHERE item_id='"+p.topic_id+"'",Page.cmd("dbQuery",[t],(function(e){if(e.length>0){var t=e[0],n=Object(o.a)(t.file_type),i=d.config,a=t.directory;t.directory||(a=i.cluster+"/data/users/"+t.user_id),ne("merged-"+i.merger_name+"/"+a+"/"+t.file_name,n,t.file_type)}else console.log("no file")}))}function ne(e,t,n){Page.cmd("optionalFileInfo",e,(function(i){var a,r;i&&(a=i.peer,r=Object(o.e)(i)),O(e);var l=f.user_settings,c=!1;l&&l.deleted_items&&l.deleted_items.indexOf(e)>-1&&(c=!0),Z(c),N(n),P(t),T(a),A(r),v(!1);var d=i&&1===i.is_downloaded&&1===i.is_downloading;(i&&!i.uploaded||d)&&(i.pieces===i.pieces_downloaded?D("downloaded"):(D("downloading"),function(e,t){var n=t&&1===t.is_downloaded&&1===t.is_downloading;if(!t.uploaded||n)if(t.pieces===t.pieces_downloaded)D("downloaded");else{1===t.is_downloading||t.is_downloaded,t.pieces_downloaded>0||t.bytes_downloaded;D("downloading"),ie(t,e)}}(e,i)))}))}function ie(e,t){Page.cmd("fileNeed",t,(function(e){Page.onRequest=function(e,n){var i,a,r,l=t.split("/")[1],d=t.split(l+"/")[1];n.event[0]&&(i=n.event[0]),n.event[1]&&(a=n.event[1]),a&&a.indexOf("|")>-1&&(r=a.split("|")[1],a=a.split("|")[0]),"setSiteInfo"==e&&a===d&&("file_failed"===i?(!function(e,t){var n=parseInt(e.split("-")[0]),i=parseInt(e.split("-")[1]),a=F.map((function(e){if(e.start===n||e.end===i)return"file_failed"===t?c({},e,{state:"failed"}):e}));A(a)}(r,i),D("download failed")):Page.cmd("optionalFileInfo",t,(function(e){var t=Object(o.e)(e);A(t),clearInterval(checkDownloadDuration)})))}}))}a.a.useEffect((function(){!function(){var t;e.topic?t=e.topic:e.comment?t=e.comment:e.profile&&(t=e.profile);t.file_to_item_id||t.added<=1498441955800?ee():t.embed_url&&function(e){var t=e.embed_url.lastIndexOf("."),n=e.embed_url.substring(t+1),i=Object(o.a)(n),a=!1;(e.embed_url.indexOf("http:")>-1||e.embed_url.indexOf("https:")>-1)&&(a=!0);a?function(e,t,n){O(e);var i=f.user_settings,a=!1;i&&i.deleted_items&&i.deleted_items.indexOf(e)>-1&&(a=!0);Z(a),N(n),P(t),v(!1),W(!0),H(!1)}(e.embed_url,i,n):ne(e.embed_url,i,n)}(t)}()}),[]);var ae,re,oe,le,ce="item-media-container";if(!0===J&&(le=e.topic.embed_url),!0===b)ae=a.a.createElement(l.a,{cssClass:"centered",msg:"Loading Item Media..."});else if(I)if(!0!==J||G){var de;if(!0===J)re=a.a.createElement("div",{className:"item-media-peers-display red"},"external");else de=!1===K?a.a.createElement("span",null,a.a.createElement("a",{onClick:function(){return function(){var t=f.user_settings;t.deleted_items||(t.deleted_items=[]);var n=w;t.deleted_items&&-1===t.deleted_items.indexOf(n)&&t.deleted_items.push(n),Page.cmd("userSetSettings",{settings:t},function(t){Page.cmd("optionalFileDelete",n,function(t){Page.cmd("optionalFileDelete",n+".piecemap.msgpack",function(t){window.top.location.href="index.html?v=topic+id="+e.topic.topic_id}.bind(this))}.bind(this))}.bind(this))}()}},a.a.createElement("i",{className:"trash icon red"}))):a.a.createElement("span",null,a.a.createElement("a",{onClick:function(){return t=f.user_settings,n=t.deleted_items.findIndex((function(e){return e===w})),t.deleted_items.splice(n),void Page.cmd("userSetSettings",{settings:t},(function(t){window.top.location.href="index.html?v=topic+id="+e.topic.topic_id}));var t,n}},a.a.createElement("i",{className:"cloud download icon green"}))),re=a.a.createElement("div",{className:"item-media-peers-display"},a.a.createElement("span",null,"peers : ",R," | "),de);!0===K?ae=a.a.createElement("div",{className:"file-deleted-container"},a.a.createElement("i",{className:"icon trash red huge"}),a.a.createElement("p",null,"file is deleted")):(F&&F.length>0&&(oe=a.a.createElement(_,{piecesInfo:F,downloadState:U}),ce+=" w-pieces "),"image"===I?(ce+=" image",q||(ce+=" image-loading ui segment"),ae=!0===Y?a.a.createElement("img",{className:"not-found",src:"assets/img/404-not-found.png"}):a.a.createElement("div",null,a.a.createElement("img",{onError:function(){Q(!0),X(!0)},onLoad:function(){Q(!0)},src:w}),le)):"video"!==I&&"audio"!==I||(ae=a.a.createElement("div",null,a.a.createElement(i.Suspense,{fallback:a.a.createElement(l.a,null)},a.a.createElement(u,{filePath:w,fileType:S,mediaType:I,comment:e.comment})),le),ce+=" video"))}else ae=a.a.createElement("div",{onClick:function(){H(!0)}},a.a.createElement("div",{className:"external-link-overlay"},"External!",a.a.createElement("br",null),"Load?"),le);else ae=a.a.createElement("img",{className:"not-found",src:"assets/img/404-not-found.png"});return a.a.createElement("div",{className:ce},ae,re,oe)},p=function(e){var t,n,r=s(Object(i.useState)(!0),2),l=(r[0],r[1]),d=s(Object(i.useState)(""),2),f=(d[0],d[1],s(Object(i.useState)(e.innerPath),2)),u=f[0],m=(f[1],s(Object(i.useState)(""),2)),p=m[0],g=m[1],b=s(Object(i.useState)(""),2),v=(b[0],b[1]),E=s(Object(i.useState)(""),2),h=(E[0],E[1]),y=s(Object(i.useState)(""),2),w=y[0],O=y[1],j=s(Object(i.useState)(""),2),S=j[0],N=j[1];return a.a.useEffect((function(){Page.cmd("optionalFileInfo",u,(function(e){var t,n;e&&(t=e.peer,n=Object(o.e)(e));var i=u.lastIndexOf("."),a=u.substring(i+1),r=Object(o.a)(p);g(a),v(r),h(t),O(n),l(!0);var d,s=e&&1===e.is_downloaded&&1===e.is_downloading;e.uploaded&&!s||(N("downloading"),d=u,Page.cmd("fileNeed",d,(function(e){Page.onRequest=function(e,t){var n,i,a,r=d.split("/")[1],l=d.split(r+"/")[1];t.event[0]&&(n=t.event[0]),t.event[1]&&(i=t.event[1]),i&&i.indexOf("|")>-1&&(a=i.split("|")[1],i=i.split("|")[0]),"setSiteInfo"==e&&i===l&&("file_failed"===n?(function(e,t){var n=parseInt(e.split("-")[0]),i=parseInt(e.split("-")[1]),a=w.map((function(e){if(e.start===n||e.end===i)return"file_failed"===t?c({},e,{state:"failed"}):e}));O(a)}(a,n),N("download failed")):Page.cmd("optionalFileInfo",d,(function(e){var t=Object(o.e)(e);O(t),clearInterval(checkDownloadDuration)})))}})))}))}),[]),w&&w.length>0&&(t=a.a.createElement(_,{piecesInfo:w,downloadState:S}),n+=" w-pieces "),a.a.createElement("div",{className:"unassigned-media-item-infobar "+n},t)},_=function(e){var t,n="";return e.piecesInfo.length>0?t=e.piecesInfo.map((function(t,n){return a.a.createElement(g,{key:n,piece:t,piecesLength:e.piecesInfo.length})})):e.fileInfo&&1===e.fileInfo.is_downloaded&&(n="non-bfs-loaded"),a.a.createElement("div",{className:"item-file-piece-download-info-container "+n},t,a.a.createElement("span",{className:"download-status"},e.downloadState))},g=function(e){var t=100/e.piecesLength,n="ui progress ";return"complete"===e.piece.state?n+=" success":"downloading"===e.piece.state?n+=" active":"failed"===e.piece.state&&(n+="error"),a.a.createElement("div",{style:{width:t+"%"},className:"piece "+e.piece.state},a.a.createElement("div",{className:n},a.a.createElement("div",{className:"bar"},a.a.createElement("div",{className:"progress"}))))}},42:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var i=function(e,t){var n=[];if(!e.title){n.push({field:"title",msg:"title is required"})}if("0"===e.channelId||!e.channelId){n.push({field:"channelId",msg:"channel is required"})}if(e.embed_url&&!e.embed_url.startsWith("merged-"+t.merger_name)){var i={field:"embedUrl",msg:'embed url must start with "merged-'+t.merger_name+'"'};n.push(i)}return n},a=function(e){var t=[];if(!e.text&&!e.file){t.push({msg:"can't post empty comment!"})}return t}}}]);