!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){"use strict";var n=[],r=e.document,i=Object.getPrototypeOf,o=n.slice,a=n.concat,s=n.push,u=n.indexOf,l={},c=l.toString,f=l.hasOwnProperty,p=f.toString,d=p.call(Object),h={},g=function e(t){return"function"==typeof t&&"number"!=typeof t.nodeType},y=function e(t){return null!=t&&t===t.window},v={type:!0,src:!0,noModule:!0};function m(e,t,n){var i,o=(t=t||r).createElement("script");if(o.text=e,n)for(i in v)n[i]&&(o[i]=n[i]);t.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[c.call(e)]||"object":typeof e}var b="3.3.1",w=function(e,t){return new w.fn.init(e,t)},T=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.fn=w.prototype={jquery:"3.3.1",constructor:w,length:0,toArray:function(){return o.call(this)},get:function(e){return null==e?o.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||g(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(r=e[t])&&(l&&r&&(w.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=n&&Array.isArray(n)?n:[]):o=n&&w.isPlainObject(n)?n:{},a[t]=w.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},w.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==c.call(e))&&(!(t=i(e))||"function"==typeof(n=f.call(t,"constructor")&&t.constructor)&&p.call(n)===d)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){m(e)},each:function(e,t){var n,r=0;if(C(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(T,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(C(Object(e))?w.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:u.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],o=0,a=e.length,s=!n;o<a;o++)(r=!t(e[o],o))!==s&&i.push(e[o]);return i},map:function(e,t,n){var r,i,o=0,s=[];if(C(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&s.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&s.push(i);return a.apply([],s)},guid:1,support:h}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function C(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!g(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}var E=function(e){var t,n,r,i,o,a,s,u,l,c,f,p,d,h,g,y,v,m,x,b="sizzle"+1*new Date,w=e.document,T=0,C=0,E=ae(),k=ae(),S=ae(),D=function(e,t){return e===t&&(f=!0),0},N={}.hasOwnProperty,A=[],j=A.pop,q=A.push,L=A.push,H=A.slice,O=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},P="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\x00-\\xa0])+",I="\\["+M+"*("+R+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+R+"))|)"+M+"*\\]",W=":("+R+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+I+")*)|.*)\\)|)",$=new RegExp(M+"+","g"),B=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),F=new RegExp("^"+M+"*,"+M+"*"),_=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),z=new RegExp("="+M+"*([^\\]'\"]*?)"+M+"*\\]","g"),X=new RegExp(W),U=new RegExp("^"+R+"$"),V={ID:new RegExp("^#("+R+")"),CLASS:new RegExp("^\\.("+R+")"),TAG:new RegExp("^("+R+"|[*])"),ATTR:new RegExp("^"+I),PSEUDO:new RegExp("^"+W),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+P+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},G=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,K=/[+~]/,Z=new RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),ee=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},te=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ne=function(e,t){return t?"\x00"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},re=function(){p()},ie=me(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{L.apply(A=H.call(w.childNodes),w.childNodes),A[w.childNodes.length].nodeType}catch(e){L={apply:A.length?function(e,t){q.apply(e,H.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function oe(e,t,r,i){var o,s,l,c,f,h,v,m=t&&t.ownerDocument,T=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==T&&9!==T&&11!==T)return r;if(!i&&((t?t.ownerDocument||t:w)!==d&&p(t),t=t||d,g)){if(11!==T&&(f=J.exec(e)))if(o=f[1]){if(9===T){if(!(l=t.getElementById(o)))return r;if(l.id===o)return r.push(l),r}else if(m&&(l=m.getElementById(o))&&x(t,l)&&l.id===o)return r.push(l),r}else{if(f[2])return L.apply(r,t.getElementsByTagName(e)),r;if((o=f[3])&&n.getElementsByClassName&&t.getElementsByClassName)return L.apply(r,t.getElementsByClassName(o)),r}if(n.qsa&&!S[e+" "]&&(!y||!y.test(e))){if(1!==T)m=t,v=e;else if("object"!==t.nodeName.toLowerCase()){(c=t.getAttribute("id"))?c=c.replace(te,ne):t.setAttribute("id",c=b),s=(h=a(e)).length;while(s--)h[s]="#"+c+" "+ve(h[s]);v=h.join(","),m=K.test(e)&&ge(t.parentNode)||t}if(v)try{return L.apply(r,m.querySelectorAll(v)),r}catch(e){}finally{c===b&&t.removeAttribute("id")}}}return u(e.replace(B,"$1"),t,r,i)}function ae(){var e=[];function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}return t}function se(e){return e[b]=!0,e}function ue(e){var t=d.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function le(e,t){var n=e.split("|"),i=n.length;while(i--)r.attrHandle[n[i]]=t}function ce(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function fe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function pe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function de(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ie(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function he(e){return se(function(t){return t=+t,se(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function ge(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}n=oe.support={},o=oe.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},p=oe.setDocument=function(e){var t,i,a=e?e.ownerDocument||e:w;return a!==d&&9===a.nodeType&&a.documentElement?(d=a,h=d.documentElement,g=!o(d),w!==d&&(i=d.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",re,!1):i.attachEvent&&i.attachEvent("onunload",re)),n.attributes=ue(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ue(function(e){return e.appendChild(d.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Q.test(d.getElementsByClassName),n.getById=ue(function(e){return h.appendChild(e).id=b,!d.getElementsByName||!d.getElementsByName(b).length}),n.getById?(r.filter.ID=function(e){var t=e.replace(Z,ee);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(r.filter.ID=function(e){var t=e.replace(Z,ee);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},r.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&g){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),r.find.TAG=n.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&g)return t.getElementsByClassName(e)},v=[],y=[],(n.qsa=Q.test(d.querySelectorAll))&&(ue(function(e){h.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&y.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||y.push("\\["+M+"*(?:value|"+P+")"),e.querySelectorAll("[id~="+b+"-]").length||y.push("~="),e.querySelectorAll(":checked").length||y.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||y.push(".#.+[+~]")}),ue(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=d.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&y.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&y.push(":enabled",":disabled"),h.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&y.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),y.push(",.*:")})),(n.matchesSelector=Q.test(m=h.matches||h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ue(function(e){n.disconnectedMatch=m.call(e,"*"),m.call(e,"[s!='']:x"),v.push("!=",W)}),y=y.length&&new RegExp(y.join("|")),v=v.length&&new RegExp(v.join("|")),t=Q.test(h.compareDocumentPosition),x=t||Q.test(h.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},D=t?function(e,t){if(e===t)return f=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===d||e.ownerDocument===w&&x(w,e)?-1:t===d||t.ownerDocument===w&&x(w,t)?1:c?O(c,e)-O(c,t):0:4&r?-1:1)}:function(e,t){if(e===t)return f=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e===d?-1:t===d?1:i?-1:o?1:c?O(c,e)-O(c,t):0;if(i===o)return ce(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?ce(a[r],s[r]):a[r]===w?-1:s[r]===w?1:0},d):d},oe.matches=function(e,t){return oe(e,null,null,t)},oe.matchesSelector=function(e,t){if((e.ownerDocument||e)!==d&&p(e),t=t.replace(z,"='$1']"),n.matchesSelector&&g&&!S[t+" "]&&(!v||!v.test(t))&&(!y||!y.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return oe(t,d,null,[e]).length>0},oe.contains=function(e,t){return(e.ownerDocument||e)!==d&&p(e),x(e,t)},oe.attr=function(e,t){(e.ownerDocument||e)!==d&&p(e);var i=r.attrHandle[t.toLowerCase()],o=i&&N.call(r.attrHandle,t.toLowerCase())?i(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},oe.escape=function(e){return(e+"").replace(te,ne)},oe.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},oe.uniqueSort=function(e){var t,r=[],i=0,o=0;if(f=!n.detectDuplicates,c=!n.sortStable&&e.slice(0),e.sort(D),f){while(t=e[o++])t===e[o]&&(i=r.push(o));while(i--)e.splice(r[i],1)}return c=null,e},i=oe.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===o||4===o)return e.nodeValue}else while(t=e[r++])n+=i(t);return n},(r=oe.selectors={cacheLength:50,createPseudo:se,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Z,ee),e[3]=(e[3]||e[4]||e[5]||"").replace(Z,ee),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||oe.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&oe.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return V.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=a(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Z,ee).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=E[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&E(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=oe.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace($," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,f,p,d,h,g=o!==a?"nextSibling":"previousSibling",y=t.parentNode,v=s&&t.nodeName.toLowerCase(),m=!u&&!s,x=!1;if(y){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===v:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?y.firstChild:y.lastChild],a&&m){x=(d=(l=(c=(f=(p=y)[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===T&&l[1])&&l[2],p=d&&y.childNodes[d];while(p=++d&&p&&p[g]||(x=d=0)||h.pop())if(1===p.nodeType&&++x&&p===t){c[e]=[T,d,x];break}}else if(m&&(x=d=(l=(c=(f=(p=t)[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===T&&l[1]),!1===x)while(p=++d&&p&&p[g]||(x=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===v:1===p.nodeType)&&++x&&(m&&((c=(f=p[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]=[T,x]),p===t))break;return(x-=i)===r||x%r==0&&x/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||oe.error("unsupported pseudo: "+e);return i[b]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?se(function(e,n){var r,o=i(e,t),a=o.length;while(a--)e[r=O(e,o[a])]=!(n[r]=o[a])}):function(e){return i(e,0,n)}):i}},pseudos:{not:se(function(e){var t=[],n=[],r=s(e.replace(B,"$1"));return r[b]?se(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}}),has:se(function(e){return function(t){return oe(e,t).length>0}}),contains:se(function(e){return e=e.replace(Z,ee),function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:se(function(e){return U.test(e||"")||oe.error("unsupported lang: "+e),e=e.replace(Z,ee).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:de(!1),disabled:de(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return Y.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:he(function(){return[0]}),last:he(function(e,t){return[t-1]}),eq:he(function(e,t,n){return[n<0?n+t:n]}),even:he(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:he(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:he(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:he(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=r.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=fe(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=pe(t);function ye(){}ye.prototype=r.filters=r.pseudos,r.setFilters=new ye,a=oe.tokenize=function(e,t){var n,i,o,a,s,u,l,c=k[e+" "];if(c)return t?0:c.slice(0);s=e,u=[],l=r.preFilter;while(s){n&&!(i=F.exec(s))||(i&&(s=s.slice(i[0].length)||s),u.push(o=[])),n=!1,(i=_.exec(s))&&(n=i.shift(),o.push({value:n,type:i[0].replace(B," ")}),s=s.slice(n.length));for(a in r.filter)!(i=V[a].exec(s))||l[a]&&!(i=l[a](i))||(n=i.shift(),o.push({value:n,type:a,matches:i}),s=s.slice(n.length));if(!n)break}return t?s.length:s?oe.error(e):k(e,u).slice(0)};function ve(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function me(e,t,n){var r=t.dir,i=t.next,o=i||r,a=n&&"parentNode"===o,s=C++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||a)return e(t,n,i);return!1}:function(t,n,u){var l,c,f,p=[T,s];if(u){while(t=t[r])if((1===t.nodeType||a)&&e(t,n,u))return!0}else while(t=t[r])if(1===t.nodeType||a)if(f=t[b]||(t[b]={}),c=f[t.uniqueID]||(f[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((l=c[o])&&l[0]===T&&l[1]===s)return p[2]=l[2];if(c[o]=p,p[2]=e(t,n,u))return!0}return!1}}function xe(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function be(e,t,n){for(var r=0,i=t.length;r<i;r++)oe(e,t[r],n);return n}function we(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Te(e,t,n,r,i,o){return r&&!r[b]&&(r=Te(r)),i&&!i[b]&&(i=Te(i,o)),se(function(o,a,s,u){var l,c,f,p=[],d=[],h=a.length,g=o||be(t||"*",s.nodeType?[s]:s,[]),y=!e||!o&&t?g:we(g,p,e,s,u),v=n?i||(o?e:h||r)?[]:a:y;if(n&&n(y,v,s,u),r){l=we(v,d),r(l,[],s,u),c=l.length;while(c--)(f=l[c])&&(v[d[c]]=!(y[d[c]]=f))}if(o){if(i||e){if(i){l=[],c=v.length;while(c--)(f=v[c])&&l.push(y[c]=f);i(null,v=[],l,u)}c=v.length;while(c--)(f=v[c])&&(l=i?O(o,f):p[c])>-1&&(o[l]=!(a[l]=f))}}else v=we(v===a?v.splice(h,v.length):v),i?i(null,a,v,u):L.apply(a,v)})}function Ce(e){for(var t,n,i,o=e.length,a=r.relative[e[0].type],s=a||r.relative[" "],u=a?1:0,c=me(function(e){return e===t},s,!0),f=me(function(e){return O(t,e)>-1},s,!0),p=[function(e,n,r){var i=!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):f(e,n,r));return t=null,i}];u<o;u++)if(n=r.relative[e[u].type])p=[me(xe(p),n)];else{if((n=r.filter[e[u].type].apply(null,e[u].matches))[b]){for(i=++u;i<o;i++)if(r.relative[e[i].type])break;return Te(u>1&&xe(p),u>1&&ve(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(B,"$1"),n,u<i&&Ce(e.slice(u,i)),i<o&&Ce(e=e.slice(i)),i<o&&ve(e))}p.push(n)}return xe(p)}function Ee(e,t){var n=t.length>0,i=e.length>0,o=function(o,a,s,u,c){var f,h,y,v=0,m="0",x=o&&[],b=[],w=l,C=o||i&&r.find.TAG("*",c),E=T+=null==w?1:Math.random()||.1,k=C.length;for(c&&(l=a===d||a||c);m!==k&&null!=(f=C[m]);m++){if(i&&f){h=0,a||f.ownerDocument===d||(p(f),s=!g);while(y=e[h++])if(y(f,a||d,s)){u.push(f);break}c&&(T=E)}n&&((f=!y&&f)&&v--,o&&x.push(f))}if(v+=m,n&&m!==v){h=0;while(y=t[h++])y(x,b,a,s);if(o){if(v>0)while(m--)x[m]||b[m]||(b[m]=j.call(u));b=we(b)}L.apply(u,b),c&&!o&&b.length>0&&v+t.length>1&&oe.uniqueSort(u)}return c&&(T=E,l=w),x};return n?se(o):o}return s=oe.compile=function(e,t){var n,r=[],i=[],o=S[e+" "];if(!o){t||(t=a(e)),n=t.length;while(n--)(o=Ce(t[n]))[b]?r.push(o):i.push(o);(o=S(e,Ee(i,r))).selector=e}return o},u=oe.select=function(e,t,n,i){var o,u,l,c,f,p="function"==typeof e&&e,d=!i&&a(e=p.selector||e);if(n=n||[],1===d.length){if((u=d[0]=d[0].slice(0)).length>2&&"ID"===(l=u[0]).type&&9===t.nodeType&&g&&r.relative[u[1].type]){if(!(t=(r.find.ID(l.matches[0].replace(Z,ee),t)||[])[0]))return n;p&&(t=t.parentNode),e=e.slice(u.shift().value.length)}o=V.needsContext.test(e)?0:u.length;while(o--){if(l=u[o],r.relative[c=l.type])break;if((f=r.find[c])&&(i=f(l.matches[0].replace(Z,ee),K.test(u[0].type)&&ge(t.parentNode)||t))){if(u.splice(o,1),!(e=i.length&&ve(u)))return L.apply(n,i),n;break}}}return(p||s(e,d))(i,t,!g,n,!t||K.test(e)&&ge(t.parentNode)||t),n},n.sortStable=b.split("").sort(D).join("")===b,n.detectDuplicates=!!f,p(),n.sortDetached=ue(function(e){return 1&e.compareDocumentPosition(d.createElement("fieldset"))}),ue(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||le("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ue(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||le("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ue(function(e){return null==e.getAttribute("disabled")})||le(P,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),oe}(e);w.find=E,w.expr=E.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=E.uniqueSort,w.text=E.getText,w.isXMLDoc=E.isXML,w.contains=E.contains,w.escapeSelector=E.escape;var k=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&w(e).is(n))break;r.push(e)}return r},S=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},D=w.expr.match.needsContext;function N(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var A=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,t,n){return g(t)?w.grep(e,function(e,r){return!!t.call(e,r,e)!==n}):t.nodeType?w.grep(e,function(e){return e===t!==n}):"string"!=typeof t?w.grep(e,function(e){return u.call(t,e)>-1!==n}):w.filter(t,e,n)}w.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},w.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;t<r;t++)if(w.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)w.find(e,i[t],n);return r>1?w.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&D.test(e)?w(e):e||[],!1).length}});var q,L=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(e,t,n){var i,o;if(!e)return this;if(n=n||q,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:L.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:r,!0)),A.test(i[1])&&w.isPlainObject(t))for(i in t)g(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(o=r.getElementById(i[2]))&&(this[0]=o,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):g(e)?void 0!==n.ready?n.ready(e):e(w):w.makeArray(e,this)}).prototype=w.fn,q=w(r);var H=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};w.fn.extend({has:function(e){var t=w(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(w.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&w(e);if(!D.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?w.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?u.call(w(e),this[0]):u.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function P(e,t){while((e=e[t])&&1!==e.nodeType);return e}w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return k(e,"parentNode")},parentsUntil:function(e,t,n){return k(e,"parentNode",n)},next:function(e){return P(e,"nextSibling")},prev:function(e){return P(e,"previousSibling")},nextAll:function(e){return k(e,"nextSibling")},prevAll:function(e){return k(e,"previousSibling")},nextUntil:function(e,t,n){return k(e,"nextSibling",n)},prevUntil:function(e,t,n){return k(e,"previousSibling",n)},siblings:function(e){return S((e.parentNode||{}).firstChild,e)},children:function(e){return S(e.firstChild)},contents:function(e){return N(e,"iframe")?e.contentDocument:(N(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},function(e,t){w.fn[e]=function(n,r){var i=w.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=w.filter(r,i)),this.length>1&&(O[e]||w.uniqueSort(i),H.test(e)&&i.reverse()),this.pushStack(i)}});var M=/[^\x20\t\r\n\f]+/g;function R(e){var t={};return w.each(e.match(M)||[],function(e,n){t[n]=!0}),t}w.Callbacks=function(e){e="string"==typeof e?R(e):w.extend({},e);var t,n,r,i,o=[],a=[],s=-1,u=function(){for(i=i||e.once,r=t=!0;a.length;s=-1){n=a.shift();while(++s<o.length)!1===o[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=o.length,n=!1)}e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},l={add:function(){return o&&(n&&!t&&(s=o.length-1,a.push(n)),function t(n){w.each(n,function(n,r){g(r)?e.unique&&l.has(r)||o.push(r):r&&r.length&&"string"!==x(r)&&t(r)})}(arguments),n&&!t&&u()),this},remove:function(){return w.each(arguments,function(e,t){var n;while((n=w.inArray(t,o,n))>-1)o.splice(n,1),n<=s&&s--}),this},has:function(e){return e?w.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||t||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],a.push(n),t||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l};function I(e){return e}function W(e){throw e}function $(e,t,n,r){var i;try{e&&g(i=e.promise)?i.call(e).done(t).fail(n):e&&g(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}w.extend({Deferred:function(t){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},"catch":function(e){return i.then(null,e)},pipe:function(){var e=arguments;return w.Deferred(function(t){w.each(n,function(n,r){var i=g(e[r[4]])&&e[r[4]];o[r[1]](function(){var e=i&&i.apply(this,arguments);e&&g(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,i?[e]:arguments)})}),e=null}).promise()},then:function(t,r,i){var o=0;function a(t,n,r,i){return function(){var s=this,u=arguments,l=function(){var e,l;if(!(t<o)){if((e=r.apply(s,u))===n.promise())throw new TypeError("Thenable self-resolution");l=e&&("object"==typeof e||"function"==typeof e)&&e.then,g(l)?i?l.call(e,a(o,n,I,i),a(o,n,W,i)):(o++,l.call(e,a(o,n,I,i),a(o,n,W,i),a(o,n,I,n.notifyWith))):(r!==I&&(s=void 0,u=[e]),(i||n.resolveWith)(s,u))}},c=i?l:function(){try{l()}catch(e){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(e,c.stackTrace),t+1>=o&&(r!==W&&(s=void 0,u=[e]),n.rejectWith(s,u))}};t?c():(w.Deferred.getStackHook&&(c.stackTrace=w.Deferred.getStackHook()),e.setTimeout(c))}}return w.Deferred(function(e){n[0][3].add(a(0,e,g(i)?i:I,e.notifyWith)),n[1][3].add(a(0,e,g(t)?t:I)),n[2][3].add(a(0,e,g(r)?r:W))}).promise()},promise:function(e){return null!=e?w.extend(e,i):i}},o={};return w.each(n,function(e,t){var a=t[2],s=t[5];i[t[1]]=a.add,s&&a.add(function(){r=s},n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),a.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=a.fireWith}),i.promise(o),t&&t.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),i=o.call(arguments),a=w.Deferred(),s=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?o.call(arguments):n,--t||a.resolveWith(r,i)}};if(t<=1&&($(e,a.done(s(n)).resolve,a.reject,!t),"pending"===a.state()||g(i[n]&&i[n].then)))return a.then();while(n--)$(i[n],s(n),a.reject);return a.promise()}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&B.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},w.readyException=function(t){e.setTimeout(function(){throw t})};var F=w.Deferred();w.fn.ready=function(e){return F.then(e)["catch"](function(e){w.readyException(e)}),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||F.resolveWith(r,[w]))}}),w.ready.then=F.then;function _(){r.removeEventListener("DOMContentLoaded",_),e.removeEventListener("load",_),w.ready()}"complete"===r.readyState||"loading"!==r.readyState&&!r.documentElement.doScroll?e.setTimeout(w.ready):(r.addEventListener("DOMContentLoaded",_),e.addEventListener("load",_));var z=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===x(n)){i=!0;for(s in n)z(e,t,s,n[s],!0,o,a)}else if(void 0!==r&&(i=!0,g(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(w(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},X=/^-ms-/,U=/-([a-z])/g;function V(e,t){return t.toUpperCase()}function G(e){return e.replace(X,"ms-").replace(U,V)
}var Y=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function Q(){this.expando=w.expando+Q.uid++}Q.uid=1,Q.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Y(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[G(t)]=n;else for(r in t)i[G(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][G(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(G):(t=G(t))in r?[t]:t.match(M)||[]).length;while(n--)delete r[t[n]]}(void 0===t||w.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var J=new Q,K=new Q,Z=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ee=/[A-Z]/g;function te(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:Z.test(e)?JSON.parse(e):e)}function ne(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(ee,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=te(n)}catch(e){}K.set(e,t,n)}else n=void 0;return n}w.extend({hasData:function(e){return K.hasData(e)||J.hasData(e)},data:function(e,t,n){return K.access(e,t,n)},removeData:function(e,t){K.remove(e,t)},_data:function(e,t,n){return J.access(e,t,n)},_removeData:function(e,t){J.remove(e,t)}}),w.fn.extend({data:function(e,t){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(i=K.get(o),1===o.nodeType&&!J.get(o,"hasDataAttrs"))){n=a.length;while(n--)a[n]&&0===(r=a[n].name).indexOf("data-")&&(r=G(r.slice(5)),ne(o,r,i[r]));J.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){K.set(this,e)}):z(this,function(t){var n;if(o&&void 0===t){if(void 0!==(n=K.get(o,e)))return n;if(void 0!==(n=ne(o,e)))return n}else this.each(function(){K.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){K.remove(this,e)})}}),w.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=J.get(e,t),n&&(!r||Array.isArray(n)?r=J.access(e,t,w.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,i=n.shift(),o=w._queueHooks(e,t),a=function(){w.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return J.get(e,n)||J.access(e,n,{empty:w.Callbacks("once memory").add(function(){J.remove(e,[t+"queue",n])})})}}),w.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?w.queue(this[0],e):void 0===t?this:this.each(function(){var n=w.queue(this,e,t);w._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&w.dequeue(this,e)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=w.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=J.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var re=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ie=new RegExp("^(?:([+-])=|)("+re+")([a-z%]*)$","i"),oe=["Top","Right","Bottom","Left"],ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&w.contains(e.ownerDocument,e)&&"none"===w.css(e,"display")},se=function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i};function ue(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return w.css(e,t,"")},u=s(),l=n&&n[3]||(w.cssNumber[t]?"":"px"),c=(w.cssNumber[t]||"px"!==l&&+u)&&ie.exec(w.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)w.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,w.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var le={};function ce(e){var t,n=e.ownerDocument,r=e.nodeName,i=le[r];return i||(t=n.body.appendChild(n.createElement(r)),i=w.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),le[r]=i,i)}function fe(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)(r=e[o]).style&&(n=r.style.display,t?("none"===n&&(i[o]=J.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&ae(r)&&(i[o]=ce(r))):"none"!==n&&(i[o]="none",J.set(r,"display",n)));for(o=0;o<a;o++)null!=i[o]&&(e[o].style.display=i[o]);return e}w.fn.extend({show:function(){return fe(this,!0)},hide:function(){return fe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?w(this).show():w(this).hide()})}});var pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,he=/^$|^module$|\/(?:java|ecma)script/i,ge={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ge.optgroup=ge.option,ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td;function ye(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&N(e,t)?w.merge([e],n):n}function ve(e,t){for(var n=0,r=e.length;n<r;n++)J.set(e[n],"globalEval",!t||J.get(t[n],"globalEval"))}var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===x(o))w.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+w.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;w.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&w.inArray(o,r)>-1)i&&i.push(o);else if(l=w.contains(o.ownerDocument,o),a=ye(f.appendChild(o),"script"),l&&ve(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}!function(){var e=r.createDocumentFragment().appendChild(r.createElement("div")),t=r.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),h.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",h.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var be=r.documentElement,we=/^key/,Te=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ce=/^([^.]*)(?:\.(.+)|)/;function Ee(){return!0}function ke(){return!1}function Se(){try{return r.activeElement}catch(e){}}function De(e,t,n,r,i,o){var a,s;if("object"==typeof t){"string"!=typeof n&&(r=r||n,n=void 0);for(s in t)De(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=ke;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return w().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=w.guid++)),e.each(function(){w.event.add(this,t,i,r,n)})}w.event={global:{},add:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=J.get(e);if(y){n.handler&&(n=(o=n).handler,i=o.selector),i&&w.find.matchesSelector(be,i),n.guid||(n.guid=w.guid++),(u=y.events)||(u=y.events={}),(a=y.handle)||(a=y.handle=function(t){return"undefined"!=typeof w&&w.event.triggered!==t.type?w.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(M)||[""]).length;while(l--)d=g=(s=Ce.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=w.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=w.event.special[d]||{},c=w.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&w.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(e,r,h,a)||e.addEventListener&&e.addEventListener(d,a)),f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),w.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=J.hasData(e)&&J.get(e);if(y&&(u=y.events)){l=(t=(t||"").match(M)||[""]).length;while(l--)if(s=Ce.exec(t[l])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){f=w.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,y.handle)||w.removeEvent(e,d,y.handle),delete u[d])}else for(d in u)w.event.remove(e,d+t[l],n,r,!0);w.isEmptyObject(u)&&J.remove(e,"handle events")}},dispatch:function(e){var t=w.event.fix(e),n,r,i,o,a,s,u=new Array(arguments.length),l=(J.get(this,"events")||{})[t.type]||[],c=w.event.special[t.type]||{};for(u[0]=t,n=1;n<arguments.length;n++)u[n]=arguments[n];if(t.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){s=w.event.handlers.call(this,t,l),n=0;while((o=s[n++])&&!t.isPropagationStopped()){t.currentTarget=o.elem,r=0;while((a=o.handlers[r++])&&!t.isImmediatePropagationStopped())t.rnamespace&&!t.rnamespace.test(a.namespace)||(t.handleObj=a,t.data=a.data,void 0!==(i=((w.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,u))&&!1===(t.result=i)&&(t.preventDefault(),t.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?w(i,this).index(l)>-1:w.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(e,t){Object.defineProperty(w.Event.prototype,e,{enumerable:!0,configurable:!0,get:g(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Se()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Se()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&N(this,"input"))return this.click(),!1},_default:function(e){return N(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ee:ke,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:ke,isPropagationStopped:ke,isImmediatePropagationStopped:ke,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ee,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ee,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ee,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&we.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&Te.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},w.event.addProp),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return i&&(i===r||w.contains(r,i))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),w.fn.extend({on:function(e,t,n,r){return De(this,e,t,n,r)},one:function(e,t,n,r){return De(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,w(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=ke),this.each(function(){w.event.remove(this,e,n,t)})}});var Ne=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Ae=/<script|<style|<link/i,je=/checked\s*(?:[^=]|=\s*.checked.)/i,qe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Le(e,t){return N(e,"table")&&N(11!==t.nodeType?t:t.firstChild,"tr")?w(e).children("tbody")[0]||e:e}function He(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Oe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Pe(e,t){var n,r,i,o,a,s,u,l;if(1===t.nodeType){if(J.hasData(e)&&(o=J.access(e),a=J.set(t,o),l=o.events)){delete a.handle,a.events={};for(i in l)for(n=0,r=l[i].length;n<r;n++)w.event.add(t,i,l[i][n])}K.hasData(e)&&(s=K.access(e),u=w.extend({},s),K.set(t,u))}}function Me(e,t){var n=t.nodeName.toLowerCase();"input"===n&&pe.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Re(e,t,n,r){t=a.apply([],t);var i,o,s,u,l,c,f=0,p=e.length,d=p-1,y=t[0],v=g(y);if(v||p>1&&"string"==typeof y&&!h.checkClone&&je.test(y))return e.each(function(i){var o=e.eq(i);v&&(t[0]=y.call(this,i,o.html())),Re(o,t,n,r)});if(p&&(i=xe(t,e[0].ownerDocument,!1,e,r),o=i.firstChild,1===i.childNodes.length&&(i=o),o||r)){for(u=(s=w.map(ye(i,"script"),He)).length;f<p;f++)l=i,f!==d&&(l=w.clone(l,!0,!0),u&&w.merge(s,ye(l,"script"))),n.call(e[f],l,f);if(u)for(c=s[s.length-1].ownerDocument,w.map(s,Oe),f=0;f<u;f++)l=s[f],he.test(l.type||"")&&!J.access(l,"globalEval")&&w.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?w._evalUrl&&w._evalUrl(l.src):m(l.textContent.replace(qe,""),c,l))}return e}function Ie(e,t,n){for(var r,i=t?w.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||w.cleanData(ye(r)),r.parentNode&&(n&&w.contains(r.ownerDocument,r)&&ve(ye(r,"script")),r.parentNode.removeChild(r));return e}w.extend({htmlPrefilter:function(e){return e.replace(Ne,"<$1></$2>")},clone:function(e,t,n){var r,i,o,a,s=e.cloneNode(!0),u=w.contains(e.ownerDocument,e);if(!(h.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(a=ye(s),r=0,i=(o=ye(e)).length;r<i;r++)Me(o[r],a[r]);if(t)if(n)for(o=o||ye(e),a=a||ye(s),r=0,i=o.length;r<i;r++)Pe(o[r],a[r]);else Pe(e,s);return(a=ye(s,"script")).length>0&&ve(a,!u&&ye(e,"script")),s},cleanData:function(e){for(var t,n,r,i=w.event.special,o=0;void 0!==(n=e[o]);o++)if(Y(n)){if(t=n[J.expando]){if(t.events)for(r in t.events)i[r]?w.event.remove(n,r):w.removeEvent(n,r,t.handle);n[J.expando]=void 0}n[K.expando]&&(n[K.expando]=void 0)}}}),w.fn.extend({detach:function(e){return Ie(this,e,!0)},remove:function(e){return Ie(this,e)},text:function(e){return z(this,function(e){return void 0===e?w.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Re(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Le(this,e).appendChild(e)})},prepend:function(){return Re(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Le(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Re(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Re(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(ye(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return z(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ae.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(w.cleanData(ye(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return Re(this,arguments,function(t){var n=this.parentNode;w.inArray(this,e)<0&&(w.cleanData(ye(this)),n&&n.replaceChild(t,this))},e)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){w.fn[e]=function(e){for(var n,r=[],i=w(e),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),w(i[a])[t](n),s.apply(r,n.get());return this.pushStack(r)}});var We=new RegExp("^("+re+")(?!px)[a-z%]+$","i"),$e=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},Be=new RegExp(oe.join("|"),"i");!function(){function t(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",be.appendChild(l).appendChild(c);var t=e.getComputedStyle(c);i="1%"!==t.top,u=12===n(t.marginLeft),c.style.right="60%",s=36===n(t.right),o=36===n(t.width),c.style.position="absolute",a=36===c.offsetWidth||"absolute",be.removeChild(l),c=null}}function n(e){return Math.round(parseFloat(e))}var i,o,a,s,u,l=r.createElement("div"),c=r.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",h.clearCloneStyle="content-box"===c.style.backgroundClip,w.extend(h,{boxSizingReliable:function(){return t(),o},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),u},scrollboxSize:function(){return t(),a}}))}();function Fe(e,t,n){var r,i,o,a,s=e.style;return(n=n||$e(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||w.contains(e.ownerDocument,e)||(a=w.style(e,t)),!h.pixelBoxStyles()&&We.test(a)&&Be.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function _e(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}var ze=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ue={position:"absolute",visibility:"hidden",display:"block"},Ve={letterSpacing:"0",fontWeight:"400"},Ge=["Webkit","Moz","ms"],Ye=r.createElement("div").style;function Qe(e){if(e in Ye)return e;var t=e[0].toUpperCase()+e.slice(1),n=Ge.length;while(n--)if((e=Ge[n]+t)in Ye)return e}function Je(e){var t=w.cssProps[e];return t||(t=w.cssProps[e]=Qe(e)||e),t}function Ke(e,t,n){var r=ie.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ze(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=w.css(e,n+oe[a],!0,i)),r?("content"===n&&(u-=w.css(e,"padding"+oe[a],!0,i)),"margin"!==n&&(u-=w.css(e,"border"+oe[a]+"Width",!0,i))):(u+=w.css(e,"padding"+oe[a],!0,i),"padding"!==n?u+=w.css(e,"border"+oe[a]+"Width",!0,i):s+=w.css(e,"border"+oe[a]+"Width",!0,i));return!r&&o>=0&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))),u}function et(e,t,n){var r=$e(e),i=Fe(e,t,r),o="border-box"===w.css(e,"boxSizing",!1,r),a=o;if(We.test(i)){if(!n)return i;i="auto"}return a=a&&(h.boxSizingReliable()||i===e.style[t]),("auto"===i||!parseFloat(i)&&"inline"===w.css(e,"display",!1,r))&&(i=e["offset"+t[0].toUpperCase()+t.slice(1)],a=!0),(i=parseFloat(i)||0)+Ze(e,t,n||(o?"border":"content"),a,r,i)+"px"}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Fe(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=G(t),u=Xe.test(t),l=e.style;if(u||(t=Je(s)),a=w.cssHooks[t]||w.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"==(o=typeof n)&&(i=ie.exec(n))&&i[1]&&(n=ue(e,t,i),o="number"),null!=n&&n===n&&("number"===o&&(n+=i&&i[3]||(w.cssNumber[s]?"":"px")),h.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=G(t);return Xe.test(t)||(t=Je(s)),(a=w.cssHooks[t]||w.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Fe(e,t,r)),"normal"===i&&t in Ve&&(i=Ve[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),w.each(["height","width"],function(e,t){w.cssHooks[t]={get:function(e,n,r){if(n)return!ze.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?et(e,t,r):se(e,Ue,function(){return et(e,t,r)})},set:function(e,n,r){var i,o=$e(e),a="border-box"===w.css(e,"boxSizing",!1,o),s=r&&Ze(e,t,r,a,o);return a&&h.scrollboxSize()===o.position&&(s-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-Ze(e,t,"border",!1,o)-.5)),s&&(i=ie.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=w.css(e,t)),Ke(e,n,s)}}}),w.cssHooks.marginLeft=_e(h.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Fe(e,"marginLeft"))||e.getBoundingClientRect().left-se(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),w.each({margin:"",padding:"",border:"Width"},function(e,t){w.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+oe[r]+t]=o[r]||o[r-2]||o[0];return i}},"margin"!==e&&(w.cssHooks[e+t].set=Ke)}),w.fn.extend({css:function(e,t){return z(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=$e(e),i=t.length;a<i;a++)o[t[a]]=w.css(e,t[a],!1,r);return o}return void 0!==n?w.style(e,t,n):w.css(e,t)},e,t,arguments.length>1)}});function tt(e,t,n,r,i){return new tt.prototype.init(e,t,n,r,i)}w.Tween=tt,tt.prototype={constructor:tt,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(w.cssNumber[n]?"":"px")},cur:function(){var e=tt.propHooks[this.prop];return e&&e.get?e.get(this):tt.propHooks._default.get(this)},run:function(e){var t,n=tt.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):tt.propHooks._default.set(this),this}},tt.prototype.init.prototype=tt.prototype,tt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[w.cssProps[e.prop]]&&!w.cssHooks[e.prop]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},tt.propHooks.scrollTop=tt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=tt.prototype.init,w.fx.step={};var nt,rt,it=/^(?:toggle|show|hide)$/,ot=/queueHooks$/;function at(){rt&&(!1===r.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(at):e.setTimeout(at,w.fx.interval),w.fx.tick())}function st(){return e.setTimeout(function(){nt=void 0}),nt=Date.now()}function ut(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=oe[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function lt(e,t,n){for(var r,i=(pt.tweeners[t]||[]).concat(pt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function ct(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),y=J.get(e,"fxshow");n.queue||(null==(a=w._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,w.queue(e,"fx").length||a.empty.fire()})}));for(r in t)if(i=t[r],it.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!y||void 0===y[r])continue;g=!0}d[r]=y&&y[r]||w.style(e,r)}if((u=!w.isEmptyObject(t))||!w.isEmptyObject(d)){f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=y&&y.display)&&(l=J.get(e,"display")),"none"===(c=w.css(e,"display"))&&(l?c=l:(fe([e],!0),l=e.style.display||l,c=w.css(e,"display"),fe([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===w.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1;for(r in d)u||(y?"hidden"in y&&(g=y.hidden):y=J.access(e,"fxshow",{display:l}),o&&(y.hidden=!g),g&&fe([e],!0),p.done(function(){g||fe([e]),J.remove(e,"fxshow");for(r in d)w.style(e,r,d[r])})),u=lt(g?y[r]:0,r,p),r in y||(y[r]=u.start,g&&(u.end=u.start,u.start=0))}}function ft(e,t){var n,r,i,o,a;for(n in e)if(r=G(n),i=t[r],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=w.cssHooks[r])&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}function pt(e,t,n){var r,i,o=0,a=pt.prefilters.length,s=w.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=nt||st(),n=Math.max(0,l.startTime+l.duration-t),r=1-(n/l.duration||0),o=0,a=l.tweens.length;o<a;o++)l.tweens[o].run(r);return s.notifyWith(e,[l,r,n]),r<1&&a?n:(a||s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:t,originalOptions:n,startTime:nt||st(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)l.tweens[n].run(1);return t?(s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l,t])):s.rejectWith(e,[l,t]),this}}),c=l.props;for(ft(c,l.opts.specialEasing);o<a;o++)if(r=pt.prefilters[o].call(l,e,c,l.opts))return g(r.stop)&&(w._queueHooks(l.elem,l.opts.queue).stop=r.stop.bind(r)),r;return w.map(c,lt,l),g(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),w.fx.timer(w.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l}w.Animation=w.extend(pt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ue(n.elem,e,ie.exec(t),n),n}]},tweener:function(e,t){g(e)?(t=e,e=["*"]):e=e.match(M);for(var n,r=0,i=e.length;r<i;r++)n=e[r],pt.tweeners[n]=pt.tweeners[n]||[],pt.tweeners[n].unshift(t)},prefilters:[ct],prefilter:function(e,t){t?pt.prefilters.unshift(e):pt.prefilters.push(e)}}),w.speed=function(e,t,n){var r=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||g(e)&&e,duration:e,easing:n&&t||t&&!g(t)&&t};return w.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in w.fx.speeds?r.duration=w.fx.speeds[r.duration]:r.duration=w.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){g(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=w.isEmptyObject(e),o=w.speed(t,n,r),a=function(){var t=pt(this,w.extend({},e),o);(i||J.get(this,"finish"))&&t.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=w.timers,a=J.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&ot.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||w.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=J.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=w.timers,a=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),w.each(["toggle","show","hide"],function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ut(t,!0),e,r,i)}}),w.each({slideDown:ut("show"),slideUp:ut("hide"),slideToggle:ut("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(nt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),nt=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){rt||(rt=!0,at())},w.fx.stop=function(){rt=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,n){return t=w.fx?w.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,r){var i=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(i)}})},function(){var e=r.createElement("input"),t=r.createElement("select").appendChild(r.createElement("option"));e.type="checkbox",h.checkOn=""!==e.value,h.optSelected=t.selected,(e=r.createElement("input")).value="t",e.type="radio",h.radioValue="t"===e.value}();var dt,ht=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return z(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})}}),w.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?w.prop(e,t,n):(1===o&&w.isXMLDoc(e)||(i=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?dt:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=w.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!h.radioValue&&"radio"===t&&N(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t
}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(M);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),dt={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,t){var n=ht[t]||w.find.attr;ht[t]=function(e,t,r){var i,o,a=t.toLowerCase();return r||(o=ht[a],ht[a]=i,i=null!=n(e,t,r)?a:null,ht[a]=o),i}});var gt=/^(?:input|select|textarea|button)$/i,yt=/^(?:a|area)$/i;w.fn.extend({prop:function(e,t){return z(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[w.propFix[e]||e]})}}),w.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&w.isXMLDoc(e)||(t=w.propFix[t]||t,i=w.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):gt.test(e.nodeName)||yt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),h.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this});function vt(e){return(e.match(M)||[]).join(" ")}function mt(e){return e.getAttribute&&e.getAttribute("class")||""}function xt(e){return Array.isArray(e)?e:"string"==typeof e?e.match(M)||[]:[]}w.fn.extend({addClass:function(e){var t,n,r,i,o,a,s,u=0;if(g(e))return this.each(function(t){w(this).addClass(e.call(this,t,mt(this)))});if((t=xt(e)).length)while(n=this[u++])if(i=mt(n),r=1===n.nodeType&&" "+vt(i)+" "){a=0;while(o=t[a++])r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,i,o,a,s,u=0;if(g(e))return this.each(function(t){w(this).removeClass(e.call(this,t,mt(this)))});if(!arguments.length)return this.attr("class","");if((t=xt(e)).length)while(n=this[u++])if(i=mt(n),r=1===n.nodeType&&" "+vt(i)+" "){a=0;while(o=t[a++])while(r.indexOf(" "+o+" ")>-1)r=r.replace(" "+o+" "," ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=typeof e,r="string"===n||Array.isArray(e);return"boolean"==typeof t&&r?t?this.addClass(e):this.removeClass(e):g(e)?this.each(function(n){w(this).toggleClass(e.call(this,n,mt(this),t),t)}):this.each(function(){var t,i,o,a;if(r){i=0,o=w(this),a=xt(e);while(t=a[i++])o.hasClass(t)?o.removeClass(t):o.addClass(t)}else void 0!==e&&"boolean"!==n||((t=mt(this))&&J.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":J.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&(" "+vt(mt(n))+" ").indexOf(t)>-1)return!0;return!1}});var bt=/\r/g;w.fn.extend({val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=g(e),this.each(function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,w(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=w.map(i,function(e){return null==e?"":e+""})),(t=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))});if(i)return(t=w.valHooks[i.type]||w.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(bt,""):null==n?"":n}}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:vt(w.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!N(n.parentNode,"optgroup"))){if(t=w(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=w.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=w.inArray(w.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=w.inArray(w(e).val(),t)>-1}},h.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),h.focusin="onfocusin"in e;var wt=/^(?:focusinfocus|focusoutblur)$/,Tt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(t,n,i,o){var a,s,u,l,c,p,d,h,v=[i||r],m=f.call(t,"type")?t.type:t,x=f.call(t,"namespace")?t.namespace.split("."):[];if(s=h=u=i=i||r,3!==i.nodeType&&8!==i.nodeType&&!wt.test(m+w.event.triggered)&&(m.indexOf(".")>-1&&(m=(x=m.split(".")).shift(),x.sort()),c=m.indexOf(":")<0&&"on"+m,t=t[w.expando]?t:new w.Event(m,"object"==typeof t&&t),t.isTrigger=o?2:3,t.namespace=x.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+x.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:w.makeArray(n,[t]),d=w.event.special[m]||{},o||!d.trigger||!1!==d.trigger.apply(i,n))){if(!o&&!d.noBubble&&!y(i)){for(l=d.delegateType||m,wt.test(l+m)||(s=s.parentNode);s;s=s.parentNode)v.push(s),u=s;u===(i.ownerDocument||r)&&v.push(u.defaultView||u.parentWindow||e)}a=0;while((s=v[a++])&&!t.isPropagationStopped())h=s,t.type=a>1?l:d.bindType||m,(p=(J.get(s,"events")||{})[t.type]&&J.get(s,"handle"))&&p.apply(s,n),(p=c&&s[c])&&p.apply&&Y(s)&&(t.result=p.apply(s,n),!1===t.result&&t.preventDefault());return t.type=m,o||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(v.pop(),n)||!Y(i)||c&&g(i[m])&&!y(i)&&((u=i[c])&&(i[c]=null),w.event.triggered=m,t.isPropagationStopped()&&h.addEventListener(m,Tt),i[m](),t.isPropagationStopped()&&h.removeEventListener(m,Tt),w.event.triggered=void 0,u&&(i[c]=u)),t.result}},simulate:function(e,t,n){var r=w.extend(new w.Event,n,{type:e,isSimulated:!0});w.event.trigger(r,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return w.event.trigger(e,t,n,!0)}}),h.focusin||w.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){w.event.simulate(t,e.target,w.event.fix(e))};w.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=J.access(r,t);i||r.addEventListener(e,n,!0),J.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=J.access(r,t)-1;i?J.access(r,t,i):(r.removeEventListener(e,n,!0),J.remove(r,t))}}});var Ct=e.location,Et=Date.now(),kt=/\?/;w.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+t),n};var St=/\[\]$/,Dt=/\r?\n/g,Nt=/^(?:submit|button|image|reset|file)$/i,At=/^(?:input|select|textarea|keygen)/i;function jt(e,t,n,r){var i;if(Array.isArray(t))w.each(t,function(t,i){n||St.test(e)?r(e,i):jt(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)});else if(n||"object"!==x(t))r(e,t);else for(i in t)jt(e+"["+i+"]",t[i],n,r)}w.param=function(e,t){var n,r=[],i=function(e,t){var n=g(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){i(this.name,this.value)});else for(n in e)jt(n,e[n],t,i);return r.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&At.test(this.nodeName)&&!Nt.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,function(e){return{name:t.name,value:e.replace(Dt,"\r\n")}}):{name:t.name,value:n.replace(Dt,"\r\n")}}).get()}});var qt=/%20/g,Lt=/#.*$/,Ht=/([?&])_=[^&]*/,Ot=/^(.*?):[ \t]*([^\r\n]*)$/gm,Pt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Mt=/^(?:GET|HEAD)$/,Rt=/^\/\//,It={},Wt={},$t="*/".concat("*"),Bt=r.createElement("a");Bt.href=Ct.href;function Ft(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(M)||[];if(g(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function _t(e,t,n,r){var i={},o=e===Wt;function a(s){var u;return i[s]=!0,w.each(e[s]||[],function(e,s){var l=s(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):void 0:(t.dataTypes.unshift(l),a(l),!1)}),u}return a(t.dataTypes[0])||!i["*"]&&a("*")}function zt(e,t){var n,r,i=w.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&w.extend(!0,e,r),e}function Xt(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}function Ut(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ct.href,type:"GET",isLocal:Pt.test(Ct.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":$t,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?zt(zt(e,w.ajaxSettings),t):zt(w.ajaxSettings,e)},ajaxPrefilter:Ft(It),ajaxTransport:Ft(Wt),ajax:function(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var i,o,a,s,u,l,c,f,p,d,h=w.ajaxSetup({},n),g=h.context||h,y=h.context&&(g.nodeType||g.jquery)?w(g):w.event,v=w.Deferred(),m=w.Callbacks("once memory"),x=h.statusCode||{},b={},T={},C="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(c){if(!s){s={};while(t=Ot.exec(a))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return c?a:null},setRequestHeader:function(e,t){return null==c&&(e=T[e.toLowerCase()]=T[e.toLowerCase()]||e,b[e]=t),this},overrideMimeType:function(e){return null==c&&(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)E.always(e[E.status]);else for(t in e)x[t]=[x[t],e[t]];return this},abort:function(e){var t=e||C;return i&&i.abort(t),k(0,t),this}};if(v.promise(E),h.url=((t||h.url||Ct.href)+"").replace(Rt,Ct.protocol+"//"),h.type=n.method||n.type||h.method||h.type,h.dataTypes=(h.dataType||"*").toLowerCase().match(M)||[""],null==h.crossDomain){l=r.createElement("a");try{l.href=h.url,l.href=l.href,h.crossDomain=Bt.protocol+"//"+Bt.host!=l.protocol+"//"+l.host}catch(e){h.crossDomain=!0}}if(h.data&&h.processData&&"string"!=typeof h.data&&(h.data=w.param(h.data,h.traditional)),_t(It,h,n,E),c)return E;(f=w.event&&h.global)&&0==w.active++&&w.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Mt.test(h.type),o=h.url.replace(Lt,""),h.hasContent?h.data&&h.processData&&0===(h.contentType||"").indexOf("application/x-www-form-urlencoded")&&(h.data=h.data.replace(qt,"+")):(d=h.url.slice(o.length),h.data&&(h.processData||"string"==typeof h.data)&&(o+=(kt.test(o)?"&":"?")+h.data,delete h.data),!1===h.cache&&(o=o.replace(Ht,"$1"),d=(kt.test(o)?"&":"?")+"_="+Et++ +d),h.url=o+d),h.ifModified&&(w.lastModified[o]&&E.setRequestHeader("If-Modified-Since",w.lastModified[o]),w.etag[o]&&E.setRequestHeader("If-None-Match",w.etag[o])),(h.data&&h.hasContent&&!1!==h.contentType||n.contentType)&&E.setRequestHeader("Content-Type",h.contentType),E.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+$t+"; q=0.01":""):h.accepts["*"]);for(p in h.headers)E.setRequestHeader(p,h.headers[p]);if(h.beforeSend&&(!1===h.beforeSend.call(g,E,h)||c))return E.abort();if(C="abort",m.add(h.complete),E.done(h.success),E.fail(h.error),i=_t(Wt,h,n,E)){if(E.readyState=1,f&&y.trigger("ajaxSend",[E,h]),c)return E;h.async&&h.timeout>0&&(u=e.setTimeout(function(){E.abort("timeout")},h.timeout));try{c=!1,i.send(b,k)}catch(e){if(c)throw e;k(-1,e)}}else k(-1,"No Transport");function k(t,n,r,s){var l,p,d,b,T,C=n;c||(c=!0,u&&e.clearTimeout(u),i=void 0,a=s||"",E.readyState=t>0?4:0,l=t>=200&&t<300||304===t,r&&(b=Xt(h,E,r)),b=Ut(h,b,E,l),l?(h.ifModified&&((T=E.getResponseHeader("Last-Modified"))&&(w.lastModified[o]=T),(T=E.getResponseHeader("etag"))&&(w.etag[o]=T)),204===t||"HEAD"===h.type?C="nocontent":304===t?C="notmodified":(C=b.state,p=b.data,l=!(d=b.error))):(d=C,!t&&C||(C="error",t<0&&(t=0))),E.status=t,E.statusText=(n||C)+"",l?v.resolveWith(g,[p,C,E]):v.rejectWith(g,[E,C,d]),E.statusCode(x),x=void 0,f&&y.trigger(l?"ajaxSuccess":"ajaxError",[E,h,l?p:d]),m.fireWith(g,[E,C]),f&&(y.trigger("ajaxComplete",[E,h]),--w.active||w.event.trigger("ajaxStop")))}return E},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],function(e,t){w[t]=function(e,n,r,i){return g(n)&&(i=i||r,r=n,n=void 0),w.ajax(w.extend({url:e,type:t,dataType:i,data:n,success:r},w.isPlainObject(e)&&e))}}),w._evalUrl=function(e){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(g(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return g(e)?this.each(function(t){w(this).wrapInner(e.call(this,t))}):this.each(function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=g(e);return this.each(function(n){w(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){w(this).replaceWith(this.childNodes)}),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Vt={0:200,1223:204},Gt=w.ajaxSettings.xhr();h.cors=!!Gt&&"withCredentials"in Gt,h.ajax=Gt=!!Gt,w.ajaxTransport(function(t){var n,r;if(h.cors||Gt&&!t.crossDomain)return{send:function(i,o){var a,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)s[a]=t.xhrFields[a];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(a in i)s.setRequestHeader(a,i[a]);n=function(e){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(Vt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=s.ontimeout=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}}),w.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),w.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(i,o){t=w("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&o("error"===e.type?404:200,e.type)}),r.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Yt=[],Qt=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Yt.pop()||w.expando+"_"+Et++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,a,s=!1!==t.jsonp&&(Qt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qt.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=g(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Qt,"$1"+i):!1!==t.jsonp&&(t.url+=(kt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return a||w.error(i+" was not called"),a[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){a=arguments},r.always(function(){void 0===o?w(e).removeProp(i):e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,Yt.push(i)),a&&g(o)&&o(a[0]),a=o=void 0}),"script"}),h.createHTMLDocument=function(){var e=r.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),w.parseHTML=function(e,t,n){if("string"!=typeof e)return[];"boolean"==typeof t&&(n=t,t=!1);var i,o,a;return t||(h.createHTMLDocument?((i=(t=r.implementation.createHTMLDocument("")).createElement("base")).href=r.location.href,t.head.appendChild(i)):t=r),o=A.exec(e),a=!n&&[],o?[t.createElement(o[1])]:(o=xe([e],t,a),a&&a.length&&w(a).remove(),w.merge([],o.childNodes))},w.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return s>-1&&(r=vt(e.slice(s)),e=e.slice(0,s)),g(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),a.length>0&&w.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?w("<div>").append(w.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.expr.pseudos.animated=function(e){return w.grep(w.timers,function(t){return e===t.elem}).length},w.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l,c=w.css(e,"position"),f=w(e),p={};"static"===c&&(e.style.position="relative"),s=f.offset(),o=w.css(e,"top"),u=w.css(e,"left"),(l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1)?(a=(r=f.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),g(t)&&(t=t.call(e,n,w.extend({},s))),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+i),"using"in t?t.using.call(e,p):f.css(p)}},w.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){w.offset.setOffset(this,e,t)});var t,n,r=this[0];if(r)return r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===w.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===w.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),i.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-w.css(r,"marginTop",!0),left:t.left-i.left-w.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===w.css(e,"position"))e=e.offsetParent;return e||be})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;w.fn[e]=function(r){return z(this,function(e,r,i){var o;if(y(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===i)return o?o[t]:e[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i},e,r,arguments.length)}}),w.each(["top","left"],function(e,t){w.cssHooks[t]=_e(h.pixelPosition,function(e,n){if(n)return n=Fe(e,t),We.test(n)?w(e).position()[t]+"px":n})}),w.each({Height:"height",Width:"width"},function(e,t){w.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){w.fn[r]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(!0===i||!0===o?"margin":"border");return z(this,function(t,n,i){var o;return y(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?w.css(t,n,s):w.style(t,n,i,s)},t,a?i:void 0,a)}})}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),w.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),g(e))return r=o.call(arguments,2),i=function(){return e.apply(t||this,r.concat(o.call(arguments)))},i.guid=e.guid=e.guid||w.guid++,i},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=N,w.isFunction=g,w.isWindow=y,w.camelCase=G,w.type=x,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},"function"==typeof define&&define.amd&&define("jquery",[],function(){return w});var Jt=e.jQuery,Kt=e.$;return w.noConflict=function(t){return e.$===w&&(e.$=Kt),t&&e.jQuery===w&&(e.jQuery=Jt),w},t||(e.jQuery=e.$=w),w});function JPEGEncoder(quality){var self=this;var fround=Math.round;var ffloor=Math.floor;var YTable=new Array(64);var UVTable=new Array(64);var fdtbl_Y=new Array(64);var fdtbl_UV=new Array(64);var YDC_HT;var UVDC_HT;var YAC_HT;var UVAC_HT;var bitcode=new Array(65535);var category=new Array(65535);var outputfDCTQuant=new Array(64);var DU=new Array(64);var byteout=[];var bytenew=0;var bytepos=7;var YDU=new Array(64);var UDU=new Array(64);var VDU=new Array(64);var clt=new Array(256);var RGB_YUV_TABLE=new Array(2048);var currentQuality;var ZigZag=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63];var std_dc_luminance_nrcodes=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];var std_dc_luminance_values=[0,1,2,3,4,5,6,7,8,9,10,11];var std_ac_luminance_nrcodes=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125];var std_ac_luminance_values=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250];var std_dc_chrominance_nrcodes=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];var std_dc_chrominance_values=[0,1,2,3,4,5,6,7,8,9,10,11];var std_ac_chrominance_nrcodes=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119];var std_ac_chrominance_values=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function initQuantTables(sf){var YQT=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99];for(var i=0;i<64;i++){var t=ffloor((YQT[i]*sf+50)/100);if(t<1){t=1}else if(t>255){t=255}YTable[ZigZag[i]]=t}var UVQT=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(var j=0;j<64;j++){var u=ffloor((UVQT[j]*sf+50)/100);if(u<1){u=1}else if(u>255){u=255}UVTable[ZigZag[j]]=u}var aasf=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379];var k=0;for(var row=0;row<8;row++){for(var col=0;col<8;col++){fdtbl_Y[k]=1/(YTable[ZigZag[k]]*aasf[row]*aasf[col]*8);fdtbl_UV[k]=1/(UVTable[ZigZag[k]]*aasf[row]*aasf[col]*8);k++}}}function computeHuffmanTbl(nrcodes,std_table){var codevalue=0;var pos_in_table=0;var HT=new Array;for(var k=1;k<=16;k++){for(var j=1;j<=nrcodes[k];j++){HT[std_table[pos_in_table]]=[];HT[std_table[pos_in_table]][0]=codevalue;HT[std_table[pos_in_table]][1]=k;pos_in_table++;codevalue++}codevalue*=2}return HT}function initHuffmanTbl(){YDC_HT=computeHuffmanTbl(std_dc_luminance_nrcodes,std_dc_luminance_values);UVDC_HT=computeHuffmanTbl(std_dc_chrominance_nrcodes,std_dc_chrominance_values);YAC_HT=computeHuffmanTbl(std_ac_luminance_nrcodes,std_ac_luminance_values);UVAC_HT=computeHuffmanTbl(std_ac_chrominance_nrcodes,std_ac_chrominance_values)}function initCategoryNumber(){var nrlower=1;var nrupper=2;for(var cat=1;cat<=15;cat++){for(var nr=nrlower;nr<nrupper;nr++){category[32767+nr]=cat;bitcode[32767+nr]=[];bitcode[32767+nr][1]=cat;bitcode[32767+nr][0]=nr}for(var nrneg=-(nrupper-1);nrneg<=-nrlower;nrneg++){category[32767+nrneg]=cat;bitcode[32767+nrneg]=[];bitcode[32767+nrneg][1]=cat;bitcode[32767+nrneg][0]=nrupper-1+nrneg}nrlower<<=1;nrupper<<=1}}function initRGBYUVTable(){for(var i=0;i<256;i++){RGB_YUV_TABLE[i]=19595*i;RGB_YUV_TABLE[i+256>>0]=38470*i;RGB_YUV_TABLE[i+512>>0]=7471*i+32768;RGB_YUV_TABLE[i+768>>0]=-11059*i;RGB_YUV_TABLE[i+1024>>0]=-21709*i;RGB_YUV_TABLE[i+1280>>0]=32768*i+8421375;RGB_YUV_TABLE[i+1536>>0]=-27439*i;RGB_YUV_TABLE[i+1792>>0]=-5329*i}}function writeBits(bs){var value=bs[0];var posval=bs[1]-1;while(posval>=0){if(value&1<<posval){bytenew|=1<<bytepos}posval--;bytepos--;if(bytepos<0){if(bytenew==255){writeByte(255);writeByte(0)}else{writeByte(bytenew)}bytepos=7;bytenew=0}}}function writeByte(value){byteout.push(clt[value])}function writeWord(value){writeByte(value>>8&255);writeByte(value&255)}function fDCTQuant(data,fdtbl){var d0,d1,d2,d3,d4,d5,d6,d7;var dataOff=0;var i;const I8=8;const I64=64;for(i=0;i<I8;++i){d0=data[dataOff];d1=data[dataOff+1];d2=data[dataOff+2];d3=data[dataOff+3];d4=data[dataOff+4];d5=data[dataOff+5];d6=data[dataOff+6];d7=data[dataOff+7];var tmp0=d0+d7;var tmp7=d0-d7;var tmp1=d1+d6;var tmp6=d1-d6;var tmp2=d2+d5;var tmp5=d2-d5;var tmp3=d3+d4;var tmp4=d3-d4;var tmp10=tmp0+tmp3;var tmp13=tmp0-tmp3;var tmp11=tmp1+tmp2;var tmp12=tmp1-tmp2;data[dataOff]=tmp10+tmp11;data[dataOff+4]=tmp10-tmp11;var z1=(tmp12+tmp13)*.707106781;data[dataOff+2]=tmp13+z1;data[dataOff+6]=tmp13-z1;tmp10=tmp4+tmp5;tmp11=tmp5+tmp6;tmp12=tmp6+tmp7;var z5=(tmp10-tmp12)*.382683433;var z2=.5411961*tmp10+z5;var z4=1.306562965*tmp12+z5;var z3=tmp11*.707106781;var z11=tmp7+z3;var z13=tmp7-z3;data[dataOff+5]=z13+z2;data[dataOff+3]=z13-z2;data[dataOff+1]=z11+z4;data[dataOff+7]=z11-z4;dataOff+=8}dataOff=0;for(i=0;i<I8;++i){d0=data[dataOff];d1=data[dataOff+8];d2=data[dataOff+16];d3=data[dataOff+24];d4=data[dataOff+32];d5=data[dataOff+40];d6=data[dataOff+48];d7=data[dataOff+56];var tmp0p2=d0+d7;var tmp7p2=d0-d7;var tmp1p2=d1+d6;var tmp6p2=d1-d6;var tmp2p2=d2+d5;var tmp5p2=d2-d5;var tmp3p2=d3+d4;var tmp4p2=d3-d4;var tmp10p2=tmp0p2+tmp3p2;var tmp13p2=tmp0p2-tmp3p2;var tmp11p2=tmp1p2+tmp2p2;var tmp12p2=tmp1p2-tmp2p2;data[dataOff]=tmp10p2+tmp11p2;data[dataOff+32]=tmp10p2-tmp11p2;var z1p2=(tmp12p2+tmp13p2)*.707106781;data[dataOff+16]=tmp13p2+z1p2;data[dataOff+48]=tmp13p2-z1p2;tmp10p2=tmp4p2+tmp5p2;tmp11p2=tmp5p2+tmp6p2;tmp12p2=tmp6p2+tmp7p2;var z5p2=(tmp10p2-tmp12p2)*.382683433;var z2p2=.5411961*tmp10p2+z5p2;var z4p2=1.306562965*tmp12p2+z5p2;var z3p2=tmp11p2*.707106781;var z11p2=tmp7p2+z3p2;var z13p2=tmp7p2-z3p2;data[dataOff+40]=z13p2+z2p2;data[dataOff+24]=z13p2-z2p2;data[dataOff+8]=z11p2+z4p2;data[dataOff+56]=z11p2-z4p2;dataOff++}var fDCTQuant;for(i=0;i<I64;++i){fDCTQuant=data[i]*fdtbl[i];outputfDCTQuant[i]=fDCTQuant>0?fDCTQuant+.5|0:fDCTQuant-.5|0}return outputfDCTQuant}function writeAPP0(){writeWord(65504);writeWord(16);writeByte(74);writeByte(70);writeByte(73);writeByte(70);writeByte(0);writeByte(1);writeByte(1);writeByte(0);writeWord(1);writeWord(1);writeByte(0);writeByte(0)}function writeSOF0(width,height){writeWord(65472);writeWord(17);writeByte(8);writeWord(height);writeWord(width);writeByte(3);writeByte(1);writeByte(17);writeByte(0);writeByte(2);writeByte(17);writeByte(1);writeByte(3);writeByte(17);writeByte(1)}function writeDQT(){writeWord(65499);writeWord(132);writeByte(0);for(var i=0;i<64;i++){writeByte(YTable[i])}writeByte(1);for(var j=0;j<64;j++){writeByte(UVTable[j])}}function writeDHT(){writeWord(65476);writeWord(418);writeByte(0);for(var i=0;i<16;i++){writeByte(std_dc_luminance_nrcodes[i+1])}for(var j=0;j<=11;j++){writeByte(std_dc_luminance_values[j])}writeByte(16);for(var k=0;k<16;k++){writeByte(std_ac_luminance_nrcodes[k+1])}for(var l=0;l<=161;l++){writeByte(std_ac_luminance_values[l])}writeByte(1);for(var m=0;m<16;m++){writeByte(std_dc_chrominance_nrcodes[m+1])}for(var n=0;n<=11;n++){writeByte(std_dc_chrominance_values[n])}writeByte(17);for(var o=0;o<16;o++){writeByte(std_ac_chrominance_nrcodes[o+1])}for(var p=0;p<=161;p++){writeByte(std_ac_chrominance_values[p])}}function writeSOS(){writeWord(65498);writeWord(12);writeByte(3);writeByte(1);writeByte(0);writeByte(2);writeByte(17);writeByte(3);writeByte(17);writeByte(0);writeByte(63);writeByte(0)}function processDU(CDU,fdtbl,DC,HTDC,HTAC){var EOB=HTAC[0];var M16zeroes=HTAC[240];var pos;const I16=16;const I63=63;const I64=64;var DU_DCT=fDCTQuant(CDU,fdtbl);for(var j=0;j<I64;++j){DU[ZigZag[j]]=DU_DCT[j]}var Diff=DU[0]-DC;DC=DU[0];if(Diff==0){writeBits(HTDC[0])}else{pos=32767+Diff;writeBits(HTDC[category[pos]]);writeBits(bitcode[pos])}var end0pos=63;for(;end0pos>0&&DU[end0pos]==0;end0pos--){}if(end0pos==0){writeBits(EOB);return DC}var i=1;var lng;while(i<=end0pos){var startpos=i;for(;DU[i]==0&&i<=end0pos;++i){}var nrzeroes=i-startpos;if(nrzeroes>=I16){lng=nrzeroes>>4;for(var nrmarker=1;nrmarker<=lng;++nrmarker)writeBits(M16zeroes);nrzeroes=nrzeroes&15}pos=32767+DU[i];writeBits(HTAC[(nrzeroes<<4)+category[pos]]);writeBits(bitcode[pos]);i++}if(end0pos!=I63){writeBits(EOB)}return DC}function initCharLookupTable(){var sfcc=String.fromCharCode;
for(var i=0;i<256;i++){clt[i]=sfcc(i)}}this.encode=function(image,quality,toRaw){var time_start=(new Date).getTime();if(quality)setQuality(quality);byteout=new Array;bytenew=0;bytepos=7;writeWord(65496);writeAPP0();writeDQT();writeSOF0(image.width,image.height);writeDHT();writeSOS();var DCY=0;var DCU=0;var DCV=0;bytenew=0;bytepos=7;this.encode.displayName="_encode_";var imageData=image.data;var width=image.width;var height=image.height;var quadWidth=width*4;var tripleWidth=width*3;var x,y=0;var r,g,b;var start,p,col,row,pos;while(y<height){x=0;while(x<quadWidth){start=quadWidth*y+x;p=start;col=-1;row=0;for(pos=0;pos<64;pos++){row=pos>>3;col=(pos&7)*4;p=start+row*quadWidth+col;if(y+row>=height){p-=quadWidth*(y+1+row-height)}if(x+col>=quadWidth){p-=x+col-quadWidth+4}r=imageData[p++];g=imageData[p++];b=imageData[p++];YDU[pos]=(RGB_YUV_TABLE[r]+RGB_YUV_TABLE[g+256>>0]+RGB_YUV_TABLE[b+512>>0]>>16)-128;UDU[pos]=(RGB_YUV_TABLE[r+768>>0]+RGB_YUV_TABLE[g+1024>>0]+RGB_YUV_TABLE[b+1280>>0]>>16)-128;VDU[pos]=(RGB_YUV_TABLE[r+1280>>0]+RGB_YUV_TABLE[g+1536>>0]+RGB_YUV_TABLE[b+1792>>0]>>16)-128}DCY=processDU(YDU,fdtbl_Y,DCY,YDC_HT,YAC_HT);DCU=processDU(UDU,fdtbl_UV,DCU,UVDC_HT,UVAC_HT);DCV=processDU(VDU,fdtbl_UV,DCV,UVDC_HT,UVAC_HT);x+=32}y+=8}if(bytepos>=0){var fillbits=[];fillbits[1]=bytepos+1;fillbits[0]=(1<<bytepos+1)-1;writeBits(fillbits)}writeWord(65497);if(toRaw){var len=byteout.length;var data=new Uint8Array(len);for(var i=0;i<len;i++){data[i]=byteout[i].charCodeAt()}byteout=[];var duration=(new Date).getTime()-time_start;console.log("Encoding time: "+duration+"ms");return data}var jpegDataUri="data:image/jpeg;base64,"+btoa(byteout.join(""));byteout=[];var duration=(new Date).getTime()-time_start;console.log("Encoding time: "+duration+"ms");return jpegDataUri};function setQuality(quality){if(quality<=0){quality=1}if(quality>100){quality=100}if(currentQuality==quality)return;var sf=0;if(quality<50){sf=Math.floor(5e3/quality)}else{sf=Math.floor(200-quality*2)}initQuantTables(sf);currentQuality=quality;console.log("Quality set to: "+quality+"%")}function init(){var time_start=(new Date).getTime();if(!quality)quality=50;initCharLookupTable();initHuffmanTbl();initCategoryNumber();initRGBYUVTable();setQuality(quality);var duration=(new Date).getTime()-time_start;console.log("Initialization "+duration+"ms")}init()}(function(){var debug=false;var root=this;var EXIF=function(obj){if(obj instanceof EXIF)return obj;if(!(this instanceof EXIF))return new EXIF(obj);this.EXIFwrapped=obj};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=EXIF}exports.EXIF=EXIF}else{root.EXIF=EXIF}var ExifTags=EXIF.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"};var TiffTags=EXIF.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"};var GPSTags=EXIF.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"};var StringValues=EXIF.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function addEvent(element,event,handler){if(element.addEventListener){element.addEventListener(event,handler,false)}else if(element.attachEvent){element.attachEvent("on"+event,handler)}}function imageHasData(img){return!!img.exifdata}function base64ToArrayBuffer(base64,contentType){contentType=contentType||base64.match(/^data\:([^\;]+)\;base64,/im)[1]||"";base64=base64.replace(/^data\:([^\;]+)\;base64,/gim,"");var binary=atob(base64);var len=binary.length;var buffer=new ArrayBuffer(len);var view=new Uint8Array(buffer);for(var i=0;i<len;i++){view[i]=binary.charCodeAt(i)}return buffer}function objectURLToBlob(url,callback){var http=new XMLHttpRequest;http.open("GET",url,true);http.responseType="blob";http.onload=function(e){if(this.status==200||this.status===0){callback(this.response)}};http.send()}function getImageData(img,callback){function handleBinaryFile(binFile){var data=findEXIFinJPEG(binFile);var iptcdata=findIPTCinJPEG(binFile);img.exifdata=data||{};img.iptcdata=iptcdata||{};if(callback){callback.call(img)}}if(img.src){if(/^data\:/i.test(img.src)){var arrayBuffer=base64ToArrayBuffer(img.src);handleBinaryFile(arrayBuffer)}else if(/^blob\:/i.test(img.src)){var fileReader=new FileReader;fileReader.onload=function(e){handleBinaryFile(e.target.result)};objectURLToBlob(img.src,function(blob){fileReader.readAsArrayBuffer(blob)})}else{var http=new XMLHttpRequest;http.onload=function(){if(this.status==200||this.status===0){handleBinaryFile(http.response)}else{throw"Could not load image"}http=null};http.open("GET",img.src,true);http.responseType="arraybuffer";http.send(null)}}else if(window.FileReader&&(img instanceof window.Blob||img instanceof window.File)){var fileReader=new FileReader;fileReader.onload=function(e){if(debug)console.log("Got file of length "+e.target.result.byteLength);handleBinaryFile(e.target.result)};fileReader.readAsArrayBuffer(img)}}function findEXIFinJPEG(file){var dataView=new DataView(file);if(debug)console.log("Got file of length "+file.byteLength);if(dataView.getUint8(0)!=255||dataView.getUint8(1)!=216){if(debug)console.log("Not a valid JPEG");return false}var offset=2,length=file.byteLength,marker;while(offset<length){if(dataView.getUint8(offset)!=255){if(debug)console.log("Not a valid marker at offset "+offset+", found: "+dataView.getUint8(offset));return false}marker=dataView.getUint8(offset+1);if(debug)console.log(marker);if(marker==225){if(debug)console.log("Found 0xFFE1 marker");return readEXIFData(dataView,offset+4,dataView.getUint16(offset+2)-2)}else{offset+=2+dataView.getUint16(offset+2)}}}function findIPTCinJPEG(file){var dataView=new DataView(file);if(debug)console.log("Got file of length "+file.byteLength);if(dataView.getUint8(0)!=255||dataView.getUint8(1)!=216){if(debug)console.log("Not a valid JPEG");return false}var offset=2,length=file.byteLength;var isFieldSegmentStart=function(dataView,offset){return dataView.getUint8(offset)===56&&dataView.getUint8(offset+1)===66&&dataView.getUint8(offset+2)===73&&dataView.getUint8(offset+3)===77&&dataView.getUint8(offset+4)===4&&dataView.getUint8(offset+5)===4};while(offset<length){if(isFieldSegmentStart(dataView,offset)){var nameHeaderLength=dataView.getUint8(offset+7);if(nameHeaderLength%2!==0)nameHeaderLength+=1;if(nameHeaderLength===0){nameHeaderLength=4}var startOffset=offset+8+nameHeaderLength;var sectionLength=dataView.getUint16(offset+6+nameHeaderLength);return readIPTCData(file,startOffset,sectionLength);break}offset++}}var IptcFieldMap={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function readIPTCData(file,startOffset,sectionLength){var dataView=new DataView(file);var data={};var fieldValue,fieldName,dataSize,segmentType,segmentSize;var segmentStartPos=startOffset;while(segmentStartPos<startOffset+sectionLength){if(dataView.getUint8(segmentStartPos)===28&&dataView.getUint8(segmentStartPos+1)===2){segmentType=dataView.getUint8(segmentStartPos+2);if(segmentType in IptcFieldMap){dataSize=dataView.getInt16(segmentStartPos+3);segmentSize=dataSize+5;fieldName=IptcFieldMap[segmentType];fieldValue=getStringFromDB(dataView,segmentStartPos+5,dataSize);if(data.hasOwnProperty(fieldName)){if(data[fieldName]instanceof Array){data[fieldName].push(fieldValue)}else{data[fieldName]=[data[fieldName],fieldValue]}}else{data[fieldName]=fieldValue}}}segmentStartPos++}return data}function readTags(file,tiffStart,dirStart,strings,bigEnd){var entries=file.getUint16(dirStart,!bigEnd),tags={},entryOffset,tag,i;for(i=0;i<entries;i++){entryOffset=dirStart+i*12+2;tag=strings[file.getUint16(entryOffset,!bigEnd)];if(!tag&&debug)console.log("Unknown tag: "+file.getUint16(entryOffset,!bigEnd));tags[tag]=readTagValue(file,entryOffset,tiffStart,dirStart,bigEnd)}return tags}function readTagValue(file,entryOffset,tiffStart,dirStart,bigEnd){var type=file.getUint16(entryOffset+2,!bigEnd),numValues=file.getUint32(entryOffset+4,!bigEnd),valueOffset=file.getUint32(entryOffset+8,!bigEnd)+tiffStart,offset,vals,val,n,numerator,denominator;switch(type){case 1:case 7:if(numValues==1){return file.getUint8(entryOffset+8,!bigEnd)}else{offset=numValues>4?valueOffset:entryOffset+8;vals=[];for(n=0;n<numValues;n++){vals[n]=file.getUint8(offset+n)}return vals}case 2:offset=numValues>4?valueOffset:entryOffset+8;return getStringFromDB(file,offset,numValues-1);case 3:if(numValues==1){return file.getUint16(entryOffset+8,!bigEnd)}else{offset=numValues>2?valueOffset:entryOffset+8;vals=[];for(n=0;n<numValues;n++){vals[n]=file.getUint16(offset+2*n,!bigEnd)}return vals}case 4:if(numValues==1){return file.getUint32(entryOffset+8,!bigEnd)}else{vals=[];for(n=0;n<numValues;n++){vals[n]=file.getUint32(valueOffset+4*n,!bigEnd)}return vals}case 5:if(numValues==1){numerator=file.getUint32(valueOffset,!bigEnd);denominator=file.getUint32(valueOffset+4,!bigEnd);val=new Number(numerator/denominator);val.numerator=numerator;val.denominator=denominator;return val}else{vals=[];for(n=0;n<numValues;n++){numerator=file.getUint32(valueOffset+8*n,!bigEnd);denominator=file.getUint32(valueOffset+4+8*n,!bigEnd);vals[n]=new Number(numerator/denominator);vals[n].numerator=numerator;vals[n].denominator=denominator}return vals}case 9:if(numValues==1){return file.getInt32(entryOffset+8,!bigEnd)}else{vals=[];for(n=0;n<numValues;n++){vals[n]=file.getInt32(valueOffset+4*n,!bigEnd)}return vals}case 10:if(numValues==1){return file.getInt32(valueOffset,!bigEnd)/file.getInt32(valueOffset+4,!bigEnd)}else{vals=[];for(n=0;n<numValues;n++){vals[n]=file.getInt32(valueOffset+8*n,!bigEnd)/file.getInt32(valueOffset+4+8*n,!bigEnd)}return vals}}}function getStringFromDB(buffer,start,length){var outstr="";for(n=start;n<start+length;n++){outstr+=String.fromCharCode(buffer.getUint8(n))}return outstr}function readEXIFData(file,start){if(getStringFromDB(file,start,4)!="Exif"){if(debug)console.log("Not valid EXIF data! "+getStringFromDB(file,start,4));return false}var bigEnd,tags,tag,exifData,gpsData,tiffOffset=start+6;if(file.getUint16(tiffOffset)==18761){bigEnd=false}else if(file.getUint16(tiffOffset)==19789){bigEnd=true}else{if(debug)console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)");return false}if(file.getUint16(tiffOffset+2,!bigEnd)!=42){if(debug)console.log("Not valid TIFF data! (no 0x002A)");return false}var firstIFDOffset=file.getUint32(tiffOffset+4,!bigEnd);if(firstIFDOffset<8){if(debug)console.log("Not valid TIFF data! (First offset less than 8)",file.getUint32(tiffOffset+4,!bigEnd));return false}tags=readTags(file,tiffOffset,tiffOffset+firstIFDOffset,TiffTags,bigEnd);if(tags.ExifIFDPointer){exifData=readTags(file,tiffOffset,tiffOffset+tags.ExifIFDPointer,ExifTags,bigEnd);for(tag in exifData){switch(tag){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":exifData[tag]=StringValues[tag][exifData[tag]];break;case"ExifVersion":case"FlashpixVersion":exifData[tag]=String.fromCharCode(exifData[tag][0],exifData[tag][1],exifData[tag][2],exifData[tag][3]);break;case"ComponentsConfiguration":exifData[tag]=StringValues.Components[exifData[tag][0]]+StringValues.Components[exifData[tag][1]]+StringValues.Components[exifData[tag][2]]+StringValues.Components[exifData[tag][3]];break}tags[tag]=exifData[tag]}}if(tags.GPSInfoIFDPointer){gpsData=readTags(file,tiffOffset,tiffOffset+tags.GPSInfoIFDPointer,GPSTags,bigEnd);for(tag in gpsData){switch(tag){case"GPSVersionID":gpsData[tag]=gpsData[tag][0]+"."+gpsData[tag][1]+"."+gpsData[tag][2]+"."+gpsData[tag][3];break}tags[tag]=gpsData[tag]}}return tags}EXIF.getData=function(img,callback){if((img instanceof Image||img instanceof HTMLImageElement)&&!img.complete)return false;if(!imageHasData(img)){getImageData(img,callback)}else{if(callback){callback.call(img)}}return true};EXIF.getTag=function(img,tag){if(!imageHasData(img))return;return img.exifdata[tag]};EXIF.getAllTags=function(img){if(!imageHasData(img))return{};var a,data=img.exifdata,tags={};for(a in data){if(data.hasOwnProperty(a)){tags[a]=data[a]}}return tags};EXIF.pretty=function(img){if(!imageHasData(img))return"";var a,data=img.exifdata,strPretty="";for(a in data){if(data.hasOwnProperty(a)){if(typeof data[a]=="object"){if(data[a]instanceof Number){strPretty+=a+" : "+data[a]+" ["+data[a].numerator+"/"+data[a].denominator+"]\r\n"}else{strPretty+=a+" : ["+data[a].length+" values]\r\n"}}else{strPretty+=a+" : "+data[a]+"\r\n"}}}return strPretty};EXIF.readFromBinaryFile=function(file){return findEXIFinJPEG(file)};if(typeof define==="function"&&define.amd){define("exif-js",[],function(){return EXIF})}}).call(this);(function(){"use strict";function FastClick(layer,options){var oldOnClick;options=options||{};this.trackingClick=false;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.touchBoundary=options.touchBoundary||10;this.layer=layer;this.tapDelay=options.tapDelay||200;this.tapTimeout=options.tapTimeout||700;if(FastClick.notNeeded(layer)){return}function bind(method,context){return function(){return method.apply(context,arguments)}}var methods=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"];var context=this;for(var i=0,l=methods.length;i<l;i++){context[methods[i]]=bind(context[methods[i]],context)}if(deviceIsAndroid){layer.addEventListener("mouseover",this.onMouse,true);layer.addEventListener("mousedown",this.onMouse,true);layer.addEventListener("mouseup",this.onMouse,true)}layer.addEventListener("click",this.onClick,true);layer.addEventListener("touchstart",this.onTouchStart,false);layer.addEventListener("touchmove",this.onTouchMove,false);layer.addEventListener("touchend",this.onTouchEnd,false);layer.addEventListener("touchcancel",this.onTouchCancel,false);if(!Event.prototype.stopImmediatePropagation){layer.removeEventListener=function(type,callback,capture){var rmv=Node.prototype.removeEventListener;if(type==="click"){rmv.call(layer,type,callback.hijacked||callback,capture)}else{rmv.call(layer,type,callback,capture)}};layer.addEventListener=function(type,callback,capture){var adv=Node.prototype.addEventListener;if(type==="click"){adv.call(layer,type,callback.hijacked||(callback.hijacked=function(event){if(!event.propagationStopped){callback(event)}}),capture)}else{adv.call(layer,type,callback,capture)}}}if(typeof layer.onclick==="function"){oldOnClick=layer.onclick;layer.addEventListener("click",function(event){oldOnClick(event)},false);layer.onclick=null}}var deviceIsWindowsPhone=navigator.userAgent.indexOf("Windows Phone")>=0;var deviceIsAndroid=navigator.userAgent.indexOf("Android")>0&&!deviceIsWindowsPhone;var deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent)&&!deviceIsWindowsPhone;var deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent);var deviceIsIOSWithBadTarget=deviceIsIOS&&/OS [6-7]_\d/.test(navigator.userAgent);var deviceIsBlackBerry10=navigator.userAgent.indexOf("BB10")>0;FastClick.prototype.needsClick=function(target){switch(target.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(target.disabled){return true}break;case"input":if(deviceIsIOS&&target.type==="file"||target.disabled){return true}break;case"label":case"iframe":case"video":return true}return/\bneedsclick\b/.test(target.className)};FastClick.prototype.needsFocus=function(target){switch(target.nodeName.toLowerCase()){case"textarea":return true;case"select":return!deviceIsAndroid;case"input":switch(target.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return false}return!target.disabled&&!target.readOnly;default:return/\bneedsfocus\b/.test(target.className)}};FastClick.prototype.sendClick=function(targetElement,event){var clickEvent,touch;if(document.activeElement&&document.activeElement!==targetElement){document.activeElement.blur()}touch=event.changedTouches[0];clickEvent=document.createEvent("MouseEvents");clickEvent.initMouseEvent(this.determineEventType(targetElement),true,true,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,false,false,false,false,0,null);clickEvent.forwardedTouchEvent=true;targetElement.dispatchEvent(clickEvent)};FastClick.prototype.determineEventType=function(targetElement){if(deviceIsAndroid&&targetElement.tagName.toLowerCase()==="select"){return"mousedown"}return"click"};FastClick.prototype.focus=function(targetElement){var length;if(deviceIsIOS&&targetElement.setSelectionRange&&targetElement.type.indexOf("date")!==0&&targetElement.type!=="time"&&targetElement.type!=="month"){length=targetElement.value.length;targetElement.setSelectionRange(length,length)}else{targetElement.focus()}};FastClick.prototype.updateScrollParent=function(targetElement){var scrollParent,parentElement;scrollParent=targetElement.fastClickScrollParent;if(!scrollParent||!scrollParent.contains(targetElement)){parentElement=targetElement;do{if(parentElement.scrollHeight>parentElement.offsetHeight){scrollParent=parentElement;targetElement.fastClickScrollParent=parentElement;break}parentElement=parentElement.parentElement}while(parentElement)}if(scrollParent){scrollParent.fastClickLastScrollTop=scrollParent.scrollTop}};FastClick.prototype.getTargetElementFromEventTarget=function(eventTarget){if(eventTarget.nodeType===Node.TEXT_NODE){return eventTarget.parentNode}return eventTarget};FastClick.prototype.onTouchStart=function(event){var targetElement,touch,selection;if(event.targetTouches.length>1){return true}targetElement=this.getTargetElementFromEventTarget(event.target);touch=event.targetTouches[0];if(deviceIsIOS){selection=window.getSelection();if(selection.rangeCount&&!selection.isCollapsed){return true}if(!deviceIsIOS4){if(touch.identifier&&touch.identifier===this.lastTouchIdentifier){event.preventDefault();return false}this.lastTouchIdentifier=touch.identifier;this.updateScrollParent(targetElement)}}this.trackingClick=true;this.trackingClickStart=event.timeStamp;this.targetElement=targetElement;this.touchStartX=touch.pageX;this.touchStartY=touch.pageY;if(event.timeStamp-this.lastClickTime<this.tapDelay){event.preventDefault()}return true};FastClick.prototype.touchHasMoved=function(event){var touch=event.changedTouches[0],boundary=this.touchBoundary;if(Math.abs(touch.pageX-this.touchStartX)>boundary||Math.abs(touch.pageY-this.touchStartY)>boundary){return true}return false};FastClick.prototype.onTouchMove=function(event){if(!this.trackingClick){return true}if(this.targetElement!==this.getTargetElementFromEventTarget(event.target)||this.touchHasMoved(event)){this.trackingClick=false;this.targetElement=null}return true};FastClick.prototype.findControl=function(labelElement){if(labelElement.control!==undefined){return labelElement.control}if(labelElement.htmlFor){return document.getElementById(labelElement.htmlFor)}return labelElement.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};FastClick.prototype.onTouchEnd=function(event){var forElement,trackingClickStart,targetTagName,scrollParent,touch,targetElement=this.targetElement;if(!this.trackingClick){return true}if(event.timeStamp-this.lastClickTime<this.tapDelay){this.cancelNextClick=true;return true}if(event.timeStamp-this.trackingClickStart>this.tapTimeout){return true}this.cancelNextClick=false;this.lastClickTime=event.timeStamp;trackingClickStart=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(deviceIsIOSWithBadTarget){touch=event.changedTouches[0];targetElement=document.elementFromPoint(touch.pageX-window.pageXOffset,touch.pageY-window.pageYOffset)||targetElement;targetElement.fastClickScrollParent=this.targetElement.fastClickScrollParent}targetTagName=targetElement.tagName.toLowerCase();if(targetTagName==="label"){forElement=this.findControl(targetElement);if(forElement){this.focus(targetElement);if(deviceIsAndroid){return false}targetElement=forElement}}else if(this.needsFocus(targetElement)){if(event.timeStamp-trackingClickStart>100||deviceIsIOS&&window.top!==window&&targetTagName==="input"){this.targetElement=null;return false}this.focus(targetElement);this.sendClick(targetElement,event);if(!deviceIsIOS||targetTagName!=="select"){this.targetElement=null;event.preventDefault()}return false}if(deviceIsIOS&&!deviceIsIOS4){scrollParent=targetElement.fastClickScrollParent;if(scrollParent&&scrollParent.fastClickLastScrollTop!==scrollParent.scrollTop){return true}}if(!this.needsClick(targetElement)){event.preventDefault();this.sendClick(targetElement,event)}return false};FastClick.prototype.onTouchCancel=function(){this.trackingClick=false;this.targetElement=null};FastClick.prototype.onMouse=function(event){if(!this.targetElement){return true}if(event.forwardedTouchEvent){return true}if(!event.cancelable){return true}if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(event.stopImmediatePropagation){event.stopImmediatePropagation()}else{event.propagationStopped=true}event.stopPropagation();event.preventDefault();return false}return true};FastClick.prototype.onClick=function(event){var permitted;if(this.trackingClick){this.targetElement=null;this.trackingClick=false;return true}if(event.target.type==="submit"&&event.detail===0){return true}permitted=this.onMouse(event);if(!permitted){this.targetElement=null}return permitted};FastClick.prototype.destroy=function(){var layer=this.layer;if(deviceIsAndroid){layer.removeEventListener("mouseover",this.onMouse,true);layer.removeEventListener("mousedown",this.onMouse,true);layer.removeEventListener("mouseup",this.onMouse,true)}layer.removeEventListener("click",this.onClick,true);layer.removeEventListener("touchstart",this.onTouchStart,false);layer.removeEventListener("touchmove",this.onTouchMove,false);layer.removeEventListener("touchend",this.onTouchEnd,false);layer.removeEventListener("touchcancel",this.onTouchCancel,false)};FastClick.notNeeded=function(layer){var metaViewport;var chromeVersion;var blackberryVersion;var firefoxVersion;if(typeof window.ontouchstart==="undefined"){return true}chromeVersion=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(chromeVersion){if(deviceIsAndroid){metaViewport=document.querySelector("meta[name=viewport]");if(metaViewport){if(metaViewport.content.indexOf("user-scalable=no")!==-1){return true}if(chromeVersion>31&&document.documentElement.scrollWidth<=window.outerWidth){return true}}}else{return true}}if(deviceIsBlackBerry10){blackberryVersion=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/);if(blackberryVersion[1]>=10&&blackberryVersion[2]>=3){metaViewport=document.querySelector("meta[name=viewport]");if(metaViewport){if(metaViewport.content.indexOf("user-scalable=no")!==-1){return true}if(document.documentElement.scrollWidth<=window.outerWidth){return true}}}}if(layer.style.msTouchAction==="none"||layer.style.touchAction==="manipulation"){return true}firefoxVersion=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(firefoxVersion>=27){metaViewport=document.querySelector("meta[name=viewport]");if(metaViewport&&(metaViewport.content.indexOf("user-scalable=no")!==-1||document.documentElement.scrollWidth<=window.outerWidth)){return true}}if(layer.style.touchAction==="none"||layer.style.touchAction==="manipulation"){return true}return false};FastClick.attach=function(layer,options){return new FastClick(layer,options)};if(typeof define==="function"&&typeof define.amd==="object"&&define.amd){define(function(){return FastClick})}else if(typeof module!=="undefined"&&module.exports){module.exports=FastClick.attach;module.exports.FastClick=FastClick}else{window.FastClick=FastClick}})();(function($,undefined){var uuid=0,runiqueId=/^ui-id-\d+$/;$.ui=$.ui||{};$.extend($.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});$.fn.extend({focus:function(orig){return function(delay,fn){return typeof delay==="number"?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus();if(fn){fn.call(elem)}},delay)}):orig.apply(this,arguments)}}($.fn.focus),scrollParent:function(){var scrollParent;if($.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))){scrollParent=this.parents().filter(function(){return/(relative|absolute|fixed)/.test($.css(this,"position"))&&/(auto|scroll)/.test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0)}else{scrollParent=this.parents().filter(function(){return/(auto|scroll)/.test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0)}return/fixed/.test(this.css("position"))||!scrollParent.length?$(document):scrollParent},zIndex:function(zIndex){if(zIndex!==undefined){return this.css("zIndex",zIndex)}if(this.length){var elem=$(this[0]),position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value}}elem=elem.parent()}}return 0},uniqueId:function(){return this.each(function(){if(!this.id){this.id="ui-id-"+ ++uuid}})},removeUniqueId:function(){return this.each(function(){if(runiqueId.test(this.id)){$(this).removeAttr("id")}})}});function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();if("area"===nodeName){map=element.parentNode;mapName=map.name;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return false}img=$("img[usemap=#"+mapName+"]")[0];return!!img&&visible(img)}return(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return $.css(this,"visibility")==="hidden"}).length}$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)}});if(!$("<a>").outerWidth(1).jquery){$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};
function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0;if(border){size-=parseFloat($.css(elem,"border"+this+"Width"))||0}if(margin){size-=parseFloat($.css(elem,"margin"+this))||0}});return size}$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this)}return this.each(function(){$(this).css(type,reduce(this,size)+"px")})};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size)}return this.each(function(){$(this).css(type,reduce(this,size,true,margin)+"px")})}})}if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}}if($("<a>").data("a-b","a").removeData("a-b").data("a-b")){$.fn.removeData=function(removeData){return function(key){if(arguments.length){return removeData.call(this,$.camelCase(key))}else{return removeData.call(this)}}}($.fn.removeData)}$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());$.support.selectstart="onselectstart"in document.createElement("div");$.fn.extend({disableSelection:function(){return this.bind(($.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(event){event.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});$.extend($.ui,{plugin:{add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]])}},call:function(instance,name,args){var i,set=instance.plugins[name];if(!set||!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11){return}for(i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args)}}}},hasScroll:function(el,a){if($(el).css("overflow")==="hidden"){return false}var scroll=a&&a==="left"?"scrollLeft":"scrollTop",has=false;if(el[scroll]>0){return true}el[scroll]=1;has=el[scroll]>0;el[scroll]=0;return has}})})(jQuery);(function($,undefined){var uuid=0,slice=Array.prototype.slice,_cleanData=$.cleanData;$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!=null;i++){try{$(elem).triggerHandler("remove")}catch(e){}}_cleanData(elems)};$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget}$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element)}if(arguments.length){this._createWidget(options,element)}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base;basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return}proxiedPrototype[prop]=function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue}}()});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix||name:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)});delete existingConstructor._childConstructors}else{base._childConstructors.push(constructor)}$.widget.bridge(name,constructor)};$.widget.extend=function(target){var input=slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value)}else{target[key]=value}}}}return target};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'")}if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance")}methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false}})}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{})._init()}else{$.data(this,fullName,new object(options,this))}})}return returnValue}};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy()}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options)}if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}key=parts.pop();if(arguments.length===1){return curOption[key]===undefined?null:curOption[key]}curOption[key]=value}else{if(arguments.length===1){return this.options[key]===undefined?null:this.options[key]}options[key]=value}}this._setOptions(options);return this},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key])}return this},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!value).attr("aria-disabled",value);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false}if(!handlers){handlers=element;element=this.element;delegateElement=this.widget()}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element)}$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return}return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++}var match=event.match(/^(\w+)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy)}else{element.bind(eventName,handlerProxy)}})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;element.unbind(eventName).undelegate(eventName)},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover")},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus")},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop]}}}this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented())}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options}}var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options}}hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay)}if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options)}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback)}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0])}next()})}}})})(jQuery);(function($,undefined){var mouseHandled=false;$(document).mouseup(function(){mouseHandled=false});$.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event){return that._mouseDown(event)}).bind("click."+this.widgetName,function(event){if(true===$.data(event.target,that.widgetName+".preventClickEvent")){$.removeData(event.target,that.widgetName+".preventClickEvent");event.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(event){if(mouseHandled){return}this._mouseStarted&&this._mouseUp(event);this._mouseDownEvent=event;var that=this,btnIsLeft=event.which===1,elIsCancel=typeof this.options.cancel==="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:false;if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=this._mouseStart(event)!==false;if(!this._mouseStarted){event.preventDefault();return true}}if(true===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(event){return that._mouseMove(event)};this._mouseUpDelegate=function(event){return that._mouseUp(event)};$(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=true;return true},_mouseMove:function(event){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button){return this._mouseUp(event)}if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault()}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=this._mouseStart(this._mouseDownEvent,event)!==false;this._mouseStarted?this._mouseDrag(event):this._mouseUp(event)}return!this._mouseStarted},_mouseUp:function(event){$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(event.target===this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(event)}return false},_mouseDistanceMet:function(event){return Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);(function($){$.support.touch="ontouchend"in document;if(!$.support.touch){return}var mouseProto=$.ui.mouse.prototype,_mouseInit=mouseProto._mouseInit,touchHandled;function simulateMouseEvent(event,simulatedType){if(event.originalEvent.touches.length>1){return}event.preventDefault();var touch=event.originalEvent.changedTouches[0],simulatedEvent=document.createEvent("MouseEvents");simulatedEvent.initMouseEvent(simulatedType,true,true,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,false,false,false,false,0,null);event.target.dispatchEvent(simulatedEvent)}mouseProto._touchStart=function(event){var self=this;if(touchHandled||!self._mouseCapture(event.originalEvent.changedTouches[0])){return}touchHandled=true;self._touchMoved=false;simulateMouseEvent(event,"mouseover");simulateMouseEvent(event,"mousemove");simulateMouseEvent(event,"mousedown")};mouseProto._touchMove=function(event){if(!touchHandled){return}this._touchMoved=true;simulateMouseEvent(event,"mousemove")};mouseProto._touchEnd=function(event){if(!touchHandled){return}simulateMouseEvent(event,"mouseup");simulateMouseEvent(event,"mouseout");if(!this._touchMoved){simulateMouseEvent(event,"click")}touchHandled=false};mouseProto._mouseInit=function(){var self=this;self.element.bind("touchstart",$.proxy(self,"_touchStart")).bind("touchmove",$.proxy(self,"_touchMove")).bind("touchend",$.proxy(self,"_touchEnd"));_mouseInit.call(self)}})(jQuery);(function($,undefined){var numPages=5;$.widget("ui.slider",$.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider"+" ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=false},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var i,handleCount,options=this.options,existingHandles=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),handle="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",handles=[];handleCount=options.values&&options.values.length||1;if(existingHandles.length>handleCount){existingHandles.slice(handleCount).remove();existingHandles=existingHandles.slice(0,handleCount)}for(i=existingHandles.length;i<handleCount;i++){handles.push(handle)}this.handles=existingHandles.add($(handles.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(i){$(this).data("ui-slider-handle-index",i)})},_createRange:function(){var options=this.options,classes="";if(options.range){if(options.range===true){if(!options.values){options.values=[this._valueMin(),this._valueMin()]}else if(options.values.length&&options.values.length!==2){options.values=[options.values[0],options.values[0]]}else if($.isArray(options.values)){options.values=options.values.slice(0)}}if(!this.range||!this.range.length){this.range=$("<div></div>").appendTo(this.element);classes="ui-slider-range"+" ui-widget-header ui-corner-all"}else{this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""})}this.range.addClass(classes+(options.range==="min"||options.range==="max"?" ui-slider-range-"+options.range:""))}else{if(this.range){this.range.remove()}this.range=null}},_setupEvents:function(){var elements=this.handles.add(this.range).filter("a");this._off(elements);this._on(elements,this._handleEvents);this._hoverable(elements);this._focusable(elements)},_destroy:function(){this.handles.remove();if(this.range){this.range.remove()}this.element.removeClass("ui-slider"+" ui-slider-horizontal"+" ui-slider-vertical"+" ui-widget"+" ui-widget-content"+" ui-corner-all");this._mouseDestroy()},_mouseCapture:function(event){var position,normValue,distance,closestHandle,index,allowed,offset,mouseOverHandle,that=this,o=this.options;if(o.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();position={x:event.pageX,y:event.pageY};normValue=this._normValueFromMouse(position);distance=this._valueMax()-this._valueMin()+1;this.handles.each(function(i){var thisDistance=Math.abs(normValue-that.values(i));if(distance>thisDistance||distance===thisDistance&&(i===that._lastChangedValue||that.values(i)===o.min)){distance=thisDistance;closestHandle=$(this);index=i}});allowed=this._start(event,index);if(allowed===false){return false}this._mouseSliding=true;this._handleIndex=index;closestHandle.addClass("ui-state-active").focus();offset=closestHandle.offset();mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle");this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-closestHandle.width()/2,top:event.pageY-offset.top-closestHandle.height()/2-(parseInt(closestHandle.css("borderTopWidth"),10)||0)-(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+(parseInt(closestHandle.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(event,index,normValue)}this._animateOff=true;return true},_mouseStart:function(){return true},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);this._slide(event,this._handleIndex,normValue);return false},_mouseStop:function(event){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(event,this._handleIndex);this._change(event,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;if(this.orientation==="horizontal"){pixelTotal=this.elementSize.width;pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{pixelTotal=this.elementSize.height;pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}percentMouse=pixelMouse/pixelTotal;if(percentMouse>1){percentMouse=1}if(percentMouse<0){percentMouse=0}if(this.orientation==="vertical"){percentMouse=1-percentMouse}valueTotal=this._valueMax()-this._valueMin();valueMouse=this._valueMin()+percentMouse*valueTotal;return this._trimAlignValue(valueMouse)},_start:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}return this._trigger("start",event,uiHash)},_slide:function(event,index,newVal){var otherVal,newValues,allowed;if(this.options.values&&this.options.values.length){otherVal=this.values(index?0:1);if(this.options.values.length===2&&this.options.range===true&&(index===0&&newVal>otherVal||index===1&&newVal<otherVal)){newVal=otherVal}if(newVal!==this.values(index)){newValues=this.values();newValues[index]=newVal;allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal,values:newValues});otherVal=this.values(index?0:1);if(allowed!==false){this.values(index,newVal)}}}else{if(newVal!==this.value()){allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal});if(allowed!==false){this.value(newVal)}}}},_stop:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}this._trigger("stop",event,uiHash)},_change:function(event,index){if(!this._keySliding&&!this._mouseSliding){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}this._lastChangedValue=index;this._trigger("change",event,uiHash)}},value:function(newValue){if(arguments.length){this.options.value=this._trimAlignValue(newValue);this._refreshValue();this._change(null,0);return}return this._value()},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1){this.options.values[index]=this._trimAlignValue(newValue);this._refreshValue();this._change(null,index);return}if(arguments.length){if($.isArray(arguments[0])){vals=this.options.values;newValues=arguments[0];for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(newValues[i]);this._change(null,i)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(index)}else{return this.value()}}}else{return this._values()}},_setOption:function(key,value){var i,valsLength=0;if(key==="range"&&this.options.range===true){if(value==="min"){this.options.value=this._values(0);this.options.values=null}else if(value==="max"){this.options.value=this._values(this.options.values.length-1);this.options.values=null}}if($.isArray(this.options.values)){valsLength=this.options.values.length}$.Widget.prototype._setOption.apply(this,arguments);switch(key){case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(i=0;i<valsLength;i+=1){this._change(null,i)}this._animateOff=false;break;case"min":case"max":this._animateOff=true;this._refreshValue();this._animateOff=false;break;case"range":this._animateOff=true;this._refresh();this._animateOff=false;break}},_value:function(){var val=this.options.value;val=this._trimAlignValue(val);return val},_values:function(index){var val,vals,i;if(arguments.length){val=this.options.values[index];val=this._trimAlignValue(val);return val}else if(this.options.values&&this.options.values.length){vals=this.options.values.slice();for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(vals[i])}return vals}else{return[]}},_trimAlignValue:function(val){if(val<=this._valueMin()){return this._valueMin()}if(val>=this._valueMax()){return this._valueMax()}var step=this.options.step>0?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;if(Math.abs(valModStep)*2>=step){alignValue+=valModStep>0?step:-step}return parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var lastValPercent,valPercent,value,valueMin,valueMax,oRange=this.options.range,o=this.options,that=this,animate=!this._animateOff?o.animate:false,_set={};if(this.options.values&&this.options.values.length){this.handles.each(function(i){valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-that._valueMin())*100;_set[that.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate);if(that.options.range===true){if(that.orientation==="horizontal"){if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate)}if(i===1){that.range[animate?"animate":"css"]({width:valPercent-lastValPercent+"%"},{queue:false,duration:o.animate})}}else{if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({bottom:valPercent+"%"},o.animate)}if(i===1){that.range[animate?"animate":"css"]({height:valPercent-lastValPercent+"%"},{queue:false,duration:o.animate})}}}lastValPercent=valPercent})}else{value=this.value();valueMin=this._valueMin();valueMax=this._valueMax();valPercent=valueMax!==valueMin?(value-valueMin)/(valueMax-valueMin)*100:0;_set[this.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate);if(oRange==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate)}if(oRange==="max"&&this.orientation==="horizontal"){this.range[animate?"animate":"css"]({width:100-valPercent+"%"},{queue:false,duration:o.animate})}if(oRange==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate)}if(oRange==="max"&&this.orientation==="vertical"){this.range[animate?"animate":"css"]({height:100-valPercent+"%"},{queue:false,duration:o.animate})}}},_handleEvents:{keydown:function(event){var allowed,curVal,newVal,step,index=$(event.target).data("ui-slider-handle-index");switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:event.preventDefault();if(!this._keySliding){this._keySliding=true;$(event.target).addClass("ui-state-active");allowed=this._start(event,index);if(allowed===false){return}}break}step=this.options.step;if(this.options.values&&this.options.values.length){curVal=newVal=this.values(index)}else{curVal=newVal=this.value()}switch(event.keyCode){case $.ui.keyCode.HOME:newVal=this._valueMin();break;case $.ui.keyCode.END:newVal=this._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=this._trimAlignValue(curVal+(this._valueMax()-this._valueMin())/numPages);break;case $.ui.keyCode.PAGE_DOWN:newVal=this._trimAlignValue(curVal-(this._valueMax()-this._valueMin())/numPages);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===this._valueMax()){return}newVal=this._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===this._valueMin()){return}newVal=this._trimAlignValue(curVal-step);break}this._slide(event,index,newVal)},click:function(event){event.preventDefault()},keyup:function(event){var index=$(event.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=false;this._stop(event,index);this._change(event,index);$(event.target).removeClass("ui-state-active")}}}})})(jQuery);(function($){var delimiter=new Array;var tags_callbacks=new Array;$.fn.doAutosize=function(o){var minWidth=$(this).data("minwidth"),maxWidth=$(this).data("maxwidth"),val="",input=$(this),testSubject=$("#"+$(this).data("tester_id"));if(val===(val=input.val())){return}var escaped=val.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");testSubject.html(escaped);var testerWidth=testSubject.width(),newWidth=testerWidth+o.comfortZone>=minWidth?testerWidth+o.comfortZone:minWidth,currentWidth=input.width(),isValidWidthChange=newWidth<currentWidth&&newWidth>=minWidth||newWidth>minWidth&&newWidth<maxWidth;if(isValidWidthChange){input.width(newWidth)}};$.fn.resetAutosize=function(options){var minWidth=$(this).data("minwidth")||options.minInputWidth||$(this).width(),maxWidth=$(this).data("maxwidth")||options.maxInputWidth||$(this).closest(".tagsinput").width()-options.inputPadding,val="",input=$(this),testSubject=$("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:input.css("fontSize"),fontFamily:input.css("fontFamily"),fontWeight:input.css("fontWeight"),letterSpacing:input.css("letterSpacing"),whiteSpace:"nowrap"}),testerId=$(this).attr("id")+"_autosize_tester";if(!$("#"+testerId).length>0){testSubject.attr("id",testerId);testSubject.appendTo("body")}input.data("minwidth",minWidth);input.data("maxwidth",maxWidth);input.data("tester_id",testerId);input.css("width",minWidth)};$.fn.addTag=function(value,options){options=jQuery.extend({focus:false,callback:true},options);this.each(function(){var id=$(this).attr("id");var tagslist=$(this).val().split(delimiter[id]);if(tagslist[0]==""){tagslist=new Array}value=jQuery.trim(value);if(options.unique){var skipTag=$(this).tagExist(value);if(skipTag==true){$("#"+id+"_tag").addClass("not_valid")}}else{var skipTag=false}if(value!=""&&skipTag!=true){$("<span>").addClass("tag").append($("<span>").text(value).append("&nbsp;&nbsp;"),$("<a>",{href:"#",title:"Removing tag",text:"x"}).click(function(){return $("#"+id).removeTag(escape(value))})).insertBefore("#"+id+"_addTag");tagslist.push(value);$("#"+id+"_tag").val("");if(options.focus){$("#"+id+"_tag").focus()}else{$("#"+id+"_tag").blur()}$.fn.tagsInput.updateTagsField(this,tagslist);if(options.callback&&tags_callbacks[id]&&tags_callbacks[id]["onAddTag"]){var f=tags_callbacks[id]["onAddTag"];f.call(this,value)}if(tags_callbacks[id]&&tags_callbacks[id]["onChange"]){var i=tagslist.length;var f=tags_callbacks[id]["onChange"];f.call(this,$(this),tagslist[i-1])}}});return false};$.fn.removeTag=function(value){value=unescape(value);this.each(function(){var id=$(this).attr("id");var old=$(this).val().split(delimiter[id]);$("#"+id+"_tagsinput .tag").remove();str="";for(i=0;i<old.length;i++){if(old[i]!=value){str=str+delimiter[id]+old[i]}}$.fn.tagsInput.importTags(this,str);if(tags_callbacks[id]&&tags_callbacks[id]["onRemoveTag"]){var f=tags_callbacks[id]["onRemoveTag"];f.call(this,value)}});return false};$.fn.tagExist=function(val){var id=$(this).attr("id");var tagslist=$(this).val().split(delimiter[id]);return jQuery.inArray(val,tagslist)>=0};$.fn.importTags=function(str){var id=$(this).attr("id");$("#"+id+"_tagsinput .tag").remove();$.fn.tagsInput.importTags(this,str)};$.fn.tagsInput=function(options){var settings=jQuery.extend({interactive:true,defaultText:"add a tag",minChars:0,width:"300px",height:"100px",autocomplete:{selectFirst:false},hide:true,delimiter:",",unique:true,removeWithBackspace:true,placeholderColor:"#666666",autosize:true,comfortZone:20,inputPadding:6*2},options);
var uniqueIdCounter=0;this.each(function(){if(typeof $(this).attr("data-tagsinput-init")!=="undefined"){return}$(this).attr("data-tagsinput-init",true);if(settings.hide){$(this).hide()}var id=$(this).attr("id");if(!id||delimiter[$(this).attr("id")]){id=$(this).attr("id","tags"+(new Date).getTime()+uniqueIdCounter++).attr("id")}var data=jQuery.extend({pid:id,real_input:"#"+id,holder:"#"+id+"_tagsinput",input_wrapper:"#"+id+"_addTag",fake_input:"#"+id+"_tag"},settings);delimiter[id]=data.delimiter;if(settings.onAddTag||settings.onRemoveTag||settings.onChange){tags_callbacks[id]=new Array;tags_callbacks[id]["onAddTag"]=settings.onAddTag;tags_callbacks[id]["onRemoveTag"]=settings.onRemoveTag;tags_callbacks[id]["onChange"]=settings.onChange}var markup='<div id="'+id+'_tagsinput" class="tagsinput"><div id="'+id+'_addTag">';if(settings.interactive){markup=markup+'<input id="'+id+'_tag" value="" data-default="'+settings.defaultText+'" />'}markup=markup+'</div><div class="tags_clear"></div></div>';$(markup).insertAfter(this);$(data.holder).css("width",settings.width);$(data.holder).css("min-height",settings.height);$(data.holder).css("height",settings.height);if($(data.real_input).val()!=""){$.fn.tagsInput.importTags($(data.real_input),$(data.real_input).val())}if(settings.interactive){$(data.fake_input).val($(data.fake_input).attr("data-default"));$(data.fake_input).css("color",settings.placeholderColor);$(data.fake_input).resetAutosize(settings);$(data.holder).bind("click",data,function(event){$(event.data.fake_input).focus()});$(data.fake_input).bind("focus",data,function(event){if($(event.data.fake_input).val()==$(event.data.fake_input).attr("data-default")){$(event.data.fake_input).val("")}$(event.data.fake_input).css("color","#000000")});if(settings.autocomplete_url!=undefined){autocomplete_options={source:settings.autocomplete_url};for(attrname in settings.autocomplete){autocomplete_options[attrname]=settings.autocomplete[attrname]}if(jQuery.Autocompleter!==undefined){$(data.fake_input).autocomplete(settings.autocomplete_url,settings.autocomplete);$(data.fake_input).bind("result",data,function(event,data,formatted){if(data){$("#"+id).addTag(data[0]+"",{focus:true,unique:settings.unique})}})}else if(jQuery.ui.autocomplete!==undefined){$(data.fake_input).autocomplete(autocomplete_options);$(data.fake_input).bind("autocompleteselect",data,function(event,ui){$(event.data.real_input).addTag(ui.item.value,{focus:true,unique:settings.unique});return false})}}else{$(data.fake_input).bind("blur",data,function(event){var d=$(this).attr("data-default");if($(event.data.fake_input).val()!=""&&$(event.data.fake_input).val()!=d){if(event.data.minChars<=$(event.data.fake_input).val().length&&(!event.data.maxChars||event.data.maxChars>=$(event.data.fake_input).val().length))$(event.data.real_input).addTag($(event.data.fake_input).val(),{focus:true,unique:settings.unique})}else{$(event.data.fake_input).val($(event.data.fake_input).attr("data-default"));$(event.data.fake_input).css("color",settings.placeholderColor)}return false})}$(data.fake_input).bind("keypress",data,function(event){if(_checkDelimiter(event)){event.preventDefault();if(event.data.minChars<=$(event.data.fake_input).val().length&&(!event.data.maxChars||event.data.maxChars>=$(event.data.fake_input).val().length))$(event.data.real_input).addTag($(event.data.fake_input).val(),{focus:true,unique:settings.unique});$(event.data.fake_input).resetAutosize(settings);return false}else if(event.data.autosize){$(event.data.fake_input).doAutosize(settings)}});data.removeWithBackspace&&$(data.fake_input).bind("keydown",function(event){if(event.keyCode==8&&$(this).val()==""){event.preventDefault();var last_tag=$(this).closest(".tagsinput").find(".tag:last").text();var id=$(this).attr("id").replace(/_tag$/,"");last_tag=last_tag.replace(/[\s]+x$/,"");$("#"+id).removeTag(escape(last_tag));$(this).trigger("focus")}});$(data.fake_input).blur();if(data.unique){$(data.fake_input).keydown(function(event){if(event.keyCode==8||String.fromCharCode(event.which).match(/\w+|[Ã¡Ã©Ã­Ã³ÃºÃÃÃÃÃÃ±Ã,\/]+/)){$(this).removeClass("not_valid")}})}}});return this};$.fn.tagsInput.updateTagsField=function(obj,tagslist){var id=$(obj).attr("id");$(obj).val(tagslist.join(delimiter[id]))};$.fn.tagsInput.importTags=function(obj,val){$(obj).val("");var id=$(obj).attr("id");var tags=val.split(delimiter[id]);for(i=0;i<tags.length;i++){$(obj).addTag(tags[i],{focus:false,callback:false})}if(tags_callbacks[id]&&tags_callbacks[id]["onChange"]){var f=tags_callbacks[id]["onChange"];f.call(obj,obj,tags[i])}};var _checkDelimiter=function(event){var found=false;if(event.which==13){return true}if(typeof event.data.delimiter==="string"){if(event.which==event.data.delimiter.charCodeAt(0)){found=true}}else{$.each(event.data.delimiter,function(index,delimiter){if(event.which==delimiter.charCodeAt(0)){found=true}})}return found}})(jQuery);(function(root,factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else if(typeof exports==="object"){module.exports=factory(require("jquery"))}else{factory(root.jQuery)}})(this,function($){$.transit={version:"0.9.12",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:true,useTransitionEnd:false};var div=document.createElement("div");var support={};function getVendorPropertyName(prop){if(prop in div.style)return prop;var prefixes=["Moz","Webkit","O","ms"];var prop_=prop.charAt(0).toUpperCase()+prop.substr(1);for(var i=0;i<prefixes.length;++i){var vendorProp=prefixes[i]+prop_;if(vendorProp in div.style){return vendorProp}}}function checkTransform3dSupport(){div.style[support.transform]="";div.style[support.transform]="rotateY(90deg)";return div.style[support.transform]!==""}var isChrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;support.transition=getVendorPropertyName("transition");support.transitionDelay=getVendorPropertyName("transitionDelay");support.transform=getVendorPropertyName("transform");support.transformOrigin=getVendorPropertyName("transformOrigin");support.filter=getVendorPropertyName("Filter");support.transform3d=checkTransform3dSupport();var eventNames={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"};var transitionEnd=support.transitionEnd=eventNames[support.transition]||null;for(var key in support){if(support.hasOwnProperty(key)&&typeof $.support[key]==="undefined"){$.support[key]=support[key]}}div=null;$.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeInCubic:"cubic-bezier(.550,.055,.675,.190)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"};$.cssHooks["transit:transform"]={get:function(elem){return $(elem).data("transform")||new Transform},set:function(elem,v){var value=v;if(!(value instanceof Transform)){value=new Transform(value)}if(support.transform==="WebkitTransform"&&!isChrome){elem.style[support.transform]=value.toString(true)}else{elem.style[support.transform]=value.toString()}$(elem).data("transform",value)}};$.cssHooks.transform={set:$.cssHooks["transit:transform"].set};$.cssHooks.filter={get:function(elem){return elem.style[support.filter]},set:function(elem,value){elem.style[support.filter]=value}};if($.fn.jquery<"1.8"){$.cssHooks.transformOrigin={get:function(elem){return elem.style[support.transformOrigin]},set:function(elem,value){elem.style[support.transformOrigin]=value}};$.cssHooks.transition={get:function(elem){return elem.style[support.transition]},set:function(elem,value){elem.style[support.transition]=value}}}registerCssHook("scale");registerCssHook("scaleX");registerCssHook("scaleY");registerCssHook("translate");registerCssHook("rotate");registerCssHook("rotateX");registerCssHook("rotateY");registerCssHook("rotate3d");registerCssHook("perspective");registerCssHook("skewX");registerCssHook("skewY");registerCssHook("x",true);registerCssHook("y",true);function Transform(str){if(typeof str==="string"){this.parse(str)}return this}Transform.prototype={setFromString:function(prop,val){var args=typeof val==="string"?val.split(","):val.constructor===Array?val:[val];args.unshift(prop);Transform.prototype.set.apply(this,args)},set:function(prop){var args=Array.prototype.slice.apply(arguments,[1]);if(this.setter[prop]){this.setter[prop].apply(this,args)}else{this[prop]=args.join(",")}},get:function(prop){if(this.getter[prop]){return this.getter[prop].apply(this)}else{return this[prop]||0}},setter:{rotate:function(theta){this.rotate=unit(theta,"deg")},rotateX:function(theta){this.rotateX=unit(theta,"deg")},rotateY:function(theta){this.rotateY=unit(theta,"deg")},scale:function(x,y){if(y===undefined){y=x}this.scale=x+","+y},skewX:function(x){this.skewX=unit(x,"deg")},skewY:function(y){this.skewY=unit(y,"deg")},perspective:function(dist){this.perspective=unit(dist,"px")},x:function(x){this.set("translate",x,null)},y:function(y){this.set("translate",null,y)},translate:function(x,y){if(this._translateX===undefined){this._translateX=0}if(this._translateY===undefined){this._translateY=0}if(x!==null&&x!==undefined){this._translateX=unit(x,"px")}if(y!==null&&y!==undefined){this._translateY=unit(y,"px")}this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var s=(this.scale||"1,1").split(",");if(s[0]){s[0]=parseFloat(s[0])}if(s[1]){s[1]=parseFloat(s[1])}return s[0]===s[1]?s[0]:s},rotate3d:function(){var s=(this.rotate3d||"0,0,0,0deg").split(",");for(var i=0;i<=3;++i){if(s[i]){s[i]=parseFloat(s[i])}}if(s[3]){s[3]=unit(s[3],"deg")}return s}},parse:function(str){var self=this;str.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(x,prop,val){self.setFromString(prop,val)})},toString:function(use3d){var re=[];for(var i in this){if(this.hasOwnProperty(i)){if(!support.transform3d&&(i==="rotateX"||i==="rotateY"||i==="perspective"||i==="transformOrigin")){continue}if(i[0]!=="_"){if(use3d&&i==="scale"){re.push(i+"3d("+this[i]+",1)")}else if(use3d&&i==="translate"){re.push(i+"3d("+this[i]+",0)")}else{re.push(i+"("+this[i]+")")}}}}return re.join(" ")}};function callOrQueue(self,queue,fn){if(queue===true){self.queue(fn)}else if(queue){self.queue(queue,fn)}else{self.each(function(){fn.call(this)})}}function getProperties(props){var re=[];$.each(props,function(key){key=$.camelCase(key);key=$.transit.propertyMap[key]||$.cssProps[key]||key;key=uncamel(key);if(support[key])key=uncamel(support[key]);if($.inArray(key,re)===-1){re.push(key)}});return re}function getTransition(properties,duration,easing,delay){var props=getProperties(properties);if($.cssEase[easing]){easing=$.cssEase[easing]}var attribs=""+toMS(duration)+" "+easing;if(parseInt(delay,10)>0){attribs+=" "+toMS(delay)}var transitions=[];$.each(props,function(i,name){transitions.push(name+" "+attribs)});return transitions.join(", ")}$.fn.transition=$.fn.transit=function(properties,duration,easing,callback){var self=this;var delay=0;var queue=true;var theseProperties=$.extend(true,{},properties);if(typeof duration==="function"){callback=duration;duration=undefined}if(typeof duration==="object"){easing=duration.easing;delay=duration.delay||0;queue=typeof duration.queue==="undefined"?true:duration.queue;callback=duration.complete;duration=duration.duration}if(typeof easing==="function"){callback=easing;easing=undefined}if(typeof theseProperties.easing!=="undefined"){easing=theseProperties.easing;delete theseProperties.easing}if(typeof theseProperties.duration!=="undefined"){duration=theseProperties.duration;delete theseProperties.duration}if(typeof theseProperties.complete!=="undefined"){callback=theseProperties.complete;delete theseProperties.complete}if(typeof theseProperties.queue!=="undefined"){queue=theseProperties.queue;delete theseProperties.queue}if(typeof theseProperties.delay!=="undefined"){delay=theseProperties.delay;delete theseProperties.delay}if(typeof duration==="undefined"){duration=$.fx.speeds._default}if(typeof easing==="undefined"){easing=$.cssEase._default}duration=toMS(duration);var transitionValue=getTransition(theseProperties,duration,easing,delay);var work=$.transit.enabled&&support.transition;var i=work?parseInt(duration,10)+parseInt(delay,10):0;if(i===0){var fn=function(next){self.css(theseProperties);if(callback){callback.apply(self)}if(next){next()}};callOrQueue(self,queue,fn);return self}var oldTransitions={};var run=function(nextCall){var bound=false;var cb=function(){if(bound){self.unbind(transitionEnd,cb)}if(i>0){self.each(function(){this.style[support.transition]=oldTransitions[this]||null})}if(typeof callback==="function"){callback.apply(self)}if(typeof nextCall==="function"){nextCall()}};if(i>0&&transitionEnd&&$.transit.useTransitionEnd){bound=true;self.bind(transitionEnd,cb)}else{window.setTimeout(cb,i)}self.each(function(){if(i>0){this.style[support.transition]=transitionValue}$(this).css(theseProperties)})};var deferredRun=function(next){this.offsetWidth;run(next)};callOrQueue(self,queue,deferredRun);return this};function registerCssHook(prop,isPixels){if(!isPixels){$.cssNumber[prop]=true}$.transit.propertyMap[prop]=support.transform;$.cssHooks[prop]={get:function(elem){var t=$(elem).css("transit:transform");return t.get(prop)},set:function(elem,value){var t=$(elem).css("transit:transform");t.setFromString(prop,value);$(elem).css({"transit:transform":t})}}}function uncamel(str){return str.replace(/([A-Z])/g,function(letter){return"-"+letter.toLowerCase()})}function unit(i,units){if(typeof i==="string"&&!i.match(/^[\-0-9\.]+$/)){return i}else{return""+i+units}}function toMS(duration){var i=duration;if(typeof i==="string"&&!i.match(/^[\-0-9\.]+/)){i=$.fx.speeds[i]||$.fx.speeds._default}return unit(i,"ms")}$.transit.getTransitionValue=getTransition;return $});if(typeof jQuery==="undefined"){throw new Error("jquery-confirm requires jQuery")}var jconfirm,Jconfirm;(function($){"use strict";$.fn.confirm=function(options,option2){if(typeof options==="undefined")options={};if(typeof options==="string")options={content:options,title:option2?option2:false};$(this).each(function(){var $this=$(this);$this.on("click",function(e){e.preventDefault();var jcOption=$.extend({},options);if($this.attr("data-title"))jcOption["title"]=$this.attr("data-title");if($this.attr("data-content"))jcOption["content"]=$this.attr("data-content");jcOption["$target"]=$this;if($this.attr("href")&&!options["confirm"])jcOption["confirm"]=function(){location.href=$this.attr("href")};$.confirm(jcOption)})});return $(this)};$.confirm=function(options,option2){if(typeof options==="undefined")options={};if(typeof options==="string")options={content:options,title:option2?option2:false};return jconfirm(options)};$.alert=function(options,option2){if(typeof options==="undefined")options={};if(typeof options==="string")options={content:options,title:option2?option2:false};options.cancelButton=false;return jconfirm(options)};$.dialog=function(options,option2){if(typeof options==="undefined")options={};if(typeof options==="string")options={content:options,title:option2?option2:false};options.cancelButton=false;options.confirmButton=false;options.confirmKeys=[13];return jconfirm(options)};jconfirm=function(options){if(typeof options==="undefined")options={};if(jconfirm.defaults){$.extend(jconfirm.pluginDefaults,jconfirm.defaults)}var options=$.extend({},jconfirm.pluginDefaults,options);return new Jconfirm(options)};Jconfirm=function(options){$.extend(this,options);this._init()};Jconfirm.prototype={_init:function(){var that=this;this._rand=Math.round(Math.random()*99999);this._buildHTML();this._bindEvents();setTimeout(function(){that.open();that._watchContent()},0)},_buildHTML:function(){var that=this;this.animation="anim-"+this.animation.toLowerCase();this.closeAnimation="anim-"+this.closeAnimation.toLowerCase();this.theme="jconfirm-"+this.theme.toLowerCase();if(this.animation=="anim-none")this.animationSpeed=0;this._lastFocused=$("body").find(":focus");this.$el=$(this.template).appendTo(this.container).addClass(this.theme);this.$el.find(".jconfirm-box-container").addClass(this.columnClass);this.$el.find(".jconfirm-bg").css(this._getCSS(this.animationSpeed,1));this.$el.find(".jconfirm-bg").css("opacity",this.opacity);this.$b=this.$el.find(".jconfirm-box").css(this._getCSS(this.animationSpeed,this.animationBounce)).addClass(this.animation);this.$body=this.$b;if(this.rtl)this.$el.addClass("rtl");this._contentReady=$.Deferred();this._modalReady=$.Deferred();this.$title=this.$el.find(".title");this.contentDiv=this.$el.find("div.content");this.$content=this.contentDiv;this.$contentPane=this.$el.find(".content-pane");this.$icon=this.$el.find(".icon-c");this.$closeIcon=this.$el.find(".closeIcon");this.$contentPane.css(this._getCSS(this.animationSpeed,1));this.setTitle();this.setIcon();this._setButtons();if(this.closeIconClass)this.$closeIcon.html('<i class="'+this.closeIconClass+'"></i>');that._contentHash=this._hash(that.$content.html());$.when(this._contentReady,this._modalReady).then(function(){that.setContent();that.setTitle();that.setIcon()});this._getContent();this._imagesLoaded();if(this.autoClose)this._startCountDown()},_unwatchContent:function(){clearInterval(this._timer)},_hash:function(){return btoa(encodeURIComponent(this.$content.html()))},_watchContent:function(){var that=this;this._timer=setInterval(function(){var now=that._hash(that.$content.html());if(that._contentHash!=now){that._contentHash=now;that.setDialogCenter();that._imagesLoaded()}},this.watchInterval)},_bindEvents:function(){var that=this;var boxClicked=false;this.$el.find(".jconfirm-scrollpane").click(function(e){if(!boxClicked){if(that.backgroundDismiss){that.cancel();that.close()}else{that.$b.addClass("hilight");setTimeout(function(){that.$b.removeClass("hilight")},800)}}boxClicked=false});this.$el.find(".jconfirm-box").click(function(e){boxClicked=true});if(this.$confirmButton){this.$confirmButton.click(function(e){e.preventDefault();var r=that.confirm(that.$b);that._stopCountDown();that.onAction("confirm");if(typeof r==="undefined"||r)that.close()})}if(this.$cancelButton){this.$cancelButton.click(function(e){e.preventDefault();var r=that.cancel(that.$b);that._stopCountDown();that.onAction("cancel");if(typeof r==="undefined"||r)that.close()})}if(this.$closeButton){this.$closeButton.click(function(e){e.preventDefault();that._stopCountDown();that.cancel();that.onAction("close");that.close()})}if(this.keyboardEnabled){setTimeout(function(){$(window).on("keyup."+this._rand,function(e){that.reactOnKey(e)})},500)}$(window).on("resize."+this._rand,function(){that.setDialogCenter(true)})},_getCSS:function(speed,bounce){return{"-webkit-transition-duration":speed/1e3+"s","transition-duration":speed/1e3+"s","-webkit-transition-timing-function":"cubic-bezier(.36,1.1,.2, "+bounce+")","transition-timing-function":"cubic-bezier(.36,1.1,.2, "+bounce+")"}},_imagesLoaded:function(){var that=this;$.each(this.$content.find("img:not(.loaded)"),function(i,a){var interval=setInterval(function(){var h=$(a).css("height");if(h!=="0px"){$(a).addClass("loaded");that.setDialogCenter();clearInterval(interval)}},40)})},_setButtons:function(){this.$btnc=this.$el.find(".buttons");if(this.confirmButton&&$.trim(this.confirmButton)!==""){this.$confirmButton=$('<button type="button" class="btn">'+this.confirmButton+"</button>").appendTo(this.$btnc).addClass(this.confirmButtonClass)}if(this.cancelButton&&$.trim(this.cancelButton)!==""){this.$cancelButton=$('<button type="button" class="btn">'+this.cancelButton+"</button>").appendTo(this.$btnc).addClass(this.cancelButtonClass)}if(!this.confirmButton&&!this.cancelButton){this.$btnc.hide()}if(!this.confirmButton&&!this.cancelButton&&this.closeIcon===null){this.$closeButton=this.$b.find(".closeIcon").show()}if(this.closeIcon===true){this.$closeButton=this.$b.find(".closeIcon").show()}},setTitle:function(string){this.title=typeof string!=="undefined"?string:this.title;this.$title.html(this.title||"")},setIcon:function(iconClass){this.title=typeof string!=="undefined"?iconClass:this.title;this.$icon.html(this.icon?'<i class="'+this.icon+'"></i>':"")},setContent:function(string){var that=this;this.content=typeof string=="undefined"?this.content:string;if(this.content==""){this.$content.html(this.content);this.$contentPane.hide()}else{this.$content.html(this.content);this.$contentPane.show()}if(this.$content.hasClass("loading")){this.$content.removeClass("loading");this.$btnc.find("button").prop("disabled",false)}},_getContent:function(string){var that=this;string=string?string:this.content;this._isAjax=false;if(!this.content){this.content="";this.setContent(this.content);this._contentReady.reject()}else if(typeof this.content==="string"){if(this.content.substr(0,4).toLowerCase()==="url:"){this._isAjax=true;this.$content.addClass("loading");this.$btnc.find("button").prop("disabled",true);var url=this.content.substring(4,this.content.length);$.get(url).done(function(html){that.content=html;that._contentReady.resolve()}).always(function(data,status,xhr){if(typeof that.contentLoaded==="function")that.contentLoaded(data,status,xhr)})}else{this.setContent(this.content);this._contentReady.reject()}}else if(typeof this.content==="function"){this.$content.addClass("loading");this.$btnc.find("button").attr("disabled","disabled");var promise=this.content(this);if(typeof promise!=="object"){console.error("The content function must return jquery promise.")}else if(typeof promise.always!=="function"){console.error("The object returned is not a jquery promise.")}else{this._isAjax=true;promise.always(function(data,status){that._contentReady.resolve()})}}else{console.error("Invalid option for property content, passed: "+typeof this.content)}this.setDialogCenter()},_stopCountDown:function(){clearInterval(this.timerInterval);if(this.$cd)this.$cd.remove()},_startCountDown:function(){var opt=this.autoClose.split("|");if(/cancel/.test(opt[0])&&this.type==="alert"){return false}else if(/confirm|cancel/.test(opt[0])){this.$cd=$('<span class="countdown">').appendTo(this["$"+opt[0]+"Button"]);var that=this;that.$cd.parent().click();var time=opt[1]/1e3;this.timerInterval=setInterval(function(){that.$cd.html(" ("+(time-=1)+")");if(time===0){that.$cd.html("");that.$cd.parent().trigger("click");clearInterval(that.timerInterval)}},1e3)}else{console.error("Invalid option "+opt[0]+", must be confirm/cancel")}},reactOnKey:function key(e){var a=$(".jconfirm");if(a.eq(a.length-1)[0]!==this.$el[0])return false;var key=e.which;if(this.contentDiv.find(":input").is(":focus")&&/13|32/.test(key))return false;if($.inArray(key,this.cancelKeys)!==-1){if(this.$cancelButton){this.$cancelButton.click()}else{this.close()}}if($.inArray(key,this.confirmKeys)!==-1){if(this.$confirmButton){this.$confirmButton.click()}}},setDialogCenter:function(){var contentHeight,paneHeight;if(this.$contentPane.css("display")=="none"){contentHeight=0;paneHeight=0}else{contentHeight=this.$content.outerHeight();paneHeight=this.$contentPane.height();if(paneHeight==0)paneHeight=contentHeight}var off=100;var w=this.$content.outerWidth();this.$content.css({clip:"rect(0px "+(off+w)+"px "+contentHeight+"px -"+off+"px)"});this.$contentPane.css({height:contentHeight});var windowHeight=$(window).height();var boxHeight=this.$b.outerHeight()-paneHeight+contentHeight;var topMargin=(windowHeight-boxHeight)/2;var minMargin=100,style;if(boxHeight>windowHeight-minMargin){style={"margin-top":minMargin/2,"margin-bottom":minMargin/2};$("body").addClass("jconfirm-noscroll")}else{if(this.lefttop==true){style={"margin-top":0,width:"60%","margin-left":"40%"}}else{style={"margin-top":topMargin}}$("body").removeClass("jconfirm-noscroll")}this.$b.css(style)},close:function(){var that=this;if(this.isClosed())return false;if(typeof this.onClose==="function")this.onClose();this._unwatchContent();that._lastFocused.focus();$(window).unbind("resize."+this._rand);if(this.keyboardEnabled)$(window).unbind("keyup."+this._rand);that.$el.find(".jconfirm-bg").removeClass("seen");$("body").removeClass("jconfirm-noscroll");this.$b.addClass(this.closeAnimation);var closeTimer=this.closeAnimation=="anim-none"?0:this.animationSpeed;setTimeout(function(){that.$el.remove()},closeTimer*25/100);jconfirm.record.closed+=1;jconfirm.record.currentlyOpen-=1;return true},open:function(){var that=this;if(this.isClosed())return false;that.$el.find(".jconfirm-bg").addClass("seen");this.$b.removeClass(this.animation);this.$b.find("input[autofocus]:visible:first").focus();jconfirm.record.opened+=1;jconfirm.record.currentlyOpen+=1;if(typeof this.onOpen==="function")this.onOpen();var jcr="jconfirm-box"+this._rand;this.$b.attr("aria-labelledby",jcr).attr("tabindex",-1).focus();if(this.$title)this.$title.attr("id",jcr);else if(this.$content)this.$content.attr("id",jcr);setTimeout(function(){that.$b.css({"transition-property":that.$b.css("transition-property")+", margin"});that._modalReady.resolve()},this.animationSpeed);return true},isClosed:function(){return this.$el.css("display")===""}};jconfirm.pluginDefaults={template:'<div class="jconfirm"><div class="jconfirm-bg"></div><div class="jconfirm-scrollpane"><div class="container"><div class="row"><div class="jconfirm-box-container"><div class="jconfirm-box" role="dialog" aria-labelledby="labelled" tabindex="-1"><div class="closeIcon">&times;</div><div class="title-c"><span class="icon-c"></span><span class="title"></span></div><div class="content-pane"><div class="content"></div></div><div class="buttons"></div><div class="jquery-clear"></div></div></div></div></div></div></div>',title:"Hello",content:"Are you sure to continue?",contentLoaded:function(){},icon:"",opacity:.2,confirmButton:"Okay",cancelButton:"Close",confirmButtonClass:"btn-default",cancelButtonClass:"btn-default",theme:"white",animation:"zoom",closeAnimation:"scale",animationSpeed:500,animationBounce:1.2,keyboardEnabled:false,rtl:false,confirmKeys:[13],cancelKeys:[27],container:"body",confirm:function(){},cancel:function(){},backgroundDismiss:true,autoClose:false,closeIcon:null,closeIconClass:false,watchInterval:100,columnClass:"col-md-4 col-md-offset-4 col-sm-6 col-sm-offset-3 col-xs-10 col-xs-offset-1",onOpen:function(){},onClose:function(){},onAction:function(){}};jconfirm.record={opened:0,closed:0,currentlyOpen:0}})(jQuery);(function($){function Scroller(elem,settings){var m,hi,v,dw,ww,wh,rwh,mw,mh,anim,debounce,that=this,ms=$.mobiscroll,e=elem,elm=$(e),theme,lang,s=extend({},defaults),pres={},warr=[],iv={},pixels={},input=elm.is("input"),visible=false;function isReadOnly(wh){if($.isArray(s.readonly)){var i=$(".dwwl",dw).index(wh);return s.readonly[i]}return s.readonly}function generateWheelItems(i){var html='<div class="dw-bf">',l=1,j;for(j in warr[i]){if(l%20==0){html+='</div><div class="dw-bf">'}html+='<div class="dw-li dw-v" data-val="'+j+'" style="height:'+hi+"px;line-height:"+hi+'px;"><div class="dw-i">'+warr[i][j]+"</div></div>";l++}html+="</div>";return html}function setGlobals(t){min=$(".dw-li",t).index($(".dw-v",t).eq(0));max=$(".dw-li",t).index($(".dw-v",t).eq(-1));index=$(".dw-ul",dw).index(t);h=hi;inst=that}function formatHeader(v){var t=s.headerText;return t?typeof t==="function"?t.call(e,v):t.replace(/\{value\}/i,v):""}function read(){that.temp=input&&that.val!==null&&that.val!=elm.val()||that.values===null?s.parseValue(elm.val()||"",that):that.values.slice(0);that.setValue(true)}function scrollToPos(time,index,manual,dir,orig){if(event("validate",[dw,index,time])!==false){$(".dw-ul",dw).each(function(i){var t=$(this),cell=$('.dw-li[data-val="'+that.temp[i]+'"]',t),cells=$(".dw-li",t),v=cells.index(cell),l=cells.length,sc=i==index||index===undefined;if(!cell.hasClass("dw-v")){var cell1=cell,cell2=cell,dist1=0,dist2=0;while(v-dist1>=0&&!cell1.hasClass("dw-v")){dist1++;cell1=cells.eq(v-dist1)}while(v+dist2<l&&!cell2.hasClass("dw-v")){dist2++;cell2=cells.eq(v+dist2)}if((dist2<dist1&&dist2&&dir!==2||!dist1||v-dist1<0||dir==1)&&cell2.hasClass("dw-v")){cell=cell2;v=v+dist2}else{cell=cell1;v=v-dist1}}if(!cell.hasClass("dw-sel")||sc){that.temp[i]=cell.attr("data-val");$(".dw-sel",t).removeClass("dw-sel");cell.addClass("dw-sel");that.scroll(t,i,v,sc?time:.1,sc?orig:undefined)}});that.change(manual)}}function position(check){if(s.display=="inline"||ww===$(window).width()&&rwh===$(window).height()&&check){return}var w,l,t,aw,ah,ap,at,al,arr,arrw,arrl,scroll,totalw=0,minw=0,st=$(window).scrollTop(),wr=$(".dwwr",dw),d=$(".dw",dw),css={},anchor=s.anchor===undefined?elm:s.anchor;ww=$(window).width();rwh=$(window).height();wh=window.innerHeight;wh=wh||rwh;if(/modal|bubble/.test(s.display)){$(".dwc",dw).each(function(){w=$(this).outerWidth(true);totalw+=w;minw=w>minw?w:minw});w=totalw>ww?minw:totalw;wr.width(w)}mw=d.outerWidth();mh=d.outerHeight(true);if(s.display=="modal"){l=(ww-mw)/2;t=st+(wh-mh)/2}else if(s.display=="bubble"){scroll=true;arr=$(".dw-arrw-i",dw);ap=anchor.offset();at=ap.top;al=ap.left;aw=anchor.outerWidth();ah=anchor.outerHeight();l=al-(d.outerWidth(true)-aw)/2;l=l>ww-mw?ww-(mw+20):l;l=l>=0?l:20;t=at-mh;if(t<st||at>st+wh){d.removeClass("dw-bubble-top").addClass("dw-bubble-bottom");t=at+ah}else{d.removeClass("dw-bubble-bottom").addClass("dw-bubble-top")}arrw=arr.outerWidth();arrl=al+aw/2-(l+(mw-arrw)/2);$(".dw-arr",dw).css({left:arrl>arrw?arrw:arrl})}else{css.width="100%";if(s.display=="top"){t=st}else if(s.display=="bottom"){t=st+wh-mh}}css.top=t<0?0:t;css.left=l;d.css(css);$(".dw-persp",dw).height(0).height(t+mh>$(document).height()?t+mh:$(document).height());if(scroll&&(t+mh>st+wh||at>st+wh)){$(window).scrollTop(t+mh-wh)}}function testTouch(e){if(e.type==="touchstart"){touch=true;setTimeout(function(){touch=false},500)}else if(touch){touch=false;return false}return true}function event(name,args){var ret;args.push(that);$.each([theme.defaults,pres,settings],function(i,v){if(v[name]){ret=v[name].apply(e,args)}});return ret}function plus(t){var p=+t.data("pos"),val=p+1;calc(t,val>max?min:val,1,true)}function minus(t){var p=+t.data("pos"),val=p-1;calc(t,val<min?max:val,2,true)}that.enable=function(){s.disabled=false;if(input){elm.prop("disabled",false)}};that.disable=function(){s.disabled=true;if(input){elm.prop("disabled",true)}};that.scroll=function(t,index,val,time,orig){function getVal(t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b}function ready(){clearInterval(iv[index]);delete iv[index];t.data("pos",val).closest(".dwwl").removeClass("dwa")}var px=(m-val)*hi,i;if(px==pixels[index]&&iv[index]){return}if(time&&px!=pixels[index]){event("onAnimStart",[dw,index,time])}pixels[index]=px;t.attr("style",prefix+"-transition:all "+(time?time.toFixed(3):0)+"s ease-out;"+(has3d?prefix+"-transform:translate3d(0,"+px+"px,0);":"top:"+px+"px;"));if(iv[index]){ready()}if(time&&orig!==undefined){i=0;t.closest(".dwwl").addClass("dwa");iv[index]=setInterval(function(){i+=.1;
t.data("pos",Math.round(getVal(i,orig,val-orig,time)));if(i>=time){ready()}},100)}else{t.data("pos",val)}};that.setValue=function(sc,fill,time,temp){if(!$.isArray(that.temp)){that.temp=s.parseValue(that.temp+"",that)}if(visible&&sc){scrollToPos(time)}v=s.formatResult(that.temp);if(!temp){that.values=that.temp.slice(0);that.val=v}if(fill){if(input){elm.val(v).trigger("change")}}};that.getValues=function(){var ret=[],i;for(i in that._selectedValues){ret.push(that._selectedValues[i])}return ret};that.validate=function(i,dir,time,orig){scrollToPos(time,i,true,dir,orig)};that.change=function(manual){v=s.formatResult(that.temp);if(s.display=="inline"){that.setValue(false,manual)}else{$(".dwv",dw).html(formatHeader(v))}if(manual){event("onChange",[v])}};that.changeWheel=function(idx,time){if(dw){var i=0,j,k,nr=idx.length;for(j in s.wheels){for(k in s.wheels[j]){if($.inArray(i,idx)>-1){warr[i]=s.wheels[j][k];$(".dw-ul",dw).eq(i).html(generateWheelItems(i));nr--;if(!nr){position();scrollToPos(time,undefined,true);return}}i++}}}};that.isVisible=function(){return visible};that.tap=function(el,handler){var startX,startY;if(s.tap){el.bind("touchstart",function(e){e.preventDefault();startX=getCoord(e,"X");startY=getCoord(e,"Y")}).bind("touchend",function(e){if(Math.abs(getCoord(e,"X")-startX)<20&&Math.abs(getCoord(e,"Y")-startY)<20){handler.call(this,e)}tap=true;setTimeout(function(){tap=false},300)})}el.bind("click",function(e){if(!tap){handler.call(this,e)}})};that.show=function(prevAnim){if(s.disabled||visible){return false}if(s.display=="top"){anim="slidedown"}if(s.display=="bottom"){anim="slideup"}read();event("onBeforeShow",[dw]);var l=0,i,label,mAnim="";if(anim&&!prevAnim){mAnim="dw-"+anim+" dw-in"}var html='<div class="dw-trans '+s.theme+" dw-"+s.display+'">'+(s.display=="inline"?'<div class="dw dwbg dwi"><div class="dwwr">':'<div class="dw-persp">'+'<div class="dwo"></div><div class="dw dwbg '+mAnim+'"><div class="dw-arrw"><div class="dw-arrw-i"><div class="dw-arr"></div></div></div><div class="dwwr">'+(s.headerText?'<div class="dwv"></div>':""));for(i=0;i<s.wheels.length;i++){html+='<div class="dwc'+(s.mode!="scroller"?" dwpm":" dwsc")+(s.showLabel?"":" dwhl")+'"><div class="dwwc dwrc"><table cellpadding="0" cellspacing="0"><tr>';for(label in s.wheels[i]){warr[l]=s.wheels[i][label];html+='<td><div class="dwwl dwrc dwwl'+l+'">'+(s.mode!="scroller"?'<div class="dwwb dwwbp" style="height:'+hi+"px;line-height:"+hi+'px;"><span>+</span></div><div class="dwwb dwwbm" style="height:'+hi+"px;line-height:"+hi+'px;"><span>&ndash;</span></div>':"")+'<div class="dwl">'+label+'</div><div class="dww" style="height:'+s.rows*hi+"px;min-width:"+s.width+'px;"><div class="dw-ul">';html+=generateWheelItems(l);html+='</div><div class="dwwo"></div></div><div class="dwwol"></div></div></td>';l++}html+="</tr></table></div></div>"}html+=(s.display!="inline"?'<div class="dwbc'+(s.button3?" dwbc-p":"")+'"><span class="dwbw dwb-s"><span class="dwb">'+s.setText+"</span></span>"+(s.button3?'<span class="dwbw dwb-n"><span class="dwb">'+s.button3Text+"</span></span>":"")+'<span class="dwbw dwb-c"><span class="dwb">'+s.cancelText+"</span></span></div></div>":'<div class="dwcc"></div>')+"</div></div></div>";dw=$(html);scrollToPos();event("onMarkupReady",[dw]);if(s.display!="inline"){dw.appendTo("body");setTimeout(function(){dw.removeClass("dw-trans").find(".dw").removeClass(mAnim)},350)}else if(elm.is("div")){elm.html(dw)}else{dw.insertAfter(elm)}event("onMarkupInserted",[dw]);visible=true;theme.init(dw,that);if(s.display!="inline"){that.tap($(".dwb-s span",dw),function(){if(that.hide(false,"set")!==false){that.setValue(false,true);event("onSelect",[that.val])}});that.tap($(".dwb-c span",dw),function(){that.cancel()});if(s.button3){that.tap($(".dwb-n span",dw),s.button3)}if(s.scrollLock){dw.bind("touchmove",function(e){if(mh<=wh&&mw<=ww){e.preventDefault()}})}$("input,select,button").each(function(){if(!$(this).prop("disabled")){$(this).addClass("dwtd").prop("disabled",true)}});position();$(window).bind("resize.dw",function(){clearTimeout(debounce);debounce=setTimeout(function(){position(true)},100)})}dw.delegate(".dwwl","DOMMouseScroll mousewheel",function(e){if(!isReadOnly(this)){e.preventDefault();e=e.originalEvent;var delta=e.wheelDelta?e.wheelDelta/120:e.detail?-e.detail/3:0,t=$(".dw-ul",this),p=+t.data("pos"),val=Math.round(p-delta);setGlobals(t);calc(t,val,delta<0?1:2)}}).delegate(".dwb, .dwwb",START_EVENT,function(e){$(this).addClass("dwb-a")}).delegate(".dwwb",START_EVENT,function(e){e.stopPropagation();e.preventDefault();var w=$(this).closest(".dwwl");if(testTouch(e)&&!isReadOnly(w)&&!w.hasClass("dwa")){click=true;var t=w.find(".dw-ul"),func=$(this).hasClass("dwwbp")?plus:minus;setGlobals(t);clearInterval(timer);timer=setInterval(function(){func(t)},s.delay);func(t)}}).delegate(".dwwl",START_EVENT,function(e){e.preventDefault();if(testTouch(e)&&!move&&!isReadOnly(this)&&!click){move=true;$(document).bind(MOVE_EVENT,onMove);target=$(".dw-ul",this);scrollable=s.mode!="clickpick";pos=+target.data("pos");setGlobals(target);moved=iv[index]!==undefined;start=getCoord(e,"Y");startTime=new Date;stop=start;that.scroll(target,index,pos,.001);if(scrollable){target.closest(".dwwl").addClass("dwa")}}});event("onShow",[dw,v])};that.hide=function(prevAnim,btn){if(!visible||event("onClose",[v,btn])===false){return false}$(".dwtd").prop("disabled",false).removeClass("dwtd");elm.blur();if(dw){if(s.display!="inline"&&anim&&!prevAnim){dw.addClass("dw-trans").find(".dw").addClass("dw-"+anim+" dw-out");setTimeout(function(){dw.remove();dw=null},350)}else{dw.remove();dw=null}visible=false;pixels={};$(window).unbind(".dw")}};that.cancel=function(){if(that.hide(false,"cancel")!==false){event("onCancel",[that.val])}};that.init=function(ss){theme=extend({defaults:{},init:empty},ms.themes[ss.theme||s.theme]);lang=ms.i18n[ss.lang||s.lang];extend(settings,ss);extend(s,theme.defaults,lang,settings);that.settings=s;elm.unbind(".dw");var preset=ms.presets[s.preset];if(preset){pres=preset.call(e,that);extend(s,pres,settings);extend(methods,pres.methods)}m=Math.floor(s.rows/2);hi=s.height;anim=s.animate;if(elm.data("dwro")!==undefined){e.readOnly=bool(elm.data("dwro"))}if(visible){that.hide()}if(s.display=="inline"){that.show()}else{read();if(input&&s.showOnFocus){elm.data("dwro",e.readOnly);e.readOnly=true;elm.bind("focus.dw",function(){that.show()})}}};that.trigger=function(name,params){return event(name,params)};that.values=null;that.val=null;that.temp=null;that._selectedValues={};that.init(settings)}function testProps(props){var i;for(i in props){if(mod[props[i]]!==undefined){return true}}return false}function testPrefix(){var prefixes=["Webkit","Moz","O","ms"],p;for(p in prefixes){if(testProps([prefixes[p]+"Transform"])){return"-"+prefixes[p].toLowerCase()}}return""}function getInst(e){return scrollers[e.id]}function getCoord(e,c){var org=e.originalEvent,ct=e.changedTouches;return ct||org&&org.changedTouches?org?org.changedTouches[0]["page"+c]:ct[0]["page"+c]:e["page"+c]}function bool(v){return v===true||v=="true"}function constrain(val,min,max){val=val>max?max:val;val=val<min?min:val;return val}function calc(t,val,dir,anim,orig){val=constrain(val,min,max);var cell=$(".dw-li",t).eq(val),o=orig===undefined?val:orig,idx=index,time=anim?val==o?.1:Math.abs((val-o)*.1):0;inst.temp[idx]=cell.attr("data-val");inst.scroll(t,idx,val,time,orig);setTimeout(function(){inst.validate(idx,dir,time,orig)},10)}function init(that,method,args){if(methods[method]){return methods[method].apply(that,Array.prototype.slice.call(args,1))}if(typeof method==="object"){return methods.init.call(that,method)}return that}var scrollers={},timer,empty=function(){},h,min,max,inst,date=new Date,uuid=date.getTime(),move,click,target,index,start,stop,startTime,pos,moved,scrollable,mod=document.createElement("modernizr").style,has3d=testProps(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]),prefix=testPrefix(),extend=$.extend,tap,touch,START_EVENT="touchstart mousedown",MOVE_EVENT="touchmove mousemove",END_EVENT="touchend mouseup",onMove=function(e){if(scrollable){e.preventDefault();stop=getCoord(e,"Y");inst.scroll(target,index,constrain(pos+(start-stop)/h,min-1,max+1))}moved=true},defaults={width:70,height:40,rows:3,delay:300,disabled:false,readonly:false,showOnFocus:true,showLabel:true,wheels:[],theme:"",headerText:"{value}",display:"modal",mode:"scroller",preset:"",lang:"en-US",setText:"Set",cancelText:"Cancel",scrollLock:true,tap:true,formatResult:function(d){return d.join(" ")},parseValue:function(value,inst){var w=inst.settings.wheels,val=value.split(" "),ret=[],j=0,i,l,v;for(i=0;i<w.length;i++){for(l in w[i]){if(w[i][l][val[j]]!==undefined){ret.push(val[j])}else{for(v in w[i][l]){ret.push(v);break}}j++}}return ret}},methods={init:function(options){if(options===undefined){options={}}return this.each(function(){if(!this.id){uuid+=1;this.id="scoller"+uuid}scrollers[this.id]=new Scroller(this,options)})},enable:function(){return this.each(function(){var inst=getInst(this);if(inst){inst.enable()}})},disable:function(){return this.each(function(){var inst=getInst(this);if(inst){inst.disable()}})},isDisabled:function(){var inst=getInst(this[0]);if(inst){return inst.settings.disabled}},isVisible:function(){var inst=getInst(this[0]);if(inst){return inst.isVisible()}},option:function(option,value){return this.each(function(){var inst=getInst(this);if(inst){var obj={};if(typeof option==="object"){obj=option}else{obj[option]=value}inst.init(obj)}})},setValue:function(d,fill,time,temp){return this.each(function(){var inst=getInst(this);if(inst){inst.temp=d;inst.setValue(true,fill,time,temp)}})},getInst:function(){return getInst(this[0])},getValue:function(){var inst=getInst(this[0]);if(inst){return inst.values}},getValues:function(){var inst=getInst(this[0]);if(inst){return inst.getValues()}},show:function(){var inst=getInst(this[0]);if(inst){return inst.show()}},hide:function(){return this.each(function(){var inst=getInst(this);if(inst){inst.hide()}})},destroy:function(){return this.each(function(){var inst=getInst(this);if(inst){inst.hide();$(this).unbind(".dw");delete scrollers[this.id];if($(this).is("input")){this.readOnly=bool($(this).data("dwro"))}}})}};$(document).bind(END_EVENT,function(e){if(move){var time=new Date-startTime,val=constrain(pos+(start-stop)/h,min-1,max+1),speed,dist,tindex,ttop=target.offset().top;if(time<300){speed=(stop-start)/time;dist=speed*speed/(2*6e-4);if(stop-start<0){dist=-dist}}else{dist=stop-start}tindex=Math.round(pos-dist/h);if(!dist&&!moved){var idx=Math.floor((stop-ttop)/h),li=$(".dw-li",target).eq(idx),hl=scrollable;if(inst.trigger("onValueTap",[li])!==false){tindex=idx}else{hl=true}if(hl){li.addClass("dw-hl");setTimeout(function(){li.removeClass("dw-hl")},200)}}if(scrollable){calc(target,tindex,0,true,Math.round(val))}move=false;target=null;$(document).unbind(MOVE_EVENT,onMove)}if(click){clearInterval(timer);click=false}$(".dwb-a").removeClass("dwb-a")}).bind("mouseover mouseup mousedown click",function(e){if(tap){e.stopPropagation();e.preventDefault();return false}});$.fn.mobiscroll=function(method){extend(this,$.mobiscroll.shorts);return init(this,method,arguments)};$.mobiscroll=$.mobiscroll||{setDefaults:function(o){extend(defaults,o)},presetShort:function(name){this.shorts[name]=function(method){return init(this,extend(method,{preset:name}),arguments)}},shorts:{},presets:{},themes:{},i18n:{}};$.scroller=$.scroller||$.mobiscroll;$.fn.scroller=$.fn.scroller||$.fn.mobiscroll})(jQuery);(function($){var ms=$.mobiscroll,date=new Date,defaults={dateFormat:"mm/dd/yy",dateOrder:"mmddy",timeWheels:"hhiiA",timeFormat:"hh:ii A",startYear:date.getFullYear()-100,endYear:date.getFullYear()+1,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortYearCutoff:"+10",monthText:"Month",dayText:"Day",yearText:"Year",hourText:"Hours",minuteText:"Minutes",secText:"Seconds",ampmText:"&nbsp;",nowText:"Now",showNow:false,stepHour:1,stepMinute:1,stepSecond:1,separator:" "},preset=function(inst){var that=$(this),html5def={},format;if(that.is("input")){switch(that.attr("type")){case"date":format="yy-mm-dd";break;case"datetime":format="yy-mm-ddTHH:ii:ssZ";break;case"datetime-local":format="yy-mm-ddTHH:ii:ss";break;case"month":format="yy-mm";html5def.dateOrder="mmyy";break;case"time":format="HH:ii:ss";break}var min=that.attr("min"),max=that.attr("max");if(min){html5def.minDate=ms.parseDate(format,min)}if(max){html5def.maxDate=ms.parseDate(format,max)}}var s=$.extend({},defaults,html5def,inst.settings),offset=0,wheels=[],ord=[],o={},i,k,f={y:"getFullYear",m:"getMonth",d:"getDate",h:getHour,i:getMinute,s:getSecond,a:getAmPm},p=s.preset,dord=s.dateOrder,tord=s.timeWheels,regen=dord.match(/D/),ampm=tord.match(/a/i),hampm=tord.match(/h/),hformat=p=="datetime"?s.dateFormat+s.separator+s.timeFormat:p=="time"?s.timeFormat:s.dateFormat,defd=new Date,stepH=s.stepHour,stepM=s.stepMinute,stepS=s.stepSecond,mind=s.minDate||new Date(s.startYear,0,1),maxd=s.maxDate||new Date(s.endYear,11,31,23,59,59);inst.settings=s;format=format||hformat;if(p.match(/date/i)){$.each(["y","m","d"],function(j,v){i=dord.search(new RegExp(v,"i"));if(i>-1){ord.push({o:i,v:v})}});ord.sort(function(a,b){return a.o>b.o?1:-1});$.each(ord,function(i,v){o[v.v]=i});var w={};for(k=0;k<3;k++){if(k==o.y){offset++;w[s.yearText]={};var start=mind.getFullYear(),end=maxd.getFullYear();for(i=start;i<=end;i++){w[s.yearText][i]=dord.match(/yy/i)?i:(i+"").substr(2,2)}}else if(k==o.m){offset++;w[s.monthText]={};for(i=0;i<12;i++){var str=dord.replace(/[dy]/gi,"").replace(/mm/,i<9?"0"+(i+1):i+1).replace(/m/,i+1);w[s.monthText][i]=str.match(/MM/)?str.replace(/MM/,'<span class="dw-mon">'+s.monthNames[i]+"</span>"):str.replace(/M/,'<span class="dw-mon">'+s.monthNamesShort[i]+"</span>")}}else if(k==o.d){offset++;w[s.dayText]={};for(i=1;i<32;i++){w[s.dayText][i]=dord.match(/dd/i)&&i<10?"0"+i:i}}}wheels.push(w)}if(p.match(/time/i)){ord=[];$.each(["h","i","s","a"],function(i,v){i=tord.search(new RegExp(v,"i"));if(i>-1){ord.push({o:i,v:v})}});ord.sort(function(a,b){return a.o>b.o?1:-1});$.each(ord,function(i,v){o[v.v]=offset+i});w={};for(k=offset;k<offset+4;k++){if(k==o.h){offset++;w[s.hourText]={};for(i=0;i<(hampm?12:24);i+=stepH){w[s.hourText][i]=hampm&&i==0?12:tord.match(/hh/i)&&i<10?"0"+i:i}}else if(k==o.i){offset++;w[s.minuteText]={};for(i=0;i<60;i+=stepM){w[s.minuteText][i]=tord.match(/ii/)&&i<10?"0"+i:i}}else if(k==o.s){offset++;w[s.secText]={};for(i=0;i<60;i+=stepS){w[s.secText][i]=tord.match(/ss/)&&i<10?"0"+i:i}}else if(k==o.a){offset++;var upper=tord.match(/A/);w[s.ampmText]={0:upper?"AM":"am",1:upper?"PM":"pm"}}}wheels.push(w)}function get(d,i,def){if(o[i]!==undefined){return+d[o[i]]}if(def!==undefined){return def}return defd[f[i]]?defd[f[i]]():f[i](defd)}function step(v,st){return Math.floor(v/st)*st}function getHour(d){var hour=d.getHours();hour=hampm&&hour>=12?hour-12:hour;return step(hour,stepH)}function getMinute(d){return step(d.getMinutes(),stepM)}function getSecond(d){return step(d.getSeconds(),stepS)}function getAmPm(d){return ampm&&d.getHours()>11?1:0}function getDate(d){var hour=get(d,"h",0);return new Date(get(d,"y"),get(d,"m"),get(d,"d",1),get(d,"a")?hour+12:hour,get(d,"i",0),get(d,"s",0))}inst.setDate=function(d,fill,time,temp){var i;for(i in o){this.temp[o[i]]=d[f[i]]?d[f[i]]():f[i](d)}this.setValue(true,fill,time,temp)};inst.getDate=function(d){return getDate(d)};return{button3Text:s.showNow?s.nowText:undefined,button3:s.showNow?function(){inst.setDate(new Date,false,.3,true)}:undefined,wheels:wheels,headerText:function(v){return ms.formatDate(hformat,getDate(inst.temp),s)},formatResult:function(d){return ms.formatDate(format,getDate(d),s)},parseValue:function(val){var d=new Date,i,result=[];try{d=ms.parseDate(format,val,s)}catch(e){}for(i in o){result[o[i]]=d[f[i]]?d[f[i]]():f[i](d)}return result},validate:function(dw,i){var temp=inst.temp,mins={y:mind.getFullYear(),m:0,d:1,h:0,i:0,s:0,a:0},maxs={y:maxd.getFullYear(),m:11,d:31,h:step(hampm?11:23,stepH),i:step(59,stepM),s:step(59,stepS),a:1},minprop=true,maxprop=true;$.each(["y","m","d","a","h","i","s"],function(x,i){if(o[i]!==undefined){var min=mins[i],max=maxs[i],maxdays=31,val=get(temp,i),t=$(".dw-ul",dw).eq(o[i]),y,m;if(i=="d"){y=get(temp,"y");m=get(temp,"m");maxdays=32-new Date(y,m,32).getDate();max=maxdays;if(regen){$(".dw-li",t).each(function(){var that=$(this),d=that.data("val"),w=new Date(y,m,d).getDay(),str=dord.replace(/[my]/gi,"").replace(/dd/,d<10?"0"+d:d).replace(/d/,d);$(".dw-i",that).html(str.match(/DD/)?str.replace(/DD/,'<span class="dw-day">'+s.dayNames[w]+"</span>"):str.replace(/D/,'<span class="dw-day">'+s.dayNamesShort[w]+"</span>"))})}}if(minprop&&mind){min=mind[f[i]]?mind[f[i]]():f[i](mind)}if(maxprop&&maxd){max=maxd[f[i]]?maxd[f[i]]():f[i](maxd)}if(i!="y"){var i1=$(".dw-li",t).index($('.dw-li[data-val="'+min+'"]',t)),i2=$(".dw-li",t).index($('.dw-li[data-val="'+max+'"]',t));$(".dw-li",t).removeClass("dw-v").slice(i1,i2+1).addClass("dw-v");if(i=="d"){$(".dw-li",t).removeClass("dw-h").slice(maxdays).addClass("dw-h")}}if(val<min){val=min}if(val>max){val=max}if(minprop){minprop=val==min}if(maxprop){maxprop=val==max}if(s.invalid&&i=="d"){var idx=[];if(s.invalid.dates){$.each(s.invalid.dates,function(i,v){if(v.getFullYear()==y&&v.getMonth()==m){idx.push(v.getDate()-1)}})}if(s.invalid.daysOfWeek){var first=new Date(y,m,1).getDay(),j;$.each(s.invalid.daysOfWeek,function(i,v){for(j=v-first;j<maxdays;j+=7){if(j>=0){idx.push(j)}}})}if(s.invalid.daysOfMonth){$.each(s.invalid.daysOfMonth,function(i,v){v=(v+"").split("/");if(v[1]){if(v[0]-1==m){idx.push(v[1]-1)}}else{idx.push(v[0]-1)}})}$.each(idx,function(i,v){$(".dw-li",t).eq(v).removeClass("dw-v")})}temp[o[i]]=val}})},methods:{getDate:function(temp){var inst=$(this).mobiscroll("getInst");if(inst){return inst.getDate(temp?inst.temp:inst.values)}},setDate:function(d,fill,time,temp){if(fill==undefined){fill=false}return this.each(function(){var inst=$(this).mobiscroll("getInst");if(inst){inst.setDate(d,fill,time,temp)}})}}}};$.each(["date","time","datetime"],function(i,v){ms.presets[v]=preset;ms.presetShort(v)});ms.formatDate=function(format,date,settings){if(!date){return null}var s=$.extend({},defaults,settings),look=function(m){var n=0;while(i+1<format.length&&format.charAt(i+1)==m){n++;i++}return n},f1=function(m,val,len){var n=""+val;if(look(m)){while(n.length<len){n="0"+n}}return n},f2=function(m,val,s,l){return look(m)?l[val]:s[val]},i,output="",literal=false;for(i=0;i<format.length;i++){if(literal){if(format.charAt(i)=="'"&&!look("'")){literal=false}else{output+=format.charAt(i)}}else{switch(format.charAt(i)){case"d":output+=f1("d",date.getDate(),2);break;case"D":output+=f2("D",date.getDay(),s.dayNamesShort,s.dayNames);break;case"o":output+=f1("o",(date.getTime()-new Date(date.getFullYear(),0,0).getTime())/864e5,3);break;case"m":output+=f1("m",date.getMonth()+1,2);break;case"M":output+=f2("M",date.getMonth(),s.monthNamesShort,s.monthNames);break;case"y":output+=look("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100;break;case"h":var h=date.getHours();output+=f1("h",h>12?h-12:h==0?12:h,2);break;case"H":output+=f1("H",date.getHours(),2);break;case"i":output+=f1("i",date.getMinutes(),2);break;case"s":output+=f1("s",date.getSeconds(),2);break;case"a":output+=date.getHours()>11?"pm":"am";break;case"A":output+=date.getHours()>11?"PM":"AM";break;case"'":if(look("'")){output+="'"}else{literal=true}break;default:output+=format.charAt(i)}}}return output};ms.parseDate=function(format,value,settings){var def=new Date;if(!format||!value){return def}value=typeof value=="object"?value.toString():value+"";var s=$.extend({},defaults,settings),shortYearCutoff=s.shortYearCutoff,year=def.getFullYear(),month=def.getMonth()+1,day=def.getDate(),doy=-1,hours=def.getHours(),minutes=def.getMinutes(),seconds=0,ampm=-1,literal=false,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)==match;if(matches){iFormat++}return matches},getNumber=function(match){lookAhead(match);var size=match=="@"?14:match=="!"?20:match=="y"?4:match=="o"?3:2,digits=new RegExp("^\\d{1,"+size+"}"),num=value.substr(iValue).match(digits);if(!num){return 0}iValue+=num[0].length;return parseInt(num[0],10)},getName=function(match,s,l){var names=lookAhead(match)?l:s,i;for(i=0;i<names.length;i++){if(value.substr(iValue,names[i].length).toLowerCase()==names[i].toLowerCase()){iValue+=names[i].length;return i+1}}return 0},checkLiteral=function(){iValue++},iValue=0,iFormat;for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{checkLiteral()}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",s.dayNamesShort,s.dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",s.monthNamesShort,s.monthNames);break;case"y":year=getNumber("y");break;case"H":hours=getNumber("H");break;case"h":hours=getNumber("h");break;case"i":minutes=getNumber("i");break;case"s":seconds=getNumber("s");break;case"a":ampm=getName("a",["am","pm"],["am","pm"])-1;break;case"A":ampm=getName("A",["am","pm"],["am","pm"])-1;break;case"'":if(lookAhead("'")){checkLiteral()}else{literal=true}break;default:checkLiteral()}}}if(year<100){year+=(new Date).getFullYear()-(new Date).getFullYear()%100+(year<=(typeof shortYearCutoff!="string"?shortYearCutoff:(new Date).getFullYear()%100+parseInt(shortYearCutoff,10))?0:-100)}if(doy>-1){month=1;day=doy;do{var dim=32-new Date(year,month-1,32).getDate();if(day<=dim){break}month++;day-=dim}while(true)}hours=ampm==-1?hours:ampm&&hours<12?hours+12:!ampm&&hours==12?0:hours;var date=new Date(year,month-1,day,hours,minutes,seconds);if(date.getFullYear()!=year||date.getMonth()+1!=month||date.getDate()!=day){throw"Invalid date"}return date}})(jQuery);(function($,window,document,undefined){var $window=$(window);$.convertImgToBase64=function(url,callback){var canvas=document.createElement("CANVAS"),ctx=canvas.getContext("2d"),img=new Image;img.crossOrigin="Anonymous";img.onload=function(){canvas.height=img.height;canvas.width=img.width;ctx.drawImage(img,0,0);var dataURL=canvas.toDataURL("image/jpeg");callback.call(this,dataURL);canvas=null};img.src=url};$.fn.lazyload=function(options){var elements=this;var $container;var settings={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:window,data_attribute:"original",skip_invisible:false,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};function update(){var counter=0;elements.each(function(){var $this=$(this);if(settings.skip_invisible&&!$this.is(":visible")){return}if($.abovethetop(this,settings)||$.leftofbegin(this,settings)){}else if(!$.belowthefold(this,settings)&&!$.rightoffold(this,settings)){$this.trigger("appear");counter=0}else{if(++counter>settings.failure_limit){return false}}})}if(options){if(undefined!==options.failurelimit){options.failure_limit=options.failurelimit;delete options.failurelimit}if(undefined!==options.effectspeed){options.effect_speed=options.effectspeed;delete options.effectspeed}$.extend(settings,options)}$container=settings.container===undefined||settings.container===window?$window:$(settings.container);if(0===settings.event.indexOf("scroll")){$container.bind(settings.event,function(){return update()})}this.each(function(){var self=this;var $self=$(self);self.loaded=false;if($self.attr("src")===undefined||$self.attr("src")===false){if($self.is("img")){$self.attr("src",settings.placeholder)}}$self.one("appear",function(){if(!this.loaded){if(settings.appear){var elements_left=elements.length;settings.appear.call(self,elements_left,settings)}var _dataUrl=$self.data(settings.data_attribute);if(Object.prototype.toString.call(_dataUrl)==="[object String]"==false){$self.data(settings.data_attribute,_dataUrl._urlb);_dataUrl=_dataUrl._urla}$("<img />").bind("load",function(){var original;if(_dataUrl==""){original=$self.data(settings.data_attribute)}else{original=_dataUrl}$self.hide();if($self.is("img")){if(undefined!==settings.max_width&&undefined!==settings.max_height){var theImage=new Image;theImage.src=$(this).attr("src");var imageWidth=theImage.width,imageHeight=theImage.height,nNewW=settings.max_width,nNewH=settings.max_height,nLeft=0,nTop=0;if(imageWidth<=settings.max_width&&imageHeight<=settings.max_height){if(imageHeight>imageWidth){}else{}}else if(imageWidth<=settings.max_width&&imageHeight>settings.max_height){}else if(imageWidth>settings.max_width&&imageHeight<=settings.max_height){}else{if(imageHeight>imageWidth){if(settings.container!=window){nNewW=settings.max_width*imageWidth/imageHeight}}else{nNewH=settings.max_height*imageHeight/imageWidth;if(settings.container!=window){nTop=(settings.max_height-nNewH)/2}}}$self.width(nNewW).height(nNewH).offset({top:nTop,left:nLeft})}$self.attr("src",original)}else{$self.css("background-image","url('"+original+"')")}$self[settings.effect](settings.effect_speed);self.loaded=true;var temp=$.grep(elements,function(element){return!element.loaded});elements=$(temp);if(settings.load){var elements_left=elements.length;settings.load.call(self,elements_left,settings)}}).one("error",function(){_dataUrl="";var original=$self.data(settings.data_attribute);if(original!=""){$(this).attr("src",original)}}).attr("src",_dataUrl)}});if(0!==settings.event.indexOf("scroll")){$self.bind(settings.event,function(){if(!self.loaded){$self.trigger("appear")}})}});$window.bind("resize",function(){update()});if(/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)){$window.bind("pageshow",function(event){if(event.originalEvent&&event.originalEvent.persisted){elements.each(function(){$(this).trigger("appear")})}})}$(document).ready(function(){update()});return this};$.belowthefold=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=(window.innerHeight?window.innerHeight:$window.height())+$window.scrollTop()}else{fold=$(settings.container).offset().top+$(settings.container).height()}return fold<=$(element).offset().top-settings.threshold};$.rightoffold=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$window.width()+$window.scrollLeft()}else{fold=$(settings.container).offset().left+$(settings.container).width()}return fold<=$(element).offset().left-settings.threshold};$.abovethetop=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$window.scrollTop()}else{fold=$(settings.container).offset().top}return fold>=$(element).offset().top+settings.threshold+$(element).height()};$.leftofbegin=function(element,settings){var fold;if(settings.container===undefined||settings.container===window){fold=$window.scrollLeft()}else{fold=$(settings.container).offset().left}return fold>=$(element).offset().left+settings.threshold+$(element).width()};$.inviewport=function(element,settings){return!$.rightoffold(element,settings)&&!$.leftofbegin(element,settings)&&!$.belowthefold(element,settings)&&!$.abovethetop(element,settings)};$.extend($.expr[":"],{"below-the-fold":function(a){return $.belowthefold(a,{threshold:0})},"above-the-top":function(a){return!$.belowthefold(a,{threshold:0})},"right-of-screen":function(a){return $.rightoffold(a,{threshold:0})},"left-of-screen":function(a){return!$.rightoffold(a,{threshold:0})},"in-viewport":function(a){return $.inviewport(a,{threshold:0})},"above-the-fold":function(a){return!$.belowthefold(a,{threshold:0})},"right-of-fold":function(a){return $.rightoffold(a,{threshold:0})},"left-of-fold":function(a){return!$.rightoffold(a,{threshold:0})}})})(jQuery,window,document);(function(window,document,Math){var rAF=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)};var utils=function(){var me={};var _elementStyle=document.createElement("div").style;var _vendor=function(){var vendors=["t","webkitT","MozT","msT","OT"],transform,i=0,l=vendors.length;for(;i<l;i++){transform=vendors[i]+"ransform";if(transform in _elementStyle)return vendors[i].substr(0,vendors[i].length-1)}return false}();function _prefixStyle(style){if(_vendor===false)return false;if(_vendor==="")return style;return _vendor+style.charAt(0).toUpperCase()+style.substr(1)}me.getTime=Date.now||function getTime(){return(new Date).getTime()};me.extend=function(target,obj){for(var i in obj){target[i]=obj[i]}};me.addEvent=function(el,type,fn,capture){el.addEventListener(type,fn,!!capture)};me.removeEvent=function(el,type,fn,capture){el.removeEventListener(type,fn,!!capture)};me.prefixPointerEvent=function(pointerEvent){return window.MSPointerEvent?"MSPointer"+pointerEvent.charAt(7).toUpperCase()+pointerEvent.substr(8):pointerEvent};me.momentum=function(current,start,time,lowerMargin,wrapperSize,deceleration){var distance=current-start,speed=Math.abs(distance)/time,destination,duration;deceleration=deceleration===undefined?6e-4:deceleration;destination=current+speed*speed/(2*deceleration)*(distance<0?-1:1);duration=speed/deceleration;if(destination<lowerMargin){destination=wrapperSize?lowerMargin-wrapperSize/2.5*(speed/8):lowerMargin;distance=Math.abs(destination-current);duration=distance/speed}else if(destination>0){destination=wrapperSize?wrapperSize/2.5*(speed/8):0;distance=Math.abs(current)+destination;duration=distance/speed}return{destination:Math.round(destination),duration:duration}};var _transform=_prefixStyle("transform");me.extend(me,{hasTransform:_transform!==false,hasPerspective:_prefixStyle("perspective")in _elementStyle,hasTouch:"ontouchstart"in window,hasPointer:!!(window.PointerEvent||window.MSPointerEvent),hasTransition:_prefixStyle("transition")in _elementStyle});me.isBadAndroid=function(){var appVersion=window.navigator.appVersion;if(/Android/.test(appVersion)&&!/Chrome\/\d/.test(appVersion)){var safariVersion=appVersion.match(/Safari\/(\d+.\d)/);if(safariVersion&&typeof safariVersion==="object"&&safariVersion.length>=2){return parseFloat(safariVersion[1])<535.19}else{return true}}else{return false}}();me.extend(me.style={},{transform:_transform,transitionTimingFunction:_prefixStyle("transitionTimingFunction"),transitionDuration:_prefixStyle("transitionDuration"),transitionDelay:_prefixStyle("transitionDelay"),transformOrigin:_prefixStyle("transformOrigin")});me.hasClass=function(e,c){var re=new RegExp("(^|\\s)"+c+"(\\s|$)");return re.test(e.className)};me.addClass=function(e,c){if(me.hasClass(e,c)){return}var newclass=e.className.split(" ");newclass.push(c);e.className=newclass.join(" ")};me.removeClass=function(e,c){if(!me.hasClass(e,c)){return}var re=new RegExp("(^|\\s)"+c+"(\\s|$)","g");e.className=e.className.replace(re," ")};me.offset=function(el){var left=-el.offsetLeft,top=-el.offsetTop;while(el=el.offsetParent){left-=el.offsetLeft;top-=el.offsetTop}return{left:left,top:top}};me.preventDefaultException=function(el,exceptions){for(var i in exceptions){if(exceptions[i].test(el[i])){return true}}return false};me.extend(me.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});me.extend(me.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(k){return k*(2-k)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(k){return Math.sqrt(1- --k*k)
}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(k){var b=4;return(k=k-1)*k*((b+1)*k+b)+1}},bounce:{style:"",fn:function(k){if((k/=1)<1/2.75){return 7.5625*k*k}else if(k<2/2.75){return 7.5625*(k-=1.5/2.75)*k+.75}else if(k<2.5/2.75){return 7.5625*(k-=2.25/2.75)*k+.9375}else{return 7.5625*(k-=2.625/2.75)*k+.984375}}},elastic:{style:"",fn:function(k){var f=.22,e=.4;if(k===0){return 0}if(k==1){return 1}return e*Math.pow(2,-10*k)*Math.sin((k-f/4)*(2*Math.PI)/f)+1}}});me.tap=function(e,eventName){var ev=document.createEvent("Event");ev.initEvent(eventName,true,true);ev.pageX=e.pageX;ev.pageY=e.pageY;e.target.dispatchEvent(ev)};me.click=function(e){var target=e.target,ev;if(!/(SELECT|INPUT|TEXTAREA)/i.test(target.tagName)){ev=document.createEvent(window.MouseEvent?"MouseEvents":"Event");ev.initEvent("click",true,true);ev.view=e.view||window;ev.detail=1;ev.screenX=target.screenX||0;ev.screenY=target.screenY||0;ev.clientX=target.clientX||0;ev.clientY=target.clientY||0;ev.ctrlKey=!!e.ctrlKey;ev.altKey=!!e.altKey;ev.shiftKey=!!e.shiftKey;ev.metaKey=!!e.metaKey;ev.button=0;ev.relatedTarget=null;ev._constructed=true;target.dispatchEvent(ev)}};return me}();function IScroll(el,options){this.wrapper=typeof el=="string"?document.querySelector(el):el;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={resizeScrollbars:true,mouseWheelSpeed:20,snapThreshold:.334,disablePointer:!utils.hasPointer,disableTouch:utils.hasPointer||!utils.hasTouch,disableMouse:utils.hasPointer||utils.hasTouch,startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true,bindToWrapper:typeof window.onmousedown==="undefined"};for(var i in options){this.options[i]=options[i]}this.translateZ=this.options.HWCompositing&&utils.hasPerspective?" translateZ(0)":"";this.options.useTransition=utils.hasTransition&&this.options.useTransition;this.options.useTransform=utils.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?utils.ease[this.options.bounceEasing]||utils.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}if(!this.options.useTransition&&!this.options.useTransform){if(!/relative|absolute/i.test(this.scrollerStyle.position)){this.scrollerStyle.position="relative"}}if(this.options.shrinkScrollbars=="scale"){this.options.useTransition=false}this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;if(this.options.probeType==3){this.options.useTransition=false}this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}IScroll.prototype={version:"5.2.0",_init:function(){this._initEvents();if(this.options.scrollbars||this.options.indicators){this._initIndicators()}if(this.options.mouseWheel){this._initWheel()}if(this.options.snap){this._initSnap()}if(this.options.keyBindings){this._initKeys()}},destroy:function(){this._initEvents(true);clearTimeout(this.resizeTimeout);this.resizeTimeout=null;this._execEvent("destroy")},_transitionEnd:function(e){if(e.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(e){if(utils.eventType[e.type]!=1){var button;if(!e.which){button=e.button<2?0:e.button==4?1:2}else{button=e.button}if(button!==0){return}}if(!this.enabled||this.initiated&&utils.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault&&!utils.isBadAndroid&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault()}var point=e.touches?e.touches[0]:e,pos;this.initiated=utils.eventType[e.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this.startTime=utils.getTime();if(this.options.useTransition&&this.isInTransition){this._transitionTime();this.isInTransition=false;pos=this.getComputedPosition();this._translate(Math.round(pos.x),Math.round(pos.y));this._execEvent("scrollEnd")}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=point.pageX;this.pointY=point.pageY;this._execEvent("beforeScrollStart")},_move:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault){e.preventDefault()}var point=e.touches?e.touches[0]:e,deltaX=point.pageX-this.pointX,deltaY=point.pageY-this.pointY,timestamp=utils.getTime(),newX,newY,absDistX,absDistY;this.pointX=point.pageX;this.pointY=point.pageY;this.distX+=deltaX;this.distY+=deltaY;absDistX=Math.abs(this.distX);absDistY=Math.abs(this.distY);if(timestamp-this.endTime>300&&(absDistX<10&&absDistY<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(absDistX>absDistY+this.options.directionLockThreshold){this.directionLocked="h"}else if(absDistY>=absDistX+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical"){e.preventDefault()}else if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}deltaY=0}else if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){e.preventDefault()}else if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}deltaX=0}deltaX=this.hasHorizontalScroll?deltaX:0;deltaY=this.hasVerticalScroll?deltaY:0;newX=this.x+deltaX;newY=this.y+deltaY;if(newX>0||newX<this.maxScrollX){newX=this.options.bounce?this.x+deltaX/3:newX>0?0:this.maxScrollX}if(newY>0||newY<this.maxScrollY){newY=this.options.bounce?this.y+deltaY/3:newY>0?0:this.maxScrollY}this.directionX=deltaX>0?-1:deltaX<0?1:0;this.directionY=deltaY>0?-1:deltaY<0?1:0;if(!this.moved){this._execEvent("scrollStart")}this.moved=true;this._translate(newX,newY);if(timestamp-this.startTime>300){this.startTime=timestamp;this.startX=this.x;this.startY=this.y;if(this.options.probeType==1){this._execEvent("scroll")}}if(this.options.probeType>1){this._execEvent("scroll")}},silieUpDown:function(){var y=this.y;if(!this.hasVerticalScroll||y>0){this._execEvent("slideDown")}else if(y<this.maxScrollY){this._execEvent("slideUp")}},_end:function(e){if(!this.enabled||utils.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault()}var point=e.changedTouches?e.changedTouches[0]:e,momentumX,momentumY,duration=utils.getTime()-this.startTime,newX=Math.round(this.x),newY=Math.round(this.y),distanceX=Math.abs(newX-this.startX),distanceY=Math.abs(newY-this.startY),time=0,easing="";this.isInTransition=0;this.initiated=0;this.endTime=utils.getTime();if(this.resetPosition(this.options.bounceTime)){this.silieUpDown();return}this.scrollTo(newX,newY);if(!this.moved){if(this.options.tap){utils.tap(e,this.options.tap)}if(this.options.click){utils.click(e)}this._execEvent("scrollCancel");return}if(this._events.flick&&duration<200&&distanceX<100&&distanceY<100){this._execEvent("flick");return}if(this.options.momentum&&duration<300){momentumX=this.hasHorizontalScroll?utils.momentum(this.x,this.startX,duration,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:newX,duration:0};momentumY=this.hasVerticalScroll?utils.momentum(this.y,this.startY,duration,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:newY,duration:0};newX=momentumX.destination;newY=momentumY.destination;time=Math.max(momentumX.duration,momentumY.duration);this.isInTransition=1}if(this.options.snap){var snap=this._nearestSnap(newX,newY);this.currentPage=snap;time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(newX-snap.x),1e3),Math.min(Math.abs(newY-snap.y),1e3)),300);newX=snap.x;newY=snap.y;this.directionX=0;this.directionY=0;easing=this.options.bounceEasing}if(newX!=this.x||newY!=this.y){if(newX>0||newX<this.maxScrollX||newY>0||newY<this.maxScrollY){easing=utils.ease.quadratic}this.scrollTo(newX,newY,time,easing);return}this._execEvent("scrollEnd")},_resize:function(){var that=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){that.refresh()},this.options.resizePolling)},resetPosition:function(time){var x=this.x,y=this.y;time=time||0;if(!this.hasHorizontalScroll||this.x>0){x=0}else if(this.x<this.maxScrollX){x=this.maxScrollX}if(!this.hasVerticalScroll||this.y>0){y=0}else if(this.y<this.maxScrollY){y=this.maxScrollY}if(x==this.x&&y==this.y){return false}this.scrollTo(x,y,time,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var rf=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=utils.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(type,fn){if(!this._events[type]){this._events[type]=[]}this._events[type].push(fn)},off:function(type,fn){if(!this._events[type]){return}var index=this._events[type].indexOf(fn);if(index>-1){this._events[type].splice(index,1)}},_execEvent:function(type){if(!this._events[type]){return}var i=0,l=this._events[type].length;if(!l){return}for(;i<l;i++){this._events[type][i].apply(this,[].slice.call(arguments,1))}},scrollBy:function(x,y,time,easing){x=this.x+x;y=this.y+y;time=time||0;this.scrollTo(x,y,time,easing)},scrollTo:function(x,y,time,easing){easing=easing||utils.ease.circular;this.isInTransition=this.options.useTransition&&time>0;var transitionType=this.options.useTransition&&easing.style;if(!time||transitionType){if(transitionType){this._transitionTimingFunction(easing.style);this._transitionTime(time)}this._translate(x,y)}else{this._animate(x,y,time,easing.fn)}},scrollToElement:function(el,time,offsetX,offsetY,easing){el=el.nodeType?el:this.scroller.querySelector(el);if(!el){return}var pos=utils.offset(el);pos.left-=this.wrapperOffset.left;pos.top-=this.wrapperOffset.top;if(offsetX===true){offsetX=Math.round(el.offsetWidth/2-this.wrapper.offsetWidth/2)}if(offsetY===true){offsetY=Math.round(el.offsetHeight/2-this.wrapper.offsetHeight/2)}pos.left-=offsetX||0;pos.top-=offsetY||0;pos.left=pos.left>0?0:pos.left<this.maxScrollX?this.maxScrollX:pos.left;pos.top=pos.top>0?0:pos.top<this.maxScrollY?this.maxScrollY:pos.top;time=time===undefined||time===null||time==="auto"?Math.max(Math.abs(this.x-pos.left),Math.abs(this.y-pos.top)):time;this.scrollTo(pos.left,pos.top,time,easing)},_transitionTime:function(time){if(!this.options.useTransition){return}time=time||0;var durationProp=utils.style.transitionDuration;if(!durationProp){return}this.scrollerStyle[durationProp]=time+"ms";if(!time&&utils.isBadAndroid){this.scrollerStyle[durationProp]="0.0001ms";var self=this;rAF(function(){if(self.scrollerStyle[durationProp]==="0.0001ms"){self.scrollerStyle[durationProp]="0s"}})}if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTime(time)}}},_transitionTimingFunction:function(easing){this.scrollerStyle[utils.style.transitionTimingFunction]=easing;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].transitionTimingFunction(easing)}}},_translate:function(x,y){if(this.options.useTransform){this.scrollerStyle[utils.style.transform]="translate("+x+"px,"+y+"px)"+this.translateZ}else{x=Math.round(x);y=Math.round(y);this.scrollerStyle.left=x+"px";this.scrollerStyle.top=y+"px"}this.x=x;this.y=y;if(this.indicators){for(var i=this.indicators.length;i--;){this.indicators[i].updatePosition()}}},_initEvents:function(remove){var eventType=remove?utils.removeEvent:utils.addEvent,target=this.options.bindToWrapper?this.wrapper:window;eventType(window,"orientationchange",this);eventType(window,"resize",this);if(this.options.click){eventType(this.wrapper,"click",this,true)}if(!this.options.disableMouse){eventType(this.wrapper,"mousedown",this);eventType(target,"mousemove",this);eventType(target,"mousecancel",this);eventType(target,"mouseup",this)}if(utils.hasPointer&&!this.options.disablePointer){eventType(this.wrapper,utils.prefixPointerEvent("pointerdown"),this);eventType(target,utils.prefixPointerEvent("pointermove"),this);eventType(target,utils.prefixPointerEvent("pointercancel"),this);eventType(target,utils.prefixPointerEvent("pointerup"),this)}if(utils.hasTouch&&!this.options.disableTouch){eventType(this.wrapper,"touchstart",this);eventType(target,"touchmove",this);eventType(target,"touchcancel",this);eventType(target,"touchend",this)}eventType(this.scroller,"transitionend",this);eventType(this.scroller,"webkitTransitionEnd",this);eventType(this.scroller,"oTransitionEnd",this);eventType(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var matrix=window.getComputedStyle(this.scroller,null),x,y;if(this.options.useTransform){matrix=matrix[utils.style.transform].split(")")[0].split(", ");x=+(matrix[12]||matrix[4]);y=+(matrix[13]||matrix[5])}else{x=+matrix.left.replace(/[^-\d.]/g,"");y=+matrix.top.replace(/[^-\d.]/g,"")}return{x:x,y:y}},_initIndicators:function(){var interactive=this.options.interactiveScrollbars,customStyle=typeof this.options.scrollbars!="string",indicators=[],indicator;var that=this;this.indicators=[];if(this.options.scrollbars){if(this.options.scrollY){indicator={el:createDefaultScrollbar("v",interactive,this.options.scrollbars),interactive:interactive,defaultScrollbars:true,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:false};this.wrapper.appendChild(indicator.el);indicators.push(indicator)}if(this.options.scrollX){indicator={el:createDefaultScrollbar("h",interactive,this.options.scrollbars),interactive:interactive,defaultScrollbars:true,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:false};this.wrapper.appendChild(indicator.el);indicators.push(indicator)}}if(this.options.indicators){indicators=indicators.concat(this.options.indicators)}for(var i=indicators.length;i--;){this.indicators.push(new Indicator(this,indicators[i]))}function _indicatorsMap(fn){if(that.indicators){for(var i=that.indicators.length;i--;){fn.call(that.indicators[i])}}}if(this.options.fadeScrollbars){this.on("scrollEnd",function(){_indicatorsMap(function(){this.fade()})});this.on("scrollCancel",function(){_indicatorsMap(function(){this.fade()})});this.on("scrollStart",function(){_indicatorsMap(function(){this.fade(1)})});this.on("beforeScrollStart",function(){_indicatorsMap(function(){this.fade(1,true)})})}this.on("refresh",function(){_indicatorsMap(function(){this.refresh()})});this.on("destroy",function(){_indicatorsMap(function(){this.destroy()});delete this.indicators})},_initWheel:function(){utils.addEvent(this.wrapper,"wheel",this);utils.addEvent(this.wrapper,"mousewheel",this);utils.addEvent(this.wrapper,"DOMMouseScroll",this);this.on("destroy",function(){clearTimeout(this.wheelTimeout);this.wheelTimeout=null;utils.removeEvent(this.wrapper,"wheel",this);utils.removeEvent(this.wrapper,"mousewheel",this);utils.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(e){if(!this.enabled){return}e.preventDefault();var wheelDeltaX,wheelDeltaY,newX,newY,that=this;if(this.wheelTimeout===undefined){that._execEvent("scrollStart")}clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){if(!that.options.snap){that._execEvent("scrollEnd")}that.wheelTimeout=undefined},400);if("deltaX"in e){if(e.deltaMode===1){wheelDeltaX=-e.deltaX*this.options.mouseWheelSpeed;wheelDeltaY=-e.deltaY*this.options.mouseWheelSpeed}else{wheelDeltaX=-e.deltaX;wheelDeltaY=-e.deltaY}}else if("wheelDeltaX"in e){wheelDeltaX=e.wheelDeltaX/120*this.options.mouseWheelSpeed;wheelDeltaY=e.wheelDeltaY/120*this.options.mouseWheelSpeed}else if("wheelDelta"in e){wheelDeltaX=wheelDeltaY=e.wheelDelta/120*this.options.mouseWheelSpeed}else if("detail"in e){wheelDeltaX=wheelDeltaY=-e.detail/3*this.options.mouseWheelSpeed}else{return}wheelDeltaX*=this.options.invertWheelDirection;wheelDeltaY*=this.options.invertWheelDirection;if(!this.hasVerticalScroll){wheelDeltaX=wheelDeltaY;wheelDeltaY=0}if(this.options.snap){newX=this.currentPage.pageX;newY=this.currentPage.pageY;if(wheelDeltaX>0){newX--}else if(wheelDeltaX<0){newX++}if(wheelDeltaY>0){newY--}else if(wheelDeltaY<0){newY++}this.goToPage(newX,newY);return}newX=this.x+Math.round(this.hasHorizontalScroll?wheelDeltaX:0);newY=this.y+Math.round(this.hasVerticalScroll?wheelDeltaY:0);this.directionX=wheelDeltaX>0?-1:wheelDeltaX<0?1:0;this.directionY=wheelDeltaY>0?-1:wheelDeltaY<0?1:0;if(newX>0){newX=0}else if(newX<this.maxScrollX){newX=this.maxScrollX}if(newY>0){newY=0}else if(newY<this.maxScrollY){newY=this.maxScrollY}this.scrollTo(newX,newY,0);if(this.options.probeType>1){this._execEvent("scroll")}},_initSnap:function(){this.currentPage={};if(typeof this.options.snap=="string"){this.options.snap=this.scroller.querySelectorAll(this.options.snap)}this.on("refresh",function(){var i=0,l,m=0,n,cx,cy,x=0,y,stepX=this.options.snapStepX||this.wrapperWidth,stepY=this.options.snapStepY||this.wrapperHeight,el;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight){return}if(this.options.snap===true){cx=Math.round(stepX/2);cy=Math.round(stepY/2);while(x>-this.scrollerWidth){this.pages[i]=[];l=0;y=0;while(y>-this.scrollerHeight){this.pages[i][l]={x:Math.max(x,this.maxScrollX),y:Math.max(y,this.maxScrollY),width:stepX,height:stepY,cx:x-cx,cy:y-cy};y-=stepY;l++}x-=stepX;i++}}else{el=this.options.snap;l=el.length;n=-1;for(;i<l;i++){if(i===0||el[i].offsetLeft<=el[i-1].offsetLeft){m=0;n++}if(!this.pages[m]){this.pages[m]=[]}x=Math.max(-el[i].offsetLeft,this.maxScrollX);y=Math.max(-el[i].offsetTop,this.maxScrollY);cx=x-Math.round(el[i].offsetWidth/2);cy=y-Math.round(el[i].offsetHeight/2);this.pages[m][n]={x:x,y:y,width:el[i].offsetWidth,height:el[i].offsetHeight,cx:cx,cy:cy};if(x>this.maxScrollX){m++}}}this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);if(this.options.snapThreshold%1===0){this.snapThresholdX=this.options.snapThreshold;this.snapThresholdY=this.options.snapThreshold}else{this.snapThresholdX=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);this.snapThresholdY=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold)}});this.on("flick",function(){var time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.x-this.startX),1e3),Math.min(Math.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,time)})},_nearestSnap:function(x,y){if(!this.pages.length){return{x:0,y:0,pageX:0,pageY:0}}var i=0,l=this.pages.length,m=0;if(Math.abs(x-this.absStartX)<this.snapThresholdX&&Math.abs(y-this.absStartY)<this.snapThresholdY){return this.currentPage}if(x>0){x=0}else if(x<this.maxScrollX){x=this.maxScrollX}if(y>0){y=0}else if(y<this.maxScrollY){y=this.maxScrollY}for(;i<l;i++){if(x>=this.pages[i][0].cx){x=this.pages[i][0].x;break}}l=this.pages[i].length;for(;m<l;m++){if(y>=this.pages[0][m].cy){y=this.pages[0][m].y;break}}if(i==this.currentPage.pageX){i+=this.directionX;if(i<0){i=0}else if(i>=this.pages.length){i=this.pages.length-1}x=this.pages[i][0].x}if(m==this.currentPage.pageY){m+=this.directionY;if(m<0){m=0}else if(m>=this.pages[0].length){m=this.pages[0].length-1}y=this.pages[0][m].y}return{x:x,y:y,pageX:i,pageY:m}},goToPage:function(x,y,time,easing){easing=easing||this.options.bounceEasing;if(x>=this.pages.length){x=this.pages.length-1}else if(x<0){x=0}if(y>=this.pages[x].length){y=this.pages[x].length-1}else if(y<0){y=0}var posX=this.pages[x][y].x,posY=this.pages[x][y].y;time=time===undefined?this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(posX-this.x),1e3),Math.min(Math.abs(posY-this.y),1e3)),300):time;this.currentPage={x:posX,y:posY,pageX:x,pageY:y};this.scrollTo(posX,posY,time,easing)},next:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;x++;if(x>=this.pages.length&&this.hasVerticalScroll){x=0;y++}this.goToPage(x,y,time,easing)},prev:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;x--;if(x<0&&this.hasVerticalScroll){x=0;y--}this.goToPage(x,y,time,easing)},_initKeys:function(e){var keys={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};var i;if(typeof this.options.keyBindings=="object"){for(i in this.options.keyBindings){if(typeof this.options.keyBindings[i]=="string"){this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0)}}}else{this.options.keyBindings={}}for(i in keys){this.options.keyBindings[i]=this.options.keyBindings[i]||keys[i]}utils.addEvent(window,"keydown",this);this.on("destroy",function(){utils.removeEvent(window,"keydown",this)})},_key:function(e){if(!this.enabled){return}var snap=this.options.snap,newX=snap?this.currentPage.pageX:this.x,newY=snap?this.currentPage.pageY:this.y,now=utils.getTime(),prevTime=this.keyTime||0,acceleration=.25,pos;if(this.options.useTransition&&this.isInTransition){pos=this.getComputedPosition();this._translate(Math.round(pos.x),Math.round(pos.y));this.isInTransition=false}this.keyAcceleration=now-prevTime<200?Math.min(this.keyAcceleration+acceleration,50):0;switch(e.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){newX+=snap?1:this.wrapperWidth}else{newY+=snap?1:this.wrapperHeight}break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){newX-=snap?1:this.wrapperWidth}else{newY-=snap?1:this.wrapperHeight}break;case this.options.keyBindings.end:newX=snap?this.pages.length-1:this.maxScrollX;newY=snap?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:newX=0;newY=0;break;case this.options.keyBindings.left:newX+=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:newY+=snap?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:newX-=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:newY-=snap?1:5+this.keyAcceleration>>0;break;default:return}if(snap){this.goToPage(newX,newY);return}if(newX>0){newX=0;this.keyAcceleration=0}else if(newX<this.maxScrollX){newX=this.maxScrollX;this.keyAcceleration=0}if(newY>0){newY=0;this.keyAcceleration=0}else if(newY<this.maxScrollY){newY=this.maxScrollY;this.keyAcceleration=0}this.scrollTo(newX,newY,0);this.keyTime=now},_animate:function(destX,destY,duration,easingFn){var that=this,startX=this.x,startY=this.y,startTime=utils.getTime(),destTime=startTime+duration;function step(){var now=utils.getTime(),newX,newY,easing;if(now>=destTime){that.isAnimating=false;that._translate(destX,destY);if(!that.resetPosition(that.options.bounceTime)){that._execEvent("scrollEnd")}return}now=(now-startTime)/duration;easing=easingFn(now);newX=(destX-startX)*easing+startX;newY=(destY-startY)*easing+startY;that._translate(newX,newY);if(that.isAnimating){rAF(step)}if(that.options.probeType==3){that._execEvent("scroll")}}this.isAnimating=true;step()},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":if(this.enabled&&!e._constructed){e.preventDefault();e.stopPropagation()}break}}};function createDefaultScrollbar(direction,interactive,type){var scrollbar=document.createElement("div"),indicator=document.createElement("div");if(type===true){scrollbar.style.cssText="position:absolute;z-index:9999";indicator.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"}indicator.className="iScrollIndicator";if(direction=="h"){if(type===true){scrollbar.style.cssText+=";height:7px;left:2px;right:2px;bottom:0";indicator.style.height="100%"}scrollbar.className="iScrollHorizontalScrollbar"}else{if(type===true){scrollbar.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px";indicator.style.width="100%"}scrollbar.className="iScrollVerticalScrollbar"}scrollbar.style.cssText+=";overflow:hidden";if(!interactive){scrollbar.style.pointerEvents="none"}scrollbar.appendChild(indicator);return scrollbar}function Indicator(scroller,options){this.wrapper=typeof options.el=="string"?document.querySelector(options.el):options.el;this.wrapperStyle=this.wrapper.style;this.indicator=this.wrapper.children[0];this.indicatorStyle=this.indicator.style;this.scroller=scroller;this.options={listenX:true,listenY:true,interactive:false,resize:true,defaultScrollbars:false,shrink:false,fade:false,speedRatioX:0,speedRatioY:0};for(var i in options){this.options[i]=options[i]}this.sizeRatioX=1;this.sizeRatioY=1;this.maxPosX=0;this.maxPosY=0;if(this.options.interactive){if(!this.options.disableTouch){utils.addEvent(this.indicator,"touchstart",this);utils.addEvent(window,"touchend",this)}if(!this.options.disablePointer){utils.addEvent(this.indicator,utils.prefixPointerEvent("pointerdown"),this);utils.addEvent(window,utils.prefixPointerEvent("pointerup"),this)}if(!this.options.disableMouse){utils.addEvent(this.indicator,"mousedown",this);utils.addEvent(window,"mouseup",this)}}if(this.options.fade){this.wrapperStyle[utils.style.transform]=this.scroller.translateZ;var durationProp=utils.style.transitionDuration;if(!durationProp){return}this.wrapperStyle[durationProp]=utils.isBadAndroid?"0.0001ms":"0ms";var self=this;if(utils.isBadAndroid){rAF(function(){if(self.wrapperStyle[durationProp]==="0.0001ms"){self.wrapperStyle[durationProp]="0s"}})}this.wrapperStyle.opacity="0"}}Indicator.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break}},destroy:function(){if(this.options.fadeScrollbars){clearTimeout(this.fadeTimeout);this.fadeTimeout=null}if(this.options.interactive){utils.removeEvent(this.indicator,"touchstart",this);utils.removeEvent(this.indicator,utils.prefixPointerEvent("pointerdown"),this);utils.removeEvent(this.indicator,"mousedown",this);utils.removeEvent(window,"touchmove",this);utils.removeEvent(window,utils.prefixPointerEvent("pointermove"),this);utils.removeEvent(window,"mousemove",this);utils.removeEvent(window,"touchend",this);utils.removeEvent(window,utils.prefixPointerEvent("pointerup"),this);utils.removeEvent(window,"mouseup",this)}if(this.options.defaultScrollbars){this.wrapper.parentNode.removeChild(this.wrapper)}},_start:function(e){var point=e.touches?e.touches[0]:e;e.preventDefault();e.stopPropagation();this.transitionTime();this.initiated=true;this.moved=false;this.lastPointX=point.pageX;this.lastPointY=point.pageY;this.startTime=utils.getTime();if(!this.options.disableTouch){utils.addEvent(window,"touchmove",this)}if(!this.options.disablePointer){utils.addEvent(window,utils.prefixPointerEvent("pointermove"),this)}if(!this.options.disableMouse){utils.addEvent(window,"mousemove",this)}this.scroller._execEvent("beforeScrollStart")},_move:function(e){var point=e.touches?e.touches[0]:e,deltaX,deltaY,newX,newY,timestamp=utils.getTime();if(!this.moved){this.scroller._execEvent("scrollStart")}this.moved=true;deltaX=point.pageX-this.lastPointX;this.lastPointX=point.pageX;deltaY=point.pageY-this.lastPointY;this.lastPointY=point.pageY;newX=this.x+deltaX;newY=this.y+deltaY;this._pos(newX,newY);if(this.scroller.options.probeType==1&&timestamp-this.startTime>300){this.startTime=timestamp;this.scroller._execEvent("scroll")}else if(this.scroller.options.probeType>1){this.scroller._execEvent("scroll")}e.preventDefault();e.stopPropagation()},_end:function(e){if(!this.initiated){return}this.initiated=false;e.preventDefault();e.stopPropagation();utils.removeEvent(window,"touchmove",this);utils.removeEvent(window,utils.prefixPointerEvent("pointermove"),this);utils.removeEvent(window,"mousemove",this);if(this.scroller.options.snap){var snap=this.scroller._nearestSnap(this.scroller.x,this.scroller.y);var time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.scroller.x-snap.x),1e3),Math.min(Math.abs(this.scroller.y-snap.y),1e3)),300);if(this.scroller.x!=snap.x||this.scroller.y!=snap.y){this.scroller.directionX=0;this.scroller.directionY=0;this.scroller.currentPage=snap;this.scroller.scrollTo(snap.x,snap.y,time,this.scroller.options.bounceEasing)}}if(this.moved){this.scroller._execEvent("scrollEnd")}},transitionTime:function(time){time=time||0;var durationProp=utils.style.transitionDuration;if(!durationProp){return}this.indicatorStyle[durationProp]=time+"ms";if(!time&&utils.isBadAndroid){this.indicatorStyle[durationProp]="0.0001ms";var self=this;rAF(function(){if(self.indicatorStyle[durationProp]==="0.0001ms"){self.indicatorStyle[durationProp]="0s"}})}},transitionTimingFunction:function(easing){this.indicatorStyle[utils.style.transitionTimingFunction]=easing},refresh:function(){this.transitionTime();if(this.options.listenX&&!this.options.listenY){this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none"}else if(this.options.listenY&&!this.options.listenX){this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none"}else{this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none"}if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){utils.addClass(this.wrapper,"iScrollBothScrollbars");utils.removeClass(this.wrapper,"iScrollLoneScrollbar");
if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right="8px"}else{this.wrapper.style.bottom="8px"}}}else{utils.removeClass(this.wrapper,"iScrollBothScrollbars");utils.addClass(this.wrapper,"iScrollLoneScrollbar");if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right="2px"}else{this.wrapper.style.bottom="2px"}}}var r=this.wrapper.offsetHeight;if(this.options.listenX){this.wrapperWidth=this.wrapper.clientWidth;if(this.options.resize){this.indicatorWidth=Math.max(Math.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8);this.indicatorStyle.width=this.indicatorWidth+"px"}else{this.indicatorWidth=this.indicator.clientWidth}this.maxPosX=this.wrapperWidth-this.indicatorWidth;if(this.options.shrink=="clip"){this.minBoundaryX=-this.indicatorWidth+8;this.maxBoundaryX=this.wrapperWidth-8}else{this.minBoundaryX=0;this.maxBoundaryX=this.maxPosX}this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX}if(this.options.listenY){this.wrapperHeight=this.wrapper.clientHeight;if(this.options.resize){this.indicatorHeight=Math.max(Math.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8);this.indicatorStyle.height=this.indicatorHeight+"px"}else{this.indicatorHeight=this.indicator.clientHeight}this.maxPosY=this.wrapperHeight-this.indicatorHeight;if(this.options.shrink=="clip"){this.minBoundaryY=-this.indicatorHeight+8;this.maxBoundaryY=this.wrapperHeight-8}else{this.minBoundaryY=0;this.maxBoundaryY=this.maxPosY}this.maxPosY=this.wrapperHeight-this.indicatorHeight;this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY}this.updatePosition()},updatePosition:function(){var x=this.options.listenX&&Math.round(this.sizeRatioX*this.scroller.x)||0,y=this.options.listenY&&Math.round(this.sizeRatioY*this.scroller.y)||0;if(!this.options.ignoreBoundaries){if(x<this.minBoundaryX){if(this.options.shrink=="scale"){this.width=Math.max(this.indicatorWidth+x,8);this.indicatorStyle.width=this.width+"px"}x=this.minBoundaryX}else if(x>this.maxBoundaryX){if(this.options.shrink=="scale"){this.width=Math.max(this.indicatorWidth-(x-this.maxPosX),8);this.indicatorStyle.width=this.width+"px";x=this.maxPosX+this.indicatorWidth-this.width}else{x=this.maxBoundaryX}}else if(this.options.shrink=="scale"&&this.width!=this.indicatorWidth){this.width=this.indicatorWidth;this.indicatorStyle.width=this.width+"px"}if(y<this.minBoundaryY){if(this.options.shrink=="scale"){this.height=Math.max(this.indicatorHeight+y*3,8);this.indicatorStyle.height=this.height+"px"}y=this.minBoundaryY}else if(y>this.maxBoundaryY){if(this.options.shrink=="scale"){this.height=Math.max(this.indicatorHeight-(y-this.maxPosY)*3,8);this.indicatorStyle.height=this.height+"px";y=this.maxPosY+this.indicatorHeight-this.height}else{y=this.maxBoundaryY}}else if(this.options.shrink=="scale"&&this.height!=this.indicatorHeight){this.height=this.indicatorHeight;this.indicatorStyle.height=this.height+"px"}}this.x=x;this.y=y;if(this.scroller.options.useTransform){this.indicatorStyle[utils.style.transform]="translate("+x+"px,"+y+"px)"+this.scroller.translateZ}else{this.indicatorStyle.left=x+"px";this.indicatorStyle.top=y+"px"}},_pos:function(x,y){if(x<0){x=0}else if(x>this.maxPosX){x=this.maxPosX}if(y<0){y=0}else if(y>this.maxPosY){y=this.maxPosY}x=this.options.listenX?Math.round(x/this.sizeRatioX):this.scroller.x;y=this.options.listenY?Math.round(y/this.sizeRatioY):this.scroller.y;this.scroller.scrollTo(x,y)},fade:function(val,hold){if(hold&&!this.visible){return}clearTimeout(this.fadeTimeout);this.fadeTimeout=null;var time=val?250:500,delay=val?0:300;val=val?"1":"0";this.wrapperStyle[utils.style.transitionDuration]=time+"ms";this.fadeTimeout=setTimeout(function(val){this.wrapperStyle.opacity=val;this.visible=+val}.bind(this,val),delay)}};IScroll.utils=utils;if(typeof module!="undefined"&&module.exports){module.exports=IScroll}else if(typeof define=="function"&&define.amd){define(function(){return IScroll})}else{window.IScroll=IScroll}})(window,document,Math);(function($,undefined){"use strict";var defaults={item:3,autoWidth:false,slideMove:1,slideMargin:10,addClass:"",mode:"slide",useCSS:true,cssEasing:"ease",easing:"linear",speed:400,auto:false,pauseOnHover:false,loop:false,slideEndAnimation:true,pause:2e3,keyPress:false,controls:true,prevHtml:"",nextHtml:"",rtl:false,adaptiveHeight:false,vertical:false,verticalHeight:500,vThumbWidth:100,thumbItem:10,pager:true,gallery:false,galleryMargin:5,thumbMargin:5,currentPagerPosition:"middle",enableTouch:true,enableDrag:true,freeMove:true,swipeThreshold:40,responsive:[],onBeforeStart:function($el){},onSliderLoad:function($el){},onBeforeSlide:function($el,scene){},onAfterSlide:function($el,scene){},onBeforeNextSlide:function($el,scene){},onBeforePrevSlide:function($el,scene){}};$.fn.lightSlider=function(options){if(this.length===0){return this}if(this.length>1){this.each(function(){$(this).lightSlider(options)});return this}var plugin={},settings=$.extend(true,{},defaults,options),settingsTemp={},$el=this;plugin.$el=this;if(settings.mode==="fade"){settings.vertical=false}var $children=$el.children(),windowW=$(window).width(),breakpoint=null,resposiveObj=null,length=0,w=0,on=false,elSize=0,$slide="",scene=0,property=settings.vertical===true?"height":"width",gutter=settings.vertical===true?"margin-bottom":"margin-right",slideValue=0,pagerWidth=0,slideWidth=0,thumbWidth=0,interval=null,isTouch="ontouchstart"in document.documentElement;var refresh={};refresh.chbreakpoint=function(){windowW=$(window).width();if(settings.responsive.length){var item;if(settings.autoWidth===false){item=settings.item}if(windowW<settings.responsive[0].breakpoint){for(var i=0;i<settings.responsive.length;i++){if(windowW<settings.responsive[i].breakpoint){breakpoint=settings.responsive[i].breakpoint;resposiveObj=settings.responsive[i]}}}if(typeof resposiveObj!=="undefined"&&resposiveObj!==null){for(var j in resposiveObj.settings){if(resposiveObj.settings.hasOwnProperty(j)){if(typeof settingsTemp[j]==="undefined"||settingsTemp[j]===null){settingsTemp[j]=settings[j]}settings[j]=resposiveObj.settings[j]}}}if(!$.isEmptyObject(settingsTemp)&&windowW>settings.responsive[0].breakpoint){for(var k in settingsTemp){if(settingsTemp.hasOwnProperty(k)){settings[k]=settingsTemp[k]}}}if(settings.autoWidth===false){if(slideValue>0&&slideWidth>0){if(item!==settings.item){scene=Math.round(slideValue/((slideWidth+settings.slideMargin)*settings.slideMove))}}}}};refresh.calSW=function(){if(settings.autoWidth===false){slideWidth=(elSize-(settings.item*settings.slideMargin-settings.slideMargin))/settings.item}};refresh.calWidth=function(cln){var ln=cln===true?$slide.find(".lslide").length:$children.length;if(settings.autoWidth===false){w=ln*(slideWidth+settings.slideMargin)}else{w=0;for(var i=0;i<ln;i++){w+=parseInt($children.eq(i).width())+settings.slideMargin}}return w};plugin={doCss:function(){var support=function(){var transition=["transition","MozTransition","WebkitTransition","OTransition","msTransition","KhtmlTransition"];var root=document.documentElement;for(var i=0;i<transition.length;i++){if(transition[i]in root.style){return true}}};if(settings.useCSS&&support()){return true}return false},keyPress:function(){if(settings.keyPress){$(document).on("keyup.lightslider",function(e){if(!$(":focus").is("input, textarea")){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}if(e.keyCode===37){$el.goToPrevSlide()}else if(e.keyCode===39){$el.goToNextSlide()}}})}},controls:function(){if(settings.controls){$el.after('<div class="lSAction"><a class="lSPrev">'+settings.prevHtml+'</a><a class="lSNext">'+settings.nextHtml+"</a></div>");if(!settings.autoWidth){if(length<=settings.item){$slide.find(".lSAction").hide()}}else{if(refresh.calWidth(false)<elSize){$slide.find(".lSAction").hide()}}$slide.find(".lSAction a").on("click",function(e){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}if($(this).attr("class")==="lSPrev"){$el.goToPrevSlide()}else{$el.goToNextSlide()}return false})}},initialStyle:function(){var $this=this;if(settings.mode==="fade"){settings.autoWidth=false;settings.slideEndAnimation=false}if(settings.auto){settings.slideEndAnimation=false}if(settings.autoWidth){settings.slideMove=1;settings.item=1}if(settings.loop){settings.slideMove=1;settings.freeMove=false}settings.onBeforeStart.call(this,$el);refresh.chbreakpoint();$el.addClass("lightSlider").wrap('<div class="lSSlideOuter '+settings.addClass+'"><div class="lSSlideWrapper"></div></div>');$slide=$el.parent(".lSSlideWrapper");if(settings.rtl===true){$slide.parent().addClass("lSrtl")}if(settings.vertical){$slide.parent().addClass("vertical");elSize=settings.verticalHeight;$slide.css("height",elSize+"px")}else{elSize=$el.outerWidth()}$children.addClass("lslide");if(settings.loop===true&&settings.mode==="slide"){refresh.calSW();refresh.clone=function(){if(refresh.calWidth(true)>elSize){var tWr=0,tI=0;for(var k=0;k<$children.length;k++){tWr+=parseInt($el.find(".lslide").eq(k).width())+settings.slideMargin;tI++;if(tWr>=elSize+settings.slideMargin){break}}var tItem=settings.autoWidth===true?tI:settings.item;if(tItem<$el.find(".clone.left").length){for(var i=0;i<$el.find(".clone.left").length-tItem;i++){$children.eq(i).remove()}}if(tItem<$el.find(".clone.right").length){for(var j=$children.length-1;j>$children.length-1-$el.find(".clone.right").length;j--){scene--;$children.eq(j).remove()}}for(var n=$el.find(".clone.right").length;n<tItem;n++){$el.find(".lslide").eq(n).clone().removeClass("lslide").addClass("clone right").appendTo($el);scene++}for(var m=$el.find(".lslide").length-$el.find(".clone.left").length;m>$el.find(".lslide").length-tItem;m--){$el.find(".lslide").eq(m-1).clone().removeClass("lslide").addClass("clone left").prependTo($el)}$children=$el.children()}else{if($children.hasClass("clone")){$el.find(".clone").remove();$this.move($el,0)}}};refresh.clone()}refresh.sSW=function(){length=$children.length;if(settings.rtl===true&&settings.vertical===false){gutter="margin-left"}if(settings.autoWidth===false){$children.css(property,slideWidth+"px")}$children.css(gutter,settings.slideMargin+"px");w=refresh.calWidth(false);$el.css(property,w+"px");if(settings.loop===true&&settings.mode==="slide"){if(on===false){scene=$el.find(".clone.left").length}}};refresh.calL=function(){$children=$el.children();length=$children.length};if(this.doCss()){$slide.addClass("usingCss")}refresh.calL();if(settings.mode==="slide"){refresh.calSW();refresh.sSW();if(settings.loop===true){slideValue=$this.slideValue();this.move($el,slideValue)}if(settings.vertical===false){this.setHeight($el,false)}}else{this.setHeight($el,true);$el.addClass("lSFade");if(!this.doCss()){$children.fadeOut(0);$children.eq(scene).fadeIn(0)}}if(settings.loop===true&&settings.mode==="slide"){$children.eq(scene).addClass("active")}else{$children.first().addClass("active")}},pager:function(){var $this=this;refresh.createPager=function(){thumbWidth=(elSize-(settings.thumbItem*settings.thumbMargin-settings.thumbMargin))/settings.thumbItem;var $children=$slide.find(".lslide");var length=$slide.find(".lslide").length;var i=0,pagers="",v=0;for(i=0;i<length;i++){if(settings.mode==="slide"){if(!settings.autoWidth){v=i*((slideWidth+settings.slideMargin)*settings.slideMove)}else{v+=(parseInt($children.eq(i).width())+settings.slideMargin)*settings.slideMove}}var thumb=$children.eq(i*settings.slideMove).attr("data-thumb");if(settings.gallery===true){pagers+='<li style="width:100%;'+property+":"+thumbWidth+"px;"+gutter+":"+settings.thumbMargin+'px"><a href="#"><img src="'+thumb+'" /></a></li>'}else{pagers+='<li><a href="#">'+(i+1)+"</a></li>"}if(settings.mode==="slide"){if(v>=w-elSize-settings.slideMargin){i=i+1;var minPgr=2;if(settings.autoWidth){pagers+='<li><a href="#">'+(i+1)+"</a></li>";minPgr=1}if(i<minPgr){pagers=null;$slide.parent().addClass("noPager")}else{$slide.parent().removeClass("noPager")}break}}}var $cSouter=$slide.parent();$cSouter.find(".lSPager").html(pagers);if(settings.gallery===true){if(settings.vertical===true){$cSouter.find(".lSPager").css("width",settings.vThumbWidth+"px")}pagerWidth=i*(settings.thumbMargin+thumbWidth)+.5;$cSouter.find(".lSPager").css({property:pagerWidth+"px","transition-duration":settings.speed+"ms"});if(settings.vertical===true){$slide.parent().css("padding-right",settings.vThumbWidth+settings.galleryMargin+"px")}$cSouter.find(".lSPager").css(property,pagerWidth+"px")}var $pager=$cSouter.find(".lSPager").find("li");$pager.first().addClass("active");$pager.on("click",function(){if(settings.loop===true&&settings.mode==="slide"){scene=scene+($pager.index(this)-$cSouter.find(".lSPager").find("li.active").index())}else{scene=$pager.index(this)}$el.mode(false);if(settings.gallery===true){$this.slideThumb()}return false})};if(settings.pager){var cl="lSpg";if(settings.gallery){cl="lSGallery"}$slide.after('<ul class="lSPager '+cl+'"></ul>');var gMargin=settings.vertical?"margin-left":"margin-top";$slide.parent().find(".lSPager").css(gMargin,settings.galleryMargin+"px");refresh.createPager()}setTimeout(function(){refresh.init()},0)},setHeight:function(ob,fade){var obj=null,$this=this;if(settings.loop){obj=ob.children(".lslide ").first()}else{obj=ob.children().first()}var setCss=function(){var tH=obj.outerHeight(),tP=0,tHT=tH;if(fade){tH=0;tP=tHT*100/elSize}ob.css({height:tH+"px","padding-bottom":tP+"%"})};setCss();if(obj.find("img").length){if(obj.find("img")[0].complete){setCss();if(!interval){$this.auto()}}else{obj.find("img").load(function(){setTimeout(function(){setCss();if(!interval){$this.auto()}},100)})}}else{if(!interval){$this.auto()}}},active:function(ob,t){if(this.doCss()&&settings.mode==="fade"){$slide.addClass("on")}var sc=0;if(scene*settings.slideMove<length){ob.removeClass("active");if(!this.doCss()&&settings.mode==="fade"&&t===false){ob.fadeOut(settings.speed)}if(t===true){sc=scene}else{sc=scene*settings.slideMove}var l,nl;if(t===true){l=ob.length;nl=l-1;if(sc+1>=l){sc=nl}}if(settings.loop===true&&settings.mode==="slide"){if(t===true){sc=scene-$el.find(".clone.left").length}else{sc=scene*settings.slideMove}if(t===true){l=ob.length;nl=l-1;if(sc+1===l){sc=nl}else if(sc+1>l){sc=0}}}if(!this.doCss()&&settings.mode==="fade"&&t===false){ob.eq(sc).fadeIn(settings.speed)}ob.eq(sc).addClass("active")}else{ob.removeClass("active");ob.eq(ob.length-1).addClass("active");if(!this.doCss()&&settings.mode==="fade"&&t===false){ob.fadeOut(settings.speed);ob.eq(sc).fadeIn(settings.speed)}}},move:function(ob,v){if(settings.rtl===true){v=-v}if(this.doCss()){if(settings.vertical===true){ob.css({transform:"translate3d(0px, "+-v+"px, 0px)","-webkit-transform":"translate3d(0px, "+-v+"px, 0px)"})}else{ob.css({transform:"translate3d("+-v+"px, 0px, 0px)","-webkit-transform":"translate3d("+-v+"px, 0px, 0px)"})}}else{if(settings.vertical===true){ob.css("position","relative").animate({top:-v+"px"},settings.speed,settings.easing)}else{ob.css("position","relative").animate({left:-v+"px"},settings.speed,settings.easing)}}var $thumb=$slide.parent().find(".lSPager").find("li");this.active($thumb,true)},fade:function(){this.active($children,false);var $thumb=$slide.parent().find(".lSPager").find("li");this.active($thumb,true)},slide:function(){var $this=this;refresh.calSlide=function(){if(w>elSize){slideValue=$this.slideValue();$this.active($children,false);if(slideValue>w-elSize-settings.slideMargin){slideValue=w-elSize-settings.slideMargin}else if(slideValue<0){slideValue=0}$this.move($el,slideValue);if(settings.loop===true&&settings.mode==="slide"){if(scene>=length-$el.find(".clone.left").length/settings.slideMove){$this.resetSlide($el.find(".clone.left").length)}if(scene===0){$this.resetSlide($slide.find(".lslide").length)}}}};refresh.calSlide()},resetSlide:function(s){var $this=this;$slide.find(".lSAction a").addClass("disabled");setTimeout(function(){scene=s;$slide.css("transition-duration","0ms");slideValue=$this.slideValue();$this.active($children,false);plugin.move($el,slideValue);setTimeout(function(){$slide.css("transition-duration",settings.speed+"ms");$slide.find(".lSAction a").removeClass("disabled")},50)},settings.speed+100)},slideValue:function(){var _sV=0;if(settings.autoWidth===false){_sV=scene*((slideWidth+settings.slideMargin)*settings.slideMove)}else{_sV=0;for(var i=0;i<scene;i++){_sV+=parseInt($children.eq(i).width())+settings.slideMargin}}return _sV},slideThumb:function(){var position;switch(settings.currentPagerPosition){case"left":position=0;break;case"middle":position=elSize/2-thumbWidth/2;break;case"right":position=elSize-thumbWidth}var sc=scene-$el.find(".clone.left").length;var $pager=$slide.parent().find(".lSPager");if(settings.mode==="slide"&&settings.loop===true){if(sc>=$pager.children().length){sc=0}else if(sc<0){sc=$pager.children().length}}var thumbSlide=sc*(thumbWidth+settings.thumbMargin)-position;if(thumbSlide+elSize>pagerWidth){thumbSlide=pagerWidth-elSize-settings.thumbMargin}if(thumbSlide<0){thumbSlide=0}this.move($pager,thumbSlide)},auto:function(){if(settings.auto){clearInterval(interval);interval=setInterval(function(){$el.goToNextSlide()},settings.pause)}},pauseOnHover:function(){var $this=this;if(settings.auto&&settings.pauseOnHover){$slide.on("mouseenter",function(){$(this).addClass("ls-hover");$el.pause();settings.auto=true});$slide.on("mouseleave",function(){$(this).removeClass("ls-hover");if(!$slide.find(".lightSlider").hasClass("lsGrabbing")){$this.auto()}})}},touchMove:function(endCoords,startCoords){$slide.css("transition-duration","0ms");if(settings.mode==="slide"){var distance=endCoords-startCoords;var swipeVal=slideValue-distance;if(swipeVal>=w-elSize-settings.slideMargin){if(settings.freeMove===false){swipeVal=w-elSize-settings.slideMargin}else{var swipeValT=w-elSize-settings.slideMargin;swipeVal=swipeValT+(swipeVal-swipeValT)/5}}else if(swipeVal<0){if(settings.freeMove===false){swipeVal=0}else{swipeVal=swipeVal/5}}this.move($el,swipeVal)}},touchEnd:function(distance){$slide.css("transition-duration",settings.speed+"ms");if(settings.mode==="slide"){var mxVal=false;var _next=true;slideValue=slideValue-distance;if(slideValue>w-elSize-settings.slideMargin){slideValue=w-elSize-settings.slideMargin;if(settings.autoWidth===false){mxVal=true}}else if(slideValue<0){slideValue=0}var gC=function(next){var ad=0;if(!mxVal){if(next){ad=1}}if(!settings.autoWidth){var num=slideValue/((slideWidth+settings.slideMargin)*settings.slideMove);scene=parseInt(num)+ad;if(slideValue>=w-elSize-settings.slideMargin){if(num%1!==0){scene++}}}else{var tW=0;for(var i=0;i<$children.length;i++){tW+=parseInt($children.eq(i).width())+settings.slideMargin;scene=i+ad;if(tW>=slideValue){break}}}};if(distance>=settings.swipeThreshold){gC(false);_next=false}else if(distance<=-settings.swipeThreshold){gC(true);_next=false}$el.mode(_next);this.slideThumb()}else{if(distance>=settings.swipeThreshold){$el.goToPrevSlide()}else if(distance<=-settings.swipeThreshold){$el.goToNextSlide()}}},enableDrag:function(){var $this=this;if(!isTouch){var startCoords=0,endCoords=0,isDraging=false;$slide.find(".lightSlider").addClass("lsGrab");$slide.on("mousedown",function(e){if(w<elSize){if(w!==0){return false}}if($(e.target).attr("class")!=="lSPrev"&&$(e.target).attr("class")!=="lSNext"){startCoords=settings.vertical===true?e.pageY:e.pageX;isDraging=true;if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}$slide.scrollLeft+=1;$slide.scrollLeft-=1;$slide.find(".lightSlider").removeClass("lsGrab").addClass("lsGrabbing");clearInterval(interval)}});$(window).on("mousemove",function(e){if(isDraging){endCoords=settings.vertical===true?e.pageY:e.pageX;$this.touchMove(endCoords,startCoords)}});$(window).on("mouseup",function(e){if(isDraging){$slide.find(".lightSlider").removeClass("lsGrabbing").addClass("lsGrab");isDraging=false;endCoords=settings.vertical===true?e.pageY:e.pageX;var distance=endCoords-startCoords;if(Math.abs(distance)>=settings.swipeThreshold){$(window).on("click.ls",function(e){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}e.stopImmediatePropagation();e.stopPropagation();$(window).off("click.ls")})}$this.touchEnd(distance)}})}},enableTouch:function(){var $this=this;if(isTouch){var startCoords={},endCoords={};$slide.on("touchstart",function(e){endCoords=e.originalEvent.targetTouches[0];startCoords.pageX=e.originalEvent.targetTouches[0].pageX;startCoords.pageY=e.originalEvent.targetTouches[0].pageY;clearInterval(interval)});$slide.on("touchmove",function(e){if(w<elSize){if(w!==0){return false}}var orig=e.originalEvent;endCoords=orig.targetTouches[0];var xMovement=Math.abs(endCoords.pageX-startCoords.pageX);var yMovement=Math.abs(endCoords.pageY-startCoords.pageY);if(settings.vertical===true){if(yMovement*3>xMovement){e.preventDefault()}$this.touchMove(endCoords.pageY,startCoords.pageY)}else{if(xMovement*3>yMovement){e.preventDefault()}$this.touchMove(endCoords.pageX,startCoords.pageX)}});$slide.on("touchend",function(){if(w<elSize){if(w!==0){return false}}var distance;if(settings.vertical===true){distance=endCoords.pageY-startCoords.pageY}else{distance=endCoords.pageX-startCoords.pageX}$this.touchEnd(distance)})}},build:function(){var $this=this;$this.initialStyle();if(this.doCss()){if(settings.enableTouch===true){$this.enableTouch()}if(settings.enableDrag===true){$this.enableDrag()}}$(window).on("focus",function(){$this.auto()});$(window).on("blur",function(){clearInterval(interval)});$this.pager();$this.pauseOnHover();$this.controls();$this.keyPress()}};plugin.build();refresh.init=function(){refresh.chbreakpoint();if(settings.vertical===true){if(settings.item>1){elSize=settings.verticalHeight}else{elSize=$children.outerHeight()}$slide.css("height",elSize+"px")}else{elSize=$slide.outerWidth()}if(settings.loop===true&&settings.mode==="slide"){refresh.clone()}refresh.calL();if(settings.mode==="slide"){$el.removeClass("lSSlide")}if(settings.mode==="slide"){refresh.calSW();refresh.sSW()}setTimeout(function(){if(settings.mode==="slide"){$el.addClass("lSSlide")}},1e3);if(settings.pager){refresh.createPager()}if(settings.adaptiveHeight===true&&settings.vertical===false){$el.css("height",$children.eq(scene).outerHeight(true))}if(settings.adaptiveHeight===false){if(settings.mode==="slide"){if(settings.vertical===false){plugin.setHeight($el,false)}else{plugin.auto()}}else{plugin.setHeight($el,true)}}if(settings.gallery===true){plugin.slideThumb()}if(settings.mode==="slide"){plugin.slide()}if(settings.autoWidth===false){if($children.length<=settings.item){$slide.find(".lSAction").hide()}else{$slide.find(".lSAction").show()}}else{if(refresh.calWidth(false)<elSize&&w!==0){$slide.find(".lSAction").hide()}else{$slide.find(".lSAction").show()}}};$el.goToPrevSlide=function(){if(scene>0){settings.onBeforePrevSlide.call(this,$el,scene);scene--;$el.mode(false);if(settings.gallery===true){plugin.slideThumb()}}else{if(settings.loop===true){settings.onBeforePrevSlide.call(this,$el,scene);if(settings.mode==="fade"){var l=length-1;scene=parseInt(l/settings.slideMove)}$el.mode(false);if(settings.gallery===true){plugin.slideThumb()}}else if(settings.slideEndAnimation===true){$el.addClass("leftEnd");setTimeout(function(){$el.removeClass("leftEnd")},400)}}};$el.goToNextSlide=function(){var nextI=true;if(settings.mode==="slide"){var _slideValue=plugin.slideValue();nextI=_slideValue<w-elSize-settings.slideMargin}if(scene*settings.slideMove<length-settings.slideMove&&nextI){settings.onBeforeNextSlide.call(this,$el,scene);scene++;$el.mode(false);if(settings.gallery===true){plugin.slideThumb()}}else{if(settings.loop===true){settings.onBeforeNextSlide.call(this,$el,scene);scene=0;$el.mode(false);if(settings.gallery===true){plugin.slideThumb()}}else if(settings.slideEndAnimation===true){$el.addClass("rightEnd");setTimeout(function(){$el.removeClass("rightEnd")},400)}}};$el.mode=function(_touch){if(settings.adaptiveHeight===true&&settings.vertical===false){$el.css("height",$children.eq(scene).outerHeight(true))}if(on===false){if(settings.mode==="slide"){if(plugin.doCss()){$el.addClass("lSSlide");if(settings.speed!==""){$slide.css("transition-duration",settings.speed+"ms")}if(settings.cssEasing!==""){$slide.css("transition-timing-function",settings.cssEasing)}}}else{if(plugin.doCss()){if(settings.speed!==""){$el.css("transition-duration",settings.speed+"ms")}if(settings.cssEasing!==""){$el.css("transition-timing-function",settings.cssEasing)}}}}if(!_touch){settings.onBeforeSlide.call(this,$el,scene)}if(settings.mode==="slide"){plugin.slide()}else{plugin.fade()}if(!$slide.hasClass("ls-hover")){plugin.auto()}setTimeout(function(){if(!_touch){settings.onAfterSlide.call(this,$el,scene)}},settings.speed);on=true};$el.play=function(){$el.goToNextSlide();settings.auto=true;plugin.auto()};$el.pause=function(){settings.auto=false;clearInterval(interval)};$el.refresh=function(){refresh.init()};$el.getCurrentSlideCount=function(){var sc=scene;if(settings.loop){var ln=$slide.find(".lslide").length,cl=$el.find(".clone.left").length;if(scene<=cl-1){sc=ln+(scene-cl)}else if(scene>=ln+cl){sc=scene-ln-cl}else{sc=scene-cl}}return sc+1};$el.getTotalSlideCount=function(){return $slide.find(".lslide").length};$el.goToSlide=function(s){if(settings.loop){scene=s+$el.find(".clone.left").length-1}else{scene=s}$el.mode(false);if(settings.gallery===true){plugin.slideThumb()}};$el.destroy=function(){if($el.lightSlider){$el.goToPrevSlide=function(){};$el.goToNextSlide=function(){};$el.mode=function(){};$el.play=function(){};$el.pause=function(){};$el.refresh=function(){};$el.getCurrentSlideCount=function(){};$el.getTotalSlideCount=function(){};$el.goToSlide=function(){};$el.lightSlider=null;refresh={init:function(){}};$el.parent().parent().find(".lSAction, .lSPager").remove();$el.removeClass("lightSlider lSFade lSSlide lsGrab lsGrabbing leftEnd right").removeAttr("style").unwrap().unwrap();$el.children().removeAttr("style");$children.removeClass("lslide active");$el.find(".clone").remove();$children=null;interval=null;on=false;scene=0}};setTimeout(function(){settings.onSliderLoad.call(this,$el)},10);$(window).on("resize orientationchange",function(e){setTimeout(function(){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}refresh.init()},200)});return this}})(jQuery);(function(root,factory){if(typeof define==="function"&&define.amd){define(factory)}else if(typeof exports==="object"){module.exports=factory()}else{root.PhotoSwipe=factory()}})(this,function(){"use strict";var PhotoSwipe=function(template,UiClass,items,options){var framework={features:null,bind:function(target,type,listener,unbind){var methodName=(unbind?"remove":"add")+"EventListener";type=type.split(" ");for(var i=0;i<type.length;i++){if(type[i]){target[methodName](type[i],listener,false)}}},isArray:function(obj){return obj instanceof Array},createEl:function(classes,tag){var el=document.createElement(tag||"div");if(classes){el.className=classes}return el},getScrollY:function(){var yOffset=window.pageYOffset;return yOffset!==undefined?yOffset:document.documentElement.scrollTop},unbind:function(target,type,listener){framework.bind(target,type,listener,true)},removeClass:function(el,className){var reg=new RegExp("(\\s|^)"+className+"(\\s|$)");el.className=el.className.replace(reg," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")},addClass:function(el,className){if(!framework.hasClass(el,className)){el.className+=(el.className?" ":"")+className}},hasClass:function(el,className){return el.className&&new RegExp("(^|\\s)"+className+"(\\s|$)").test(el.className)},getChildByClass:function(parentEl,childClassName){var node=parentEl.firstChild;while(node){if(framework.hasClass(node,childClassName)){return node}node=node.nextSibling}},arraySearch:function(array,value,key){var i=array.length;while(i--){if(array[i][key]===value){return i}}return-1},extend:function(o1,o2,preventOverwrite){for(var prop in o2){if(o2.hasOwnProperty(prop)){if(preventOverwrite&&o1.hasOwnProperty(prop)){continue}o1[prop]=o2[prop]}}},easing:{sine:{out:function(k){return Math.sin(k*(Math.PI/2))},inOut:function(k){return-(Math.cos(Math.PI*k)-1)/2}},cubic:{out:function(k){return--k*k*k+1}}},detectFeatures:function(){if(framework.features){return framework.features}var helperEl=framework.createEl(),helperStyle=helperEl.style,vendor="",features={};features.oldIE=document.all&&!document.addEventListener;features.touch="ontouchstart"in window;if(window.requestAnimationFrame){features.raf=window.requestAnimationFrame;features.caf=window.cancelAnimationFrame}features.pointerEvent=navigator.pointerEnabled||navigator.msPointerEnabled;if(!features.pointerEvent){var ua=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var v=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);if(v&&v.length>0){v=parseInt(v[1],10);if(v>=1&&v<8){features.isOldIOSPhone=true}}}var match=ua.match(/Android\s([0-9\.]*)/);var androidversion=match?match[1]:0;androidversion=parseFloat(androidversion);if(androidversion>=1){if(androidversion<4.4){features.isOldAndroid=true}features.androidVersion=androidversion}features.isMobileOpera=/opera mini|opera mobi/i.test(ua)}var styleChecks=["transform","perspective","animationName"],vendors=["","webkit","Moz","ms","O"],styleCheckItem,styleName;for(var i=0;i<4;i++){vendor=vendors[i];for(var a=0;a<3;a++){styleCheckItem=styleChecks[a];styleName=vendor+(vendor?styleCheckItem.charAt(0).toUpperCase()+styleCheckItem.slice(1):styleCheckItem);if(!features[styleCheckItem]&&styleName in helperStyle){features[styleCheckItem]=styleName}}if(vendor&&!features.raf){vendor=vendor.toLowerCase();features.raf=window[vendor+"RequestAnimationFrame"];if(features.raf){features.caf=window[vendor+"CancelAnimationFrame"]||window[vendor+"CancelRequestAnimationFrame"]}}}if(!features.raf){var lastTime=0;features.raf=function(fn){var currTime=(new Date).getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){fn(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id};features.caf=function(id){clearTimeout(id)}}features.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;framework.features=features;return features}};framework.detectFeatures();if(framework.features.oldIE){framework.bind=function(target,type,listener,unbind){type=type.split(" ");var methodName=(unbind?"detach":"attach")+"Event",evName,_handleEv=function(){listener.handleEvent.call(listener)};for(var i=0;i<type.length;i++){evName=type[i];if(evName){if(typeof listener==="object"&&listener.handleEvent){if(!unbind){listener["oldIE"+evName]=_handleEv}else{if(!listener["oldIE"+evName]){return false}}target[methodName]("on"+evName,listener["oldIE"+evName])}else{target[methodName]("on"+evName,listener)}}}}}var self=this;var DOUBLE_TAP_RADIUS=25,NUM_HOLDERS=3;var _options={allowPanToNext:true,spacing:.12,bgOpacity:1,mouseUsed:false,loop:true,pinchToClose:true,closeOnScroll:true,closeOnVerticalDrag:true,verticalDragRange:.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:false,focus:true,escKey:true,arrowKeys:true,mainScrollEndFriction:.35,panEndFriction:.35,isClickableElement:function(el){return el.tagName==="A"},getDoubleTapZoom:function(isMouseClick,item){if(isMouseClick){return 1}else{return item.initialZoomLevel<.7?1:1.33}},maxSpreadZoom:1.33,modal:true,scaleMode:"fit"};framework.extend(_options,options);var _getEmptyPoint=function(){return{x:0,y:0}};var _isOpen,_isDestroying,_closedByScroll,_currentItemIndex,_containerStyle,_containerShiftIndex,_currPanDist=_getEmptyPoint(),_startPanOffset=_getEmptyPoint(),_panOffset=_getEmptyPoint(),_upMoveEvents,_downEvents,_globalEventHandlers,_viewportSize={},_currZoomLevel,_startZoomLevel,_translatePrefix,_translateSufix,_updateSizeInterval,_itemsNeedUpdate,_currPositionIndex=0,_offset={},_slideSize=_getEmptyPoint(),_itemHolders,_prevItemIndex,_indexDiff=0,_dragStartEvent,_dragMoveEvent,_dragEndEvent,_dragCancelEvent,_transformKey,_pointerEventEnabled,_isFixedPosition=true,_likelyTouchDevice,_modules=[],_requestAF,_cancelAF,_initalClassName,_initalWindowScrollY,_oldIE,_currentWindowScrollY,_features,_windowVisibleSize={},_renderMaxResolution=false,_registerModule=function(name,module){framework.extend(self,module.publicMethods);
_modules.push(name)},_getLoopedId=function(index){var numSlides=_getNumItems();if(index>numSlides-1){return index-numSlides}else if(index<0){return numSlides+index}return index},_listeners={},_listen=function(name,fn){if(!_listeners[name]){_listeners[name]=[]}return _listeners[name].push(fn)},_shout=function(name){var listeners=_listeners[name];if(listeners){var args=Array.prototype.slice.call(arguments);args.shift();for(var i=0;i<listeners.length;i++){listeners[i].apply(self,args)}}},_getCurrentTime=function(){return(new Date).getTime()},_applyBgOpacity=function(opacity){_bgOpacity=opacity;self.bg.style.opacity=opacity*_options.bgOpacity},_applyZoomTransform=function(styleObj,x,y,zoom,item){if(!_renderMaxResolution||item&&item!==self.currItem){zoom=zoom/(item?item.fitRatio:self.currItem.fitRatio)}styleObj[_transformKey]=_translatePrefix+x+"px, "+y+"px"+_translateSufix+" scale("+zoom+")"},_applyCurrentZoomPan=function(allowRenderResolution){if(_currZoomElementStyle){if(allowRenderResolution){if(_currZoomLevel>self.currItem.fitRatio){if(!_renderMaxResolution){_setImageSize(self.currItem,false,true);_renderMaxResolution=true}}else{if(_renderMaxResolution){_setImageSize(self.currItem);_renderMaxResolution=false}}}_applyZoomTransform(_currZoomElementStyle,_panOffset.x,_panOffset.y,_currZoomLevel)}},_applyZoomPanToItem=function(item){if(item.container){_applyZoomTransform(item.container.style,item.initialPosition.x,item.initialPosition.y,item.initialZoomLevel,item)}},_setTranslateX=function(x,elStyle){elStyle[_transformKey]=_translatePrefix+x+"px, 0px"+_translateSufix},_moveMainScroll=function(x,dragging){if(!_options.loop&&dragging){var newSlideIndexOffset=_currentItemIndex+(_slideSize.x*_currPositionIndex-x)/_slideSize.x,delta=Math.round(x-_mainScrollPos.x);if(newSlideIndexOffset<0&&delta>0||newSlideIndexOffset>=_getNumItems()-1&&delta<0){x=_mainScrollPos.x+delta*_options.mainScrollEndFriction}}_mainScrollPos.x=x;_setTranslateX(x,_containerStyle)},_calculatePanOffset=function(axis,zoomLevel){var m=_midZoomPoint[axis]-_offset[axis];return _startPanOffset[axis]+_currPanDist[axis]+m-m*(zoomLevel/_startZoomLevel)},_equalizePoints=function(p1,p2){p1.x=p2.x;p1.y=p2.y;if(p2.id){p1.id=p2.id}},_roundPoint=function(p){p.x=Math.round(p.x);p.y=Math.round(p.y)},_mouseMoveTimeout=null,_onFirstMouseMove=function(){if(_mouseMoveTimeout){framework.unbind(document,"mousemove",_onFirstMouseMove);framework.addClass(template,"pswp--has_mouse");_options.mouseUsed=true;_shout("mouseUsed")}_mouseMoveTimeout=setTimeout(function(){_mouseMoveTimeout=null},100)},_bindEvents=function(){framework.bind(document,"keydown",self);if(_features.transform){framework.bind(self.scrollWrap,"click",self)}if(!_options.mouseUsed){framework.bind(document,"mousemove",_onFirstMouseMove)}framework.bind(window,"resize scroll",self);_shout("bindEvents")},_unbindEvents=function(){framework.unbind(window,"resize",self);framework.unbind(window,"scroll",_globalEventHandlers.scroll);framework.unbind(document,"keydown",self);framework.unbind(document,"mousemove",_onFirstMouseMove);if(_features.transform){framework.unbind(self.scrollWrap,"click",self)}if(_isDragging){framework.unbind(window,_upMoveEvents,self)}_shout("unbindEvents")},_calculatePanBounds=function(zoomLevel,update){var bounds=_calculateItemSize(self.currItem,_viewportSize,zoomLevel);if(update){_currPanBounds=bounds}return bounds},_getMinZoomLevel=function(item){if(!item){item=self.currItem}return item.initialZoomLevel},_getMaxZoomLevel=function(item){if(!item){item=self.currItem}return item.w>0?_options.maxSpreadZoom:1},_modifyDestPanOffset=function(axis,destPanBounds,destPanOffset,destZoomLevel){if(destZoomLevel===self.currItem.initialZoomLevel){destPanOffset[axis]=self.currItem.initialPosition[axis];return true}else{destPanOffset[axis]=_calculatePanOffset(axis,destZoomLevel);if(destPanOffset[axis]>destPanBounds.min[axis]){destPanOffset[axis]=destPanBounds.min[axis];return true}else if(destPanOffset[axis]<destPanBounds.max[axis]){destPanOffset[axis]=destPanBounds.max[axis];return true}}return false},_setupTransforms=function(){if(_transformKey){var allow3dTransform=_features.perspective&&!_likelyTouchDevice;_translatePrefix="translate"+(allow3dTransform?"3d(":"(");_translateSufix=_features.perspective?", 0px)":")";return}_transformKey="left";framework.addClass(template,"pswp--ie");_setTranslateX=function(x,elStyle){elStyle.left=x+"px"};_applyZoomPanToItem=function(item){var zoomRatio=item.fitRatio>1?1:item.fitRatio,s=item.container.style,w=zoomRatio*item.w,h=zoomRatio*item.h;s.width=w+"px";s.height=h+"px";s.left=item.initialPosition.x+"px";s.top=item.initialPosition.y+"px"};_applyCurrentZoomPan=function(){if(_currZoomElementStyle){var s=_currZoomElementStyle,item=self.currItem,zoomRatio=item.fitRatio>1?1:item.fitRatio,w=zoomRatio*item.w,h=zoomRatio*item.h;s.width=w+"px";s.height=h+"px";s.left=_panOffset.x+"px";s.top=_panOffset.y+"px"}}},_onKeyDown=function(e){var keydownAction="";if(_options.escKey&&e.keyCode===27){keydownAction="close"}else if(_options.arrowKeys){if(e.keyCode===37){keydownAction="prev"}else if(e.keyCode===39){keydownAction="next"}}if(keydownAction){if(!e.ctrlKey&&!e.altKey&&!e.shiftKey&&!e.metaKey){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}self[keydownAction]()}}},_onGlobalClick=function(e){if(!e){return}if(_moved||_zoomStarted||_mainScrollAnimating||_verticalDragInitiated){e.preventDefault();e.stopPropagation()}},_updatePageScrollOffset=function(){self.setScrollOffset(0,framework.getScrollY())};var _animations={},_numAnimations=0,_stopAnimation=function(name){if(_animations[name]){if(_animations[name].raf){_cancelAF(_animations[name].raf)}_numAnimations--;delete _animations[name]}},_registerStartAnimation=function(name){if(_animations[name]){_stopAnimation(name)}if(!_animations[name]){_numAnimations++;_animations[name]={}}},_stopAllAnimations=function(){for(var prop in _animations){if(_animations.hasOwnProperty(prop)){_stopAnimation(prop)}}},_animateProp=function(name,b,endProp,d,easingFn,onUpdate,onComplete){var startAnimTime=_getCurrentTime(),t;_registerStartAnimation(name);var animloop=function(){if(_animations[name]){t=_getCurrentTime()-startAnimTime;if(t>=d){_stopAnimation(name);onUpdate(endProp);if(onComplete){onComplete()}return}onUpdate((endProp-b)*easingFn(t/d)+b);_animations[name].raf=_requestAF(animloop)}};animloop()};var publicMethods={shout:_shout,listen:_listen,viewportSize:_viewportSize,options:_options,isMainScrollAnimating:function(){return _mainScrollAnimating},getZoomLevel:function(){return _currZoomLevel},getCurrentIndex:function(){return _currentItemIndex},isDragging:function(){return _isDragging},isZooming:function(){return _isZooming},setScrollOffset:function(x,y){_offset.x=x;_currentWindowScrollY=_offset.y=y;_shout("updateScrollOffset",_offset)},applyZoomPan:function(zoomLevel,panX,panY,allowRenderResolution){_panOffset.x=panX;_panOffset.y=panY;_currZoomLevel=zoomLevel;_applyCurrentZoomPan(allowRenderResolution)},init:function(){if(_isOpen||_isDestroying){return}var i;self.framework=framework;self.template=template;self.bg=framework.getChildByClass(template,"pswp__bg");_initalClassName=template.className;_isOpen=true;_features=framework.detectFeatures();_requestAF=_features.raf;_cancelAF=_features.caf;_transformKey=_features.transform;_oldIE=_features.oldIE;self.scrollWrap=framework.getChildByClass(template,"pswp__scroll-wrap");self.container=framework.getChildByClass(self.scrollWrap,"pswp__container");_containerStyle=self.container.style;self.itemHolders=_itemHolders=[{el:self.container.children[0],wrap:0,index:-1},{el:self.container.children[1],wrap:0,index:-1},{el:self.container.children[2],wrap:0,index:-1}];_itemHolders[0].el.style.display=_itemHolders[2].el.style.display="none";_setupTransforms();_globalEventHandlers={resize:self.updateSize,scroll:_updatePageScrollOffset,keydown:_onKeyDown,click:_onGlobalClick};var oldPhone=_features.isOldIOSPhone||_features.isOldAndroid||_features.isMobileOpera;if(!_features.animationName||!_features.transform||oldPhone){_options.showAnimationDuration=_options.hideAnimationDuration=0}for(i=0;i<_modules.length;i++){self["init"+_modules[i]]()}if(UiClass){var ui=self.ui=new UiClass(self,framework);ui.init()}_shout("firstUpdate");_currentItemIndex=_currentItemIndex||_options.index||0;if(isNaN(_currentItemIndex)||_currentItemIndex<0||_currentItemIndex>=_getNumItems()){_currentItemIndex=0}self.currItem=_getItemAt(_currentItemIndex);if(_features.isOldIOSPhone||_features.isOldAndroid){_isFixedPosition=false}template.setAttribute("aria-hidden","false");if(_options.modal){if(!_isFixedPosition){template.style.position="absolute";template.style.top=framework.getScrollY()+"px"}else{template.style.position="fixed"}}if(_currentWindowScrollY===undefined){_shout("initialLayout");_currentWindowScrollY=_initalWindowScrollY=framework.getScrollY()}var rootClasses="pswp--open ";if(_options.mainClass){rootClasses+=_options.mainClass+" "}if(_options.showHideOpacity){rootClasses+="pswp--animate_opacity "}rootClasses+=_likelyTouchDevice?"pswp--touch":"pswp--notouch";rootClasses+=_features.animationName?" pswp--css_animation":"";rootClasses+=_features.svg?" pswp--svg":"";framework.addClass(template,rootClasses);self.updateSize();_containerShiftIndex=-1;_indexDiff=null;for(i=0;i<NUM_HOLDERS;i++){_setTranslateX((i+_containerShiftIndex)*_slideSize.x,_itemHolders[i].el.style)}if(!_oldIE){framework.bind(self.scrollWrap,_downEvents,self)}_listen("initialZoomInEnd",function(){self.setContent(_itemHolders[0],_currentItemIndex-1);self.setContent(_itemHolders[2],_currentItemIndex+1);_itemHolders[0].el.style.display=_itemHolders[2].el.style.display="block";if(_options.focus){template.focus()}_bindEvents()});self.setContent(_itemHolders[1],_currentItemIndex);self.updateCurrItem();_shout("afterInit");if(!_isFixedPosition){_updateSizeInterval=setInterval(function(){if(!_numAnimations&&!_isDragging&&!_isZooming&&_currZoomLevel===self.currItem.initialZoomLevel){self.updateSize()}},1e3)}framework.addClass(template,"pswp--visible")},close:function(){if(!_isOpen){return}_isOpen=false;_isDestroying=true;_shout("close");_unbindEvents();_showOrHide(self.currItem,null,true,self.destroy)},destroy:function(){_shout("destroy");if(_showOrHideTimeout){clearTimeout(_showOrHideTimeout)}template.setAttribute("aria-hidden","true");template.className=_initalClassName;if(_updateSizeInterval){clearInterval(_updateSizeInterval)}framework.unbind(self.scrollWrap,_downEvents,self);framework.unbind(window,"scroll",self);_stopDragUpdateLoop();_stopAllAnimations();_listeners=null},panTo:function(x,y,force){if(!force){if(x>_currPanBounds.min.x){x=_currPanBounds.min.x}else if(x<_currPanBounds.max.x){x=_currPanBounds.max.x}if(y>_currPanBounds.min.y){y=_currPanBounds.min.y}else if(y<_currPanBounds.max.y){y=_currPanBounds.max.y}}_panOffset.x=x;_panOffset.y=y;_applyCurrentZoomPan()},handleEvent:function(e){e=e||window.event;if(_globalEventHandlers[e.type]){_globalEventHandlers[e.type](e)}},goTo:function(index){index=_getLoopedId(index);var diff=index-_currentItemIndex;_indexDiff=diff;_currentItemIndex=index;self.currItem=_getItemAt(_currentItemIndex);_currPositionIndex-=diff;_moveMainScroll(_slideSize.x*_currPositionIndex);_stopAllAnimations();_mainScrollAnimating=false;self.updateCurrItem()},next:function(){self.goTo(_currentItemIndex+1)},prev:function(){self.goTo(_currentItemIndex-1)},updateCurrZoomItem:function(emulateSetContent){if(emulateSetContent){_shout("beforeChange",0)}if(_itemHolders[1].el.children.length){var zoomElement=_itemHolders[1].el.children[0];if(framework.hasClass(zoomElement,"pswp__zoom-wrap")){_currZoomElementStyle=zoomElement.style}else{_currZoomElementStyle=null}}else{_currZoomElementStyle=null}_currPanBounds=self.currItem.bounds;_startZoomLevel=_currZoomLevel=self.currItem.initialZoomLevel;_panOffset.x=_currPanBounds.center.x;_panOffset.y=_currPanBounds.center.y;if(emulateSetContent){_shout("afterChange")}},invalidateCurrItems:function(){_itemsNeedUpdate=true;for(var i=0;i<NUM_HOLDERS;i++){if(_itemHolders[i].item){_itemHolders[i].item.needsUpdate=true}}},updateCurrItem:function(beforeAnimation){if(_indexDiff===0){return}var diffAbs=Math.abs(_indexDiff),tempHolder;if(beforeAnimation&&diffAbs<2){return}self.currItem=_getItemAt(_currentItemIndex);_renderMaxResolution=false;_shout("beforeChange",_indexDiff);if(diffAbs>=NUM_HOLDERS){_containerShiftIndex+=_indexDiff+(_indexDiff>0?-NUM_HOLDERS:NUM_HOLDERS);diffAbs=NUM_HOLDERS}for(var i=0;i<diffAbs;i++){if(_indexDiff>0){tempHolder=_itemHolders.shift();_itemHolders[NUM_HOLDERS-1]=tempHolder;_containerShiftIndex++;_setTranslateX((_containerShiftIndex+2)*_slideSize.x,tempHolder.el.style);self.setContent(tempHolder,_currentItemIndex-diffAbs+i+1+1)}else{tempHolder=_itemHolders.pop();_itemHolders.unshift(tempHolder);_containerShiftIndex--;_setTranslateX(_containerShiftIndex*_slideSize.x,tempHolder.el.style);self.setContent(tempHolder,_currentItemIndex+diffAbs-i-1-1)}}if(_currZoomElementStyle&&Math.abs(_indexDiff)===1){var prevItem=_getItemAt(_prevItemIndex);if(prevItem.initialZoomLevel!==_currZoomLevel){_calculateItemSize(prevItem,_viewportSize);_setImageSize(prevItem);_applyZoomPanToItem(prevItem)}}_indexDiff=0;self.updateCurrZoomItem();_prevItemIndex=_currentItemIndex;_shout("afterChange")},updateSize:function(force){if(!_isFixedPosition&&_options.modal){var windowScrollY=framework.getScrollY();if(_currentWindowScrollY!==windowScrollY){template.style.top=windowScrollY+"px";_currentWindowScrollY=windowScrollY}if(!force&&_windowVisibleSize.x===window.innerWidth&&_windowVisibleSize.y===window.innerHeight){return}_windowVisibleSize.x=window.innerWidth;_windowVisibleSize.y=window.innerHeight;template.style.height=_windowVisibleSize.y+"px"}_viewportSize.x=self.scrollWrap.clientWidth;_viewportSize.y=self.scrollWrap.clientHeight;_updatePageScrollOffset();_slideSize.x=_viewportSize.x+Math.round(_viewportSize.x*_options.spacing);_slideSize.y=_viewportSize.y;_moveMainScroll(_slideSize.x*_currPositionIndex);_shout("beforeResize");if(_containerShiftIndex!==undefined){var holder,item,hIndex;for(var i=0;i<NUM_HOLDERS;i++){holder=_itemHolders[i];_setTranslateX((i+_containerShiftIndex)*_slideSize.x,holder.el.style);hIndex=_currentItemIndex+i-1;if(_options.loop&&_getNumItems()>2){hIndex=_getLoopedId(hIndex)}item=_getItemAt(hIndex);if(item&&(_itemsNeedUpdate||item.needsUpdate||!item.bounds)){self.cleanSlide(item);self.setContent(holder,hIndex);if(i===1){self.currItem=item;self.updateCurrZoomItem(true)}item.needsUpdate=false}else if(holder.index===-1&&hIndex>=0){self.setContent(holder,hIndex)}if(item&&item.container){_calculateItemSize(item,_viewportSize);_setImageSize(item);_applyZoomPanToItem(item)}}_itemsNeedUpdate=false}_startZoomLevel=_currZoomLevel=self.currItem.initialZoomLevel;_currPanBounds=self.currItem.bounds;if(_currPanBounds){_panOffset.x=_currPanBounds.center.x;_panOffset.y=_currPanBounds.center.y;_applyCurrentZoomPan(true)}_shout("resize")},zoomTo:function(destZoomLevel,centerPoint,speed,easingFn,updateFn){if(centerPoint){_startZoomLevel=_currZoomLevel;_midZoomPoint.x=Math.abs(centerPoint.x)-_panOffset.x;_midZoomPoint.y=Math.abs(centerPoint.y)-_panOffset.y;_equalizePoints(_startPanOffset,_panOffset)}var destPanBounds=_calculatePanBounds(destZoomLevel,false),destPanOffset={};_modifyDestPanOffset("x",destPanBounds,destPanOffset,destZoomLevel);_modifyDestPanOffset("y",destPanBounds,destPanOffset,destZoomLevel);var initialZoomLevel=_currZoomLevel;var initialPanOffset={x:_panOffset.x,y:_panOffset.y};_roundPoint(destPanOffset);var onUpdate=function(now){if(now===1){_currZoomLevel=destZoomLevel;_panOffset.x=destPanOffset.x;_panOffset.y=destPanOffset.y}else{_currZoomLevel=(destZoomLevel-initialZoomLevel)*now+initialZoomLevel;_panOffset.x=(destPanOffset.x-initialPanOffset.x)*now+initialPanOffset.x;_panOffset.y=(destPanOffset.y-initialPanOffset.y)*now+initialPanOffset.y}if(updateFn){updateFn(now)}_applyCurrentZoomPan(now===1)};if(speed){_animateProp("customZoomTo",0,1,speed,easingFn||framework.easing.sine.inOut,onUpdate)}else{onUpdate(1)}}};var MIN_SWIPE_DISTANCE=30,DIRECTION_CHECK_OFFSET=10;var _gestureStartTime,_gestureCheckSpeedTime,p={},p2={},delta={},_currPoint={},_startPoint={},_currPointers=[],_startMainScrollPos={},_releaseAnimData,_posPoints=[],_tempPoint={},_isZoomingIn,_verticalDragInitiated,_oldAndroidTouchEndTimeout,_currZoomedItemIndex=0,_centerPoint=_getEmptyPoint(),_lastReleaseTime=0,_isDragging,_isMultitouch,_zoomStarted,_moved,_dragAnimFrame,_mainScrollShifted,_currentPoints,_isZooming,_currPointsDistance,_startPointsDistance,_currPanBounds,_mainScrollPos=_getEmptyPoint(),_currZoomElementStyle,_mainScrollAnimating,_midZoomPoint=_getEmptyPoint(),_currCenterPoint=_getEmptyPoint(),_direction,_isFirstMove,_opacityChanged,_bgOpacity,_wasOverInitialZoom,_isEqualPoints=function(p1,p2){return p1.x===p2.x&&p1.y===p2.y},_isNearbyPoints=function(touch0,touch1){return Math.abs(touch0.x-touch1.x)<DOUBLE_TAP_RADIUS&&Math.abs(touch0.y-touch1.y)<DOUBLE_TAP_RADIUS},_calculatePointsDistance=function(p1,p2){_tempPoint.x=Math.abs(p1.x-p2.x);_tempPoint.y=Math.abs(p1.y-p2.y);return Math.sqrt(_tempPoint.x*_tempPoint.x+_tempPoint.y*_tempPoint.y)},_stopDragUpdateLoop=function(){if(_dragAnimFrame){_cancelAF(_dragAnimFrame);_dragAnimFrame=null}},_dragUpdateLoop=function(){if(_isDragging){_dragAnimFrame=_requestAF(_dragUpdateLoop);_renderMovement()}},_canPan=function(){return!(_options.scaleMode==="fit"&&_currZoomLevel===self.currItem.initialZoomLevel)},_closestElement=function(el,fn){if(!el||el===document){return false}if(el.getAttribute("class")&&el.getAttribute("class").indexOf("pswp__scroll-wrap")>-1){return false}if(fn(el)){return el}return _closestElement(el.parentNode,fn)},_preventObj={},_preventDefaultEventBehaviour=function(e,isDown){_preventObj.prevent=!_closestElement(e.target,_options.isClickableElement);_shout("preventDragEvent",e,isDown,_preventObj);return _preventObj.prevent},_convertTouchToPoint=function(touch,p){p.x=touch.pageX;p.y=touch.pageY;p.id=touch.identifier;return p},_findCenterOfPoints=function(p1,p2,pCenter){pCenter.x=(p1.x+p2.x)*.5;pCenter.y=(p1.y+p2.y)*.5},_pushPosPoint=function(time,x,y){if(time-_gestureCheckSpeedTime>50){var o=_posPoints.length>2?_posPoints.shift():{};o.x=x;o.y=y;_posPoints.push(o);_gestureCheckSpeedTime=time}},_calculateVerticalDragOpacityRatio=function(){var yOffset=_panOffset.y-self.currItem.initialPosition.y;return 1-Math.abs(yOffset/(_viewportSize.y/2))},_ePoint1={},_ePoint2={},_tempPointsArr=[],_tempCounter,_getTouchPoints=function(e){while(_tempPointsArr.length>0){_tempPointsArr.pop()}if(!_pointerEventEnabled){if(e.type.indexOf("touch")>-1){if(e.touches&&e.touches.length>0){_tempPointsArr[0]=_convertTouchToPoint(e.touches[0],_ePoint1);if(e.touches.length>1){_tempPointsArr[1]=_convertTouchToPoint(e.touches[1],_ePoint2)}}}else{_ePoint1.x=e.pageX;_ePoint1.y=e.pageY;_ePoint1.id="";_tempPointsArr[0]=_ePoint1}}else{_tempCounter=0;_currPointers.forEach(function(p){if(_tempCounter===0){_tempPointsArr[0]=p}else if(_tempCounter===1){_tempPointsArr[1]=p}_tempCounter++})}return _tempPointsArr},_panOrMoveMainScroll=function(axis,delta){var panFriction,overDiff=0,newOffset=_panOffset[axis]+delta[axis],startOverDiff,dir=delta[axis]>0,newMainScrollPosition=_mainScrollPos.x+delta.x,mainScrollDiff=_mainScrollPos.x-_startMainScrollPos.x,newPanPos,newMainScrollPos;if(newOffset>_currPanBounds.min[axis]||newOffset<_currPanBounds.max[axis]){panFriction=_options.panEndFriction}else{panFriction=1}newOffset=_panOffset[axis]+delta[axis]*panFriction;if(_options.allowPanToNext||_currZoomLevel===self.currItem.initialZoomLevel){if(!_currZoomElementStyle){newMainScrollPos=newMainScrollPosition}else if(_direction==="h"&&axis==="x"&&!_zoomStarted){if(dir){if(newOffset>_currPanBounds.min[axis]){panFriction=_options.panEndFriction;overDiff=_currPanBounds.min[axis]-newOffset;startOverDiff=_currPanBounds.min[axis]-_startPanOffset[axis]}if((startOverDiff<=0||mainScrollDiff<0)&&_getNumItems()>1){newMainScrollPos=newMainScrollPosition;if(mainScrollDiff<0&&newMainScrollPosition>_startMainScrollPos.x){newMainScrollPos=_startMainScrollPos.x}}else{if(_currPanBounds.min.x!==_currPanBounds.max.x){newPanPos=newOffset}}}else{if(newOffset<_currPanBounds.max[axis]){panFriction=_options.panEndFriction;overDiff=newOffset-_currPanBounds.max[axis];startOverDiff=_startPanOffset[axis]-_currPanBounds.max[axis]}if((startOverDiff<=0||mainScrollDiff>0)&&_getNumItems()>1){newMainScrollPos=newMainScrollPosition;if(mainScrollDiff>0&&newMainScrollPosition<_startMainScrollPos.x){newMainScrollPos=_startMainScrollPos.x}}else{if(_currPanBounds.min.x!==_currPanBounds.max.x){newPanPos=newOffset}}}}if(axis==="x"){if(newMainScrollPos!==undefined){_moveMainScroll(newMainScrollPos,true);if(newMainScrollPos===_startMainScrollPos.x){_mainScrollShifted=false}else{_mainScrollShifted=true}}if(_currPanBounds.min.x!==_currPanBounds.max.x){if(newPanPos!==undefined){_panOffset.x=newPanPos}else if(!_mainScrollShifted){_panOffset.x+=delta.x*panFriction}}return newMainScrollPos!==undefined}}if(!_mainScrollAnimating){if(!_mainScrollShifted){if(_currZoomLevel>self.currItem.fitRatio){_panOffset[axis]+=delta[axis]*panFriction}}}},_onDragStart=function(e){if(e.type==="mousedown"&&e.button>0){return}if(_initialZoomRunning){e.preventDefault();return}if(_oldAndroidTouchEndTimeout&&e.type==="mousedown"){return}if(_preventDefaultEventBehaviour(e,true)){e.preventDefault()}_shout("pointerDown");if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,"id");if(pointerIndex<0){pointerIndex=_currPointers.length}_currPointers[pointerIndex]={x:e.pageX,y:e.pageY,id:e.pointerId}}var startPointsList=_getTouchPoints(e),numPoints=startPointsList.length;_currentPoints=null;_stopAllAnimations();if(!_isDragging||numPoints===1){_isDragging=_isFirstMove=true;framework.bind(window,_upMoveEvents,self);_isZoomingIn=_wasOverInitialZoom=_opacityChanged=_verticalDragInitiated=_mainScrollShifted=_moved=_isMultitouch=_zoomStarted=false;_direction=null;_shout("firstTouchStart",startPointsList);_equalizePoints(_startPanOffset,_panOffset);_currPanDist.x=_currPanDist.y=0;_equalizePoints(_currPoint,startPointsList[0]);_equalizePoints(_startPoint,_currPoint);_startMainScrollPos.x=_slideSize.x*_currPositionIndex;_posPoints=[{x:_currPoint.x,y:_currPoint.y}];_gestureCheckSpeedTime=_gestureStartTime=_getCurrentTime();_calculatePanBounds(_currZoomLevel,true);_stopDragUpdateLoop();_dragUpdateLoop()}if(!_isZooming&&numPoints>1&&!_mainScrollAnimating&&!_mainScrollShifted){_startZoomLevel=_currZoomLevel;_zoomStarted=false;_isZooming=_isMultitouch=true;_currPanDist.y=_currPanDist.x=0;_equalizePoints(_startPanOffset,_panOffset);_equalizePoints(p,startPointsList[0]);_equalizePoints(p2,startPointsList[1]);_findCenterOfPoints(p,p2,_currCenterPoint);_midZoomPoint.x=Math.abs(_currCenterPoint.x)-_panOffset.x;_midZoomPoint.y=Math.abs(_currCenterPoint.y)-_panOffset.y;_currPointsDistance=_startPointsDistance=_calculatePointsDistance(p,p2)}},_onDragMove=function(e){e.preventDefault();if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,"id");if(pointerIndex>-1){var p=_currPointers[pointerIndex];p.x=e.pageX;p.y=e.pageY}}if(_isDragging){var touchesList=_getTouchPoints(e);if(!_direction&&!_moved&&!_isZooming){if(_mainScrollPos.x!==_slideSize.x*_currPositionIndex){_direction="h"}else{var diff=Math.abs(touchesList[0].x-_currPoint.x)-Math.abs(touchesList[0].y-_currPoint.y);if(Math.abs(diff)>=DIRECTION_CHECK_OFFSET){_direction=diff>0?"h":"v";_currentPoints=touchesList}}}else{_currentPoints=touchesList}}},_renderMovement=function(){if(!_currentPoints){return}var numPoints=_currentPoints.length;if(numPoints===0){return}_equalizePoints(p,_currentPoints[0]);delta.x=p.x-_currPoint.x;delta.y=p.y-_currPoint.y;if(_isZooming&&numPoints>1){_currPoint.x=p.x;_currPoint.y=p.y;if(!delta.x&&!delta.y&&_isEqualPoints(_currentPoints[1],p2)){return}_equalizePoints(p2,_currentPoints[1]);if(!_zoomStarted){_zoomStarted=true;_shout("zoomGestureStarted")}var pointsDistance=_calculatePointsDistance(p,p2);var zoomLevel=_calculateZoomLevel(pointsDistance);if(zoomLevel>self.currItem.initialZoomLevel+self.currItem.initialZoomLevel/15){_wasOverInitialZoom=true}var zoomFriction=1,minZoomLevel=_getMinZoomLevel(),maxZoomLevel=_getMaxZoomLevel();if(zoomLevel<minZoomLevel){if(_options.pinchToClose&&!_wasOverInitialZoom&&_startZoomLevel<=self.currItem.initialZoomLevel){var minusDiff=minZoomLevel-zoomLevel;var percent=1-minusDiff/(minZoomLevel/1.2);_applyBgOpacity(percent);_shout("onPinchClose",percent);_opacityChanged=true}else{zoomFriction=(minZoomLevel-zoomLevel)/minZoomLevel;if(zoomFriction>1){zoomFriction=1}zoomLevel=minZoomLevel-zoomFriction*(minZoomLevel/3)}}else if(zoomLevel>maxZoomLevel){zoomFriction=(zoomLevel-maxZoomLevel)/(minZoomLevel*6);if(zoomFriction>1){zoomFriction=1}zoomLevel=maxZoomLevel+zoomFriction*minZoomLevel}if(zoomFriction<0){zoomFriction=0}_currPointsDistance=pointsDistance;_findCenterOfPoints(p,p2,_centerPoint);_currPanDist.x+=_centerPoint.x-_currCenterPoint.x;_currPanDist.y+=_centerPoint.y-_currCenterPoint.y;_equalizePoints(_currCenterPoint,_centerPoint);_panOffset.x=_calculatePanOffset("x",zoomLevel);_panOffset.y=_calculatePanOffset("y",zoomLevel);_isZoomingIn=zoomLevel>_currZoomLevel;_currZoomLevel=zoomLevel;_applyCurrentZoomPan()}else{if(!_direction){return}if(_isFirstMove){_isFirstMove=false;if(Math.abs(delta.x)>=DIRECTION_CHECK_OFFSET){delta.x-=_currentPoints[0].x-_startPoint.x}if(Math.abs(delta.y)>=DIRECTION_CHECK_OFFSET){delta.y-=_currentPoints[0].y-_startPoint.y}}_currPoint.x=p.x;_currPoint.y=p.y;if(delta.x===0&&delta.y===0){return}if(_direction==="v"&&_options.closeOnVerticalDrag){if(!_canPan()){_currPanDist.y+=delta.y;_panOffset.y+=delta.y;var opacityRatio=_calculateVerticalDragOpacityRatio();_verticalDragInitiated=true;_shout("onVerticalDrag",opacityRatio);_applyBgOpacity(opacityRatio);_applyCurrentZoomPan();return}}_pushPosPoint(_getCurrentTime(),p.x,p.y);_moved=true;_currPanBounds=self.currItem.bounds;var mainScrollChanged=_panOrMoveMainScroll("x",delta);if(!mainScrollChanged){_panOrMoveMainScroll("y",delta);_roundPoint(_panOffset);_applyCurrentZoomPan()}}},_onDragRelease=function(e){if(_features.isOldAndroid){if(_oldAndroidTouchEndTimeout&&e.type==="mouseup"){return}if(e.type.indexOf("touch")>-1){clearTimeout(_oldAndroidTouchEndTimeout);_oldAndroidTouchEndTimeout=setTimeout(function(){_oldAndroidTouchEndTimeout=0},600)}}_shout("pointerUp");if(_preventDefaultEventBehaviour(e,false)){e.preventDefault()}var releasePoint;if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,"id");if(pointerIndex>-1){releasePoint=_currPointers.splice(pointerIndex,1)[0];if(navigator.pointerEnabled){releasePoint.type=e.pointerType||"mouse"}else{var MSPOINTER_TYPES={4:"mouse",2:"touch",3:"pen"};releasePoint.type=MSPOINTER_TYPES[e.pointerType];if(!releasePoint.type){releasePoint.type=e.pointerType||"mouse"}}}}var touchList=_getTouchPoints(e),gestureType,numPoints=touchList.length;if(e.type==="mouseup"){numPoints=0}if(numPoints===2){_currentPoints=null;return true}if(numPoints===1){_equalizePoints(_startPoint,touchList[0])}if(numPoints===0&&!_direction&&!_mainScrollAnimating){if(!releasePoint){if(e.type==="mouseup"){releasePoint={x:e.pageX,y:e.pageY,type:"mouse"}}else if(e.changedTouches&&e.changedTouches[0]){releasePoint={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY,type:"touch"}}}_shout("touchRelease",e,releasePoint)}var releaseTimeDiff=-1;if(numPoints===0){_isDragging=false;framework.unbind(window,_upMoveEvents,self);_stopDragUpdateLoop();if(_isZooming){releaseTimeDiff=0}else if(_lastReleaseTime!==-1){releaseTimeDiff=_getCurrentTime()-_lastReleaseTime}}_lastReleaseTime=numPoints===1?_getCurrentTime():-1;if(releaseTimeDiff!==-1&&releaseTimeDiff<150){gestureType="zoom"}else{gestureType="swipe"}if(_isZooming&&numPoints<2){_isZooming=false;if(numPoints===1){gestureType="zoomPointerUp"}_shout("zoomGestureEnded")}_currentPoints=null;if(!_moved&&!_zoomStarted&&!_mainScrollAnimating&&!_verticalDragInitiated){return}_stopAllAnimations();if(!_releaseAnimData){_releaseAnimData=_initDragReleaseAnimationData()}_releaseAnimData.calculateSwipeSpeed("x");if(_verticalDragInitiated){var opacityRatio=_calculateVerticalDragOpacityRatio();if(opacityRatio<_options.verticalDragRange){self.close()}else{var initalPanY=_panOffset.y,initialBgOpacity=_bgOpacity;_animateProp("verticalDrag",0,1,300,framework.easing.cubic.out,function(now){_panOffset.y=(self.currItem.initialPosition.y-initalPanY)*now+initalPanY;_applyBgOpacity((1-initialBgOpacity)*now+initialBgOpacity);_applyCurrentZoomPan()});_shout("onVerticalDrag",1)}return}if((_mainScrollShifted||_mainScrollAnimating)&&numPoints===0){var itemChanged=_finishSwipeMainScrollGesture(gestureType,_releaseAnimData);if(itemChanged){return}gestureType="zoomPointerUp"}if(_mainScrollAnimating){return}if(gestureType!=="swipe"){_completeZoomGesture();return}if(!_mainScrollShifted&&_currZoomLevel>self.currItem.fitRatio){_completePanGesture(_releaseAnimData)}},_initDragReleaseAnimationData=function(){var lastFlickDuration,tempReleasePos;var s={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(axis){if(_posPoints.length>1){lastFlickDuration=_getCurrentTime()-_gestureCheckSpeedTime+50;tempReleasePos=_posPoints[_posPoints.length-2][axis]}else{lastFlickDuration=_getCurrentTime()-_gestureStartTime;tempReleasePos=_startPoint[axis]}s.lastFlickOffset[axis]=_currPoint[axis]-tempReleasePos;s.lastFlickDist[axis]=Math.abs(s.lastFlickOffset[axis]);if(s.lastFlickDist[axis]>20){s.lastFlickSpeed[axis]=s.lastFlickOffset[axis]/lastFlickDuration}else{s.lastFlickSpeed[axis]=0}if(Math.abs(s.lastFlickSpeed[axis])<.1){s.lastFlickSpeed[axis]=0}s.slowDownRatio[axis]=.95;s.slowDownRatioReverse[axis]=1-s.slowDownRatio[axis];s.speedDecelerationRatio[axis]=1},calculateOverBoundsAnimOffset:function(axis,speed){if(!s.backAnimStarted[axis]){if(_panOffset[axis]>_currPanBounds.min[axis]){s.backAnimDestination[axis]=_currPanBounds.min[axis]}else if(_panOffset[axis]<_currPanBounds.max[axis]){s.backAnimDestination[axis]=_currPanBounds.max[axis]}if(s.backAnimDestination[axis]!==undefined){s.slowDownRatio[axis]=.7;s.slowDownRatioReverse[axis]=1-s.slowDownRatio[axis];if(s.speedDecelerationRatioAbs[axis]<.05){s.lastFlickSpeed[axis]=0;s.backAnimStarted[axis]=true;_animateProp("bounceZoomPan"+axis,_panOffset[axis],s.backAnimDestination[axis],speed||300,framework.easing.sine.out,function(pos){_panOffset[axis]=pos;_applyCurrentZoomPan()})}}}},calculateAnimOffset:function(axis){if(!s.backAnimStarted[axis]){s.speedDecelerationRatio[axis]=s.speedDecelerationRatio[axis]*(s.slowDownRatio[axis]+s.slowDownRatioReverse[axis]-s.slowDownRatioReverse[axis]*s.timeDiff/10);s.speedDecelerationRatioAbs[axis]=Math.abs(s.lastFlickSpeed[axis]*s.speedDecelerationRatio[axis]);s.distanceOffset[axis]=s.lastFlickSpeed[axis]*s.speedDecelerationRatio[axis]*s.timeDiff;_panOffset[axis]+=s.distanceOffset[axis]}},panAnimLoop:function(){if(_animations.zoomPan){_animations.zoomPan.raf=_requestAF(s.panAnimLoop);s.now=_getCurrentTime();s.timeDiff=s.now-s.lastNow;s.lastNow=s.now;s.calculateAnimOffset("x");s.calculateAnimOffset("y");_applyCurrentZoomPan();s.calculateOverBoundsAnimOffset("x");s.calculateOverBoundsAnimOffset("y");if(s.speedDecelerationRatioAbs.x<.05&&s.speedDecelerationRatioAbs.y<.05){_panOffset.x=Math.round(_panOffset.x);_panOffset.y=Math.round(_panOffset.y);_applyCurrentZoomPan();_stopAnimation("zoomPan");return}}}};return s},_completePanGesture=function(animData){animData.calculateSwipeSpeed("y");_currPanBounds=self.currItem.bounds;animData.backAnimDestination={};animData.backAnimStarted={};
if(Math.abs(animData.lastFlickSpeed.x)<=.05&&Math.abs(animData.lastFlickSpeed.y)<=.05){animData.speedDecelerationRatioAbs.x=animData.speedDecelerationRatioAbs.y=0;animData.calculateOverBoundsAnimOffset("x");animData.calculateOverBoundsAnimOffset("y");return true}_registerStartAnimation("zoomPan");animData.lastNow=_getCurrentTime();animData.panAnimLoop()},_finishSwipeMainScrollGesture=function(gestureType,_releaseAnimData){var itemChanged;if(!_mainScrollAnimating){_currZoomedItemIndex=_currentItemIndex}var itemsDiff;if(gestureType==="swipe"){var totalShiftDist=_currPoint.x-_startPoint.x,isFastLastFlick=_releaseAnimData.lastFlickDist.x<10;if(totalShiftDist>MIN_SWIPE_DISTANCE&&(isFastLastFlick||_releaseAnimData.lastFlickOffset.x>20)){itemsDiff=-1}else if(totalShiftDist<-MIN_SWIPE_DISTANCE&&(isFastLastFlick||_releaseAnimData.lastFlickOffset.x<-20)){itemsDiff=1}}var nextCircle;if(itemsDiff){_currentItemIndex+=itemsDiff;if(_currentItemIndex<0){_currentItemIndex=_options.loop?_getNumItems()-1:0;nextCircle=true}else if(_currentItemIndex>=_getNumItems()){_currentItemIndex=_options.loop?0:_getNumItems()-1;nextCircle=true}if(!nextCircle||_options.loop){_indexDiff+=itemsDiff;_currPositionIndex-=itemsDiff;itemChanged=true}}var animateToX=_slideSize.x*_currPositionIndex;var animateToDist=Math.abs(animateToX-_mainScrollPos.x);var finishAnimDuration;if(!itemChanged&&animateToX>_mainScrollPos.x!==_releaseAnimData.lastFlickSpeed.x>0){finishAnimDuration=333}else{finishAnimDuration=Math.abs(_releaseAnimData.lastFlickSpeed.x)>0?animateToDist/Math.abs(_releaseAnimData.lastFlickSpeed.x):333;finishAnimDuration=Math.min(finishAnimDuration,400);finishAnimDuration=Math.max(finishAnimDuration,250)}if(_currZoomedItemIndex===_currentItemIndex){itemChanged=false}_mainScrollAnimating=true;_shout("mainScrollAnimStart");_animateProp("mainScroll",_mainScrollPos.x,animateToX,finishAnimDuration,framework.easing.cubic.out,_moveMainScroll,function(){_stopAllAnimations();_mainScrollAnimating=false;_currZoomedItemIndex=-1;if(itemChanged||_currZoomedItemIndex!==_currentItemIndex){self.updateCurrItem()}_shout("mainScrollAnimComplete")});if(itemChanged){self.updateCurrItem(true)}return itemChanged},_calculateZoomLevel=function(touchesDistance){return 1/_startPointsDistance*touchesDistance*_startZoomLevel},_completeZoomGesture=function(){var destZoomLevel=_currZoomLevel,minZoomLevel=_getMinZoomLevel(),maxZoomLevel=_getMaxZoomLevel();if(_currZoomLevel<minZoomLevel){destZoomLevel=minZoomLevel}else if(_currZoomLevel>maxZoomLevel){destZoomLevel=maxZoomLevel}var destOpacity=1,onUpdate,initialOpacity=_bgOpacity;if(_opacityChanged&&!_isZoomingIn&&!_wasOverInitialZoom&&_currZoomLevel<minZoomLevel){self.close();return true}if(_opacityChanged){onUpdate=function(now){_applyBgOpacity((destOpacity-initialOpacity)*now+initialOpacity)}}self.zoomTo(destZoomLevel,0,200,framework.easing.cubic.out,onUpdate);return true};_registerModule("Gestures",{publicMethods:{initGestures:function(){var addEventNames=function(pref,down,move,up,cancel){_dragStartEvent=pref+down;_dragMoveEvent=pref+move;_dragEndEvent=pref+up;if(cancel){_dragCancelEvent=pref+cancel}else{_dragCancelEvent=""}};_pointerEventEnabled=_features.pointerEvent;if(_pointerEventEnabled&&_features.touch){_features.touch=false}if(_pointerEventEnabled){if(navigator.pointerEnabled){addEventNames("pointer","down","move","up","cancel")}else{addEventNames("MSPointer","Down","Move","Up","Cancel")}}else if(_features.touch){addEventNames("touch","start","move","end","cancel");_likelyTouchDevice=true}else{addEventNames("mouse","down","move","up")}_upMoveEvents=_dragMoveEvent+" "+_dragEndEvent+" "+_dragCancelEvent;_downEvents=_dragStartEvent;if(_pointerEventEnabled&&!_likelyTouchDevice){_likelyTouchDevice=navigator.maxTouchPoints>1||navigator.msMaxTouchPoints>1}self.likelyTouchDevice=_likelyTouchDevice;_globalEventHandlers[_dragStartEvent]=_onDragStart;_globalEventHandlers[_dragMoveEvent]=_onDragMove;_globalEventHandlers[_dragEndEvent]=_onDragRelease;if(_dragCancelEvent){_globalEventHandlers[_dragCancelEvent]=_globalEventHandlers[_dragEndEvent]}if(_features.touch){_downEvents+=" mousedown";_upMoveEvents+=" mousemove mouseup";_globalEventHandlers.mousedown=_globalEventHandlers[_dragStartEvent];_globalEventHandlers.mousemove=_globalEventHandlers[_dragMoveEvent];_globalEventHandlers.mouseup=_globalEventHandlers[_dragEndEvent]}if(!_likelyTouchDevice){_options.allowPanToNext=false}}}});var _showOrHideTimeout,_showOrHide=function(item,img,out,completeFn){if(_showOrHideTimeout){clearTimeout(_showOrHideTimeout)}_initialZoomRunning=true;_initialContentSet=true;var thumbBounds;if(item.initialLayout){thumbBounds=item.initialLayout;item.initialLayout=null}else{thumbBounds=_options.getThumbBoundsFn&&_options.getThumbBoundsFn(_currentItemIndex)}var duration=out?_options.hideAnimationDuration:_options.showAnimationDuration;var onComplete=function(){_stopAnimation("initialZoom");if(!out){_applyBgOpacity(1);if(img){img.style.display="block"}framework.addClass(template,"pswp--animated-in");_shout("initialZoom"+(out?"OutEnd":"InEnd"))}else{self.template.removeAttribute("style");self.bg.removeAttribute("style")}if(completeFn){completeFn()}_initialZoomRunning=false};if(!duration||!thumbBounds||thumbBounds.x===undefined){_shout("initialZoom"+(out?"Out":"In"));_currZoomLevel=item.initialZoomLevel;_equalizePoints(_panOffset,item.initialPosition);_applyCurrentZoomPan();template.style.opacity=out?0:1;_applyBgOpacity(1);if(duration){setTimeout(function(){onComplete()},duration)}else{onComplete()}return}var startAnimation=function(){var closeWithRaf=_closedByScroll,fadeEverything=!self.currItem.src||self.currItem.loadError||_options.showHideOpacity;if(item.miniImg){item.miniImg.style.webkitBackfaceVisibility="hidden"}if(!out){_currZoomLevel=thumbBounds.w/item.w;_panOffset.x=thumbBounds.x;_panOffset.y=thumbBounds.y-_initalWindowScrollY;self[fadeEverything?"template":"bg"].style.opacity=.001;_applyCurrentZoomPan()}_registerStartAnimation("initialZoom");if(out&&!closeWithRaf){framework.removeClass(template,"pswp--animated-in")}if(fadeEverything){if(out){framework[(closeWithRaf?"remove":"add")+"Class"](template,"pswp--animate_opacity")}else{setTimeout(function(){framework.addClass(template,"pswp--animate_opacity")},30)}}_showOrHideTimeout=setTimeout(function(){_shout("initialZoom"+(out?"Out":"In"));if(!out){_currZoomLevel=item.initialZoomLevel;_equalizePoints(_panOffset,item.initialPosition);_applyCurrentZoomPan();_applyBgOpacity(1);if(fadeEverything){template.style.opacity=1}else{_applyBgOpacity(1)}_showOrHideTimeout=setTimeout(onComplete,duration+20)}else{var destZoomLevel=thumbBounds.w/item.w,initialPanOffset={x:_panOffset.x,y:_panOffset.y},initialZoomLevel=_currZoomLevel,initalBgOpacity=_bgOpacity,onUpdate=function(now){if(now===1){_currZoomLevel=destZoomLevel;_panOffset.x=thumbBounds.x;_panOffset.y=thumbBounds.y-_currentWindowScrollY}else{_currZoomLevel=(destZoomLevel-initialZoomLevel)*now+initialZoomLevel;_panOffset.x=(thumbBounds.x-initialPanOffset.x)*now+initialPanOffset.x;_panOffset.y=(thumbBounds.y-_currentWindowScrollY-initialPanOffset.y)*now+initialPanOffset.y}_applyCurrentZoomPan();if(fadeEverything){template.style.opacity=1-now}else{_applyBgOpacity(initalBgOpacity-now*initalBgOpacity)}};if(closeWithRaf){_animateProp("initialZoom",0,1,duration,framework.easing.cubic.out,onUpdate,onComplete)}else{onUpdate(1);_showOrHideTimeout=setTimeout(onComplete,duration+20)}}},out?25:90)};startAnimation()};var _items,_tempPanAreaSize={},_imagesToAppendPool=[],_initialContentSet,_initialZoomRunning,_controllerDefaultOptions={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:false,preload:[1,1],getNumItemsFn:function(){return _items.length}};var _getItemAt,_getNumItems,_initialIsLoop,_getZeroBounds=function(){return{center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}}},_calculateSingleItemPanBounds=function(item,realPanElementW,realPanElementH){var bounds=item.bounds;bounds.center.x=Math.round((_tempPanAreaSize.x-realPanElementW)/2);bounds.center.y=Math.round((_tempPanAreaSize.y-realPanElementH)/2)+item.vGap.top;bounds.max.x=realPanElementW>_tempPanAreaSize.x?Math.round(_tempPanAreaSize.x-realPanElementW):bounds.center.x;bounds.max.y=realPanElementH>_tempPanAreaSize.y?Math.round(_tempPanAreaSize.y-realPanElementH)+item.vGap.top:bounds.center.y;bounds.min.x=realPanElementW>_tempPanAreaSize.x?0:bounds.center.x;bounds.min.y=realPanElementH>_tempPanAreaSize.y?item.vGap.top:bounds.center.y},_calculateItemSize=function(item,viewportSize,zoomLevel){if(item.src&&!item.loadError){var isInitial=!zoomLevel;if(isInitial){if(!item.vGap){item.vGap={top:0,bottom:0}}_shout("parseVerticalMargin",item)}_tempPanAreaSize.x=viewportSize.x;_tempPanAreaSize.y=viewportSize.y-item.vGap.top-item.vGap.bottom;if(isInitial){var hRatio=_tempPanAreaSize.x/item.w;var vRatio=_tempPanAreaSize.y/item.h;item.fitRatio=hRatio<vRatio?hRatio:vRatio;var scaleMode=_options.scaleMode;if(scaleMode==="orig"){zoomLevel=1}else if(scaleMode==="fit"){zoomLevel=item.fitRatio}if(zoomLevel>1){zoomLevel=1}item.initialZoomLevel=zoomLevel;if(!item.bounds){item.bounds=_getZeroBounds()}}if(!zoomLevel){return}_calculateSingleItemPanBounds(item,item.w*zoomLevel,item.h*zoomLevel);if(isInitial&&zoomLevel===item.initialZoomLevel){item.initialPosition=item.bounds.center}return item.bounds}else{item.w=item.h=0;item.initialZoomLevel=item.fitRatio=1;item.bounds=_getZeroBounds();item.initialPosition=item.bounds.center;return item.bounds}},_appendImage=function(index,item,baseDiv,img,preventAnimation,keepPlaceholder){if(item.loadError){return}if(img){item.imageAppended=true;_setImageSize(item,img,item===self.currItem&&_renderMaxResolution);baseDiv.appendChild(img);if(keepPlaceholder){setTimeout(function(){if(item&&item.loaded&&item.placeholder){item.placeholder.style.display="none";item.placeholder=null}},500)}}},_preloadImage=function(item){item.loading=true;item.loaded=false;var img=item.img=framework.createEl("pswp__img","img");var onComplete=function(){item.loading=false;item.loaded=true;if(item.loadComplete){item.loadComplete(item)}else{item.img=null}img.onload=img.onerror=null;img=null};img.onload=onComplete;img.onerror=function(){item.loadError=true;onComplete()};img.src=item.src;return img},_checkForError=function(item,cleanUp){if(item.src&&item.loadError&&item.container){if(cleanUp){item.container.innerHTML=""}item.container.innerHTML=_options.errorMsg.replace("%url%",item.src);return true}},_setImageSize=function(item,img,maxRes){if(!item.src){return}if(!img){img=item.container.lastChild}var w=maxRes?item.w:Math.round(item.w*item.fitRatio),h=maxRes?item.h:Math.round(item.h*item.fitRatio);if(item.placeholder&&!item.loaded){item.placeholder.style.width=w+"px";item.placeholder.style.height=h+"px"}img.style.width=w+"px";img.style.height=h+"px"},_appendImagesPool=function(){if(_imagesToAppendPool.length){var poolItem;for(var i=0;i<_imagesToAppendPool.length;i++){poolItem=_imagesToAppendPool[i];if(poolItem.holder.index===poolItem.index){_appendImage(poolItem.index,poolItem.item,poolItem.baseDiv,poolItem.img,false,poolItem.clearPlaceholder)}}_imagesToAppendPool=[]}};_registerModule("Controller",{publicMethods:{lazyLoadItem:function(index){index=_getLoopedId(index);var item=_getItemAt(index);if(!item||(item.loaded||item.loading)&&!_itemsNeedUpdate){return}_shout("gettingData",index,item);if(!item.src){return}_preloadImage(item)},initController:function(){framework.extend(_options,_controllerDefaultOptions,true);self.items=_items=items;_getItemAt=self.getItemAt;_getNumItems=_options.getNumItemsFn;_initialIsLoop=_options.loop;if(_getNumItems()<3){_options.loop=false}_listen("beforeChange",function(diff){var p=_options.preload,isNext=diff===null?true:diff>=0,preloadBefore=Math.min(p[0],_getNumItems()),preloadAfter=Math.min(p[1],_getNumItems()),i;for(i=1;i<=(isNext?preloadAfter:preloadBefore);i++){self.lazyLoadItem(_currentItemIndex+i)}for(i=1;i<=(isNext?preloadBefore:preloadAfter);i++){self.lazyLoadItem(_currentItemIndex-i)}});_listen("initialLayout",function(){self.currItem.initialLayout=_options.getThumbBoundsFn&&_options.getThumbBoundsFn(_currentItemIndex)});_listen("mainScrollAnimComplete",_appendImagesPool);_listen("initialZoomInEnd",_appendImagesPool);_listen("destroy",function(){var item;for(var i=0;i<_items.length;i++){item=_items[i];if(item.container){item.container=null}if(item.placeholder){item.placeholder=null}if(item.img){item.img=null}if(item.preloader){item.preloader=null}if(item.loadError){item.loaded=item.loadError=false}}_imagesToAppendPool=null})},getItemAt:function(index){if(index>=0){return _items[index]!==undefined?_items[index]:false}return false},allowProgressiveImg:function(){return _options.forceProgressiveLoading||!_likelyTouchDevice||_options.mouseUsed||screen.width>1200},setContent:function(holder,index){if(_options.loop){index=_getLoopedId(index)}var prevItem=self.getItemAt(holder.index);if(prevItem){prevItem.container=null}var item=self.getItemAt(index),img;if(!item){holder.el.innerHTML="";return}_shout("gettingData",index,item);holder.index=index;holder.item=item;var baseDiv=item.container=framework.createEl("pswp__zoom-wrap");if(!item.src&&item.html){if(item.html.tagName){baseDiv.appendChild(item.html)}else{baseDiv.innerHTML=item.html}}_checkForError(item);_calculateItemSize(item,_viewportSize);if(item.src&&!item.loadError&&!item.loaded){item.loadComplete=function(item){if(!_isOpen){return}if(holder&&holder.index===index){if(_checkForError(item,true)){item.loadComplete=item.img=null;_calculateItemSize(item,_viewportSize);_applyZoomPanToItem(item);if(holder.index===_currentItemIndex){self.updateCurrZoomItem()}return}if(!item.imageAppended){if(_features.transform&&(_mainScrollAnimating||_initialZoomRunning)){_imagesToAppendPool.push({item:item,baseDiv:baseDiv,img:item.img,index:index,holder:holder,clearPlaceholder:true})}else{_appendImage(index,item,baseDiv,item.img,_mainScrollAnimating||_initialZoomRunning,true)}}else{if(!_initialZoomRunning&&item.placeholder){item.placeholder.style.display="none";item.placeholder=null}}}item.loadComplete=null;item.img=null;_shout("imageLoadComplete",index,item)};if(framework.features.transform){var placeholderClassName="pswp__img pswp__img--placeholder";placeholderClassName+=item.msrc?"":" pswp__img--placeholder--blank";var placeholder=framework.createEl(placeholderClassName,item.msrc?"img":"");if(item.msrc){placeholder.src=item.msrc}_setImageSize(item,placeholder);baseDiv.appendChild(placeholder);item.placeholder=placeholder}if(!item.loading){_preloadImage(item)}if(self.allowProgressiveImg()){if(!_initialContentSet&&_features.transform){_imagesToAppendPool.push({item:item,baseDiv:baseDiv,img:item.img,index:index,holder:holder})}else{_appendImage(index,item,baseDiv,item.img,true,true)}}}else if(item.src&&!item.loadError){img=framework.createEl("pswp__img","img");img.style.opacity=1;img.src=item.src;_setImageSize(item,img);_appendImage(index,item,baseDiv,img,true)}if(!_initialContentSet&&index===_currentItemIndex){_currZoomElementStyle=baseDiv.style;_showOrHide(item,img||item.img)}else{_applyZoomPanToItem(item)}holder.el.innerHTML="";holder.el.appendChild(baseDiv)},cleanSlide:function(item){if(item.img){item.img.onload=item.img.onerror=null}item.loaded=item.loading=item.img=item.imageAppended=false}}});var tapTimer,tapReleasePoint={},_dispatchTapEvent=function(origEvent,releasePoint,pointerType){var e=document.createEvent("CustomEvent"),eDetail={origEvent:origEvent,target:origEvent.target,releasePoint:releasePoint,pointerType:pointerType||"touch"};e.initCustomEvent("pswpTap",true,true,eDetail);origEvent.target.dispatchEvent(e)};_registerModule("Tap",{publicMethods:{initTap:function(){_listen("firstTouchStart",self.onTapStart);_listen("touchRelease",self.onTapRelease);_listen("destroy",function(){tapReleasePoint={};tapTimer=null})},onTapStart:function(touchList){if(touchList.length>1){clearTimeout(tapTimer);tapTimer=null}},onTapRelease:function(e,releasePoint){if(!releasePoint){return}if(!_moved&&!_isMultitouch&&!_numAnimations){var p0=releasePoint;if(tapTimer){clearTimeout(tapTimer);tapTimer=null;if(_isNearbyPoints(p0,tapReleasePoint)){_shout("doubleTap",p0);return}}if(releasePoint.type==="mouse"){_dispatchTapEvent(e,releasePoint,"mouse");return}var clickedTagName=e.target.tagName.toUpperCase();if(clickedTagName==="BUTTON"||framework.hasClass(e.target,"pswp__single-tap")){_dispatchTapEvent(e,releasePoint);return}_equalizePoints(tapReleasePoint,p0);tapTimer=setTimeout(function(){_dispatchTapEvent(e,releasePoint);tapTimer=null},300)}}}});var _wheelDelta;_registerModule("DesktopZoom",{publicMethods:{initDesktopZoom:function(){if(_oldIE){return}if(_likelyTouchDevice){_listen("mouseUsed",function(){self.setupDesktopZoom()})}else{self.setupDesktopZoom(true)}},setupDesktopZoom:function(onInit){_wheelDelta={};var events="wheel mousewheel DOMMouseScroll";_listen("bindEvents",function(){framework.bind(template,events,self.handleMouseWheel)});_listen("unbindEvents",function(){if(_wheelDelta){framework.unbind(template,events,self.handleMouseWheel)}});self.mouseZoomedIn=false;var hasDraggingClass,updateZoomable=function(){if(self.mouseZoomedIn){framework.removeClass(template,"pswp--zoomed-in");self.mouseZoomedIn=false}if(_currZoomLevel<1){framework.addClass(template,"pswp--zoom-allowed")}else{framework.removeClass(template,"pswp--zoom-allowed")}removeDraggingClass()},removeDraggingClass=function(){if(hasDraggingClass){framework.removeClass(template,"pswp--dragging");hasDraggingClass=false}};_listen("resize",updateZoomable);_listen("afterChange",updateZoomable);_listen("pointerDown",function(){if(self.mouseZoomedIn){hasDraggingClass=true;framework.addClass(template,"pswp--dragging")}});_listen("pointerUp",removeDraggingClass);if(!onInit){updateZoomable()}},handleMouseWheel:function(e){if(_currZoomLevel<=self.currItem.fitRatio){if(_options.modal){if(!_options.closeOnScroll||_numAnimations||_isDragging){e.preventDefault()}else if(_transformKey&&Math.abs(e.deltaY)>2){_closedByScroll=true;self.close()}}return true}e.stopPropagation();_wheelDelta.x=0;if("deltaX"in e){if(e.deltaMode===1){_wheelDelta.x=e.deltaX*18;_wheelDelta.y=e.deltaY*18}else{_wheelDelta.x=e.deltaX;_wheelDelta.y=e.deltaY}}else if("wheelDelta"in e){if(e.wheelDeltaX){_wheelDelta.x=-.16*e.wheelDeltaX}if(e.wheelDeltaY){_wheelDelta.y=-.16*e.wheelDeltaY}else{_wheelDelta.y=-.16*e.wheelDelta}}else if("detail"in e){_wheelDelta.y=e.detail}else{return}_calculatePanBounds(_currZoomLevel,true);var newPanX=_panOffset.x-_wheelDelta.x,newPanY=_panOffset.y-_wheelDelta.y;if(_options.modal||newPanX<=_currPanBounds.min.x&&newPanX>=_currPanBounds.max.x&&newPanY<=_currPanBounds.min.y&&newPanY>=_currPanBounds.max.y){e.preventDefault()}self.panTo(newPanX,newPanY)},toggleDesktopZoom:function(centerPoint){centerPoint=centerPoint||{x:_viewportSize.x/2+_offset.x,y:_viewportSize.y/2+_offset.y};var doubleTapZoomLevel=_options.getDoubleTapZoom(true,self.currItem);var zoomOut=_currZoomLevel===doubleTapZoomLevel;self.mouseZoomedIn=!zoomOut;self.zoomTo(zoomOut?self.currItem.initialZoomLevel:doubleTapZoomLevel,centerPoint,333);framework[(!zoomOut?"add":"remove")+"Class"](template,"pswp--zoomed-in")}}});var _historyDefaultOptions={history:true,galleryUID:1};var _historyUpdateTimeout,_hashChangeTimeout,_hashAnimCheckTimeout,_hashChangedByScript,_hashChangedByHistory,_hashReseted,_initialHash,_historyChanged,_closedFromURL,_urlChangedOnce,_windowLoc,_supportsPushState,_getHash=function(){return _windowLoc.hash.substring(1)},_cleanHistoryTimeouts=function(){if(_historyUpdateTimeout){clearTimeout(_historyUpdateTimeout)}if(_hashAnimCheckTimeout){clearTimeout(_hashAnimCheckTimeout)}},_parseItemIndexFromURL=function(){var hash=_getHash(),params={};if(hash.length<5){return params}var i,vars=hash.split("&");for(i=0;i<vars.length;i++){if(!vars[i]){continue}var pair=vars[i].split("=");if(pair.length<2){continue}params[pair[0]]=pair[1]}if(_options.galleryPIDs){var searchfor=params.pid;params.pid=0;for(i=0;i<_items.length;i++){if(_items[i].pid===searchfor){params.pid=i;break}}}else{params.pid=parseInt(params.pid,10)-1}if(params.pid<0){params.pid=0}return params},_updateHash=function(){if(_hashAnimCheckTimeout){clearTimeout(_hashAnimCheckTimeout)}if(_numAnimations||_isDragging){_hashAnimCheckTimeout=setTimeout(_updateHash,500);return}if(_hashChangedByScript){clearTimeout(_hashChangeTimeout)}else{_hashChangedByScript=true}var pid=_currentItemIndex+1;var item=_getItemAt(_currentItemIndex);if(item.hasOwnProperty("pid")){pid=item.pid}var newHash=_initialHash+"&"+"gid="+_options.galleryUID+"&"+"pid="+pid;if(!_historyChanged){if(_windowLoc.hash.indexOf(newHash)===-1){_urlChangedOnce=true}}var newURL=_windowLoc.href.split("#")[0]+"#"+newHash;if(_supportsPushState){if("#"+newHash!==window.location.hash){history[_historyChanged?"replaceState":"pushState"]("",document.title,newURL)}}else{if(_historyChanged){_windowLoc.replace(newURL)}else{_windowLoc.hash=newHash}}_historyChanged=true;_hashChangeTimeout=setTimeout(function(){_hashChangedByScript=false},60)};_registerModule("History",{publicMethods:{initHistory:function(){framework.extend(_options,_historyDefaultOptions,true);if(!_options.history){return}_windowLoc=window.location;_urlChangedOnce=false;_closedFromURL=false;_historyChanged=false;_initialHash=_getHash();_supportsPushState="pushState"in history;if(_initialHash.indexOf("gid=")>-1){_initialHash=_initialHash.split("&gid=")[0];_initialHash=_initialHash.split("?gid=")[0]}_listen("afterChange",self.updateURL);_listen("unbindEvents",function(){framework.unbind(window,"hashchange",self.onHashChange)});var returnToOriginal=function(){_hashReseted=true;if(!_closedFromURL){if(_urlChangedOnce){history.back()}else{if(_initialHash){_windowLoc.hash=_initialHash}else{if(_supportsPushState){history.pushState("",document.title,_windowLoc.pathname+_windowLoc.search)}else{_windowLoc.hash=""}}}}_cleanHistoryTimeouts()};_listen("unbindEvents",function(){if(_closedByScroll){returnToOriginal()}});_listen("destroy",function(){if(!_hashReseted){returnToOriginal()}});_listen("firstUpdate",function(){_currentItemIndex=_parseItemIndexFromURL().pid});var index=_initialHash.indexOf("pid=");if(index>-1){_initialHash=_initialHash.substring(0,index);if(_initialHash.slice(-1)==="&"){_initialHash=_initialHash.slice(0,-1)}}setTimeout(function(){if(_isOpen){framework.bind(window,"hashchange",self.onHashChange)}},40)},onHashChange:function(){if(_getHash()===_initialHash){_closedFromURL=true;self.close();return}if(!_hashChangedByScript){_hashChangedByHistory=true;self.goTo(_parseItemIndexFromURL().pid);_hashChangedByHistory=false}},updateURL:function(){_cleanHistoryTimeouts();if(_hashChangedByHistory){return}if(!_historyChanged){_updateHash()}else{_historyUpdateTimeout=setTimeout(_updateHash,800)}}}});framework.extend(self,publicMethods)};return PhotoSwipe});(function(root,factory){if(typeof define==="function"&&define.amd){define(factory)}else if(typeof exports==="object"){module.exports=factory()}else{root.PhotoSwipeUI_Default=factory()}})(this,function(){"use strict";var PhotoSwipeUI_Default=function(pswp,framework){var ui=this;var _overlayUIUpdated=false,_controlsVisible=true,_fullscrenAPI,_controls,_captionContainer,_fakeCaptionContainer,_indexIndicator,_shareButton,_shareModal,_shareModalHidden=true,_initalCloseOnScrollValue,_isIdle,_listen,_loadingIndicator,_loadingIndicatorHidden,_loadingIndicatorTimeout,_galleryHasOneSlide,_options,_defaultUIOptions={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4e3,timeToIdleOutside:1e3,loadingIndicatorDelay:1e3,addCaptionHTMLFn:function(item,captionEl){if(!item.title){captionEl.children[0].innerHTML="";return false}captionEl.children[0].innerHTML=item.title;return true},closeEl:true,captionEl:true,fullscreenEl:true,zoomEl:true,shareEl:true,counterEl:true,arrowEl:true,preloaderEl:true,tapToClose:false,tapToToggleControls:true,clickToCloseNonZoomable:true,shareButtons:[{id:"facebook",label:"Share on Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"Tweet",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"Pin it",url:"http://www.pinterest.com/pin/create/button/"+"?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"Download image",url:"{{raw_image_url}}",download:true}],getImageURLForShare:function(){return pswp.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return pswp.currItem.title||""},indexIndicatorSep:" / ",fitControlsWidth:1200},_blockControlsTap,_blockControlsTapTimeout;var _onControlsTap=function(e){if(_blockControlsTap){return true}e=e||window.event;if(_options.timeToIdle&&_options.mouseUsed&&!_isIdle){_onIdleMouseMove()}var target=e.target||e.srcElement,uiElement,clickedClass=target.getAttribute("class")||"",found;for(var i=0;i<_uiElements.length;i++){uiElement=_uiElements[i];if(uiElement.onTap&&clickedClass.indexOf("pswp__"+uiElement.name)>-1){uiElement.onTap();found=true}}if(found){if(e.stopPropagation){e.stopPropagation()}_blockControlsTap=true;var tapDelay=framework.features.isOldAndroid?600:30;_blockControlsTapTimeout=setTimeout(function(){_blockControlsTap=false},tapDelay)}},_fitControlsInViewport=function(){return!pswp.likelyTouchDevice||_options.mouseUsed||screen.width>_options.fitControlsWidth},_togglePswpClass=function(el,cName,add){framework[(add?"add":"remove")+"Class"](el,"pswp__"+cName)},_countNumItems=function(){var hasOneSlide=_options.getNumItemsFn()===1;if(hasOneSlide!==_galleryHasOneSlide){_togglePswpClass(_controls,"ui--one-slide",hasOneSlide);_galleryHasOneSlide=hasOneSlide}},_toggleShareModalClass=function(){_togglePswpClass(_shareModal,"share-modal--hidden",_shareModalHidden)},_toggleShareModal=function(){_shareModalHidden=!_shareModalHidden;if(!_shareModalHidden){_toggleShareModalClass();setTimeout(function(){if(!_shareModalHidden){framework.addClass(_shareModal,"pswp__share-modal--fade-in")}},30)}else{framework.removeClass(_shareModal,"pswp__share-modal--fade-in");setTimeout(function(){if(_shareModalHidden){_toggleShareModalClass()}},300)}if(!_shareModalHidden){_updateShareURLs()}return false},_openWindowPopup=function(e){e=e||window.event;var target=e.target||e.srcElement;pswp.shout("shareLinkClick",e,target);if(!target.href){return false}if(target.hasAttribute("download")){return true}window.open(target.href,"pswp_share","scrollbars=yes,resizable=yes,toolbar=no,"+"location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100));if(!_shareModalHidden){_toggleShareModal()}return false},_updateShareURLs=function(){var shareButtonOut="",shareButtonData,shareURL,image_url,page_url,share_text;for(var i=0;i<_options.shareButtons.length;i++){shareButtonData=_options.shareButtons[i];image_url=_options.getImageURLForShare(shareButtonData);page_url=_options.getPageURLForShare(shareButtonData);share_text=_options.getTextForShare(shareButtonData);shareURL=shareButtonData.url.replace("{{url}}",encodeURIComponent(page_url)).replace("{{image_url}}",encodeURIComponent(image_url)).replace("{{raw_image_url}}",image_url).replace("{{text}}",encodeURIComponent(share_text));shareButtonOut+='<a href="'+shareURL+'" target="_blank" '+'class="pswp__share--'+shareButtonData.id+'"'+(shareButtonData.download?"download":"")+">"+shareButtonData.label+"</a>";if(_options.parseShareButtonOut){shareButtonOut=_options.parseShareButtonOut(shareButtonData,shareButtonOut)}}_shareModal.children[0].innerHTML=shareButtonOut;_shareModal.children[0].onclick=_openWindowPopup},_hasCloseClass=function(target){for(var i=0;i<_options.closeElClasses.length;i++){if(framework.hasClass(target,"pswp__"+_options.closeElClasses[i])){return true}}},_idleInterval,_idleTimer,_idleIncrement=0,_onIdleMouseMove=function(){clearTimeout(_idleTimer);_idleIncrement=0;if(_isIdle){ui.setIdle(false)}},_onMouseLeaveWindow=function(e){e=e?e:window.event;var from=e.relatedTarget||e.toElement;if(!from||from.nodeName==="HTML"){clearTimeout(_idleTimer);_idleTimer=setTimeout(function(){ui.setIdle(true)},_options.timeToIdleOutside)}},_setupFullscreenAPI=function(){if(_options.fullscreenEl&&!framework.features.isOldAndroid){if(!_fullscrenAPI){_fullscrenAPI=ui.getFullscreenAPI()}if(_fullscrenAPI){framework.bind(document,_fullscrenAPI.eventK,ui.updateFullscreen);ui.updateFullscreen();framework.addClass(pswp.template,"pswp--supports-fs")}else{framework.removeClass(pswp.template,"pswp--supports-fs")}}},_setupLoadingIndicator=function(){if(_options.preloaderEl){_toggleLoadingIndicator(true);_listen("beforeChange",function(){clearTimeout(_loadingIndicatorTimeout);_loadingIndicatorTimeout=setTimeout(function(){if(pswp.currItem&&pswp.currItem.loading){if(!pswp.allowProgressiveImg()||pswp.currItem.img&&!pswp.currItem.img.naturalWidth){_toggleLoadingIndicator(false)}}else{_toggleLoadingIndicator(true)}},_options.loadingIndicatorDelay)});_listen("imageLoadComplete",function(index,item){if(pswp.currItem===item){_toggleLoadingIndicator(true)}})}},_toggleLoadingIndicator=function(hide){if(_loadingIndicatorHidden!==hide){_togglePswpClass(_loadingIndicator,"preloader--active",!hide);_loadingIndicatorHidden=hide}},_applyNavBarGaps=function(item){var gap=item.vGap;if(_fitControlsInViewport()){var bars=_options.barsSize;if(_options.captionEl&&bars.bottom==="auto"){if(!_fakeCaptionContainer){_fakeCaptionContainer=framework.createEl("pswp__caption pswp__caption--fake");_fakeCaptionContainer.appendChild(framework.createEl("pswp__caption__center"));_controls.insertBefore(_fakeCaptionContainer,_captionContainer);framework.addClass(_controls,"pswp__ui--fit")}if(_options.addCaptionHTMLFn(item,_fakeCaptionContainer,true)){var captionSize=_fakeCaptionContainer.clientHeight;gap.bottom=parseInt(captionSize,10)||44}else{gap.bottom=bars.top}}else{gap.bottom=bars.bottom==="auto"?0:bars.bottom}gap.top=bars.top}else{gap.top=gap.bottom=0}},_setupIdle=function(){if(_options.timeToIdle){_listen("mouseUsed",function(){framework.bind(document,"mousemove",_onIdleMouseMove);framework.bind(document,"mouseout",_onMouseLeaveWindow);_idleInterval=setInterval(function(){_idleIncrement++;if(_idleIncrement===2){ui.setIdle(true)}},_options.timeToIdle/2)})}},_setupHidingControlsDuringGestures=function(){_listen("onVerticalDrag",function(now){if(_controlsVisible&&now<.95){ui.hideControls()}else if(!_controlsVisible&&now>=.95){ui.showControls()}});var pinchControlsHidden;_listen("onPinchClose",function(now){if(_controlsVisible&&now<.9){ui.hideControls();pinchControlsHidden=true}else if(pinchControlsHidden&&!_controlsVisible&&now>.9){ui.showControls()}});_listen("zoomGestureEnded",function(){pinchControlsHidden=false;if(pinchControlsHidden&&!_controlsVisible){ui.showControls()}})};var _uiElements=[{name:"caption",option:"captionEl",onInit:function(el){_captionContainer=el}},{name:"share-modal",option:"shareEl",onInit:function(el){_shareModal=el},onTap:function(){_toggleShareModal()}},{name:"button--share",option:"shareEl",onInit:function(el){_shareButton=el},onTap:function(){_toggleShareModal()}},{name:"button--zoom",option:"zoomEl",onTap:pswp.toggleDesktopZoom},{name:"counter",option:"counterEl",onInit:function(el){_indexIndicator=el}},{name:"button--close",option:"closeEl",onTap:pswp.close},{name:"button--arrow--left",option:"arrowEl",onTap:pswp.prev},{name:"button--arrow--right",option:"arrowEl",onTap:pswp.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){if(_fullscrenAPI.isFullscreen()){_fullscrenAPI.exit()}else{_fullscrenAPI.enter()}}},{name:"preloader",option:"preloaderEl",onInit:function(el){_loadingIndicator=el}}];var _setupUIElements=function(){var item,classAttr,uiElement;var loopThroughChildElements=function(sChildren){if(!sChildren){return}var l=sChildren.length;
for(var i=0;i<l;i++){item=sChildren[i];classAttr=item.className;for(var a=0;a<_uiElements.length;a++){uiElement=_uiElements[a];if(classAttr.indexOf("pswp__"+uiElement.name)>-1){if(_options[uiElement.option]){framework.removeClass(item,"pswp__element--disabled");if(uiElement.onInit){uiElement.onInit(item)}}else{framework.addClass(item,"pswp__element--disabled")}}}}};loopThroughChildElements(_controls.children);var topBar=framework.getChildByClass(_controls,"pswp__top-bar");if(topBar){loopThroughChildElements(topBar.children)}};ui.init=function(){framework.extend(pswp.options,_defaultUIOptions,true);_options=pswp.options;_controls=framework.getChildByClass(pswp.scrollWrap,"pswp__ui");_listen=pswp.listen;_setupHidingControlsDuringGestures();_listen("beforeChange",ui.update);_listen("doubleTap",function(point){var initialZoomLevel=pswp.currItem.initialZoomLevel;if(pswp.getZoomLevel()!==initialZoomLevel){pswp.zoomTo(initialZoomLevel,point,333)}else{pswp.zoomTo(_options.getDoubleTapZoom(false,pswp.currItem),point,333)}});_listen("preventDragEvent",function(e,isDown,preventObj){var t=e.target||e.srcElement;if(t&&t.getAttribute("class")&&e.type.indexOf("mouse")>-1&&(t.getAttribute("class").indexOf("__caption")>0||/(SMALL|STRONG|EM)/i.test(t.tagName))){preventObj.prevent=false}});_listen("bindEvents",function(){framework.bind(_controls,"pswpTap click",_onControlsTap);framework.bind(pswp.scrollWrap,"pswpTap",ui.onGlobalTap);if(!pswp.likelyTouchDevice){framework.bind(pswp.scrollWrap,"mouseover",ui.onMouseOver)}});_listen("unbindEvents",function(){if(!_shareModalHidden){_toggleShareModal()}if(_idleInterval){clearInterval(_idleInterval)}framework.unbind(document,"mouseout",_onMouseLeaveWindow);framework.unbind(document,"mousemove",_onIdleMouseMove);framework.unbind(_controls,"pswpTap click",_onControlsTap);framework.unbind(pswp.scrollWrap,"pswpTap",ui.onGlobalTap);framework.unbind(pswp.scrollWrap,"mouseover",ui.onMouseOver);if(_fullscrenAPI){framework.unbind(document,_fullscrenAPI.eventK,ui.updateFullscreen);if(_fullscrenAPI.isFullscreen()){_options.hideAnimationDuration=0;_fullscrenAPI.exit()}_fullscrenAPI=null}});_listen("destroy",function(){if(_options.captionEl){if(_fakeCaptionContainer){_controls.removeChild(_fakeCaptionContainer)}framework.removeClass(_captionContainer,"pswp__caption--empty")}if(_shareModal){_shareModal.children[0].onclick=null}framework.removeClass(_controls,"pswp__ui--over-close");framework.addClass(_controls,"pswp__ui--hidden");ui.setIdle(false)});if(!_options.showAnimationDuration){framework.removeClass(_controls,"pswp__ui--hidden")}_listen("initialZoomIn",function(){if(_options.showAnimationDuration){framework.removeClass(_controls,"pswp__ui--hidden")}});_listen("initialZoomOut",function(){framework.addClass(_controls,"pswp__ui--hidden")});_listen("parseVerticalMargin",_applyNavBarGaps);_setupUIElements();if(_options.shareEl&&_shareButton&&_shareModal){_shareModalHidden=true}_countNumItems();_setupIdle();_setupFullscreenAPI();_setupLoadingIndicator()};ui.setIdle=function(isIdle){_isIdle=isIdle;_togglePswpClass(_controls,"ui--idle",isIdle)};ui.update=function(){if(_controlsVisible&&pswp.currItem){ui.updateIndexIndicator();if(_options.captionEl){_options.addCaptionHTMLFn(pswp.currItem,_captionContainer);_togglePswpClass(_captionContainer,"caption--empty",!pswp.currItem.title)}_overlayUIUpdated=true}else{_overlayUIUpdated=false}if(!_shareModalHidden){_toggleShareModal()}_countNumItems()};ui.updateFullscreen=function(e){if(e){setTimeout(function(){pswp.setScrollOffset(0,framework.getScrollY())},50)}framework[(_fullscrenAPI.isFullscreen()?"add":"remove")+"Class"](pswp.template,"pswp--fs")};ui.updateIndexIndicator=function(){if(_options.counterEl){_indexIndicator.innerHTML=pswp.getCurrentIndex()+1+_options.indexIndicatorSep+_options.getNumItemsFn()}};ui.onGlobalTap=function(e){e=e||window.event;var target=e.target||e.srcElement;if(_blockControlsTap){return}if(e.detail&&e.detail.pointerType==="mouse"){if(_hasCloseClass(target)){pswp.close();return}if(framework.hasClass(target,"pswp__img")){if(pswp.getZoomLevel()===1&&pswp.getZoomLevel()<=pswp.currItem.fitRatio){if(_options.clickToCloseNonZoomable){pswp.close()}}else{pswp.toggleDesktopZoom(e.detail.releasePoint)}}}else{if(_options.tapToToggleControls){if(_controlsVisible){ui.hideControls()}else{ui.showControls()}}if(_options.tapToClose&&(framework.hasClass(target,"pswp__img")||_hasCloseClass(target))){pswp.close();return}}};ui.onMouseOver=function(e){e=e||window.event;var target=e.target||e.srcElement;_togglePswpClass(_controls,"ui--over-close",_hasCloseClass(target))};ui.hideControls=function(){framework.addClass(_controls,"pswp__ui--hidden");_controlsVisible=false};ui.showControls=function(){_controlsVisible=true;if(!_overlayUIUpdated){ui.update()}framework.removeClass(_controls,"pswp__ui--hidden")};ui.supportsFullscreen=function(){var d=document;return!!(d.exitFullscreen||d.mozCancelFullScreen||d.webkitExitFullscreen||d.msExitFullscreen)};ui.getFullscreenAPI=function(){var dE=document.documentElement,api,tF="fullscreenchange";if(dE.requestFullscreen){api={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:tF}}else if(dE.mozRequestFullScreen){api={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+tF}}else if(dE.webkitRequestFullscreen){api={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+tF}}else if(dE.msRequestFullscreen){api={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}}if(api){api.enter=function(){_initalCloseOnScrollValue=_options.closeOnScroll;_options.closeOnScroll=false;if(this.enterK==="webkitRequestFullscreen"){pswp.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)}else{return pswp.template[this.enterK]()}};api.exit=function(){_options.closeOnScroll=_initalCloseOnScrollValue;return document[this.exitK]()};api.isFullscreen=function(){return document[this.elementK]}}return api}};return PhotoSwipeUI_Default});function QR8bitByte(data){this.mode=QRMode.MODE_8BIT_BYTE;this.data=data}QR8bitByte.prototype={getLength:function(buffer){return this.data.length},write:function(buffer){for(var i=0;i<this.data.length;i++){buffer.put(this.data.charCodeAt(i),8)}}};function QRCode(typeNumber,errorCorrectLevel){this.typeNumber=typeNumber;this.errorCorrectLevel=errorCorrectLevel;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=new Array}QRCode.prototype={addData:function(data){var newData=new QR8bitByte(data);this.dataList.push(newData);this.dataCache=null},isDark:function(row,col){if(row<0||this.moduleCount<=row||col<0||this.moduleCount<=col){throw new Error(row+","+col)}return this.modules[row][col]},getModuleCount:function(){return this.moduleCount},make:function(){if(this.typeNumber<1){var typeNumber=1;for(typeNumber=1;typeNumber<40;typeNumber++){var rsBlocks=QRRSBlock.getRSBlocks(typeNumber,this.errorCorrectLevel);var buffer=new QRBitBuffer;var totalDataCount=0;for(var i=0;i<rsBlocks.length;i++){totalDataCount+=rsBlocks[i].dataCount}for(var i=0;i<this.dataList.length;i++){var data=this.dataList[i];buffer.put(data.mode,4);buffer.put(data.getLength(),QRUtil.getLengthInBits(data.mode,typeNumber));data.write(buffer)}if(buffer.getLengthInBits()<=totalDataCount*8)break}this.typeNumber=typeNumber}this.makeImpl(false,this.getBestMaskPattern())},makeImpl:function(test,maskPattern){this.moduleCount=this.typeNumber*4+17;this.modules=new Array(this.moduleCount);for(var row=0;row<this.moduleCount;row++){this.modules[row]=new Array(this.moduleCount);for(var col=0;col<this.moduleCount;col++){this.modules[row][col]=null}}this.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(test,maskPattern);if(this.typeNumber>=7){this.setupTypeNumber(test)}if(this.dataCache==null){this.dataCache=QRCode.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)}this.mapData(this.dataCache,maskPattern)},setupPositionProbePattern:function(row,col){for(var r=-1;r<=7;r++){if(row+r<=-1||this.moduleCount<=row+r)continue;for(var c=-1;c<=7;c++){if(col+c<=-1||this.moduleCount<=col+c)continue;if(0<=r&&r<=6&&(c==0||c==6)||0<=c&&c<=6&&(r==0||r==6)||2<=r&&r<=4&&2<=c&&c<=4){this.modules[row+r][col+c]=true}else{this.modules[row+r][col+c]=false}}}},getBestMaskPattern:function(){var minLostPoint=0;var pattern=0;for(var i=0;i<8;i++){this.makeImpl(true,i);var lostPoint=QRUtil.getLostPoint(this);if(i==0||minLostPoint>lostPoint){minLostPoint=lostPoint;pattern=i}}return pattern},createMovieClip:function(target_mc,instance_name,depth){var qr_mc=target_mc.createEmptyMovieClip(instance_name,depth);var cs=1;this.make();for(var row=0;row<this.modules.length;row++){var y=row*cs;for(var col=0;col<this.modules[row].length;col++){var x=col*cs;var dark=this.modules[row][col];if(dark){qr_mc.beginFill(0,100);qr_mc.moveTo(x,y);qr_mc.lineTo(x+cs,y);qr_mc.lineTo(x+cs,y+cs);qr_mc.lineTo(x,y+cs);qr_mc.endFill()}}}return qr_mc},setupTimingPattern:function(){for(var r=8;r<this.moduleCount-8;r++){if(this.modules[r][6]!=null){continue}this.modules[r][6]=r%2==0}for(var c=8;c<this.moduleCount-8;c++){if(this.modules[6][c]!=null){continue}this.modules[6][c]=c%2==0}},setupPositionAdjustPattern:function(){var pos=QRUtil.getPatternPosition(this.typeNumber);for(var i=0;i<pos.length;i++){for(var j=0;j<pos.length;j++){var row=pos[i];var col=pos[j];if(this.modules[row][col]!=null){continue}for(var r=-2;r<=2;r++){for(var c=-2;c<=2;c++){if(r==-2||r==2||c==-2||c==2||r==0&&c==0){this.modules[row+r][col+c]=true}else{this.modules[row+r][col+c]=false}}}}}},setupTypeNumber:function(test){var bits=QRUtil.getBCHTypeNumber(this.typeNumber);for(var i=0;i<18;i++){var mod=!test&&(bits>>i&1)==1;this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=mod}for(var i=0;i<18;i++){var mod=!test&&(bits>>i&1)==1;this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=mod}},setupTypeInfo:function(test,maskPattern){var data=this.errorCorrectLevel<<3|maskPattern;var bits=QRUtil.getBCHTypeInfo(data);for(var i=0;i<15;i++){var mod=!test&&(bits>>i&1)==1;if(i<6){this.modules[i][8]=mod}else if(i<8){this.modules[i+1][8]=mod}else{this.modules[this.moduleCount-15+i][8]=mod}}for(var i=0;i<15;i++){var mod=!test&&(bits>>i&1)==1;if(i<8){this.modules[8][this.moduleCount-i-1]=mod}else if(i<9){this.modules[8][15-i-1+1]=mod}else{this.modules[8][15-i-1]=mod}}this.modules[this.moduleCount-8][8]=!test},mapData:function(data,maskPattern){var inc=-1;var row=this.moduleCount-1;var bitIndex=7;var byteIndex=0;for(var col=this.moduleCount-1;col>0;col-=2){if(col==6)col--;while(true){for(var c=0;c<2;c++){if(this.modules[row][col-c]==null){var dark=false;if(byteIndex<data.length){dark=(data[byteIndex]>>>bitIndex&1)==1}var mask=QRUtil.getMask(maskPattern,row,col-c);if(mask){dark=!dark}this.modules[row][col-c]=dark;bitIndex--;if(bitIndex==-1){byteIndex++;bitIndex=7}}}row+=inc;if(row<0||this.moduleCount<=row){row-=inc;inc=-inc;break}}}}};QRCode.PAD0=236;QRCode.PAD1=17;QRCode.createData=function(typeNumber,errorCorrectLevel,dataList){var rsBlocks=QRRSBlock.getRSBlocks(typeNumber,errorCorrectLevel);var buffer=new QRBitBuffer;for(var i=0;i<dataList.length;i++){var data=dataList[i];buffer.put(data.mode,4);buffer.put(data.getLength(),QRUtil.getLengthInBits(data.mode,typeNumber));data.write(buffer)}var totalDataCount=0;for(var i=0;i<rsBlocks.length;i++){totalDataCount+=rsBlocks[i].dataCount}if(buffer.getLengthInBits()>totalDataCount*8){throw new Error("code length overflow. ("+buffer.getLengthInBits()+">"+totalDataCount*8+")")}if(buffer.getLengthInBits()+4<=totalDataCount*8){buffer.put(0,4)}while(buffer.getLengthInBits()%8!=0){buffer.putBit(false)}while(true){if(buffer.getLengthInBits()>=totalDataCount*8){break}buffer.put(QRCode.PAD0,8);if(buffer.getLengthInBits()>=totalDataCount*8){break}buffer.put(QRCode.PAD1,8)}return QRCode.createBytes(buffer,rsBlocks)};QRCode.createBytes=function(buffer,rsBlocks){var offset=0;var maxDcCount=0;var maxEcCount=0;var dcdata=new Array(rsBlocks.length);var ecdata=new Array(rsBlocks.length);for(var r=0;r<rsBlocks.length;r++){var dcCount=rsBlocks[r].dataCount;var ecCount=rsBlocks[r].totalCount-dcCount;maxDcCount=Math.max(maxDcCount,dcCount);maxEcCount=Math.max(maxEcCount,ecCount);dcdata[r]=new Array(dcCount);for(var i=0;i<dcdata[r].length;i++){dcdata[r][i]=255&buffer.buffer[i+offset]}offset+=dcCount;var rsPoly=QRUtil.getErrorCorrectPolynomial(ecCount);var rawPoly=new QRPolynomial(dcdata[r],rsPoly.getLength()-1);var modPoly=rawPoly.mod(rsPoly);ecdata[r]=new Array(rsPoly.getLength()-1);for(var i=0;i<ecdata[r].length;i++){var modIndex=i+modPoly.getLength()-ecdata[r].length;ecdata[r][i]=modIndex>=0?modPoly.get(modIndex):0}}var totalCodeCount=0;for(var i=0;i<rsBlocks.length;i++){totalCodeCount+=rsBlocks[i].totalCount}var data=new Array(totalCodeCount);var index=0;for(var i=0;i<maxDcCount;i++){for(var r=0;r<rsBlocks.length;r++){if(i<dcdata[r].length){data[index++]=dcdata[r][i]}}}for(var i=0;i<maxEcCount;i++){for(var r=0;r<rsBlocks.length;r++){if(i<ecdata[r].length){data[index++]=ecdata[r][i]}}}return data};var QRMode={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};var QRErrorCorrectLevel={L:1,M:0,Q:3,H:2};var QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var QRUtil={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,G18:1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,G15_MASK:1<<14|1<<12|1<<10|1<<4|1<<1,getBCHTypeInfo:function(data){var d=data<<10;while(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G15)>=0){d^=QRUtil.G15<<QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G15)}return(data<<10|d)^QRUtil.G15_MASK},getBCHTypeNumber:function(data){var d=data<<12;while(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G18)>=0){d^=QRUtil.G18<<QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G18)}return data<<12|d},getBCHDigit:function(data){var digit=0;while(data!=0){digit++;data>>>=1}return digit},getPatternPosition:function(typeNumber){return QRUtil.PATTERN_POSITION_TABLE[typeNumber-1]},getMask:function(maskPattern,i,j){switch(maskPattern){case QRMaskPattern.PATTERN000:return(i+j)%2==0;case QRMaskPattern.PATTERN001:return i%2==0;case QRMaskPattern.PATTERN010:return j%3==0;case QRMaskPattern.PATTERN011:return(i+j)%3==0;case QRMaskPattern.PATTERN100:return(Math.floor(i/2)+Math.floor(j/3))%2==0;case QRMaskPattern.PATTERN101:return i*j%2+i*j%3==0;case QRMaskPattern.PATTERN110:return(i*j%2+i*j%3)%2==0;case QRMaskPattern.PATTERN111:return(i*j%3+(i+j)%2)%2==0;default:throw new Error("bad maskPattern:"+maskPattern)}},getErrorCorrectPolynomial:function(errorCorrectLength){var a=new QRPolynomial([1],0);for(var i=0;i<errorCorrectLength;i++){a=a.multiply(new QRPolynomial([1,QRMath.gexp(i)],0))}return a},getLengthInBits:function(mode,type){if(1<=type&&type<10){switch(mode){case QRMode.MODE_NUMBER:return 10;case QRMode.MODE_ALPHA_NUM:return 9;case QRMode.MODE_8BIT_BYTE:return 8;case QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+mode)}}else if(type<27){switch(mode){case QRMode.MODE_NUMBER:return 12;case QRMode.MODE_ALPHA_NUM:return 11;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+mode)}}else if(type<41){switch(mode){case QRMode.MODE_NUMBER:return 14;case QRMode.MODE_ALPHA_NUM:return 13;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+mode)}}else{throw new Error("type:"+type)}},getLostPoint:function(qrCode){var moduleCount=qrCode.getModuleCount();var lostPoint=0;for(var row=0;row<moduleCount;row++){for(var col=0;col<moduleCount;col++){var sameCount=0;var dark=qrCode.isDark(row,col);for(var r=-1;r<=1;r++){if(row+r<0||moduleCount<=row+r){continue}for(var c=-1;c<=1;c++){if(col+c<0||moduleCount<=col+c){continue}if(r==0&&c==0){continue}if(dark==qrCode.isDark(row+r,col+c)){sameCount++}}}if(sameCount>5){lostPoint+=3+sameCount-5}}}for(var row=0;row<moduleCount-1;row++){for(var col=0;col<moduleCount-1;col++){var count=0;if(qrCode.isDark(row,col))count++;if(qrCode.isDark(row+1,col))count++;if(qrCode.isDark(row,col+1))count++;if(qrCode.isDark(row+1,col+1))count++;if(count==0||count==4){lostPoint+=3}}}for(var row=0;row<moduleCount;row++){for(var col=0;col<moduleCount-6;col++){if(qrCode.isDark(row,col)&&!qrCode.isDark(row,col+1)&&qrCode.isDark(row,col+2)&&qrCode.isDark(row,col+3)&&qrCode.isDark(row,col+4)&&!qrCode.isDark(row,col+5)&&qrCode.isDark(row,col+6)){lostPoint+=40}}}for(var col=0;col<moduleCount;col++){for(var row=0;row<moduleCount-6;row++){if(qrCode.isDark(row,col)&&!qrCode.isDark(row+1,col)&&qrCode.isDark(row+2,col)&&qrCode.isDark(row+3,col)&&qrCode.isDark(row+4,col)&&!qrCode.isDark(row+5,col)&&qrCode.isDark(row+6,col)){lostPoint+=40}}}var darkCount=0;for(var col=0;col<moduleCount;col++){for(var row=0;row<moduleCount;row++){if(qrCode.isDark(row,col)){darkCount++}}}var ratio=Math.abs(100*darkCount/moduleCount/moduleCount-50)/5;lostPoint+=ratio*10;return lostPoint}};var QRMath={glog:function(n){if(n<1){throw new Error("glog("+n+")")}return QRMath.LOG_TABLE[n]},gexp:function(n){while(n<0){n+=255}while(n>=256){n-=255}return QRMath.EXP_TABLE[n]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var i=0;i<8;i++){QRMath.EXP_TABLE[i]=1<<i}for(var i=8;i<256;i++){QRMath.EXP_TABLE[i]=QRMath.EXP_TABLE[i-4]^QRMath.EXP_TABLE[i-5]^QRMath.EXP_TABLE[i-6]^QRMath.EXP_TABLE[i-8]}for(var i=0;i<255;i++){QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]]=i}function QRPolynomial(num,shift){if(num.length==undefined){throw new Error(num.length+"/"+shift)}var offset=0;while(offset<num.length&&num[offset]==0){offset++}this.num=new Array(num.length-offset+shift);for(var i=0;i<num.length-offset;i++){this.num[i]=num[i+offset]}}QRPolynomial.prototype={get:function(index){return this.num[index]},getLength:function(){return this.num.length},multiply:function(e){var num=new Array(this.getLength()+e.getLength()-1);for(var i=0;i<this.getLength();i++){for(var j=0;j<e.getLength();j++){num[i+j]^=QRMath.gexp(QRMath.glog(this.get(i))+QRMath.glog(e.get(j)))}}return new QRPolynomial(num,0)},mod:function(e){if(this.getLength()-e.getLength()<0){return this}var ratio=QRMath.glog(this.get(0))-QRMath.glog(e.get(0));var num=new Array(this.getLength());for(var i=0;i<this.getLength();i++){num[i]=this.get(i)}for(var i=0;i<e.getLength();i++){num[i]^=QRMath.gexp(QRMath.glog(e.get(i))+ratio)}return new QRPolynomial(num,0).mod(e)}};function QRRSBlock(totalCount,dataCount){this.totalCount=totalCount;this.dataCount=dataCount}QRRSBlock.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];QRRSBlock.getRSBlocks=function(typeNumber,errorCorrectLevel){var rsBlock=QRRSBlock.getRsBlockTable(typeNumber,errorCorrectLevel);if(rsBlock==undefined){throw new Error("bad rs block @ typeNumber:"+typeNumber+"/errorCorrectLevel:"+errorCorrectLevel)}var length=rsBlock.length/3;var list=new Array;for(var i=0;i<length;i++){var count=rsBlock[i*3+0];var totalCount=rsBlock[i*3+1];var dataCount=rsBlock[i*3+2];for(var j=0;j<count;j++){list.push(new QRRSBlock(totalCount,dataCount))}}return list};QRRSBlock.getRsBlockTable=function(typeNumber,errorCorrectLevel){switch(errorCorrectLevel){case QRErrorCorrectLevel.L:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+0];case QRErrorCorrectLevel.M:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+1];case QRErrorCorrectLevel.Q:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+2];case QRErrorCorrectLevel.H:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+3];default:return undefined}};function QRBitBuffer(){this.buffer=new Array;this.length=0}QRBitBuffer.prototype={get:function(index){var bufIndex=Math.floor(index/8);return(this.buffer[bufIndex]>>>7-index%8&1)==1},put:function(num,length){for(var i=0;i<length;i++){this.putBit((num>>>length-i-1&1)==1)}},getLengthInBits:function(){return this.length},putBit:function(bit){var bufIndex=Math.floor(this.length/8);if(this.buffer.length<=bufIndex){this.buffer.push(0)}if(bit){this.buffer[bufIndex]|=128>>>this.length%8}this.length++}};var g_gs=null,g_animationEnd="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",g_isMobile=false,g_offsetWidth=360,g_ClientHeight=640,g_leftFix=0,g_TopFix=0;function Uint8ToString(u8a){var CHUNK_SZ=32768;var c=[];for(var i=0;i<u8a.length;i+=CHUNK_SZ){c.push(String.fromCharCode.apply(null,u8a.subarray(i,i+CHUNK_SZ)))}return c.join("")}g_checkFullNameIsValid=function(strName,callback){var _re=/^[\u4e00-\u9fa5a-zA-Z]{2,10}$/;if(strName){if(_re.test(strName)==false){callback(false,"åå­é¡»æ¯é¿åº¦2ï½10ä¸ªä¸­ææè±æå­æ¯çç»åï¼")}}else{callback(false,"åå­ä¸è½ä¸ºç©ºï¼")}};g_checkIsImageFile=function(file){if(g_isMobile==false){var ImgType=["jpeg","jpg","bmp","png"];if(!RegExp(".("+ImgType.join("|")+")$","i").test(file.name.toLowerCase())){alert("éæ©æä»¶éè¯¯,å¾çç±»åé¡»æ¯(jpeg,jpg,bmp,png)ä¸­çä¸ç§");return false}}return true};digit=function(num){return num<10?"0"+(num|0):num};dateaparse=function(ymd,hms,format){ymd=ymd.concat(hms);return format.replace(/YYYY|MM|DD|hh|mm|ss/g,function(str,index){ymd.index=++ymd.index|0;return digit(ymd[ymd.index])})};g_convertTimeToYMD=function(timedata,fmt){var De=new Date(timedata);return dateaparse([De.getFullYear(),De.getMonth()+1,De.getDate()],[De.getHours(),De.getMinutes(),De.getSeconds()],fmt)};g_timeAgo=function(timestamp){var _now=new Date(Date.now()),_time=new Date(timestamp),_strTime="";var mon=_time.getMonth()+1;if(mon<10){mon="0"+mon}var day=_time.getDate();if(day<10){day="0"+day}var h=_time.getHours();if(h<10){h="0"+h}var min=_time.getMinutes();if(min<10){min="0"+min}if(_now.getFullYear()==_time.getFullYear()){if(_now.getMonth()==_time.getMonth()){if(_now.getDate()==_time.getDate()){return h+":"+min}else{if(_now.getDate()==_time.getDate()+1){_strTime="æ¨å¤© "+h+":"+min}else if(_now.getDate()==_time.getDate()+2){_strTime="åå¤© "+h+":"+min}else{_strTime=mon+"æ"+day+"æ¥ "+h+":"+min}}}else{_strTime=mon+"æ"+day+"æ¥ "+h+":"+min}}else{_strTime=_time.getFullYear()+"å¹´"+mon+"æ"+day+"æ¥ "+h+":"+min}return _strTime};function g_getRandomNum(Min,Max){var Range=Max-Min;var Rand=Math.random();return Min+Math.round(Rand*Range)}function decodeBase64(s){var e={},i,b=0,c,x,l=0,a,r="",w=String.fromCharCode,L=s.length;var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(i=0;i<64;i++){e[A.charAt(i)]=i}for(x=0;x<L;x++){c=e[s.charAt(x)];b=(b<<6)+c;l+=6;while(l>=8){((a=b>>>(l-=8)&255)||x<L-2)&&(r+=w(a))}}return r}function g_dataURLtoBlob(dataurl){var arr=dataurl.split(","),mime=arr[0].match(/:(.*?);/)[1],bstr=decodeBase64(arr[1]),n=bstr.length,u8arr=new Uint8Array(n);while(n--){u8arr[n]=bstr.charCodeAt(n)}return new Blob([u8arr],{type:mime})}function rotateImg(img,direction,canvas){var min_step=0;var max_step=3;if(img==null)return;var height=img.height;var width=img.width;var step=2;if(step==null){step=min_step}if(direction=="right"){step++;step>max_step&&(step=min_step)}else{step--;step<min_step&&(step=max_step)}var degree=step*90*Math.PI/180;var ctx=canvas.getContext("2d");switch(step){case 0:canvas.width=width;canvas.height=height;ctx.drawImage(img,0,0);break;case 1:canvas.width=height;canvas.height=width;ctx.rotate(degree);ctx.drawImage(img,0,-height);break;case 2:canvas.width=width;canvas.height=height;ctx.rotate(degree);ctx.drawImage(img,-width,-height);break;case 3:canvas.width=height;canvas.height=width;ctx.rotate(degree);ctx.drawImage(img,-width,0);break}}g_photoFix=function(file,callback){var Orientation=null;EXIF.getData(file,function(){EXIF.getAllTags(this);Orientation=EXIF.getTag(this,"Orientation")});var oReader=new FileReader;oReader.onload=function(e){var image=new Image;image.src=e.target.result;image.onload=function(){var expectWidth=this.naturalWidth;var expectHeight=this.naturalHeight;if(this.naturalWidth>this.naturalHeight&&this.naturalWidth>800){expectWidth=800;expectHeight=expectWidth*this.naturalHeight/this.naturalWidth}else if(this.naturalHeight>this.naturalWidth&&this.naturalHeight>1200){expectHeight=1200;expectWidth=expectHeight*this.naturalWidth/this.naturalHeight}var canvas=document.createElement("canvas");var ctx=canvas.getContext("2d");canvas.width=expectWidth;canvas.height=expectHeight;ctx.drawImage(this,0,0,expectWidth,expectHeight);var base64=null;if(navigator.userAgent.match(/iphone/i)){if(Orientation!=""&&Orientation!=1){switch(Orientation){case 6:rotateImg(this,"left",canvas);break;case 8:rotateImg(this,"right",canvas);break;case 3:rotateImg(this,"right",canvas);rotateImg(this,"right",canvas);break}}base64=canvas.toDataURL("image/jpeg",1)}else if(navigator.userAgent.match(/Android/i)){var encoder=new JPEGEncoder;base64=encoder.encode(ctx.getImageData(0,0,expectWidth,expectHeight),80)}else{if(Orientation!=""&&Orientation!=1){switch(Orientation){case 6:rotateImg(this,"left",canvas);break;case 8:rotateImg(this,"right",canvas);break;case 3:rotateImg(this,"right",canvas);rotateImg(this,"right",canvas);break}}base64=canvas.toDataURL("image/jpeg",1)}callback(base64,canvas.width,canvas.height)}};oReader.readAsDataURL(file)};(function(){var Class,__slice=[].slice;Class=function(){function Class(){}Class.prototype.trace=true;Class.prototype.log=function(){var args;args=1<=arguments.length?__slice.call(arguments,0):[];if(!this.trace){return}if(typeof console==="undefined"){return}args.unshift("["+this.constructor.name+"]");console.log.apply(console,args);return this};Class.prototype.logStart=function(){var args,name;name=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];if(!this.trace){return}this.logtimers||(this.logtimers={});this.logtimers[name]=+new Date;if(args.length>0){this.log.apply(this,[""+name].concat(__slice.call(args),["(started)"]))}return this};Class.prototype.logEnd=function(){var args,ms,name;name=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];ms=+new Date-this.logtimers[name];this.log.apply(this,[""+name].concat(__slice.call(args),["(Done in "+ms+"ms)"]));return this};return Class}();window.Class=Class}).call(this);(function(){var iiPFrame,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},__hasProp={}.hasOwnProperty;iiPFrame=function(_super){__extends(iiPFrame,_super);function iiPFrame(url){this.onCloseWebsocket=__bind(this.onCloseWebsocket,this);this.onOpenWebsocket=__bind(this.onOpenWebsocket,this);this.onRequest=__bind(this.onRequest,this);this.onMessage=__bind(this.onMessage,this);this.cmd=__bind(this.cmd,this);this.url=url;this.waiting_cb={};this.wrapper_nonce=document.location.href.replace(/.*wrapper_nonce=([A-Za-z0-9]+).*/,"$1");this.connect();this.next_message_id=1;this.site_info=null;this.ajax_key=null;this.init()}iiPFrame.prototype.init=function(){return this};iiPFrame.prototype.connect=function(){this.target=window.parent;window.addEventListener("message",this.onMessage,false);return this.cmd("innerReady")};iiPFrame.prototype.onMessage=function(e){var cmd,message;message=e.data;cmd=message.cmd;if(cmd==="response"){if(this.waiting_cb[message.to]!=null){return this.waiting_cb[message.to](message.result)}else{return this.log("Websocket callback not found:",message)}}else if(cmd==="wrapperReady"){return this.cmd("innerReady")}else if(cmd==="ping"){return this.response(message.id,"pong")}else if(cmd==="wrapperOpenedWebsocket"){return this.onOpenWebsocket()}else if(cmd==="wrapperClosedWebsocket"){return this.onCloseWebsocket()}else{return this.onRequest(cmd,message)}};iiPFrame.prototype.onRequest=function(cmd,message){if(cmd=="setSiteInfo"){if(message.params.cert_user_id){if(g_gs._5!=null&&g_gs._8==false){g_gs._5.doClose();g_gs._6.find("[name='loading-div']").show();g_gs.getGameImageResLoop(null)}}else{if(g_gs._8==true){g_gs._f4v()}}this.site_info=message.params;if(typeof message.params.event!="undefined"&&message.params.event[0]=="file_done"){var _filename=message.params.event[1];if(_filename.lastIndexOf("/data.json")==_filename.length-10&&_filename.indexOf("data/users/")==0){if(g_gs._8==true){g_gs.updateFile(_filename)}return}}}return this.log("Unknown request",message)};iiPFrame.prototype.response=function(to,result){return this.send({cmd:"response",to:to,result:result})};iiPFrame.prototype.cmd=function(cmd,params,cb){if(params==null){params={}
}if(cb==null){cb=null}return this.send({cmd:cmd,params:params},cb)};iiPFrame.prototype.send=function(message,cb){if(cb==null){cb=null}message.wrapper_nonce=this.wrapper_nonce;message.id=this.next_message_id;this.next_message_id+=1;this.target.postMessage(message,"*");if(cb){return this.waiting_cb[message.id]=cb}};iiPFrame.prototype.onOpenWebsocket=function(){var _that=this;this.cmd("siteInfo",{},function(site_info){_that.site_info=site_info;if(site_info.cert_user_id==null){g_gs._6.find("[name='loading-div']").hide();g_gs._f4v()}else{g_gs.getGameImageResLoop(function(){g_gs._f5t(function(){g_gs.InitGame()})})}});return this.log("Websocket open")};iiPFrame.prototype.onCloseWebsocket=function(){return this.log("Websocket close")};return iiPFrame}(Class);window.iiPFrame=iiPFrame}).call(this);function _checkBrowserType(){var ua=navigator.userAgent.toLowerCase();var ipad=ua.match(/(ipad).*os\s([\d_]+)/),isIphone=!ipad&&ua.match(/(iphone\sos)\s([\d_]+)/),isAndroid=ua.match(/(android)\s+([\d.]+)/);g_isMobile=isIphone||isAndroid;if(g_isMobile!=null){g_isMobile=true}else{g_isMobile=false}if(ua.match(/iphone/i)=="iphone"){g_biOS=true}}_checkBrowserType();var Video_Game_Screen={createNew:function(){var _self={};_self.m_pFrame=null;_self._2=null;_self._3=$("#screen_main").width();_self._4=null;_self._5=null;_self._6=null;_self._8=false;_self._9=DogTravelChat_Screen;_self._1a=null;_self._1b="left top";_self._1c="right top";_self._1d="right bottom";_self._1f=["data/dogbg/bg1.jpg","data/dogbg/bg2-2.jpg","data/dogbg/ui05.png"];_self._1g={0:{w:"25px",h:"43px",l:"-828px",t:"-1021px"},1:{w:"25px",h:"43px",l:"-911px",t:"-95px"},2:{w:"25px",h:"43px",l:"-944px",t:"-1442px"},3:{w:"25px",h:"43px",l:"-815px",t:"-1626px"},4:{w:"25px",h:"43px",l:"-911px",t:"-140px"},5:{w:"25px",h:"43px",l:"-911px",t:"-185px"},6:{w:"25px",h:"43px",l:"-911px",t:"-230px"},7:{w:"25px",h:"43px",l:"-911px",t:"-275px"},8:{w:"25px",h:"43px",l:"-938px",t:"-95px"},9:{w:"25px",h:"43px",l:"-938px",t:"-140px"},add:{w:"40px",h:"40px",l:"-815px",t:"-1584px"},bone:{w:"55px",h:"48px",l:"-911px",t:"-1px"},clothes:{w:"271px",h:"86px",l:"-347px",t:"-1021px"},collection:{w:"72px",h:"108px",l:"-741px",t:"-1472px"},cup:{w:"51px",h:"42px",l:"-911px",t:"-51px"},d1:{w:"344px",h:"172px",l:"-1px",t:"-1015px"},d2:{w:"344px",h:"172px",l:"-1px",t:"-1189px"},d3:{w:"344px",h:"172px",l:"-1px",t:"-1363px"},d4:{w:"344px",h:"172px",l:"-1px",t:"-1537px"},d5:{w:"344px",h:"172px",l:"-1px",t:"-1015px"},"d5-dsb":{w:"344px",h:"172px",l:"-456px",t:"-663px"},del:{w:"90px",h:"90px",l:"-640px",t:"-1612px"},diary:{w:"108px",h:"138px",l:"-864px",t:"-948px"},door:{w:"226px",h:"322px",l:"-456px",t:"-339px"},draw_ioc:{w:"69px",h:"119px",l:"-750px",t:"-1329px"},first:{w:"38px",h:"20px",l:"-750px",t:"-1450px"},heart:{w:"39px",h:"33px",l:"-821px",t:"-1329px"},help:{w:"72px",h:"108px",l:"-907px",t:"-1492px"},hoe1:{w:"120px",h:"214px",l:"-347px",t:"-1109px"},hoe2:{w:"200px",h:"123px",l:"-469px",t:"-1109px"},indoor:{w:"111px",h:"143px",l:"-347px",t:"-1325px"},lantern1:{w:"202px",h:"182px",l:"-456px",t:"-837px"},lantern2:{w:"202px",h:"182px",l:"-660px",t:"-837px"},left:{w:"99px",h:"138px",l:"-863px",t:"-1228px"},"luck-txt":{w:"190px",h:"96px",l:"-469px",t:"-1234px"},mail:{w:"121px",h:"122px",l:"-821px",t:"-1368px"},mailbox:{w:"152px",h:"218px",l:"-802px",t:"-583px"},paper:{w:"116px",h:"70px",l:"-684px",t:"-583px"},pendant:{w:"35px",h:"27px",l:"-944px",t:"-1413px"},photos:{w:"108px",h:"138px",l:"-851px",t:"-1088px"},plate1:{w:"453px",h:"336px",l:"-1px",t:"-1px"},plate2:{w:"453px",h:"336px",l:"-1px",t:"-339px"},plate3:{w:"453px",h:"336px",l:"-456px",t:"-1px"},plate4:{w:"453px",h:"336px",l:"-1px",t:"-677px"},pokedex:{w:"108px",h:"138px",l:"-640px",t:"-1332px"},prop:{w:"72px",h:"108px",l:"-741px",t:"-1582px"},ready:{w:"206px",h:"86px",l:"-620px",t:"-1021px"},right:{w:"99px",h:"138px",l:"-640px",t:"-1472px"},s1:{w:"178px",h:"120px",l:"-671px",t:"-1109px"},s2:{w:"178px",h:"120px",l:"-460px",t:"-1332px"},s3:{w:"178px",h:"120px",l:"-460px",t:"-1454px"},s4:{w:"178px",h:"120px",l:"-460px",t:"-1576px"},second:{w:"38px",h:"20px",l:"-802px",t:"-803px"},share:{w:"90px",h:"90px",l:"-815px",t:"-1492px"},shop:{w:"111px",h:"143px",l:"-347px",t:"-1470px"},"shop-txt":{w:"190px",h:"96px",l:"-671px",t:"-1231px"},strawberry:{w:"35px",h:"43px",l:"-944px",t:"-1368px"},table_lamp1:{w:"146px",h:"242px",l:"-684px",t:"-339px"},table_lamp2:{w:"146px",h:"242px",l:"-832px",t:"-339px"},third:{w:"38px",h:"20px",l:"-857px",t:"-1584px"},top_window:{w:"108px",h:"76px",l:"-347px",t:"-1615px"},yard:{w:"111px",h:"143px",l:"-864px",t:"-803px"}};_self._1h=false;_self._1j=null;_self._1k=null;_self._1l=null;_self._1m=null;_self._1n=null;_self._1o=null;_self._1p=null;_self._1q=null;_self._1r=null;_self._1s=null;_self._1t=null;_self._1u=null;_self._1v=null;_self._1w=null;_self._1x=null;_self._1y=null;_self._1z=null;_self._2a=null;_self._2b=null;_self._2c=null;_self._2d=null;_self._2e=null;_self._2f=null;_self._2g=[];_self._2h=null;_self._2j=-1;_self._2k=null;_self._2l=null;_self._2m=null;_self._2n=null;_self._2o=0;_self._2p=null;_self._2q=null;_self._2r=null;_self._2s=null;_self._2t=null;_self._2u=0;_self._2v=null;_self._2w=null;_self._2x=0;_self._2y=0;_self._2z=null;_self.m_preparebagScreen=null;_self.m_prepareTableScreen=null;_self.m_QuitDiv=null;_self.m_nInWhere=0;_self.m_nChangeInRoomStataTime=0;_self.m_nStataInRoom=0;_self.m_cloneGoods=null;_self.m_pPlayerdata=null;_self.ZN_NeedQueryFriends=[];_self.NeedQueryFriends=null;_self.m_GameData={travel:0,data:{tstata:0,money:0,goods:[],bag:[],table:[]},mailid:1,photoid:1};_self.m_nLastQueryMailTS=0;_self.m_bMailScorllMore=false;_self.m_nLastQueryPhotoTS=0;_self.m_bPhotoScorllMore=false;_self.m_GoodsInShopping=null;_self.m_NeedQueryFriend=null;_self.m_version=5;_self.m_strDivHtml="<div style='position: absolute;overflow:hidden;float:left;background-color: #F7E0AC;-moz-user-select: none;-webkit-user-select: none;-o-user-select: none;user-select: none;'>                                <div name='gamecanvas' style='position: absolute;font-size:12px;overflow:hidden;display:none;'>                                    <div name='yard-screen' style='position:absolute;left:0px;'>                                        <div name='yard-mail-box' style='position:absolute;'></div>                                        <div name='yard-kettle' style='position:absolute;'></div>                                        <div name='yg-0' style='position:absolute;'></div>                                        <div name='yg-1' style='position:absolute;'></div>                                        <div name='yg-2' style='position:absolute;'></div>                                        <div name='yg-3' style='position:absolute;'></div>                                        <div name='yg-4' style='position:absolute;'></div>                                        <div name='yg-5' style='position:absolute;'></div>                                        <div name='yg-6' style='position:absolute;'></div>                                        <div name='yg-7' style='position:absolute;'></div>                                        <div name='yg-8' style='position:absolute;'></div>                                        <div name='dark-mask' style='position:absolute;display:none;'></div>                                        <div name='yard-gift' style='position:absolute;display:none;'></div>                                        <div name='yard-site' style='position:absolute;display:none;'></div>                                        <div name='yard-door' style='position:absolute;'></div>                                        <div name='yard-window' style='position:absolute;'></div>                                        <div name='yard-lantern' style='position:absolute;'></div>                                        <div name='yard-lantern-night' style='position:absolute;'></div>                                        <div name='yard-mail-box-pop' style='position:absolute;opacity:0.75;position:absolute;display:none;'></div>                                    </div>                                    <div name='room-screen' style='position:absolute;left:0px;display:none;'>                                        <div name='room-paper' style='position:absolute;display:none;'></div>                                        <div name='room-cup' style='position:absolute;display:none;'></div>                                        <div name='room-clothes' style='position:absolute;display:none;'></div>                                        <div style='position:absolute;display:none;' name='room-site'></div>                                        <div style='position:absolute;display:none;' name='room-desk'></div>                                        <div style='position:absolute;display:none;' name='room-writeletter'></div>                                        <div style='position:absolute;display:none;' name='room-sleep'></div>                                        <div style='position:absolute;display:none;' name='room-readbook'></div>                                        <div style='position:absolute;display:none;' name='room-cooking'></div>                                        <div style='position:absolute;display:none;' name='room-cellphone'></div>                                        <div style='position:absolute;display:none;' name='room-lunch'></div>                                        <div style='position:absolute;display:none;' name='room-lamp'></div>                                        <div style='position:absolute;' name='room-lamp-night'></div>                                    </div>                                    <div name='ranking-div' style='position:absolute;opacity:0.75;top:50%;left:0;text-align: center;font-size:34px;color:#795442;display:none;'>                                        <div style='background-color:#795643;color:#F7E0AC;width:200px;border-radius:20px 20px 0 0;margin: 0 auto;'>æ&nbsp;&nbsp;å</div>                                        <div style='border:#795643 2px solid;width:240px;height:775px;border-radius: 20px;background-color:#FEC305'>                                            <div name='ranking-content' style='background-color:#F5E7B8;height:650px;width:205px;border-radius: 20px;margin: 20px auto;overflow: hidden;'>                                                <div name='ranking-myself' style='height:195px;'>                                                    <div name='ranking-avatar' style='width:145px;height:145px;border-radius:25%;border:4px solid #D5AA66;margin:20px auto 2px;'></div>                                                    <div style='margin-top:-160px;margin-left: 10px;width: 55px;position: absolute;'>                                                        <div style='width:50px;height:50px;display:inline-block;background-color:#EBB234;border-radius:50%'>M</div>                                                        <div name='ranking-icon-no1' style='position:relative;top:-32px;display:inline-block'></div>                                                    </div>                                                    <div name='ranking-name' style='word-break:break-all;white-space: nowrap;margin: 0 auto;max-width: 150px;color:#A27F61'></div>                                                </div>                                            </div>                                            <div style='background-color:#00ADAC;border-radius: 20px;margin: 20px auto;width:200px;color:white'>å¨é¨æå</div>                                        </div>                                    </div>                                </div>                                <div name='shopping-screen-div' style='position: absolute;overflow: hidden;display:none;'>                                    <div name='shopping-screen-title' style='position:absolute'>                                        <div name='shopping-screen-title-tip' style='position:absolute;'></div>                                    </div>                                    <div style='position:absolute;' name='shopping-screen-draw-btn'></div>                                    <div name='shopping-screen-content' style='position:absolute'>                                        <div name='shopping-screen-counter'>                                            <div></div>                                            <div></div>                                        </div>                                        <div name='shopping-screen-item-resume' style='word-break:break-all;text-overflow:ellipsis;'></div>                                    </div>                                    <div name='shopping-screen-goods' style='position:absolute'>                                    </div>                                    <div name='shopping-screen-pagepre' style='display:none;'></div>                                    <div name='shopping-screen-pagenext' style='display:none;'></div>                                </div>                                <div style='position:absolute;display:none;' name='enter-room-btn'></div>                                <div style='position:absolute;display:none;' name='enter-yard-btn'></div>                                <div style='position:absolute;display:none;' name='backyard-btn'></div>                                <div style='position:absolute;display:none;' name='shop-btn'></div>                                <div style='position:absolute;display:none;' name='prepare-btn'></div>                                <div name='iconograph-screen-div' style='position:absolute;font-weight:bold;text-align:center;display:none;'>                                    <div name='iconograph-screen-title' style='margin:0 auto'>å¾é´</div>                                    <div name='iconograph-screen-content-box'>                                        <div name='iconograph-screen-nav'>                                            <div name='iconographtab' data-index=0 style='background-color:#92684F'>&nbsp;é£&nbsp;&nbsp;è°±&nbsp;</div>                                            <div name='iconographtab' data-index=1 style='background-color:#92684F'>&nbsp;é£&nbsp;&nbsp;æ¯&nbsp;</div>                                            <div name='iconographtab' data-index=2 style='background-color:#92684F'>&nbsp;ç¹&nbsp;&nbsp;äº§&nbsp;</div>                                        </div>                                        <div name='iconograph-screen-content'>                                            <div class='scroller-hidden'>                                            </div>                                        </div>                                    </div>                                    <div name='iconograph-screen-close-btn'><i class='fa fa-times'></i></div>                                    <div name='iconograph-detaile' style='display:none;position: absolute;'></div>                                </div>                                <div name='collection-screen-div' style='position:absolute;font-weight:bold;text-align:center;display:none;'>                                    <div name='collection-screen-content-box'>                                        <div name='collection-screen-content' style='background-color: #F5E7B8;overflow: hidden;'>                                            <div name='pic-btn' style='display:inline-block;border:4px #795642 solid;border-radius:10%;padding:20px 60px;margin:117px 20px;background-color:#F6D3CD;box-shadow: 10px 10px 10px rgba(0, 0, 0,0.5);-moz-box-shadow: 10px 10px 10px rgba(0, 0, 0,0.5);-webkit-box-shadow: 10px 10px 10px rgba(0, 0, 0,0.5);'></div>                                            <div name='photo-btn' style='display:inline-block;border:4px #795642 solid;border-radius:10%;padding:20px 60px;margin:117px 20px;background-color:#FAEA99;box-shadow: 10px 10px 10px rgba(0, 0, 0,0.5);-moz-box-shadow: 10px 10px 10px rgba(0, 0, 0,0.5);-webkit-box-shadow: 10px 10px 10px rgba(0, 0, 0,0.5);'></div>                                            <div name='calendar-btn' style='display:inline-block;border:4px #795642 solid;border-radius:10%;padding:20px 60px;margin:117px 20px;background-color:#C1D1D9box-shadow: 10px 10px 10px rgba(0, 0, 0,0.5);-moz-box-shadow: 10px 10px 10px rgba(0, 0, 0,0.5);-webkit-box-shadow: 10px 10px 10px rgba(0, 0, 0,0.5);'></div>                                        </div>                                    </div>                                    <div name='collection-screen-close-btn'><i class='fa fa-times'></i></div>                                </div>                                <div name='preparebag-screen-div' style='position:absolute;font-weight:bold;text-align:center;display:none'>                                    <div name='preparebag-screen-title' style='margin:0 auto'>è¡å</div>                                    <div name='preparebag-screen-content-box'>                                        <div name='preparebag-screen-content'>                                            <div style='overflow: auto;'>                                                <div style='float:left;width:50%;'>                                                    <div>é£ç©</div>                                                    <div name='preparebag-item' data-type=0 data-item=0 style='box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-moz-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-webkit-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);'></div>                                                </div>                                                <div style='float:right;width:50%;'>                                                    <div>ç¨å</div>                                                    <div name='preparebag-item' data-type=1 data-item=0 style='box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-moz-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-webkit-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);'></div>                                                </div>                                            </div>                                            <div style='margin: 10px 0;'>                                                <div>è£å¤</div>                                                <div name='preparebag-item' data-type=2 data-item=0 style='box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-moz-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-webkit-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);'></div>                                                <div name='preparebag-item' data-type=2 data-item=0 style='box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-moz-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-webkit-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);'></div>                                            </div>                                        </div>                                        <div name='preparebag-screen-confirm' class='button button-raised button-royal button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>ç¡®&nbsp;&nbsp;&nbsp;&nbsp;è®¤</div>                                    </div>                                    <div name='preparebag-screen-close-btn'><i class='fa fa-times'></i></div>                                </div>                                <div name='preparetable-screen-div' style='position:absolute;font-weight:bold;text-align:center;display:none;'>                                    <div name='preparetable-screen-title' style='margin:0 auto'>æ¡å­</div>                                    <div name='preparetable-screen-content-box'>                                        <div name='preparetable-screen-content'>                                            <div style='overflow: auto;'>                                                <div style='float:left;width:50%;'>                                                    <div>é£ç©</div>                                                    <div name='preparetable-item' data-type=0 data-item=0 style='box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-moz-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-webkit-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);'></div>                                                    <div name='preparetable-item' data-type=0 data-item=0 style='box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-moz-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-webkit-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);'></div>                                                </div>                                                <div style='float:right;width:50%;'>                                                    <div>ç¨å</div>                                                    <div name='preparetable-item' data-type=1 data-item=0 style='box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-moz-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-webkit-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);'></div>                                                    <div name='preparetable-item' data-type=1 data-item=0 style='box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-moz-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-webkit-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);'></div>                                                </div>                                            </div>                                            <div style='margin: 10px 0;'>                                                <div>è£å¤</div>                                                <div name='preparetable-item' data-type=2 data-item=0 style='box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-moz-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-webkit-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);'></div>                                                <div name='preparetable-item' data-type=2 data-item=0 style='box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-moz-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-webkit-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);'></div>                                                <div name='preparetable-item' data-type=2 data-item=0 style='box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-moz-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-webkit-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);'></div>                                                <div name='preparetable-item' data-type=2 data-item=0 style='box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-moz-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);-webkit-box-shadow: 2px 2px 2px rgba(0, 0, 0,0.5);'></div>                                            </div>                                        </div>                                        <div name='preparetable-screen-confirm' class='button button-raised button-royal button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>ç¡®&nbsp;&nbsp;&nbsp;&nbsp;è®¤</div>                                    </div>                                    <div name='preparetable-screen-close-btn'><i class='fa fa-times'></i></div>                                </div>                                <div name='goods-screen-div' style='position:absolute;font-weight:bold;text-align:center;display:none;'>                                    <div name='goods-screen-title' style='margin:0 auto'>éå·</div>                                    <div name='goods-screen-content-box'>                                        <div name='goods-screen-nav'>                                            <div name='goodstab' data-index=0>é£ç©</div>                                            <div name='goodstab' data-index=1>ç¨å</div>                                            <div name='goodstab' data-index=2>è£å¤</div>                                            <div name='goodstab' data-index=3>ç¹äº§</div>                                            <div name='goodstab' data-index=4>é£æ</div>                                        </div>                                        <div name='goods-screen-content'>                                            <div class='scroller-hidden'>                                            </div>                                        </div>                                    </div>                                    <div name='goods-screen-close-btn'><i class='fa fa-times'></i></div>                                </div>                                <div name='ranking-screen-div' style='position:absolute;font-weight:bold;text-align:center;display:none;'>                                    <div name='rankings-screen-title' style='margin:0 auto'>æ&nbsp;&nbsp;å</div>                                    <div name='ranking-screen-content-box'>                                        <div name='ranking-screen-content' style='background-color: #F5E7B8;overflow: hidden;border-radius: 6px;height:100%;position: relative;'>                                            <div class='scroller-hidden'>                                                <div name='ranking-screen-self'>                                                    <div style='width:100%;overflow: auto;padding: 5px 0;'>                                                        <div name='rsi-img' style='float:left;width: 50px;height: 50px;border-radius: 25%;margin-left: 5px;'></div>                                                        <div style='float:left;text-align: left;margin: 0 10px;'>                                                            <div name='rsi-name' style='font-size: 14px;'></div>                                                            <div style='font-size: 13px;font-weight: normal;text-align: left;overflow: hidden;color: #286add;'>ç¹å»å¯ä¿®æ¹å¤´å</div>                                                        </div>                                                    </div>                                                </div>                                                <div name='ranking-screen-welcome' style='max-height: 28px;text-align: left;font-size: 13px;margin: 5px 10px;padding: 5px;background-color:#FFFDF1;border-radius: 5px;font-weight: normal;word-break: break-all;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;'>æ¨èå¥½åï¼æ´å¤æºä¼è®¤è¯å¶ä»æè¡æ±ªãä½ ä»ç¥æåªäºè¢«æ¨èçå¥½å·²ç»å å¥æ¸¸æï¼ä½ç¸äºä¸ä¼è·æå¯¹æ¹çæ¸¸æç¶æï¼é¤éæ±ªæ±ªä»¬å¨æéä¸­ç¸éç¸è¯ï¼ææå¯è½æä¸ºæåã<div style='margin-top: 10px;'>æåä¹é´çåéçæ¶æ¯ï¼å¨10~30åéåéè¾¾ï¼æä»¥ä¸ç¨å»æç­å¾å¯¹æ¹çåå¤ï¼é²ææ¶åçä¸ç¼å³å¯ã</div><div style='margin-top: 10px;'>åå¸ä¼æå¾å¤æ¯ç¹ï¼è¥éæåä¹é´çç¸äºæ¨èï¼ææ¯å¾é¾æ·±å¥éå½»å¶æååºè´ã</div><div style='margin-top: 10px;font-weight: bold;text-align: center;'>ç¥åä½å¹¸ç¦å¼å¿ï¼</div></div>                                                <div name='ranking-screen-wi' data-url='s1' style='background-color: #FFFDF1; border: 2px solid rgb(121, 85, 69); border-radius: 10px; margin: 5px auto; width: 85%;font-size: 16px;color: #de21e3;'>ä»å¹´è¯å®ä¼è±å<span style='color:#f00;font-size:12px;'>ãèã</span></div>                                                <div name='ranking-screen-wi' data-url='s2' style='background-color: #FFFDF1; border: 2px solid rgb(121, 85, 69); border-radius: 10px; margin: 5px auto; width: 85%;font-size: 16px;color: #de21e3;'>èå°ä¸è¦ä¸è¦ç<span style='color:#f00;font-size:12px;'>ãèã</span></div>                                                <div name='ranking-screen-friend'></div>                                            </div>                                        </div>                                    </div>                                    <div name='ranking-screen-bottom-bar' style='color:#986A50'></div>                                    <div name='ranking-screen-close-btn'><i class='fa fa-times'></i></div>                                </div>                                <div name='help-screen-div' style='position:absolute;font-weight:bold;text-align:center;display:none;'>                                    <div name='help-screen-title' style='margin:0 auto'>å¸®å©</div>                                    <div name='help-screen-content-box'>                                        <div name='help-screen-content' style='background-color: #F5E7B8;overflow: hidden;border-radius: 6px;height:100%;position: relative;'>                                            <div class='scroller-hidden'>                                                <div name='help-screen-loading' style='text-align: center;color: #666;font-size: 14px;'><i class='fa fa-spinner fa-pulse'></i><p name='tipmsg' style='font-size: 14px;font-weight: normal;'>æ­£å¨è·åå¸®å©</p></div>                                            </div>                                        </div>                                    </div>                                    <div name='help-screen-close-btn'><i class='fa fa-times'></i></div>                                </div>                                <div name='mailbox-screen-div' style='position:absolute;font-weight:bold;text-align:center;display:none;'>                                    <div name='mailbox-screen-title' style='margin:0 auto'>é®ä»¶</div>                                    <div name='mailbox-screen-content-box'>                                        <div name='mailbox-screen-content' style='background-color: #F5E7B8;overflow: hidden;border-radius: 6px;height:100%;position: relative;'>                                            <div class='scroller-hidden'>                                                <div name='mailbox-screen-loading' style='text-align: center;color: #666;font-size: 14px;'><i class='fa fa-spinner fa-pulse'></i><p name='tipmsg' style='font-size: 14px;font-weight: normal;'>æ­£å¨è·åé®ä»¶</p></div>                                            </div>                                        </div>                                    </div>                                    <div name='mailbox-screen-close-btn'><i class='fa fa-times'></i></div>                                </div>                                <div name='calendar-screen-div' style='position:absolute;font-weight:bold;text-align:center;display:none;'>                                    <div name='calendar-screen-title' style='margin:0 auto'>æ¥è®°</div>                                    <div name='calendar-screen-content-box'>                                        <div name='calendar-screen-content' style='background-color: #F5E7B8;overflow: hidden;border-radius: 6px;height:100%;position: relative;'>                                            <div class='scroller-hidden'>                                                <div name='calendar-screen-loading' style='text-align: center;color: #666;font-size: 14px;'><i class='fa fa-spinner fa-pulse'></i><p name='tipmsg' style='font-size: 14px;font-weight: normal;'>æ­£å¨è·åæ¥è®°</p></div>                                            </div>                                        </div>                                    </div>                                    <div name='calendar-screen-close-btn'><i class='fa fa-times'></i></div>                                </div>                                <div name='photo-screen-div' style='position:absolute;font-weight:bold;text-align:center;display:none;'>                                    <div name='photo-screen-title' style='margin:0 auto'>ç¸å</div>                                    <div name='photo-screen-content-box'>                                        <div name='photo-screen-content' style='background-color: #F5E7B8;overflow: hidden;border-radius: 6px;height:100%;position: relative;'>                                            <div class='scroller-hidden'>                                                <div name='photobox-screen-loading' style='text-align: center;color: #666;font-size: 14px;'><i class='fa fa-spinner fa-pulse'></i><p name='tipmsg' style='font-size: 14px;font-weight: normal;'>æ­£å¨è·åç§ç</p></div>                                            </div>                                        </div>                                    </div>                                    <div name='photo-screen-close-btn'><i class='fa fa-times'></i></div>                                </div>                                <div name='my-money-div' style='position:absolute;display:none;'>                                    <div name='scoreNum'></div>                                </div>                                <div style='position:absolute;display:none;' name='recharge-btn'></div>                                <div style='position:absolute;display:none;' name='help-btn'></div>                                <div style='position:absolute;display:none;' name='collection-btn'></div>                                <div style='position:absolute;display:none;' name='mybag-btn'></div>                                <div name='dialog-message-div' style='display:none;position: absolute;'><div name='dialog-content'></div></div>                                <div name='confirmdialog-message-div' style='display:none;position: absolute;text-align: center;font-size: 16px;'><div name='confirmdialog-content'></div></div>                                <div name='toptip-msg-div' style='position:absolute;text-align:center;display:none;'>                                    <div style='max-width:80%;font-size: 14px;font-weight: bold;line-height:26px;color:#fff;display: inline-block;background: rgba(0,0,0,0.3);padding: 2px 20px;border-radius:0 0 10px 10px;'><div name='toptip-msg'></div>                                    </div>                                </div>                                <div name='exitbtn' class='button button-raised button-royal button-circle' style='display:none;position: absolute;opacity: 0.75;bottom: 10px;'><i class='fa fa-rotate-left'></i>                                </div>                                <div name='register-div' style='display:none;position: absolute;'><div name='register-content'></div></div>                                <div name='modify-div' style='display:none;position: absolute;'><div name='modify-content'></div></div>                                <div name='endgame-div' style='text-align: center;position: absolute;background-color: rgba(0,0,0,0.5);display:none;'>                                    <div name='endgame-tip' style='overflow:auto;margin:20px auto;font-size: 16px;color:#fff;'>                                    </div>                                    <div style='overflow:auto;margin:20px auto;'>                                        <div name='endgame_yes_btn' class='button button-raised button-caution button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>é&nbsp;&nbsp;&nbsp;&nbsp;åº</div>                                        <div name='endgame_cancel_btn' class='button button-raised button-royal button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>å&nbsp;&nbsp;&nbsp;&nbsp;æ¶</div>                                    </div>                                </div>                                <div name='loading-div' style='text-align: center;font-size: 18px;color: #fff;position: absolute;'>                                    <div style='overflow:auto;margin:0 auto;background-color: rgba(0,0,0,0.4);border-radius: 5px;padding: 5px 10px;display:inline-block'><i class='fa fa-spinner fa-pulse'></i>&nbsp;&nbsp;<span name='loading-msg'>æ­£å¨è£è½½èµæºâ¦</span></div>                                </div>                            </div>";
_self._f1a=function(filename,w,h){var _scale=g_ClientHeight/1920;var _subNode=$("<div></div>");_subNode.css({"background-image":"url("+"data/dog/"+filename+".gif)","background-size":"100% 100%",width:w*_scale,height:h*_scale});return _subNode};_self._f1b=function(point){var srcimg=_self._1g[point];var _subNode=$("<div></div>");_subNode.css({background:"url("+_self._1f[2]+") no-repeat scroll "+srcimg.l+" "+srcimg.t,width:srcimg.w,height:srcimg.h});return _subNode};_self.onSizeChange=function(offsetWidth,clientHeight){var _sfm=$("#screen_main");var _scale=clientHeight/1920,_css,_div,_childrens,i,subWidth=0;if(_self._1a!=null){subWidth=_self._1a.getNumsScreen()*offsetWidth}_self._3=_sfm.width()-offsetWidth-subWidth;_sfm.height(clientHeight);_self._6.find("[name='loading-div']").css({width:offsetWidth,top:clientHeight/2-25});_self._6.find("[name='exitbtn']").css({left:_self._3+10});_self._6.find("[name='endgame-div']").css({width:offsetWidth,top:clientHeight/2-85});_self._6.find("[name='toptip-msg-div']").css({height:30,width:offsetWidth,top:0});_self._6.css({width:offsetWidth,height:clientHeight});_self._6.find("[name='gamecanvas']").css({width:offsetWidth,height:clientHeight});_self._6.find("[name='yard-screen']").css({height:clientHeight,width:_scale*2160});_self._6.find("[name='room-screen']").css({height:clientHeight,width:_scale*1480});_div=_self._6.find("[name='dialog-message-div']");_div.css({width:offsetWidth,height:clientHeight});_div=_div.find("[name='dialog-content']");_div.css({top:(clientHeight-_div.height())/2,left:(offsetWidth-offsetWidth*.85)/2});_div=_self._6.find("[name='register-div']");_div.css({width:offsetWidth,height:clientHeight});_div=_div.find("[name='register-content']");_div.css({top:(clientHeight-_div.height())/2,left:(offsetWidth-offsetWidth*.9)/2});_div=_self._6.find("[name='modify-div']");_div.css({width:offsetWidth,height:clientHeight});_div=_div.find("[name='modify-content']");_div.css({top:"18px",left:(offsetWidth-offsetWidth*.9)/2});_div=_self._6.find("[name='confirmdialog-message-div']");_div.css({width:offsetWidth,height:clientHeight});_div=_div.find("[name='confirmdialog-content']");_div.css({top:(clientHeight-_div.height())/2,left:(offsetWidth-offsetWidth*.75)/2});{_self._6.find("[name='room-paper']").css({transform:"scale("+_scale+")","-o-transform":"scale("+_scale+")","-webkit-transform":"scale("+_scale+")","-moz-transform":"scale("+_scale+")","transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b,top:568*_scale,left:490*_scale});_self._6.find("[name='room-cup']").css({transform:"scale("+_scale+")","-o-transform":"scale("+_scale+")","-webkit-transform":"scale("+_scale+")","-moz-transform":"scale("+_scale+")","transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b,top:1260*_scale,left:720*_scale});_self._6.find("[name='room-clothes']").css({transform:"scale("+_scale+")","-o-transform":"scale("+_scale+")","-webkit-transform":"scale("+_scale+")","-moz-transform":"scale("+_scale+")","transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b,top:656*_scale,left:660*_scale});_css={transform:"scale("+_scale+")","-o-transform":"scale("+_scale+")","-webkit-transform":"scale("+_scale+")","-moz-transform":"scale("+_scale+")","transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b,top:879*_scale,left:454*_scale};_self._6.find("[name='room-lamp']").css(_css);_self._6.find("[name='room-lamp-night']").css(_css);_self._6.find("[name='yard-gift']").css({transform:"scale("+_scale+")","-o-transform":"scale("+_scale+")","-webkit-transform":"scale("+_scale+")","-moz-transform":"scale("+_scale+")","transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b,top:992*_scale,left:634*_scale});_self._6.find("[name='yard-site']").css({width:222*_scale,top:954*_scale,left:410*_scale});_self._6.find("[name='room-site']").css({width:240*_scale,top:1290*_scale,left:586*_scale});_self._6.find("[name='room-desk']").css({width:228*_scale,top:308*_scale,left:530*_scale});_self._6.find("[name='room-writeletter']").css({width:166*_scale,top:344*_scale,left:606*_scale});_self._6.find("[name='room-sleep']").css({width:321*_scale,top:403*_scale,left:865*_scale});_self._6.find("[name='room-readbook']").css({width:172*_scale,top:347*_scale,left:968*_scale});_self._6.find("[name='room-cooking']").css({width:224*_scale,top:870*_scale,left:955*_scale});_self._6.find("[name='room-cellphone']").css({width:164*_scale,top:1122*_scale,left:500*_scale});_self._6.find("[name='room-lunch']").css({width:178*_scale,top:1110*_scale,left:493*_scale})}var _strScale="scale("+_scale+")";_css={"background-color":"#F7E0AC",height:80,width:300,"border-radius":10,top:5,left:_self._3+5,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b};if(_self._2u!=0){_css.left="";_css.top+=_self._2u;_css["transform-origin"]=_self._1c;_css["-o-transform-origin"]=_self._1c;_css["-webkit-transform-origin"]=_self._1c;_css["-moz-transform-origin"]=_self._1c}_self._6.find("[name='my-money-div']").css(_css);_self._6.find("[name='scoreNum']").css({"text-align":"right",position:"absolute",width:"90%",height:45,top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)","-o-transform":"translateX(-50%) translateY(-50%)","-webkit-transform":"translateX(-50%) translateY(-50%)","-moz-transform":"translateX(-50%) translateY(-50%)","white-space":"nowrap"});_css={"background-color":"#F7E0AC",height:80,width:80,"border-radius":10,top:5,left:_self._3+310*_scale+5,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b};if(_self._2u!=0){_css.left="";_css.top+=_self._2u;_css["transform-origin"]=_self._1c;_css["-o-transform-origin"]=_self._1c;_css["-webkit-transform-origin"]=_self._1c;_css["-moz-transform-origin"]=_self._1c}_self._6.find("[name='recharge-btn']").css(_css);_css={"background-color":"#F7E0AC",border:"5px solid #775742",height:140,width:140,"border-radius":20,top:5,right:5,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1c,"-o-transform-origin":_self._1c,"-webkit-transform-origin":_self._1c,"-moz-transform-origin":_self._1c};_self._6.find("[name='help-btn']").css(_css);_css.top=10;_css.right=20;_css.height=150;_css.width=150;_self._6.find("[name='shopping-screen-draw-btn']").css(_css);_self._6.find("[name='collection-btn']").css({"background-color":"#F7E0AC",border:"5px solid #775742",height:140,width:140,"border-radius":20,top:5,right:280*_scale+15,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1c,"-o-transform-origin":_self._1c,"-webkit-transform-origin":_self._1c,"-moz-transform-origin":_self._1c});_self._6.find("[name='mybag-btn']").css({"background-color":"#F7E0AC",border:"5px solid #775742",height:140,width:140,"border-radius":20,top:5,right:140*_scale+10,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1c,"-o-transform-origin":_self._1c,"-webkit-transform-origin":_self._1c,"-moz-transform-origin":_self._1c});_css={"background-color":"#F7E0AC",border:"5px solid #775742",height:180,width:180,"border-radius":25,bottom:5,right:5,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1d,"-o-transform-origin":_self._1d,"-webkit-transform-origin":_self._1d,"-moz-transform-origin":_self._1d};_self._6.find("[name='enter-room-btn']").css(_css);_self._6.find("[name='enter-yard-btn']").css(_css);_css={"background-color":"#F7E0AC",border:"5px solid #775742",height:180,width:180,"border-radius":25,bottom:180*_scale+10,right:5,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1d,"-o-transform-origin":_self._1d,"-webkit-transform-origin":_self._1d,"-moz-transform-origin":_self._1d};_self._6.find("[name='shop-btn']").css(_css);_self._6.find("[name='backyard-btn']").css(_css);_self._6.find("[name='prepare-btn']").css({"background-color":"#F7E0AC",border:"5px solid #775742",height:140,width:300,"border-radius":25,bottom:30*_scale,left:_self._3+30*_scale,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":"left bottom","-o-transform-origin":"left bottom","-webkit-transform-origin":"left bottom","-moz-transform-origin":"left bottom"});_self._6.find("[name='ranking-div']").css({transform:"scale("+_scale+") translate(0%,-50%)","-o-transform":"scale("+_scale+") translate(0%,-50%)","-webkit-transform":"scale("+_scale+") translate(0%,-50%)","-moz-transform":"scale("+_scale+") translate(0%,-50%)","transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yard-mail-box']").css({top:clientHeight*.31,left:clientHeight*.45,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yard-mail-box-pop']").css({top:clientHeight*.27,left:clientHeight*.5,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yard-kettle']").css({top:clientHeight*.5,left:clientHeight*.6,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yard-door']").css({top:clientHeight*.3368,left:clientHeight*.191,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yard-window']").css({top:0,left:clientHeight*.204,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_css={top:clientHeight*.244,left:clientHeight*.262,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b};_self._6.find("[name='yard-lantern']").css(_css);_self._6.find("[name='yard-lantern-night']").css(_css);_self._6.find("[name='dark-mask']").css({height:clientHeight,width:_scale*2160,left:0,top:0,"background-color":"rgba(0,0,0,0.5)"});_self._6.find("[name='yg-0']").css({top:clientHeight*.289,left:clientHeight*.73,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yg-1']").css({top:clientHeight*.331,left:clientHeight*.631,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yg-2']").css({top:clientHeight*.375,left:clientHeight*.529,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yg-3']").css({top:clientHeight*.34,left:clientHeight*.823,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yg-4']").css({top:clientHeight*.38,left:clientHeight*.724,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yg-5']").css({top:clientHeight*.424,left:clientHeight*.628,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yg-6']").css({top:clientHeight*.391,left:clientHeight*.919,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yg-7']").css({top:clientHeight*.433,left:clientHeight*.823,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._6.find("[name='yg-8']").css({top:clientHeight*.478,left:clientHeight*.721,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});{_self._2s.css({top:0,left:_self._3,height:clientHeight,width:offsetWidth});_self._2s.find("[name='shopping-screen-title']").css({top:0,left:0,height:210,width:offsetWidth/_scale,transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._2s.find("[name='shopping-screen-title-tip']").css({top:50,left:60});_self._2s.find("[name='shopping-screen-content']").css({top:210*_scale,height:clientHeight/_scale-210,width:offsetWidth/_scale,color:"#966650","background-color":"#D9EEED",transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b,overflow:"hidden"});_self._2s.find("[name='shopping-screen-pagepre']").css({position:"absolute",transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b,top:570*_scale,left:10*_scale});_self._2s.find("[name='shopping-screen-pagenext']").css({position:"absolute",transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,"transform-origin":_self._1c,"-o-transform-origin":_self._1c,"-webkit-transform-origin":_self._1c,"-moz-transform-origin":_self._1c,top:570*_scale,right:10*_scale});_div=_self._2s.find("[name='shopping-screen-counter']");_childrens=_div.children("div");for(i=0;i<_childrens.length;i++){$(_childrens[i]).css({width:offsetWidth/_scale,height:400,"margin-top":50})}_self._2s.find("[name='shopping-screen-goods']").css({top:210*_scale,height:900*_scale,width:offsetWidth,overflow:"hidden"});_self._2s.find("[name='shopping-screen-item-resume']").css({position:"absolute",width:offsetWidth*3/5/_scale,height:offsetWidth*3/5/_scale/2,bottom:80,left:50,"border-radius":20,"background-color":"#FFFCF1",border:"3px solid #BC956C","font-size":46,"font-weight":"bold",padding:"10px 20px",overflow:"hidden"})}{_self._6.find("[name='rankings-screen-title']").css({height:95*_scale,width:888*_scale,"border-radius":20*_scale+"px "+20*_scale+"px 0px 0px","background-color":"#795643","font-size":65*_scale,color:"#FBD7A0"});_self._6.find("[name='ranking-screen-close-btn']").css({height:110*_scale,width:110*_scale,"border-radius":20*_scale,"background-color":"#E76624",color:"#fff",position:"absolute","margin-top":-100*_scale,right:(950-888)/2*_scale,top:95*_scale,"font-size":70*_scale});_self._6.find("[name='ranking-screen-bottom-bar']").css({width:925*_scale,"border-radius":20*_scale,"background-color":"#EAC04D",border:"solid 2px #795643","font-size":36*_scale,margin:"0 auto","text-align":"left",padding:"0 10px"});_self._6.find("[name='ranking-screen-content-box']").css({width:950*_scale,height:1152*_scale,"border-radius":20*_scale,"background-color":"#FEC305",border:"solid 1px #795643",opacity:.9,padding:"10px 5px",color:"#795643",overflow:"hidden"});_self._1j.css({top:(clientHeight-_self._1j.height())/2,left:_self._3+(offsetWidth-_self._1j.width())/2})}{_self._6.find("[name='help-screen-title']").css({height:95*_scale,width:888*_scale,"border-radius":20*_scale+"px "+20*_scale+"px 0px 0px","background-color":"#795643","font-size":65*_scale,color:"#FBD7A0"});_self._6.find("[name='help-screen-close-btn']").css({height:110*_scale,width:110*_scale,"border-radius":20*_scale,"background-color":"#E76624",color:"#fff",position:"absolute","margin-top":-100*_scale,right:(1e3-888)/2*_scale,top:95*_scale,"font-size":70*_scale});_self._6.find("[name='help-screen-content-box']").css({width:1e3*_scale,height:1152*_scale,"border-radius":20*_scale,"background-color":"#FEC305",border:"solid 1px #795643",opacity:.9,padding:"10px 5px",color:"#795643",overflow:"hidden"});_self._1n.css({top:(clientHeight-_self._1n.height())/2,left:_self._3+(offsetWidth-_self._1n.width())/2})}{_self._1s.find("[name='mailbox-screen-title']").css({height:95*_scale,width:888*_scale,"border-radius":20*_scale+"px "+20*_scale+"px 0px 0px","background-color":"#795643","font-size":65*_scale,color:"#FBD7A0"});_self._1s.find("[name='mailbox-screen-close-btn']").css({height:110*_scale,width:110*_scale,"border-radius":20*_scale,"background-color":"#E76624",color:"#fff",position:"absolute","margin-top":-100*_scale,right:(1e3-888)/2*_scale,top:95*_scale,"font-size":70*_scale});_self._1s.find("[name='mailbox-screen-content-box']").css({width:1e3*_scale,height:1152*_scale,"border-radius":20*_scale,"background-color":"#FEC305",border:"solid 1px #795643",opacity:.9,padding:"10px 5px",color:"#795643",overflow:"hidden"});_self._1s.find("[name='mailitem-resume']").css({width:1e3*_scale-50-50});_self._1s.css({top:(clientHeight-_self._1s.height())/2,left:_self._3+(offsetWidth-_self._1s.width())/2})}{_self._1x.find("[name='calendar-screen-title']").css({height:95*_scale,width:888*_scale,"border-radius":20*_scale+"px "+20*_scale+"px 0px 0px","background-color":"#795643","font-size":65*_scale,color:"#FBD7A0"});_self._1x.find("[name='calendar-screen-close-btn']").css({height:110*_scale,width:110*_scale,"border-radius":20*_scale,"background-color":"#E76624",color:"#fff",position:"absolute","margin-top":-100*_scale,right:(1e3-888)/2*_scale,top:95*_scale,"font-size":70*_scale});_self._1x.find("[name='calendar-screen-content-box']").css({width:1e3*_scale,height:1152*_scale,"border-radius":20*_scale,"background-color":"#FEC305",border:"solid 1px #795643",opacity:.9,padding:"10px 5px",color:"#795643",overflow:"hidden"});_self._1x.css({top:(clientHeight-_self._1x.height())/2,left:_self._3+(offsetWidth-_self._1x.width())/2})}{_self._6.find("[name='photo-screen-title']").css({height:95*_scale,width:888*_scale,"border-radius":20*_scale+"px "+20*_scale+"px 0px 0px","background-color":"#795643","font-size":65*_scale,color:"#FBD7A0"});_self._6.find("[name='photo-screen-close-btn']").css({height:110*_scale,width:110*_scale,"border-radius":20*_scale,"background-color":"#E76624",color:"#fff",position:"absolute","margin-top":-100*_scale,right:(1e3-888)/2*_scale,top:95*_scale,"font-size":70*_scale});_self._6.find("[name='photo-screen-content-box']").css({width:1e3*_scale,height:1152*_scale,"border-radius":20*_scale,"background-color":"#FEC305",border:"solid 1px #795643",opacity:.9,padding:"10px 5px",color:"#795643",overflow:"hidden","text-align":"left"});_self._2b.css({top:(clientHeight-_self._2b.height())/2,left:_self._3+(offsetWidth-_self._2b.width())/2})}{_self._2v.find("[name='collection-screen-close-btn']").css({height:90*_scale,width:90*_scale,"border-radius":20*_scale,"background-color":"#E76624",color:"#fff",position:"absolute",right:0,top:-90*_scale/2,"font-size":50*_scale});_self._2v.find("[name='collection-screen-content-box']").css({"border-radius":40*_scale,opacity:.9,"background-color":"#EAC04D",padding:"10px 10px",border:"solid 2px #795643",width:1040*_scale+24,height:418*_scale+24});_self._2v.find("[name='collection-screen-content']").css({width:1040,height:418-20,"border-radius":60*_scale,transform:"scale("+_scale+")","-o-transform":"scale("+_scale+")","-webkit-transform":"scale("+_scale+")","-moz-transform":"scale("+_scale+")","transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b});_self._2v.css({top:(clientHeight-_self._2v.height())/2,left:_self._3+(offsetWidth-_self._2v.width())/2})}{_self.m_prepareTableScreen.find("[name='preparetable-screen-title']").css({height:95*_scale,width:888*_scale,"border-radius":20*_scale+"px "+20*_scale+"px 0px 0px","background-color":"#795643","font-size":65*_scale,color:"#FBD7A0"});_self.m_prepareTableScreen.find("[name='preparetable-screen-close-btn']").css({height:110*_scale,width:110*_scale,"border-radius":20*_scale,"background-color":"#E76624",color:"#fff",position:"absolute","margin-top":-100*_scale,right:(1e3-888)/2*_scale,top:95*_scale,"font-size":70*_scale});_self.m_prepareTableScreen.find("[name='preparetable-screen-content-box']").css({width:1e3*_scale,"border-radius":20*_scale,"background-color":"rgba(234, 192, 77,0.9)",padding:"5px 5px 10px 5px",border:"solid 2px #795643"});_self.m_prepareTableScreen.find("[name='preparetable-screen-content']").css({width:1e3*_scale-14,"border-radius":20*_scale,"margin-bottom":"15px","background-color":"rgba(244, 235, 204,0.65)",color:"#795643",overflow:"hidden",padding:"10px 0","font-size":15,position:"relative"});_self.m_prepareTableScreen.find("[name='preparetable-item']").css({display:"inline-block",width:150*_scale,height:150*_scale,border:"solid 1px #D3A863","border-radius":20*_scale,margin:"0 "+10*_scale+"px","background-size":"100% 100%"});_self.m_prepareTableScreen.css({top:(clientHeight-_self.m_prepareTableScreen.height())/2,left:_self._3+(offsetWidth-_self.m_prepareTableScreen.width())/2})}{_self.m_preparebagScreen.find("[name='preparebag-screen-title']").css({height:95*_scale,width:888*_scale,"border-radius":20*_scale+"px "+20*_scale+"px 0px 0px","background-color":"#795643","font-size":65*_scale,color:"#FBD7A0"});_self.m_preparebagScreen.find("[name='preparebag-screen-close-btn']").css({height:110*_scale,width:110*_scale,"border-radius":20*_scale,"background-color":"#E76624",color:"#fff",position:"absolute","margin-top":-100*_scale,right:(1e3-888)/2*_scale,top:95*_scale,"font-size":70*_scale});_self.m_preparebagScreen.find("[name='preparebag-screen-content-box']").css({width:1e3*_scale,"border-radius":20*_scale,"background-color":"rgba(234, 192, 77,0.9)",padding:"5px 5px 10px 5px",border:"solid 2px #795643"});_self.m_preparebagScreen.find("[name='preparebag-screen-content']").css({width:1e3*_scale-14,"border-radius":20*_scale,"margin-bottom":"15px","background-color":"rgba(244, 235, 204,0.65)",color:"#795643",overflow:"hidden",padding:"10px 0","font-size":15,position:"relative"});_self.m_preparebagScreen.find("[name='preparebag-item']").css({display:"inline-block",width:150*_scale,height:150*_scale,border:"solid 1px #D3A863","border-radius":20*_scale,margin:"0 "+10*_scale+"px","background-size":"100% 100%"});_self.m_preparebagScreen.css({top:(clientHeight-_self.m_preparebagScreen.height())/2,left:_self._3+(offsetWidth-_self.m_preparebagScreen.width())/2})}{_self._2h.find("[name='goods-screen-title']").css({height:95*_scale,width:888*_scale,"border-radius":20*_scale+"px "+20*_scale+"px 0px 0px","background-color":"#795643","font-size":65*_scale,color:"#FBD7A0"});_self._2h.find("[name='goods-screen-close-btn']").css({height:110*_scale,width:110*_scale,"border-radius":20*_scale,"background-color":"#E76624",color:"#fff",position:"absolute","margin-top":-100*_scale,right:(1e3-888)/2*_scale,top:95*_scale,"font-size":70*_scale});_self._2h.find("[name='goods-screen-content-box']").css({width:1e3*_scale,"border-radius":20*_scale,opacity:.9,"background-color":"#EAC04D",padding:"5px 5px 10px 5px",border:"solid 2px #795643"});_self._2h.find("[name='goods-screen-nav']").css({width:"100%",color:"#D4A763","text-align":"center"});_self._2h.find("[name='goodstab']").css({width:150*_scale,"background-color":"#92684F","border-radius":20*_scale+"px "+20*_scale+"px 0px 0px","font-size":16,display:"inline-block"});_self._2h.find("[name='goods-screen-content']").css({width:1e3*_scale-14,height:1085*_scale,"border-radius":20*_scale,"background-color":"#F4EBCC",color:"#795643",overflow:"hidden",position:"relative"});_self._2h.find("[name='item-label']").css({width:1e3*_scale-14-10,margin:"5px 5px","border-bottom":"2px dashed #EFDAAB",overflow:"hidden"});_self._2h.find("[name='items-img']").css({width:145*_scale,height:145*_scale,"border-radius":4,margin:10*_scale,border:"2px solid #D2A562","float":"left"});_self._2h.find("[name='items-content']").css({height:165*_scale,"max-width":990*_scale-14-10-165*_scale});_self._2h.css({top:(clientHeight-_self._2h.height())/2,left:_self._3+(offsetWidth-_self._2h.width())/2})}{_self._2n.find("[name='iconograph-screen-title']").css({height:95*_scale,width:888*_scale,"border-radius":20*_scale+"px "+20*_scale+"px 0px 0px","background-color":"#795643","font-size":65*_scale,color:"#FBD7A0"});_self._2n.find("[name='iconograph-screen-close-btn']").css({height:110*_scale,width:110*_scale,"border-radius":20*_scale,"background-color":"#E76624",color:"#fff",position:"absolute","margin-top":-100*_scale,right:(950-888)/2*_scale,top:95*_scale,"font-size":70*_scale});_self._2n.find("[name='iconograph-screen-content-box']").css({width:1020*_scale,"border-radius":20*_scale,opacity:.9,"background-color":"#EAC04D",padding:"5px 5px 10px 5px",border:"solid 2px #795643"});_self._2n.find("[name='iconograph-screen-nav']").css({width:"100%",color:"#D4A763","text-align":"center"});_self._2n.find("[name='iconographtab']").css({width:220*_scale,"border-radius":20*_scale+"px "+20*_scale+"px 0px 0px","font-size":16,display:"inline-block"});_self._2n.find("[name='iconograph-screen-content']").css({width:1020*_scale-14,height:1085*_scale,"border-radius":20*_scale,"background-color":"#F4EBCC",color:"#795643",overflow:"hidden",position:"relative"});_self._2n.find("[name='iconographitemimg']").css({height:(1020*_scale-14)/5-10});_self._2n.css({top:(clientHeight-_self._2n.height())/2,left:_self._3+(offsetWidth-_self._2n.width())/2});_div=_self._2n.find("[name='iconograph-detaile']");_div.css({height:clientHeight,width:offsetWidth,top:-(clientHeight-_self._2n.height())/2,left:-(offsetWidth-_self._2n.width())/2});_div=_div.find("[name='content-box']");_div.css({top:(clientHeight-_div.height())/2,left:(offsetWidth-_div.width())/2})}if(_self._1a!=null){_self._1a.onSizeChange(offsetWidth,clientHeight)}};_self.getNumsScreen=function(){return _self._1a==null?1:_self._1a.getNumsScreen()+1};_self.unbindEvent=function(){var _yardscreen=_self._6.find("[name='yard-screen']");if(g_isMobile==true){_yardscreen.off("touchstart");_yardscreen.off("touchend")}else{_yardscreen.off("mouseover");_yardscreen.off("mouseout");_yardscreen.off("mousedown");_yardscreen.off("mouseup")}_self._6.find("[name='recharge-btn']").off("click");_self._6.find("[name='help-btn']").off("click");_self._6.find("[name='collection-btn']").off("click");_self._6.find("[name='mybag-btn']").off("click");_self._6.find("[name='shop-btn']").off("click");_self._6.find("[name='enter-room-btn']").off("click");_self._6.find("[name='enter-yard-btn']").off("click");_self._6.find("[name='prepare-btn']").off("click");_self._6.find("[name='ranking-div']").off("click");_self._6.find("[name='backyard-btn']").off("click");_self._6.find("[name='exitbtn']").off("click");_self._1h=false;_self._f3s()};_self.unbindRecvEvent=function(){};_self.forceToBack=function(){if(_self._1a!=null){_self._1a.forceToBack();_self._1a=null}if(_self._2z!=null){_self._2z.close();_self._2z=null}if(_self._5!=null){_self._5.doClose();_self._5=null}if(_self._4!=null){_self._4.doClose();_self._4=null}_self.unbindRecvEvent();_self.unbindEvent();var _sfm=$("#screen_main");_self._6.hide();_self._6.remove();_self._6=null;_sfm.css({width:_self._3+"px",left:_self._7.backScreenLeftPos,height:g_ClientHeight+"px"});_self._2();_sfm.resize()};_self._f1c=function(){if(_self._8==true){if((_self.m_GameData.data.tstata&32)==32){_self.m_QuitDiv.find("[name='endgame-tip']").text("è®°å¾å¸¸åæ¥ï¼å«è®©TAè¹²å¨é¨å£ç­ä½ å¤ªä¹")}else{_self.m_QuitDiv.find("[name='endgame-tip']").text("å¼å¯¼å°æå æ­¥æ²¡æå®æï¼ä½ ç¡®è®¤è¦æ¾å¼åï¼")}_self._4=_self.m_QuitDiv;_self.m_QuitDiv.show();_self.m_QuitDiv.find("[name='endgame_yes_btn']").one("click",function(event){_self._4=null;_self.m_QuitDiv.hide();event.stopPropagation();return false});_self.m_QuitDiv.find("[name='endgame_cancel_btn']").one("click",function(event){_self._4=null;_self.m_QuitDiv.hide();event.stopPropagation();return false});return false}return true};_self.backKeyDown=function(){if(_self._1a!=null){if(_self._1a.backKeyDown()){_self._1a=null}return false}if(_self._2z!=null){_self._2z.close();_self._2z=null;return false}if(_self._5!=null){_self._5.doClose();return false}if(_self._4!=null){_self._4.doClose();return false}if(_self._2s.is(":hidden")==false){if((_self.m_GameData.data.tstata&32)==32){if(_self.m_nInWhere==0){_self._f4c()}else{_self._f4b()}return false}else{return false}}return _self._f1c()};_self._f1d=function(x,y,x1,y1){if(Math.abs(x-x1)>30*g_offsetWidth/g_ClientHeight){var _roomscreen=_self._6.find("[name='room-screen']");if(x>x1){_roomscreen.transition({left:g_offsetWidth-g_ClientHeight/1920*1480},"slow")}else{_roomscreen.transition({left:0},"slow")}}};_self._f1e=function(id){var _nums=0,i;for(i=0;i<_self.m_GameData.data.goods.length;i++){if(_self.m_GameData.data.goods[i].id==id){_nums+=_self.m_GameData.data.goods[i].nums;break}}for(i=0;i<_self.m_GameData.data.bag.length;i++){if(_self.m_GameData.data.bag[i].id==id){_nums++}}for(i=0;i<_self.m_GameData.data.table.length;i++){if(_self.m_GameData.data.table[i].id==id){_nums++}}return _nums};_self._f1f=function(x,y,x1,y1){var _nStep=Math.abs(x-x1),_rect,_mbd,i,_scale;var _yardscreen=_self._6.find("[name='yard-screen']");if(_nStep>30*g_offsetWidth/g_ClientHeight){if((_self.m_GameData.data.tstata&32)==32){if(x>x1){_yardscreen.transition({left:g_offsetWidth-g_ClientHeight/1920*2160},"slow");_self._6.find("[name='ranking-div']").transition({opacity:0},"slow",function(){_self._f5o(false)})}else{_yardscreen.transition({left:0},"slow");_self._f5o(true);_self._6.find("[name='ranking-div']").transition({opacity:.75},"slow")
}}}else{if(Math.abs(y-y1)<10*g_offsetWidth/g_ClientHeight&&_nStep<10*g_offsetWidth/g_ClientHeight&&_self._4==null){var point={x:x-_yardscreen.offset().left+parseInt(_yardscreen.css("left"))+g_leftFix,y:y-_yardscreen.offset().top+g_TopFix};_scale=g_ClientHeight/1920;if(_self.m_bNewbieGif==true){_mbd=_yardscreen.find("[name='yard-gift']");_rect={x:_mbd.offset().left,y:_mbd.offset().top,w:_mbd.width()*_scale,h:_mbd.height()*_scale};if(point.x>=_rect.x&&point.x<=_rect.x+_rect.w&&point.y>=_rect.y&&point.y<=_rect.y+_rect.h){_self.m_bNewbieGif=false;_self._6.find("[name='toptip-msg-div']").hide();_mbd.remove();_self._6.find("[name='yard-site']").show();_self._6.find("[name='room-site']").append(_self._f1a("package",240,289));_self._f5g(1)}return}if((_self.m_GameData.data.tstata&32)==32){_mbd=_yardscreen.find("[name='yard-mail-box']");_rect={x:_mbd.offset().left,y:_mbd.offset().top,w:_mbd.width()*_scale,h:_mbd.height()*_scale};if(point.x>=_rect.x&&point.x<=_rect.x+_rect.w&&point.y>=_rect.y&&point.y<=_rect.y+_rect.h){_self._1h=true;_self._6.find("[name='yard-mail-box-pop']").hide();_self._f5o(false);_self._4=_self._1s;_self._4.show();_self._4.addClass("animated zoomIn").one(g_animationEnd,function(){_self._4.setEvent();_self._f2c();_self._4.removeClass("animated zoomIn")});return}}if((_self.m_GameData.data.tstata&4)==4){var _ee,_w,_h,_nIndex=-1;for(i=0;i<9;i++){_ee="[name='yg-"+i+"']";_mbd=_self._6.find(_ee);_w=_mbd.width()*_scale;_h=_mbd.height()*_scale;if(_self._f4g(x,y,_mbd.offset().left,_mbd.offset().top+_h/2,_mbd.offset().left+_w/2,_mbd.offset().top,_mbd.offset().left+_w,_mbd.offset().top+_h/2)==true){_nIndex=i;break}if(_self._f4g(x,y,_mbd.offset().left,_mbd.offset().top+_h/2,_mbd.offset().left+_w/2,_mbd.offset().top+_h,_mbd.offset().left+_w,_mbd.offset().top+_h/2)==true){_nIndex=i;break}}if(_nIndex!=-1){var _data=_mbd.data("info");if(_data.ctrl!=1){_data.ctrl=1;if(_data.stata==3){_data.stata=0;if(_self.m_GameData.data.tstata==7){_self.m_GameData.data.money+=3;_self._f5f(_self.m_GameData.data.money,_self._6.find("[name='scoreNum']"))}$(_mbd.children("div")[1]).addClass("animated fadeOutUp").one(g_animationEnd,function(){$(this).remove();_self._f5e(_nIndex,0);if(_self.m_GameData.data.money==27&&_self.m_GameData.data.tstata==7){_self.m_GameData.data.tstata=_self.m_GameData.data.tstata|8;_self._f5g(4)}else{if((_self.m_GameData.data.tstata&32)==32){var _qmsg={cmd:"extgame",subcmd:"dogtravel",data:{cmd:"farm",data:{id:_nIndex}}}}}})}}}}}}};_self._f1g=function(){if(_self._1l){_self._1l.destroy();_self._1l=null}_self._1j.find("[name='ranking-screen-close-btn']").off("click");_self._1j.find("[name='ranking-screen-self']").off("tap");_self._1j.find("[name='ranking-screen-wi']").off("tap");_self._1j.find("[name='rsf-item']").off("tap");_self._1j.find("[name='ranking-screen-welcome']").off("tap")};_self._f1h=function(){_self._4.unbindEvent();_self._1j.find("[name='ranking-screen-friend']").empty();_self._4.addClass("animated bounceOutLeft").one(g_animationEnd,function(){if(_self._4!=null){_self._4.removeClass("animated bounceOutLeft");_self._4.hide();_self._4=null;_self._f5o(true)}})};_self._f1hh=function(div,userData){if(userData.chatmsgs.length>0){var _chatMsg=userData.chatmsgs[userData.chatmsgs.length-1];var _content=_chatMsg.content;div.text(_content)}else{div.text("ç¸è¯äº"+g_convertTimeToYMD(userData.ts,"YYYY/MM/DD"))}};_self._f1j=function(data){var _div,_scale=g_ClientHeight/1920,_node,_css,_picurl;_node=$("<div name='rsf-item' style='overflow:auto;margin:5px 10px 5px 10px;border-bottom: 2px dashed #BDA673;border-radius: 8px;background-color: #F2D883;'><div style='width:100%;overflow: auto;padding: 5px 0;'><div name='rsfi-img' style='float:left;width: 50px;height: 50px;border-radius: 25%;margin-left: 5px;'><div name='unread' style='display:none;iposition: relative;width: 10px;height: 10px;background-color: #f00;border-radius: 50%;left: 45px;top: -5px;'></div></div><div style='float:left;text-align: left;margin: 0 10px;'><div name='rsfi-name' style='font-size: 14px;'></div><div name='rsfi-resume' style='font-size: 12px;font-weight: normal;text-align: left;word-break:break-all;white-space: nowrap;text-overflow:ellipsis;overflow: hidden;'></div></div></div></div>");_node.find("[name='rsfi-name']").html(data.userinfo[0].name);if(data.userinfo[0].avatar==""){var _ricon=data.uid%12;if(data.data.gender==0){_picurl="data/dog/avatar/boy/"+_ricon+".jpg"}else{_picurl="data/dog/avatar/girl/"+_ricon+".jpg"}}else{_picurl="data/users/"+data.userinfo[0].address+"/"+data.userinfo[0].avatar}_css={"background-image":"url("+_picurl+")","background-size":"100% 100%","box-shadow":"2px 2px 2px","-moz-box-shadow":"2px 2px 2px","-o-box-shadow":"2px 2px 2px","-webkit-box-shadow":"2px 2px 2px"};if(data.userinfo[0].gender==1){_css.border="2px solid #e720d7"}_node.find("[name='rsfi-img']").css(_css);_div=_node.find("[name='rsfi-resume']");_div.css({width:950*_scale-60-50});_self._f1hh(_div,data);_node.data("item",data);_self._1j.find("[name='ranking-screen-friend']").append(_node)};_self._f1k=function(){var i;for(i=_self.m_GameData.friends.length-1;i>=0;i--){_self._f1j(_self.m_GameData.friends[i])}_self._f1n()};_self._f1l=function(itemdata){_self._6.find("[name='my-money-div']").hide();_self._6.find("[name='recharge-btn']").hide();_self._6.find("[name='enter-room-btn']").hide();_self._6.find("[name='shop-btn']").hide();_self._6.find("[name='help-btn']").hide();_self._6.find("[name='collection-btn']").hide();_self._6.find("[name='mybag-btn']").hide();_self._f1g();_self.unbindEvent();_self._1a.setExtData({backScreenLeftPos:"0%",moveToLeft:-100,animatspeed:"normal",userinfo:itemdata,GameData:_self.m_GameData,showfun:function(){_self._6.css("visibility","hidden");_self._1j.hide()},hidefun:function(){_self._6.css("visibility","visible")}});_self._1a.show(function(){_self._1a=null;_self._6.find("[name='my-money-div']").show();_self._6.find("[name='recharge-btn']").show();_self._6.find("[name='enter-room-btn']").show();_self._6.find("[name='shop-btn']").show();_self._6.find("[name='help-btn']").show();_self._6.find("[name='collection-btn']").show();_self._6.find("[name='mybag-btn']").show();_self._1j.show();_self.setEvent();_self._f1o()})};_self._f1m=function(){var _divitem=_self._1j.find("[name='rsf-item']");_divitem.off("tap");_divitem.on("tap",function(event){_self._1a=_self._9.createNew(_self);_self._f1l($(this).data("item"));event.stopPropagation();return false})};_self._f1n=function(){var _divwi=_self._1j.find("[name='ranking-screen-wi']"),_divself=_self._1j.find("[name='ranking-screen-self']"),_divwc=_self._1j.find("[name='ranking-screen-welcome']");_divwi.off("tap");_divself.off("tap");_divwc.off("tap");_self._f1m();_divwc.on("tap",function(event){if($(this).data("closed")!=1){$(this).css({"white-space":"","max-height":""});$(this).data("closed",1)}else{$(this).css({"white-space":"nowrap","max-height":"28px"});$(this).data("closed",0)}_self._1l.refresh();event.stopPropagation();return false});_divself.on("tap",function(event){_self._f4j();event.stopPropagation();return false});_divwi.on("tap",function(event){var _url=$(this).data("url");_self._f4w("<div style='font-size:14px;text-align: center;'><i class='fa fa-spinner fa-pulse'></i>&nbsp;&nbsp;æ­£å¨çæä½ çç¹å«ç¥ç¦</div>",null);_self._f4d("data/imgs/"+_url+".jpg",function(err,qrresult){if(err==null){var uInt8ArrayCode=new Uint8Array(qrresult);var imgcode=new Image;imgcode.onload=function(){var canvas=document.createElement("canvas");canvas.width=620;canvas.height=580;var context=canvas.getContext("2d");context.font="22px Arial";context.fillStyle="#ffffff";context.fillRect(0,0,620,580);context.drawImage(imgcode,10,10,600,400);context.fillStyle="#795643";if(_url=="s1"){_self._f2k("âææ¶åå¥½æ³å»æè¡ï¼èµ°è¿ä½ æ²¡æèµ°è¿çå°æ¹â",canvas,context,10,420+32,32)}else{_self._f2k("âæç¥éæå¾ç¯è´±ï¼èæ¯å¿ä¸ä½å»æ³ä½ ï¼å¿ä¸ä½è§ä½ â",canvas,context,10,420+32,32)}context.fillStyle="#000000";var qrcode=new QRCode(-1,QRErrorCorrectLevel.H);qrcode.addData("http://lu.changit.cn/story/?gid=9&tid=237&pid=1168");qrcode.make();var tileW=120/qrcode.getModuleCount();var tileH=120/qrcode.getModuleCount();for(var row=0;row<qrcode.getModuleCount();row++){for(var col=0;col<qrcode.getModuleCount();col++){context.fillStyle=qrcode.isDark(row,col)?"#000000":"#ffffff";var w=Math.ceil((col+1)*tileW)-Math.floor(col*tileW);var h=Math.ceil((row+1)*tileW)-Math.floor(row*tileW);context.fillRect(Math.round(col*tileW)+480,Math.round(row*tileH)+430,w,h)}}var _src=canvas.toDataURL("image/jpeg");var imgtrue=new Image;imgtrue.onload=function(){var subBuff=[];subBuff.push("<div style='font-size:16px;text-align: center;'>é¿æå¾çåäº«ç»æå</div>");subBuff.push("<img name='imagediv' src='");subBuff.push(this.src);subBuff.push("' width='100%'/>");_self._5.doClose();setTimeout(function(){_self._f4w(subBuff.join(""),function(){})},0)};imgtrue.src=_src}}imgcode.src="data:image/jpeg;base64,"+btoa(Uint8ToString(uInt8ArrayCode))});event.stopPropagation();return false})};_self._f1o=function(){_self._1l=new IScroll(_self._1k[0],{tap:true,hScrollbar:false,preventDefaultException:{tagName:/^(IMG|INS|A)$/}});_self._1j.doClose=_self._f1h;_self._f1n();_self._1j.find("[name='ranking-screen-close-btn']").on("click",function(event){_self._f1h();event.stopPropagation();return false})};_self._f1p=function(){if(_self._1p){_self._1p.destroy();_self._1p=null}_self._1n.find("[name='help-screen-close-btn']").off("click");_self._1n.find("[name='help-title']").off("tap");_self._1q.find("[name='help-text']").remove()};_self._f1q=function(){_self._4.unbindEvent();_self._4.addClass("animated bounceOutUp").one(g_animationEnd,function(){if(_self._4!=null){_self._4.removeClass("animated bounceOutUp");_self._4.hide();_self._4=null;if(_self._6.find("[name='yard-screen']").is(":hidden")==false){_self._f5o(true)}}})};_self._f1r=function(){var _div=_self._1n.find("[name='help-title']");_div.off("tap");_div.on("tap",function(event){var _index=$(this).data("index");var _children=_self._1n.find("[name='help-resume']");for(var i=0;i<_children.length;i++){var _resumediv=$(_children[i]);if(_resumediv.data("index")==_index){if(_resumediv.is(":hidden")==false){_resumediv.hide()}else{_resumediv.show()}}else{_resumediv.hide()}}_self._1p.refresh();event.stopPropagation();return false})};_self._f1s=function(){_self._1p=new IScroll(_self._1o[0],{tap:true,hScrollbar:false});_self._1n.doClose=_self._f1q;_self._f1r();_self._1n.find("[name='help-screen-close-btn']").on("click",function(event){_self._f1q();event.stopPropagation();return false})};_self._f1t=function(){if(_self._1u){_self._1u.off("slideUp");_self._1u.off("scroll");_self._1w=_self._1u.y;_self._1u.destroy();_self._1u=null}_self._1s.find("[name='mailbox-screen-close-btn']").off("click");_self._1v.find("[name='mirb']").off("tap")};_self._f1u=function(){_self._1v.find("[name='mailitem']").remove();_self._4.unbindEvent();_self._4.addClass("animated zoomOut").one(g_animationEnd,function(){if(_self._4!=null){_self._4.removeClass("animated zoomOut");_self._4.hide();_self._4=null;_self._f5o(true)}})};_self.MailEciesDecryptLoop=function(mails,index,callback){if(index==mails.length){return callback(mails)}_self.m_pFrame.cmd("eciesDecrypt",mails[index].content,function(dres){mails[index].content=JSON.parse(dres);index++;_self.MailEciesDecryptLoop(mails,index,callback)})};_self._f1v=function(){if(_self.m_nLastQueryMailTS==-1||_self.m_bMailScorllMore==true)return;_self.m_bMailScorllMore=true;_self._1v.find("[name='mailbox-screen-loading']").hide();_self.m_bMailScorllMore=false};_self._f1w=function(){if(_self._1u.maxScrollY-_self._1u.y>40){if(_self.m_nLastQueryMailTS>0){_self._f1v()}}};_self._f1x=function(msgObj,callback){var data_inner_path="data/users/"+_self.m_pFrame.site_info.auth_address+"/data.json";var content_inner_path="data/users/"+_self.m_pFrame.site_info.auth_address+"/content.json";_self.m_pFrame.cmd("fileGet",{inner_path:data_inner_path,required:false},function(data){if(data){data=JSON.parse(data);var _now=Date.now();data.message.push({playerdata:JSON.stringify(msgObj),date_added:_now});var json_raw=unescape(encodeURIComponent(JSON.stringify(data,void 0,"	")));_self.m_pFrame.cmd("fileWrite",[data_inner_path,btoa(json_raw)],function(res){if(res=="ok"){_self.m_pFrame.cmd("sitePublish",{inner_path:content_inner_path,sign:true});callback(null)}else{_self.m_pFrame.cmd("wrapperNotification",["error","File write error: #{res}"]);callback({message:"error"})}})}else{callback({message:"error"})}})};_self._f1y=function(maildata,nIndex,bMenu){var i,bFound;_self.m_GameData.mails.splice(nIndex,1);if(maildata.content.attachment.key=="money"){_self.m_GameData.data.money+=maildata.content.attachment.money;_self._f5f(_self.m_GameData.data.money,_self._6.find("[name='scoreNum']"));if(bMenu==true){_self._f3v("ä½ è·å¾äºèèx"+maildata.content.attachment.money,500)}}else if(maildata.content.attachment.key=="goods"){bFound=false;for(i=0;i<_self.m_GameData.data.goods.length;i++){if(_self.m_GameData.data.goods[i].id==maildata.content.attachment.data.id){bFound=true;_self.m_GameData.data.goods[i].nums+=maildata.content.attachment.data.nums;break}}if(bFound==false){_self.m_GameData.data.goods.push(maildata.content.attachment.data)}if(bMenu==true){_self._f3v("ä½ è·å¾äº"+maildata.content.attachment.data.name+"x"+maildata.content.attachment.data.nums,500)}}else if(maildata.content.attachment.key=="iconograph"){bFound=false;for(i=0;i<_self.m_GameData.data.iconographs.length;i++){if(_self.m_GameData.data.iconographs[i].id==maildata.content.attachment.data.id){bFound=true;break}}if(bMenu==true){if(maildata.content.attachment.data.type==2){_self._f3v("åç°äºæ°ç¹äº§ï¼"+maildata.content.attachment.data.name,500)}else if(maildata.content.attachment.data.type==0){_self._f3v("å¾å°é£è°±ï¼"+maildata.content.attachment.data.name,500)}else{_self._f3v("åç°äºæ°å°æ¹ï¼"+maildata.content.attachment.data.name,500)}}if(bFound==false){_self.m_GameData.data.iconographs.push(maildata.content.attachment.data);_self.m_GameData.data.iconographs.sort(function(a,b){return a.type-b.type})}}else if(maildata.content.attachment.key=="photo"){if(bMenu==true){var pswpElement=document.querySelectorAll(".pswp")[0];var items=[{src:"data/imgs/items/"+maildata.content.attachment.data.icon,w:600,h:400,title:"ä½ è·å¾äºä¸å¼ ç§çï¼å¯ä»¥å¨æ¶èçç¸åä¸­è¿è¡æ¥ç"}];var options={history:false,focus:false,showAnimationDuration:0,hideAnimationDuration:0,index:0,closeEl:true,captionEl:true,fullscreenEl:false,zoomEl:false,shareEl:false,counterEl:true,arrowEl:true,preloaderEl:true,tapToClose:false,pinchToClose:false,closeOnVerticalDrag:false,escKey:false};_self._2z=new PhotoSwipe(pswpElement,PhotoSwipeUI_Default,items,options);_self._2z.init();_self._2z.listen("close",function(){_self._2z=null})}var _photoinfo={icon:maildata.content.attachment.data.icon,content:maildata.content.content,ts:maildata.date_added};_self._f4k(_photoinfo,maildata.date_added)}};_self._f1z=function(data,nType){var msgObj,i;if(data.content.attachment.key=="friend"){if(nType==0){msgObj={contract:{key:"ifs",values:[data.content.attachment.data.address]}}}else{msgObj={contract:{key:"afs",values:[data.content.attachment.data.address]}}}for(i=0;i<_self.m_GameData.mails.length;i++){if(_self.m_GameData.mails[i].content.attachment.data.address==data.content.attachment.data.address){_self.m_GameData.mails.splice(i,1);break}}}else{var nIndex=-1;for(i=0;i<_self.m_GameData.mails.length;i++){if(_self.m_GameData.mails[i].content.pid==data.content.pid){nIndex=i;break}}if(nIndex==-1)return;msgObj={contract:{key:"dm",values:[data.content.pid]}};_self._f1x(msgObj,function(err){if(err==null){_self._f1y(data,nIndex,true)}})}};_self._f2a=function(){var _div=_self._1v.find("[name='mirb']");_div.off("tap");_div.on("tap",function(event){var _itemdiv=$(this).parent();var _divDetail=_itemdiv.find("[name='mailboxdetail']");if(_divDetail.is(":hidden")==false){_divDetail.hide()}else{var _children=_self._1v.find("[name='mailboxdetail']");for(var i=0;i<_children.length;i++){var _divSubDetail=$(_children[i]);if(_divSubDetail.is(":hidden")==false){_divSubDetail.hide();break}}_self._1u.scrollToElement(_itemdiv[0]);_divDetail.show();_divDetail.find("[name='mb-a']").on("tap",function(event){var _data=$(this).data("mailinfo");if(_data.content.attachment.key=="friend"){var subBuff=[],_node;subBuff.push("<div style='text-align: center;'><div name='avatar' style='width:100%;margin: 0 auto;'></div><div name='msg' style='font-size: 14px;font-weight: normal;text-align: left;margin: 16px auto;'></div><div name='confirmbtn' class='button button-raised button-royal button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>ææå¼</div><div name='cancelbtn' class='button button-raised button-caution button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>å &nbsp;&nbsp;é¤</div></div>");_node=$(subBuff.join(""));_node.find("[name='msg']").html("å¨æè¡éä¸­è®¤è¯ç<span style='color: #9c3b3b;font-weight: bold;'>"+_data.content.attachment.data.name+"</span>ï¼è¦å»æä¸ªæå¼åï¼");var _strIcon;if(_data.content.attachment.data.icon==""){var _ricon=_data.content.attachment.data.uid%12;if(_data.content.attachment.data.gender==0){_strIcon="data/dog/avatar/boy/"+_ricon+".jpg"}else{_strIcon="data/dog/avatar/girl/"+_ricon+".jpg"}}else{_strIcon="data/users/"+_data.content.attachment.data.address+"/"+_data.content.attachment.data.icon+".jpg"}_node.find("[name='avatar']").css({width:g_offsetWidth*.6-20,height:g_offsetWidth*.6-20,border:"2px solid #c300ff","border-radius":"6px","background-image":"url("+_strIcon+")","background-size":"100% 100%","box-shadow":"5px 5px 5px","-moz-box-shadow":"5px 5px 5px","-o-box-shadow":"5px 5px 5px","-webkit-box-shadow":"5px 5px 5px"});_self._f4h(_node,function(){_self._f1z(_data,1);_divDetail.find("[name='mb-a']").parent().parent().remove();_self._1u.refresh();_self._f3v("ææå¼æ¶æ¯å·²åé",500)},function(){_self._f1z(_data,0);_divDetail.find("[name='mb-a']").parent().parent().remove();_self._1u.refresh()})}else{_self._f1z(_data,1);$(this).parent().parent().remove();_self._1u.refresh()}event.stopPropagation();return false})}_self._1u.refresh();event.stopPropagation();return false})};_self._f2b=function(data){var _div,_subNode,_scale=g_ClientHeight/1920,_node,_css,_strIcon;_subNode=$("<div style='width:100%;overflow: auto;margin: 5px 0 5px 0;padding: 5px 10px;background-color: #ddd;border-radius: 8px;border: 1px solid #c85f5f;'><div name='mailattachment-img' style='float:left;width: 48px;height: 48px;border: 2px solid #D2A562;border-radius: 25%;'></div><div name='mailattachment-contentbox' style='float:left;text-align: left;margin: 0 5px;'><div style='font-size: 12px;'><div name='mailattachment-resume' ></div><div name='mailattachment-tipmsg' style='font-size: 10px;color: #751cc9;'>ç¹å»é¢åéä»¶</div></div></div></div>");_node=$("<div name='mailitem' style='overflow:auto;margin:5px 10px 5px 10px;border-bottom: 2px dashed #EFDAAB'><div name='mirb' style='width:100%;overflow: auto;margin: 5px 0 5px 0;padding: 5px 0;'><div name='mailitem-img' style='float:left;width: 50px;height: 50px;border: 2px solid #D2A562;border-radius: 25%;'></div><div style='float:left;text-align: left;margin: 0 5px;'><div name='mailitem-title' style='font-size: 14px;'></div><div name='mailitem-resume' style='font-size: 12px;font-weight: normal;text-align: left;word-break:break-all;white-space: nowrap;text-overflow:ellipsis;overflow: hidden;'></div></div></div><div name='mailboxdetail' style='display:none;border-radius: 5px;text-align: left;font-size:13px;border-top: 2px dashed #EFDAAB;margin: 0 0 10px 0;padding: 5px;font-weight: normal;background-color: #FFFDF1;'><div name='mailboxdetail-content'></div><div name='mb-a'></div></div></div>");_node.find("[name='mailitem-title']").html(data.content.title);_div=_node.find("[name='mailitem-resume']");_div.css({width:1e3*_scale-50-50});_div.html(data.content.resume);_div=_node.find("[name='mailboxdetail-content']");_div.html(data.content.content);_div.find("p").css("font-size",13);_div=_div.find("img");if(_div.length==1){_div.attr("src",_div.data("url"))}if(data.content.attachment.key=="money"){_css={"background-image":"url("+"data/dogbg/strawberry.png)","background-size":"50% 50%"};_node.find("[name='mailitem-img']").css(_css);_subNode.find("[name='mailattachment-img']").css(_css);_subNode.find("[name='mailattachment-resume']").html("èè&nbsp;x"+data.content.attachment.money);_div=_node.find("[name='mb-a']");_div.data("mailinfo",data);_div.append(_subNode)}else if(data.content.attachment.key=="photo"){_strIcon="url("+"data/imgs/items/"+data.content.attachment.data.icon+")";_css={"background-image":_strIcon,"background-size":"100% 100%"};_node.find("[name='mailitem-img']").css(_css);_css["border-radius"]="5px";var _imgScale=(1e3*_scale-70)/600;_css.width=600*_imgScale;_css.height=400*_imgScale;_subNode.find("[name='mailattachment-img']").css(_css);_subNode.find("[name='mailattachment-contentbox']").hide();_div=_node.find("[name='mb-a']");_div.data("mailinfo",data);_div.append(_subNode)}else if(data.content.attachment.key=="goods"||data.content.attachment.key=="iconograph"){if(data.content.attachment.data.icon.indexOf("/")==-1){_strIcon="url(data/dog/items/"+data.content.attachment.data.icon}else{_strIcon="url(data/imgs/items/"+data.content.attachment.data.icon}if(data.content.attachment.key=="goods"){_strIcon=_strIcon+".png)"}else{_strIcon=_strIcon+")"}_css={"background-image":_strIcon,"background-size":"100% 100%"};_node.find("[name='mailitem-img']").css(_css);_subNode.find("[name='mailattachment-img']").css(_css);if(data.content.attachment.key=="goods"){_subNode.find("[name='mailattachment-resume']").html(data.content.attachment.data.name+"&nbsp;x"+data.content.attachment.data.nums)}else{_subNode.find("[name='mailattachment-resume']").html(data.content.attachment.data.name)}_div=_node.find("[name='mb-a']");_div.data("mailinfo",data);_div.append(_subNode)}else if(data.content.attachment.key=="friend"){_subNode.find("[name='mailattachment-tipmsg']").html("ç¹å»æ¥ç");if(data.content.attachment.data.icon==""){var _ricon=data.content.attachment.data.uid%12;if(data.content.attachment.data.gender==0){_strIcon="data/dog/avatar/boy/"+_ricon+".jpg"}else{_strIcon="data/dog/avatar/girl/"+_ricon+".jpg"}}else{_strIcon="data/users/"+data.content.attachment.data.address+"/"+data.content.attachment.data.icon+".jpg"}_css={"background-image":"url("+_strIcon+")","background-size":"100% 100%"};_node.find("[name='mailitem-img']").css(_css);_subNode.find("[name='mailattachment-img']").css(_css);_subNode.find("[name='mailattachment-resume']").html(data.content.attachment.data.name);_div=_node.find("[name='mb-a']");_div.data("mailinfo",data);_div.append(_subNode)}_self._1v.find("[name='mailbox-screen-loading']").before(_node)};_self._f2c=function(){_self._1v.find("[name='mailitem']").remove();_self._1v.find("[name='item-empty-box']").remove();for(var i=0;i<_self.m_GameData.mails.length;i++){_self._f2b(_self.m_GameData.mails[i])}if(_self.m_nLastQueryMailTS==-1&&_self.m_GameData.mails.length==0){var _scale=g_ClientHeight/1920;var subBuff=[];subBuff.push("<div name='item-empty-box' style='text-align: center;margin-top:60px;'><div name='item-empty'></div></div>");var _node=$(subBuff.join(""));_node.find("[name='item-empty']").css({"background-image":"url("+"data/dogbg/empty.png)","background-size":"100% 100%",margin:"0 auto",width:306*_scale,height:206*_scale});_self._1v.append(_node)}_self._1u.refresh();_self._f2a()};_self._f2d=function(){_self._1u=new IScroll(_self._1t[0],{probeType:3,tap:true,hScrollbar:false,preventDefaultException:{tagName:/^(IMG|INS|A)$/}});_self._1u.on("slideUp",_self._f1w);_self._1u.on("scroll",function(){var bottomHeight=this.maxScrollY-this.y;if(bottomHeight>=40){_self._1v.find("[name='mailbox-screen-loading']").show()}else if(bottomHeight<40&&bottomHeight>=0){_self._1v.find("[name='mailbox-screen-loading']").hide()}});if(_self._1w!=null){_self._1u.scrollTo(0,_self._1w,0)}_self._1s.doClose=_self._f1u;_self._f2a();_self._1s.find("[name='mailbox-screen-close-btn']").on("click",function(event){_self._f1u();event.stopPropagation();return false})};_self._f2e=function(){if(_self._1z){_self._1z.destroy();_self._1z=null}_self._1x.find("[name='calendar-screen-close-btn']").off("click")};_self._f2f=function(){_self._4.unbindEvent();_self._4.addClass("animated zoomOut").one(g_animationEnd,function(){if(_self._4!=null){_self._4.removeClass("animated zoomOut");_self._4.hide();_self._4=_self._2v;_self._4.show();_self._4.addClass("animated zoomIn").one(g_animationEnd,function(){_self._4.setEvent();_self._4.removeClass("animated zoomIn")})}})};_self._f2g=function(){_self._1z=new IScroll(_self._1y[0],{tap:true,hScrollbar:false});_self._1x.doClose=_self._f2f;_self._1x.find("[name='calendar-screen-close-btn']").on("click",function(event){_self._f2f();event.stopPropagation();return false})};_self._f2h=function(){if(_self._2d){_self._2d.off("slideUp");_self._2d.off("scroll");_self._2f=_self._2d.y;_self._2d.destroy();_self._2d=null}_self._2b.find("[name='photo-screen-close-btn']").off("click");_self._2e.find("[name='photoitem']").off("tap")};_self._f2j=function(){_self._2e.find("[name='photoitem']").remove();_self._2e.find("[name='photoitem-empty']").remove();_self._2g=[];_self._4.unbindEvent();_self._4.addClass("animated zoomOut").one(g_animationEnd,function(){if(_self._4!=null){if(_self._4!=null){_self._4.removeClass("animated zoomOut");_self._4.hide();_self._4=_self._2v;_self._4.show();_self._4.addClass("animated zoomIn").one(g_animationEnd,function(){_self._4.setEvent();_self._4.removeClass("animated zoomIn")})}}})};_self._f2k=function(str,canvas,ctx,initX,initY,lineHeight){var lineWidth=0;var canvasWidth=460;var lastSubStrIndex=0;for(var i=0;i<str.length;i++){lineWidth+=ctx.measureText(str[i]).width;if(lineWidth>canvasWidth-initX){ctx.fillText(str.substring(lastSubStrIndex,i),initX,initY);initY+=lineHeight;lineWidth=0;lastSubStrIndex=i}if(i==str.length-1){ctx.fillText(str.substring(lastSubStrIndex,i+1),initX,initY)}}};_self._f2l=function(){var _div=_self._2e.find("[name='photoitem']");_div.off("tap");_div.on("tap",function(event){var _item=$(this).data("item");var pswpElement=document.querySelectorAll(".pswp")[0];var nIndex=0;for(var i=0;i<_self._2g.length;i++){if(_self._2g[i].ts==_item.ts){nIndex=i;break}}var options={history:false,focus:false,showAnimationDuration:0,hideAnimationDuration:0,index:nIndex,closeEl:true,captionEl:true,fullscreenEl:false,zoomEl:false,shareEl:false,counterEl:true,arrowEl:true,preloaderEl:true,tapToClose:false,pinchToClose:false,closeOnVerticalDrag:false,escKey:false,isClickableElement:function(el){var _btn=$(el).find("[name='sharebtn']");if(_btn.length>0){return true}return el.tagName==="A"}};_self._2z=new PhotoSwipe(pswpElement,PhotoSwipeUI_Default,_self._2g,options);_self._2z.listen("close",function(){_self._2z=null});_self._2z.listen("afterChange",function(){var _div=$(this.template);$(this.template).find("[name='sharebtn']").one("click",function(event){var _imgurl=$(this).data("imgurl");var _content=$(this).data("text");_self._2z.close();_self._f4w("<div style='font-size:14px;text-align: center;'><i class='fa fa-spinner fa-pulse'></i>&nbsp;&nbsp;æ­£å¨çæåäº«ç§ç</div>",null);_self._f4d("data/imgs/items/"+_imgurl,function(err,qrresult){if(err==null){var uInt8ArrayCode=new Uint8Array(qrresult);var imgcode=new Image;imgcode.onload=function(){var canvas=document.createElement("canvas");canvas.width=620;canvas.height=580;var context=canvas.getContext("2d");context.font="22px Arial";context.fillStyle="#ffffff";context.fillRect(0,0,620,580);context.drawImage(imgcode,10,10,600,400);context.fillStyle="#795643";_self._f2k(_content,canvas,context,10,420+32,32);context.fillStyle="#000000";var qrcode=new QRCode(-1,QRErrorCorrectLevel.H);qrcode.addData("http://lu.changit.cn/story/?gid=9&tid=237&pid=116");qrcode.make();var tileW=120/qrcode.getModuleCount();var tileH=120/qrcode.getModuleCount();for(var row=0;row<qrcode.getModuleCount();row++){for(var col=0;col<qrcode.getModuleCount();col++){context.fillStyle=qrcode.isDark(row,col)?"#000000":"#ffffff";var w=Math.ceil((col+1)*tileW)-Math.floor(col*tileW);var h=Math.ceil((row+1)*tileW)-Math.floor(row*tileW);context.fillRect(Math.round(col*tileW)+480,Math.round(row*tileH)+430,w,h)}}var _src=canvas.toDataURL("image/jpeg");var imgtrue=new Image;imgtrue.onload=function(){var subBuff=[];subBuff.push("<div style='font-size:16px;text-align: center;'>é¿æå¾çå³å¯åäº«</div>");subBuff.push("<img name='imagediv' src='");subBuff.push(this.src);subBuff.push("' width='100%'/>");_self._5.doClose();setTimeout(function(){_self._f4w(subBuff.join(""),function(){})},0)};imgtrue.src=_src}}imgcode.src="data:image/jpeg;base64,"+btoa(Uint8ToString(uInt8ArrayCode))});event.stopPropagation();return false})});_self._2z.init();event.stopPropagation();return false})};_self._f2m=function(photoinfo){var subBuff=[],_nodeSub;subBuff.push("<div>");subBuff.push(photoinfo.content.content);subBuff.push("</div>");subBuff.push("<div data-imgurl=");subBuff.push(photoinfo.content.icon);subBuff.push(" data-text=");subBuff.push(photoinfo.content.content);subBuff.push(" name='sharebtn' class='button button-circle button-royal button-tiny' style='margin: 0 10px 10px 0;float: right;'><i class='fa fa-share-alt'></i></div>");_self._2g.unshift({src:"data/imgs/items/"+photoinfo.content.icon,w:600,h:400,ts:photoinfo.ts,title:subBuff.join("")});var _scale=g_ClientHeight/1920;var _w=1e3*_scale/2-16;subBuff=[];subBuff.push("<div name='photoitem' style='margin:5px;display:inline-block; '><div name='photoitem-tip' style='font-size: 14px;color: #fff;display: inline;padding: 0 5px;border-radius: 5px;background-color: rgba(0,0,0,0.5);position: relative;top: -8px;'></div></div>");_nodeSub=$(subBuff.join(""));_nodeSub.css({width:_w,height:400*_w/600,"background-image":"url(data/imgs/items/"+photoinfo.content.icon+")","background-size":"100% 100%",border:"1px solid #795643","border-radius":"5px","box-shadow":"2px 2px 2px","-moz-box-shadow":"2px 2px 2px","-o-box-shadow":"2px 2px 2px","-webkit-box-shadow":"2px 2px 2px"});var De=new Date(photoinfo.content.ts);_nodeSub.find("[name='photoitem-tip']").text(De.getFullYear()+"."+De.getMonth()+"."+De.getDate());_nodeSub.data("item",photoinfo);return _nodeSub};_self._f2n=function(){if(_self.m_nLastQueryPhotoTS==-1||_self.m_bPhotoScorllMore==true)return;_self._2e.find("[name='photobox-screen-loading']").hide();_self.m_bPhotoScorllMore=false};_self._f2o=function(){var subBuff,_node;var _scale=g_ClientHeight/1920;subBuff=[];subBuff.push("<div name='photoitem-empty' style='text-align: center;margin-top:60px;'><div name='item-empty'></div></div>");_node=$(subBuff.join(""));_node.find("[name='item-empty']").css({"background-image":"url("+"data/dogbg/empty.png)","background-size":"100% 100%",margin:"0 auto",width:306*_scale,height:206*_scale});_self._2e.find("[name='photobox-screen-loading']").before(_node)};_self._f2p=function(){var i,_photoInfo;_self._2g=[];for(i=0;i<_self.m_GameData.pics.length;i++){_photoInfo=_self.m_GameData.pics[i];_self._2e.find("[name='photobox-screen-loading']").before(_self._f2m(_photoInfo))}if(_self._2e.find("[name='photoitem']").length==0&&_self.m_nLastQueryPhotoTS==-1){_self._f2o()}_self._2d.refresh();_self._f2l();if(_self.m_nLastQueryPhotoTS==0){_self._2e.find("[name='photobox-screen-loading']").show();_self._f2n()}};_self._f2q=function(){if(_self._2d.maxScrollY-_self._2d.y>40){if(_self.m_nLastQueryPhotoTS>0){_self._f2n()}}};_self._f2r=function(){_self._2d=new IScroll(_self._2c[0],{probeType:3,tap:true,hScrollbar:false});_self._2d.on("slideUp",_self._f2q);_self._2d.on("scroll",function(){var bottomHeight=this.maxScrollY-this.y;if(bottomHeight>=40){_self._2e.find("[name='photobox-screen-loading']").show()}else if(bottomHeight<40&&bottomHeight>=0){_self._2e.find("[name='photobox-screen-loading']").hide()}});if(_self._2f!=null){_self._2d.scrollTo(0,_self._2f,0)}_self._2b.doClose=_self._f2j;_self._f2l();_self._2b.find("[name='photo-screen-close-btn']").on("click",function(event){_self._f2j();
event.stopPropagation();return false})};_self._f2s=function(){if(_self._2l){_self._2l.destroy();_self._2l=null}_self._2h.find("[name='goods-screen-close-btn']").off("click");_self._2h.find("[name='goodstab']").off("click");_self._2h.find("[name='item-label']").off("tap");_self._2j=-1;_self._2m.empty();if(!((_self.m_GameData.data.tstata&32)==32)){_self._2h.find("[name='goods-screen-title']").text("éå·")}};_self._f2t=function(){var _div=_self._2h.find("[name='item-label']"),i;_div.off("tap");_div.on("tap",function(event){if(_self._2h.extDiv!=null){var _item=$(this).data("item");var _isEqiup=$(this).data("equip");if(_isEqiup==1){_self._2h.extDiv.data("item",0);_self._2h.extDiv.css({"background-image":""});$(this).data("equip",0);var _name=_item.name;var bFound=false;for(i=0;i<_self.m_GameData.data.goods.length;i++){if(_self.m_GameData.data.goods[i].id==_item.id){bFound=true;_self.m_GameData.data.goods[i].nums++;if(_item.type!=1&&_item.type!=2){_name=_name+"&nbsp;<span style='font-weight: normal;font-size: 12px;'>x"+_self.m_GameData.goods[i].nums+"</span>"}break}}if(bFound==false){var _cloneObj={};$.extend(_cloneObj,_item);_self.m_GameData.data.goods.push(_cloneObj);if(_item.type!=1&&_item.type!=2){_name=_name+"&nbsp;<span style='font-weight: normal;font-size: 12px;'>x1</span>"}}$(this).find("[name='items-name']").html(_name);event.stopPropagation();return false}else{_self._2h.extDiv.data("item",_item);_self._2h.extDiv.css({"background-image":"url("+"data/dog/items/"+_item.icon+".png)"});for(i=0;i<_self.m_GameData.data.goods.length;i++){if(_self.m_GameData.data.goods[i].id==_item.id){if(_item.nums==1){_self.m_GameData.data.goods.splice(i,1)}else{_self.m_GameData.data.goods[i].nums--}break}}}_self._f2s();_self._2h.hide();if(typeof _self._2h.closeFun=="function"){_self._2h.closeFun()}}event.stopPropagation();return false})};_self._f2u=function(){if(typeof _self._2h.closeFun=="function"){_self._f2s();_self._2h.hide();_self._2h.closeFun()}else{_self._4.unbindEvent();_self._4.addClass("animated bounceOutUp").one(g_animationEnd,function(){if(_self._4!=null){_self._4.removeClass("animated bounceOutUp");_self._4.hide();_self._4=null;if(_self._6.find("[name='yard-screen']").is(":hidden")==false){_self._f5o(true)}}})}};_self._f2v=function(){_self._2l=new IScroll(_self._2k[0],{tap:true,hScrollbar:false});_self._f2t();_self._2h.find("[name='goodstab']").on("click",function(event){if(_self._2h.extDiv!=null){_self._f3v("è¯¥æ ç­¾åå®¹ä¸å¹éå½åçéæ©",1e3)}else{var _index=$(this).data("index");_self._f2y(_index)}event.stopPropagation();return false});_self._2h.doClose=_self._f2u;_self._2h.find("[name='goods-screen-close-btn']").on("click",function(event){_self._f2u();event.stopPropagation();return false})};_self._f2w=function(data){var _scale=g_ClientHeight/1920,_name=data.name;var _node=$("<div name='item-label'><div name='items-img'></div><div name='items-content' style='text-align:left;display:table-cell;vertical-align: middle;'><div name='items-name' style='font-weight:bold;'></div><div name='items-resume' style='font-weight:normal;font-size: 12px;word-break:keep-all;white-space:nowrap;text-overflow:ellipsis;overflow: hidden;'></div></div></div>");if(data.type!=1&&data.type!=2){_name=_name+"&nbsp;<span style='font-weight: normal;font-size: 12px;'>x"+data.nums+"</span>"}_node.find("[name='items-name']").html(_name);_node.find("[name='items-resume']").html(data.resume);_node.css({width:1e3*_scale-14-10,margin:"5px 5px","border-bottom":"2px dashed #EFDAAB",overflow:"hidden"});var _imgurl;if(data.icon.indexOf("/")==-1){_imgurl="url("+"data/dog/items/"+data.icon+".png)"}else{_imgurl="url("+"data/imgs/items/"+data.icon+".png)"}_node.find("[name='items-img']").css({width:145*_scale,height:145*_scale,"border-radius":4,margin:10*_scale,border:"2px solid #D2A562","background-image":_imgurl,"background-size":"100% 100%","float":"left"});_node.find("[name='items-content']").css({height:165*_scale,"max-width":990*_scale-14-10-165*_scale});_node.data("item",data);_node.data("equip",0);return _node};_self._f2x=function(){var i,_goodsInfo,bFound=false,_node;_self._2m.empty();for(i=0;i<_self.m_GameData.data.goods.length;i++){_goodsInfo=_self.m_GameData.data.goods[i];if(_goodsInfo.type==_self._2j){_node=_self._f2w(_goodsInfo);if(_self._2h.extDiv!=null&&_self._2h.extDiv.data("item").id==_goodsInfo.id){bFound=true;_name=_goodsInfo.name;if(_goodsInfo.type!=1&&_goodsInfo.type!=2){var _nums=_goodsInfo.nums+1;_name=_name+"&nbsp;<span style='font-weight: normal;font-size: 12px;'>x"+_nums+"</span>"}_node.find("[name='items-name']").html(_name+"&nbsp;&nbsp;<span style='font-weight: normal;font-size: 12px;color: #136fd7;'>å·²è£å¤</span>");_node.data("equip",1)}_self._2m.append(_node)}}if(_self._2h.extDiv!=null&&bFound==false){_goodsInfo=_self._2h.extDiv.data("item");if(_goodsInfo!=0){_node=_self._f2w(_goodsInfo);var _name=_goodsInfo.name;if(_goodsInfo.type!=1&&_goodsInfo.type!=2){_name=_name+"&nbsp;<span style='font-weight: normal;font-size: 12px;'>x"+_goodsInfo.nums+"</span>"}_node.find("[name='items-name']").html(_name+"&nbsp;&nbsp;<span style='font-weight: normal;font-size: 12px;color: #136fd7;'>å·²è£å¤</span>");_node.data("equip",1);_self._2m.prepend(_node)}}if(_self._2m.find("[name='item-label']").length==0){var _scale=g_ClientHeight/1920;var subBuff=[];subBuff.push("<div style='text-align: center;margin-top:60px;'><div name='item-empty'></div></div>");_node=$(subBuff.join(""));_node.find("[name='item-empty']").css({"background-image":"url("+"data/dogbg/empty.png)","background-size":"100% 100%",margin:"0 auto",width:306*_scale,height:206*_scale});_self._2m.append(_node)}_self._f2t();_self._2l.refresh()};_self._f2y=function(type){if(type!=_self._2j){var _childrens=_self._2h.find("[name='goodstab']");for(var i=0;i<_childrens.length;i++){if($(_childrens[i]).data("index")==_self._2j){$(_childrens[i]).css({"background-color":"#92684F",color:""});break}else{if(_self._2j==-1){$(_childrens[i]).css({"background-color":"#92684F",color:""})}}}$(_childrens[type]).css({"background-color":"#E76624",color:"#fff"});_self._2j=type;_self._f2x()}};_self._f2z=function(nType){var _childrens;if(nType==0){_childrens=_self.m_preparebagScreen.find("[name='preparebag-item']")}else{_childrens=_self.m_prepareTableScreen.find("[name='preparetable-item']")}var _bags=[],_data,i;for(i=0;i<_childrens.length;i++){_data=$(_childrens[i]).data("item");if(_data!=0){_bags.push(_data)}}if(nType==0){if(_bags.length!=_self.m_GameData.data.bag.length){return _bags}}else{if(_bags.length!=_self.m_GameData.data.table.length){return _bags}}_bags.sort(function(a,b){return a.id-b.id});if(nType==0){_self.m_GameData.data.bag.sort(function(a,b){return a.id-b.id})}else{_self.m_GameData.data.table.sort(function(a,b){return a.id-b.id})}for(i=0;i<_bags.length;i++){if(nType==0){if(_bags[i].id!=_self.m_GameData.data.bag[i].id){return _bags}}else{if(_bags[i].id!=_self.m_GameData.data.table[i].id){return _bags}}}return null};_self._f3a=function(){_self.m_prepareTableScreen.find("[name='preparetable-screen-close-btn']").off("click");_self.m_prepareTableScreen.find("[name='preparetable-screen-confirm']").off("click");_self.m_prepareTableScreen.find("[name='preparetable-item']").off("click")};_self._f3b=function(){var _newBags=_self._f2z(1);if(_newBags!=null){_self.m_GameData.data.goods=_self.m_cloneGoods;_self.m_cloneGoods=null;_self._f3v("ä½ æ¾å¼äºå¯¹æ¡å­çæ´çã",600)}if(_self.m_prepareTableScreen.subdiv!=null){if(typeof _self.m_prepareTableScreen.subdiv.closeFun=="function"){return _self.m_prepareTableScreen.subdiv.doClose()}}_self._4.unbindEvent();_self._4.addClass("animated zoomOut").one(g_animationEnd,function(){if(_self._4!=null){_self._4.removeClass("animated zoomOut");_self._4.hide();_self._4=null}})};_self._f3c=function(div,type){_self.m_prepareTableScreen.hide();_self._2h.closeFun=function(){_self._2h.closeFun=null;_self._2h.extDiv=null;_self.m_prepareTableScreen.subdiv=null;_self.m_prepareTableScreen.show()};_self._2h.extDiv=div;_self._f2v();_self.m_prepareTableScreen.subdiv=_self._2h;_self._2h.show();_self._f2y(type)};_self._f3d=function(){_self.m_prepareTableScreen.doClose=_self._f3b;_self.m_prepareTableScreen.find("[name='preparetable-item']").on("click",function(event){var _type=$(this).data("type");_self._f3c($(this),_type);event.stopPropagation();return false});_self.m_prepareTableScreen.find("[name='preparetable-screen-confirm']").on("click",function(event){var _newBags=_self._f2z(1);if(_newBags!=null){if(_self.m_GameData.data.money==0){return _self._f3v("ä½ çèèæ°éä¸å¤äºå¦ã",1e3)}else{var _values=[];for(var i=0;i<_newBags.length;i++){_values.push({id:_newBags[i].id,type:_newBags[i].type})}var msgObj={contract:{key:"pt",values:_values}};_self._f1x(msgObj,function(err){if(err==null){_self.m_cloneGoods=null;_self.m_GameData.data.money--;_self.m_GameData.data.table=_newBags}})}}_self._4.unbindEvent();_self._4.addClass("animated zoomOut").one(g_animationEnd,function(){_self._4.removeClass("animated zoomOut");_self._4.hide();_self._4=null});event.stopPropagation();return false});_self.m_prepareTableScreen.find("[name='preparetable-screen-close-btn']").on("click",function(event){_self._f3b();event.stopPropagation();return false})};_self._f3e=function(){var i,_goods,_childrens=_self.m_prepareTableScreen.find("[name='preparetable-item']"),_div,j;if(_self.m_cloneGoods==null){_self.m_cloneGoods=[];for(i=0;i<_self.m_GameData.data.goods.length;i++){var _cloneObj={};$.extend(_cloneObj,_self.m_GameData.data.goods[i]);_self.m_cloneGoods.push(_cloneObj)}}for(i=0;i<_childrens.length;i++){_div=$(_childrens[i]);_div.data("item",0);_div.css({"background-image":""})}_self._4=_self.m_prepareTableScreen;_self._4.setEvent();var _imgurl;for(i=0;i<_self.m_GameData.data.table.length;i++){_goods=_self.m_GameData.data.table[i];if(_goods.type==0||_goods.type==1){for(j=0;j<2;j++){if(_goods.type==0){_div=$(_childrens[j])}else{_div=$(_childrens[2+j])}if(_div.data("item")==0){_div.data("item",_goods);if(_goods.icon.indexOf("/")==-1){_imgurl="url("+"data/dog/items/"+_goods.icon+".png)"}else{_imgurl="url("+"data/imgs/items/"+_goods.icon+".png)"}_div.css({"background-image":_imgurl});break}}}else{for(j=0;j<4;j++){_div=$(_childrens[j+4]);if(_div.data("item")==0){_div.data("item",_goods);if(_goods.icon.indexOf("/")==-1){_imgurl="url("+"data/dog/items/"+_goods.icon+".png)"}else{_imgurl="url("+"data/imgs/items/"+_goods.icon+".png)"}_div.css({"background-image":_imgurl});break}}}}_self._4.show()};_self._f3f=function(){_self.m_preparebagScreen.find("[name='preparebag-screen-close-btn']").off("click");_self.m_preparebagScreen.find("[name='preparebag-screen-confirm']").off("click");_self.m_preparebagScreen.find("[name='preparebag-item']").off("click")};_self._f3g=function(div,type){_self.m_preparebagScreen.hide();_self._2h.closeFun=function(){_self._2h.closeFun=null;_self._2h.extDiv=null;_self.m_preparebagScreen.subdiv=null;_self.m_preparebagScreen.show();if((_self.m_GameData.data.tstata&32)==32){}else{var _childrens=_self.m_preparebagScreen.find("[name='preparebag-item']"),_data01=$(_childrens[0]).data("item"),_data02=$(_childrens[1]).data("item"),_toptipdiv=_self._6.find("[name='toptip-msg-div']");if(typeof _data01!="undefined"){if(typeof _data02!="undefined"){_toptipdiv.find("[name='toptip-msg']").text("ç¹å»ç¡®è®¤ï¼å®ææ¶æ¾è¡å")}else{_toptipdiv.find("[name='toptip-msg']").text("ç¹å»ç¨åæ ï¼å°é£æ²¹ç²¾æ¾è¿å»")}}}};_self._2h.extDiv=div;_self._f2v();if(!((_self.m_GameData.data.tstata&32)==32)){var _node=$("<span style='font-size:16px;'>ç¹å»ç©åè¿è¡æä½</span>");var _scale=g_ClientHeight/1920;_node.css({height:95*_scale,"line-height":95*_scale+"px"});_self._2h.find("[name='goods-screen-title']").html(_node)}_self.m_preparebagScreen.subdiv=_self._2h;_self._2h.show();_self._f2y(type)};_self._f3h=function(){if((_self.m_GameData.data.tstata&32)==32){var _newBags=_self._f2z(0);if(_newBags!=null){_self.m_GameData.data.goods=_self.m_cloneGoods;_self.m_cloneGoods=null;_self._f3v("ä½ æ¾å¼äºå¯¹èåçæ´çã",600)}}if(_self.m_preparebagScreen.subdiv!=null){if(typeof _self.m_preparebagScreen.subdiv.closeFun=="function"){return _self.m_preparebagScreen.subdiv.doClose()}}if((_self.m_GameData.data.tstata&32)==32){_self._4.unbindEvent();_self._4.addClass("animated zoomOut").one(g_animationEnd,function(){if(_self._4!=null){_self._4.removeClass("animated zoomOut");_self._4.hide();_self._4=null}})}else{_self._f3v("è¯·æç§æç¤ºåå¤éå·",1e3)}};_self._f3j=function(){_self.m_preparebagScreen.doClose=_self._f3h;_self.m_preparebagScreen.find("[name='preparebag-item']").on("click",function(event){var _type=$(this).data("type");if((_self.m_GameData.data.tstata&32)==32){_self._f3g($(this),_type)}else{var _childrens=_self.m_preparebagScreen.find("[name='preparebag-item']"),_data01=$(_childrens[0]).data("item"),_msg01="ç¹å»é£ç©æ ï¼æ¾å¥ä¸ææ²»",_data02=$(_childrens[1]).data("item"),_msg02="ç¹å»ç¨åæ ï¼æ¾å¥é£æ²¹ç²¾",_msgOver="ç¹å»ç¡®è®¤ï¼å®ææ¶æ¾è¡å";if(_type==2){if(_data01!=0){if(_data02==0){_self._f3v(_msg02,1e3)}else{_self._f3v(_msgOver,1e3)}}else{_self._f3v(_msg01,1e3)}}else if(_type==1){if(_data01==0){_self._f3v(_msg01,1e3)}else{if(_data02==0){_self._f3g($(this),_type)}else{_self._f3v(_msgOver,1e3)}}}else{if(_data01==0){_self._f3g($(this),_type)}else{if(_data01!=0){_self._f3v(_msg02,1e3)}else{_self._f3g($(this),_type)}}}}event.stopPropagation();return false});_self.m_preparebagScreen.find("[name='preparebag-screen-confirm']").on("click",function(event){if((_self.m_GameData.data.tstata&32)==32){var _newBags=_self._f2z(0);if(_newBags!=null){if(_self.m_GameData.data.money==0){return _self._f3v("ä½ çèèæ°éä¸å¤äºå¦ã",1e3)}else{_self.m_cloneGoods=null;var _qmsg={cmd:"extgame",subcmd:"dogtravel",data:{cmd:"preparegoods",data:{type:0,goods:[]}}};for(var i=0;i<_newBags.length;i++){_qmsg.data.data.goods.push({id:_newBags[i].id,type:_newBags[i].type})}_self.m_GameData.data.bag=_newBags}}_self._4.unbindEvent();_self._4.addClass("animated zoomOut").one(g_animationEnd,function(){_self._4.removeClass("animated zoomOut");_self._4.hide();_self._4=null})}else{var _childrens=_self.m_preparebagScreen.find("[name='preparebag-item']"),_data01=$(_childrens[0]).data("item"),_data02=$(_childrens[1]).data("item");if(_data01==0){_self._f3v("ç¹å»é£ç©æ ï¼æ¾å¥ä¸ææ²»",1e3)}else if(_data02==0){_self._f3v("ç¹å»ç¨åæ ï¼æ¾å¥é£æ²¹ç²¾",1e3)}else{_self.m_GameData.data.bag.push(_data01);_self.m_GameData.data.bag.push(_data02);_self._f5g(6);_self._4.unbindEvent();_self._4.addClass("animated zoomOut").one(g_animationEnd,function(){_self._4.removeClass("animated zoomOut");_self._4.hide();_self._4=null})}}event.stopPropagation();return false});_self.m_preparebagScreen.find("[name='preparebag-screen-close-btn']").on("click",function(event){_self._f3h();event.stopPropagation();return false})};_self._f3k=function(){var i,_goods,_childrens=_self.m_preparebagScreen.find("[name='preparebag-item']"),_div,j;if(_self.m_cloneGoods==null){_self.m_cloneGoods=[];for(i=0;i<_self.m_GameData.data.goods.length;i++){var _cloneObj={};$.extend(_cloneObj,_self.m_GameData.data.goods[i]);_self.m_cloneGoods.push(_cloneObj)}}_self._4=_self.m_preparebagScreen;_self._4.setEvent();for(i=0;i<_childrens.length;i++){_div=$(_childrens[i]);_div.data("item",0);_div.css({"background-image":""})}var _imgurl;for(i=0;i<_self.m_GameData.data.bag.length;i++){_goods=_self.m_GameData.data.bag[i];if(_goods.type==0||_goods.type==1){_div=$(_childrens[_goods.type]);if(_div.data("item")==0){_div.data("item",_goods);if(_goods.icon.indexOf("/")==-1){_imgurl="url("+"data/dog/items/"+_goods.icon+".png)"}else{_imgurl="url("+"data/imgs/items/"+_goods.icon+".png)"}_div.css({"background-image":_imgurl})}}else{for(j=0;j<2;j++){_div=$(_childrens[j+2]);if(_div.data("item")==0){_div.data("item",_goods);if(_goods.icon.indexOf("/")==-1){_imgurl="url("+"data/dog/items/"+_goods.icon+".png)"}else{_imgurl="url("+"data/imgs/items/"+_goods.icon+".png)"}_div.css({"background-image":_imgurl});break}}}}_self._4.show()};_self._f3l=function(){if(_self._2q){_self._2q.destroy();_self._2q=null}_self._2n.find("[name='iconograph-screen-close-btn']").off("click");_self._2n.find("[name='iconographtab']").off("click");_self._2n.find("[name='iconographitem']").off("tap")};_self._f3m=function(){_self._2r.empty();_self._4.unbindEvent();_self._4.addClass("animated zoomOut").one(g_animationEnd,function(){if(_self._4!=null){_self._4.removeClass("animated zoomOut");_self._4.hide();_self._4=_self._2v;_self._4.show();_self._4.addClass("animated zoomIn").one(g_animationEnd,function(){_self._4.setEvent();_self._4.removeClass("animated zoomIn")})}})};_self._f3n=function(){var _div=_self._2n.find("[name='iconographitem']");_div.off("tap");_div.on("tap",function(event){var _div=_self._2n.find("[name='iconograph-detaile']"),_node=_self._f4x($(this).data("item"));_div.append(_node);_div.show();_node.css({top:(g_ClientHeight-_node.height())/2});_div.one("click",function(){_div.empty();$(this).hide()});event.stopPropagation();return false})};_self._f3o=function(){_self._2q=new IScroll(_self._2p[0],{tap:true,hScrollbar:false});_self._2n.doClose=_self._f3m;_self._f3n();_self._2n.find("[name='iconographtab']").on("click",function(event){var _index=$(this).data("index");if(_index!=_self._2o){$(this).css({"background-color":"#E76624",color:"#fff"});var _childrens=_self._2n.find("[name='iconographtab']");for(var i=0;i<_childrens.length;i++){if($(_childrens[i]).data("index")==_self._2o){$(_childrens[i]).css({"background-color":"#92684F",color:""});break}}_self._2o=_index;_self._f4z()}event.stopPropagation();return false});_self._2n.find("[name='iconograph-screen-close-btn']").on("click",function(event){_self._f3m();event.stopPropagation();return false})};_self._f3p=function(){_self._2v.find("[name='collection-screen-close-btn']").off("click");_self._2v.find("[name='pic-btn']").off("click");_self._2v.find("[name='photo-btn']").off("click");_self._2v.find("[name='calendar-btn']").off("click")};_self._f3q=function(){_self._4.unbindEvent();_self._4.addClass("animated zoomOutUp").one(g_animationEnd,function(){if(_self._4!=null){_self._4.removeClass("animated zoomOutUp");_self._4.hide();_self._4=null;if(_self._6.find("[name='yard-screen']").is(":hidden")==false){_self._f5o(true)}}})};_self._f3r=function(){_self._2v.doClose=_self._f3q;_self._2v.find("[name='collection-screen-close-btn']").on("click",function(event){_self._f3q();event.stopPropagation();return false});_self._2v.find("[name='pic-btn']").on("click",function(event){_self._4.unbindEvent();_self._4.addClass("animated zoomOut").one(g_animationEnd,function(){_self._4.removeClass("animated zoomOut");_self._4.hide();_self._4=_self._2n;_self._4.show();_self._4.addClass("animated zoomIn").one(g_animationEnd,function(){_self._4.setEvent();_self._f4z();_self._4.removeClass("animated zoomIn")})});event.stopPropagation();return false});_self._2v.find("[name='photo-btn']").on("click",function(event){_self._2v.unbindEvent();_self._4.addClass("animated zoomOut").one(g_animationEnd,function(){_self._4.removeClass("animated zoomOut");_self._4.hide();_self._4=_self._2b;_self._4.show();_self._4.addClass("animated zoomIn").one(g_animationEnd,function(){_self._4.setEvent();_self._f2p();_self._4.removeClass("animated zoomIn")})});event.stopPropagation();return false});_self._2v.find("[name='calendar-btn']").on("click",function(event){_self._2v.unbindEvent();_self._4.addClass("animated zoomOut").one(g_animationEnd,function(){_self._4.removeClass("animated zoomOut");_self._4.hide();_self._4=_self._1x;_self._4.show();_self._4.addClass("animated zoomIn").one(g_animationEnd,function(){_self._4.setEvent();_self._4.removeClass("animated zoomIn")})});event.stopPropagation();return false})};_self._f3s=function(){_self._2s.find("[name='goodsitem']").off("click");_self._2s.find("[name='shopping-screen-draw-btn']").off("click");_self._2s.find("[name='shopping-screen-pagepre']").off("click");_self._2s.find("[name='shopping-screen-pagenext']").off("click")};_self._f3t=function(div,data){var _havenums=div.data("itemnums");if(data.type==1||data.type==2){if(_havenums>0){return _self._f3v("ä½ å·²ç»æ¥æ"+data.name+"äºã",1e3)}}else{if(_havenums>=99){return _self._f3v("ä½ å·²ç»æ¥æè¶³å¤å¤ç"+data.name+"äºã",1e3)}}if(_self.m_GameData.data.money<data.price){return _self._f3v("ä½ çèèæ°éä¸å¤äºå¦ã",1e3)}var subBuff=[];subBuff.push("<div style='margin: 20px;'>æ¯å¦è¦è´­ä¹°&nbsp;");subBuff.push(data.name);subBuff.push("&nbsp;ï¼</div>");subBuff.push("<div style='overflow:hidden;margin:20px auto;'><div name='confirmbtn' class='button button-raised button-royal button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>ç¡®&nbsp;&nbsp;è®¤</div><div name='cancelbtn' class='button button-raised button-caution button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>å&nbsp;&nbsp;æ¶</div></div>");_self._f4h($(subBuff.join("")),function(){div.find("[name='itemplate']").css({border:""});_havenums=div.data("itemnums")+1;div.data("itemnums",_havenums);div.find("[name='goodsname']").html(data.name+"&nbsp;<span style='font-size: 34px;font-weight: normal;color: #775742;'>x"+_havenums+"</span>");var _now=Date.now();_self._f4n(data,_now,function(){_self._f3v("ä½ è·å¾äº"+data.name,500);_self._f5f(_self.m_GameData.data.money,_self._6.find("[name='scoreNum']"))})},function(){div.find("[name='itemplate']").css({border:""})})};_self._f3u=function(div,data){var subBuff=[];subBuff.push("<div style='margin: 20px;'>æ¯å¦è¦è´­ä¹°&nbsp;");subBuff.push(data.name);subBuff.push("&nbsp;ï¼</div>");subBuff.push("<div style='overflow:hidden;margin:20px auto;'><div name='confirmbtn' class='button button-raised button-royal button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>ç¡®&nbsp;&nbsp;è®¤</div><div name='cancelbtn' class='button button-raised button-caution button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>å&nbsp;&nbsp;æ¶</div></div>");_self._f4h($(subBuff.join("")),function(){div.find("[name='itemplate']").css({border:""});var _havenums=div.data("itemnums")+1;div.data("itemnums",_havenums);div.find("[name='goodsname']").html(data.name+"&nbsp;<span style='font-size: 34px;font-weight: normal;color: #775742;'>x"+_havenums+"</span>");if(data.id==1){data.clicked=1;_self._f3v("ä½ è·å¾äºä¸ææ²»",500);_self.m_GameData.data.money-=20;_self._f5f(_self.m_GameData.data.money,_self._6.find("[name='scoreNum']"));_self._6.find("[name='toptip-msg-div']").find("[name='toptip-msg']").html("<div>ç¹å»æ¥çï¼åå»è´­ä¹°</div><div style='font-size:14px;color:#e317c3;'>åæ¥ä¸ç¶âé£æ²¹ç²¾â</div>")}else{_self._f3v("ä½ è·å¾äºé£æ²¹ç²¾",500);_self.m_GameData.data.money-=5;_self._f5f(_self.m_GameData.data.money,_self._6.find("[name='scoreNum']"));setTimeout(function(){_self.m_GameData.data.goods=[{id:1,nums:1,name:"ä¸ææ²»",resume:"éåé£é¨å¤©çè§è½éï¼ä¸ä¸ªäººå»å¤§å£å¤§å£å°åå¼ã",icon:"1001",type:0},{id:2,nums:1,name:"é£æ²¹ç²¾",resume:"æ»ä¼éå¤±å¨ä¸ç»æçè§è½éï¼ææå°åº¦è¿æ¥ç§å¬å¤ã",icon:"1102",type:1}];_self._f5g(5)},1e3)}},function(){div.find("[name='itemplate']").css({border:""})})};_self._f3v=function(msg,timeout){var subBuff=[],_node;subBuff.push("<div style='text-align: center;font-size: 16px;color: #fff;position: absolute;'><div style='overflow:auto;margin:0 auto;background-color: rgba(0,0,0,0.4);border-radius: 5px;padding: 5px 10px;display:inline-block'>");subBuff.push(msg);subBuff.push("<div><div>");_node=$(subBuff.join(""));_node.css({width:g_offsetWidth,top:g_ClientHeight/2-25});_self._6.append(_node);setTimeout(function(){_node.addClass("animated fadeOutUp").one(g_animationEnd,function(){_node.remove()})},timeout)};_self._f3w=function(){var _goodsitemdiv=_self._2s.find("[name='goodsitem']");_goodsitemdiv.off("click");_goodsitemdiv.on("click",function(event){var _data=$(this).data("iteminfo");if(_self._2t!=null){_self._2t.find("[name='itemplate']").css({"box-shadow":"","-moz-box-shadow":"","-o-box-shadow":"","-webkit-box-shadow":""})}if(_self._2t==null||_self._2t.data("iteminfo").id!=_data.id){if(_self._2t!=null){_self._2t.find("[name='itemplate']").css({border:""})}_self._2t=$(this);$(this).find("[name='itemplate']").css({"box-shadow":"0 0 40px rgba(255,22,255,0.75) inset","-moz-box-shadow":"0 0 40px rgba(255,22,255,0.75) inset","-o-box-shadow":"0 0 40px rgba(255,22,255,0.75) inset","-webkit-box-shadow":"0 0 40px rgba(255,22,255,0.75) inset"});var subBuff=[];subBuff.push("<div style='text-align: center;border-bottom: 10px dashed #F5D886;color: #3a69da'>");subBuff.push(_data.name);subBuff.push("</div>");subBuff.push(_data.resume);_self._2s.find("[name='shopping-screen-item-resume']").html(subBuff.join(""))}else{$(this).find("[name='itemplate']").css({border:"6px solid #E34612"});if(_self.m_GameData.data.tstata==15){var msg="è¿æ¯åæ¥ä¸ä¸ªä¸ææ²»å§",bOne=false;if($(_self._2s.find("[name='goodsitem']")[0]).data("iteminfo").clicked==1){msg="ç°å¨éè¦ä¸ç¶é£æ²¹ç²¾";bOne=true}if(_data.id==1){if(bOne==false){return _self._f3u($(this),_data)}}else if(_data.id==2){if(bOne==true){return _self._f3u($(this),_data)}}_self._f3v(msg,1e3)}else{_self._f3t($(this),_data)}}event.stopPropagation();return false})};_self._f3x=function(){_self._2s.find("[name='shopping-screen-draw-btn']").on("click",function(event){event.stopPropagation();return false});_self._2s.find("[name='shopping-screen-pagepre']").on("click",function(event){_self._2y--;_self._f3z();event.stopPropagation();return false});_self._2s.find("[name='shopping-screen-pagenext']").on("click",function(event){_self._2y++;_self._f3z();event.stopPropagation();return false});_self._f3w()};_self._f3y=function(){if(_self._2t!=null){_self._2t=null;_self._2s.find("[name='shopping-screen-item-resume']").empty()}};_self._f3z=function(){_self._f3y();_self._2s.find("[name='goodsitem']").off("click");_self._2s.find("[name='shopping-screen-goods']").empty();for(var i=0;i<_self._2w[_self._2y].length;i++){_self._2s.find("[name='shopping-screen-goods']").append(_self._f4y(_self._2w[_self._2y][i]))}_self._2s.find("[name='shopping-screen-pagepre']").hide();_self._2s.find("[name='shopping-screen-pagenext']").hide();if(_self._2y<Math.ceil(_self._2x/4)-1){_self._2s.find("[name='shopping-screen-pagenext']").show()}if(_self._2y>0){_self._2s.find("[name='shopping-screen-pagepre']").show()}_self._f3w()};_self._f4a=function(bShow){var i,_div,_scale=g_ClientHeight/1920;if(bShow){if(_self.m_GameData.data.tstata==15){for(i in _self.m_GoodsInShopping){_div=_self._f4y(_self.m_GoodsInShopping[i]);_self._2s.find("[name='shopping-screen-goods']").append(_div);if(i==4)break}var _toptipdiv=_self._6.find("[name='toptip-msg-div']");_toptipdiv.show();_toptipdiv.find("[name='toptip-msg']").html("<div>ç¹å»æ¥çï¼åå»è´­ä¹°</div><div style='font-size:14px;color:#e317c3;'>åæ¥ä¸ä¸ªâä¸ææ²»âå§</div>")}else{if(_self._2w==null){_self._2w=[];var sdic=Object.keys(_self.m_GoodsInShopping).sort(function(a,b){return _self.m_GoodsInShopping[a].type-_self.m_GoodsInShopping[b].type});for(i=0;i<sdic.length;i++){if(_self._2x%4==0){_self._2w.push([])}_self._2w[_self._2w.length-1].push(_self.m_GoodsInShopping[sdic[i]]);_self._2x++}_self._2y=0}_self._f3z()}if(_self._6.find("[name='yard-screen']").is(":hidden")==false){_self._6.find("[name='yard-screen']").hide();_self._f5o(false)}else{_self._6.find("[name='room-screen']").hide()}_self._f5m(false);_self._f5n(false);_self._f5l(false);_self._f5k(false);_self._f5j(false);_self._2u=20;_div=_self._6.find("[name='my-money-div']");_div.css({top:parseInt(_div.css("top"))+_self._2u,left:"","transform-origin":_self._1c,"-o-transform-origin":_self._1c,"-webkit-transform-origin":_self._1c,"-moz-transform-origin":_self._1c,right:(140+80)*_scale+35});_div=_self._6.find("[name='recharge-btn']");_div.css({top:parseInt(_div.css("top"))+_self._2u,left:"","transform-origin":_self._1c,"-o-transform-origin":_self._1c,"-webkit-transform-origin":_self._1c,"-moz-transform-origin":_self._1c,right:140*_scale+30});_self._2s.show();_self._6.find("[name='backyard-btn']").show();_self._6.find("[name='enter-room-btn']").show();_self._2s.find("[name='shopping-screen-draw-btn']").show();_self._f3x()}else{_self._f3s();_self._f3y();_self._2s.hide();_self._6.find("[name='backyard-btn']").hide();_self._2s.find("[name='shopping-screen-goods']").empty();_self._2u=0;_div=_self._6.find("[name='my-money-div']");_div.css({top:5,left:_self._3+5,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b,right:""});_div=_self._6.find("[name='recharge-btn']");_div.css({top:5,left:_self._3+310*_scale+5,"transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b,right:""});_self._6.find("[name='yard-screen']").show();if(_self._6.find("[name='yard-screen']").is(":hidden")==false){_self._f5o(true)}_self._f5m(true);_self._f5n(true);_self._f5l(true);_self._f5k(true)}};_self._f4b=function(){_self.m_nInWhere=1;if(_self._2s.is(":hidden")==false){_self._f4a(false)}_self._f5o(false);_self._6.find("[name='yard-screen']").hide();_self._6.find("[name='room-screen']").show();_self._6.find("[name='enter-room-btn']").hide();_self._f5j(true);_self._f5b();if(_self.m_GameData.data.tstata==1){return _self._f5g(2)}if((_self.m_GameData.data.tstata&32)==32){_self._f5c()}};_self._f4c=function(){_self.m_nInWhere=0;_self._6.find("[name='enter-room-btn']").show();_self._f5j(false);_self._f4a(false);_self._6.find("[name='room-screen']").hide()};_self._f4d=function(url,callback){var xhr=new XMLHttpRequest;xhr.open("GET",url+"?ajax_key="+_self.m_pFrame.ajax_key,true);if("responseType"in xhr){xhr.responseType="arraybuffer"}if(xhr.overrideMimeType){xhr.overrideMimeType("text/plain; charset=x-user-defined")}xhr.onreadystatechange=function(){var file,err;if(xhr.readyState===4){if(xhr.status===200||xhr.status===0){file=null;err=null;try{file=xhr.response||xhr.responseText}catch(e){err=new Error(e)}callback(err,file)}else{callback(new Error("Ajax error for "+url+" : "+this.status+" "+this.statusText),null)}}};xhr.send()};_self._f4e=function(url,callback){var xhr=new XMLHttpRequest;xhr.open("GET",url+"?ajax_key="+_self.m_pFrame.ajax_key,true);xhr.onreadystatechange=function(){if(xhr.readyState===4){if(xhr.status===200||xhr.status===0){callback(null,xhr.responseText)}else{callback({message:"æ²¡ææ¾å°éè¦ä¸è½½çæä»¶"})}}};xhr.send()};_self._f4f=function(){_self._1r.find("[name='help-title']").css({"background-color":"#FFFDF1",border:"solid 2px #795545","border-radius":"10px",margin:"5px auto",width:"85%"});_self._1r.find("[name='help-resume']").css({"background-color":"#FFFDF1",margin:"5px 10px",padding:"5px 5px","font-size":"14px","font-weight":"normal","text-align":"left"});var _childern=_self._1r.find("[name='help-img']");var _w=_self._1n.find("[name='help-screen-content-box']").width()-60;for(var i=0;i<_childern.length;i++){var _div=$(_childern[i]);var _imgurl=_div.data("url");_div.css({"background-image":"url("+"data/dog/"+_imgurl+".jpg)","background-size":"100% 100%",margin:"0 auto",width:_w,height:_w*320/400})}_self._1q.find("[name='help-screen-loading']").hide();_self._1q.append(_self._1r);_self._f1r();_self._1p.refresh()};_self.setEvent=function(){_self._6.find("[name='exitbtn']").on("click",function(event){if(_self._4==null){_self._f1c()}event.stopPropagation();return false});_self._6.find("[name='recharge-btn']").on("click",function(event){if(_self._4==null&&(_self.m_GameData.data.tstata&32)==32){}event.stopPropagation();return false});_self._6.find("[name='help-btn']").on("click",function(event){if(_self._4==null){_self._f5o(false);_self._4=_self._1n;_self._4.show();_self._4.addClass("animated bounceInDown").one(g_animationEnd,function(){_self._4.setEvent();if(_self._1r==null){_self._f4e("data/dogbg/helpcontent.txt",function(err,resText){if(err==null){_self._1r=$(resText);_self._f4f()}})}else{_self._1q.append(_self._1r);_self._f1r();_self._1p.refresh()}_self._4.removeClass("animated bounceInDown")})}event.stopPropagation();return false});_self._6.find("[name='collection-btn']").on("click",function(event){if(_self._4==null){_self._f5o(false);_self._4=_self._2v;_self._4.show();_self._4.addClass("animated zoomInDown").one(g_animationEnd,function(){_self._4.setEvent();
_self._4.removeClass("animated zoomInDown")})}event.stopPropagation();return false});_self._6.find("[name='mybag-btn']").on("click",function(event){if(_self._4==null){_self._f5o(false);_self._4=_self._2h;_self._2h.closeFun=null;_self._2h.extDiv=null;_self._f2v();_self._4.show();_self._f2y(0);_self._4.addClass("animated bounceInDown").one(g_animationEnd,function(){_self._4.removeClass("animated bounceInDown")})}event.stopPropagation();return false});_self._6.find("[name='enter-yard-btn']").on("click",function(event){if(_self._4==null){_self._f4c()}event.stopPropagation();return false});_self._6.find("[name='prepare-btn']").on("click",function(event){if(_self._4==null){if(_self.m_GameData.travel==0){_self._f3k()}else{_self._f3e()}}event.stopPropagation();return false});_self._6.find("[name='backyard-btn']").on("click",function(event){if(_self._4==null){if(_self.m_GameData.data.tstata!=15){_self._f4c()}}event.stopPropagation();return false});_self._6.find("[name='shop-btn']").on("click",function(event){if(_self._4==null){if(_self.m_GameData.data.tstata==15){$(this).css({"box-shadow":"","-moz-box-shadow":"","-o-box-shadow":"","-webkit-box-shadow":""})}_self._f4a(true)}event.stopPropagation();return false});_self._6.find("[name='enter-room-btn']").on("click",function(event){if(!(_self.m_GameData.data.tstata==15||_self.m_GameData.data.tstata==7)){if(_self._4==null){if(_self.m_GameData.data.tstata==1){$(this).css({"box-shadow":"","-moz-box-shadow":"","-o-box-shadow":"","-webkit-box-shadow":""})}_self._f4b()}}event.stopPropagation();return false});_self._6.find("[name='ranking-div']").on("click",function(event){if(_self._4==null){_self._f5o(false);_self._4=_self._1j;_self._4.show();_self._4.addClass("animated bounceInLeft").one(g_animationEnd,function(){_self._4.setEvent();_self._f1k();_self._4.removeClass("animated bounceInLeft")})}event.stopPropagation();return false});var _yardscreen=_self._6.find("[name='yard-screen']");var _roomscreen=_self._6.find("[name='room-screen']");if(g_isMobile==true){_yardscreen.on("touchstart",function(e){if(_self._4==null){var _touch=e.originalEvent.targetTouches[0];_self.m_Touchs={x:_touch.pageX,y:_touch.pageY}}e.preventDefault()});_yardscreen.on("touchend",function(e){if(_self._4==null){var _touch=e.originalEvent.changedTouches[0];if(_self.m_Touchs!=null){_self._f1f(_self.m_Touchs.x,_self.m_Touchs.y,_touch.pageX,_touch.pageY);_self.m_Touchs=null}}e.preventDefault()});_roomscreen.on("touchstart",function(e){if(_self._4==null){var _touch=e.originalEvent.targetTouches[0];_self.m_Touchs={x:_touch.pageX,y:_touch.pageY}}e.preventDefault()});_roomscreen.on("touchend",function(e){if(_self._4==null){var _touch=e.originalEvent.changedTouches[0];if(_self.m_Touchs!=null){_self._f1d(_self.m_Touchs.x,_self.m_Touchs.y,_touch.pageX,_touch.pageY);_self.m_Touchs=null}}e.preventDefault()})}else{_yardscreen.on("mouseover mouseout",function(event){if(_self._4==null){if(event.type=="mouseover"){if(_yardscreen.hasClass("hover")==false){_yardscreen.addClass("hover");_yardscreen.on("mousedown",function(e){_self.m_Touchs={x:e.pageX,y:e.pageY};e.stopPropagation();return false});_yardscreen.on("mouseup",function(e){if(_self.m_Touchs!=null){_self._f1f(_self.m_Touchs.x,_self.m_Touchs.y,e.pageX,e.pageY);_self.m_Touchs=null}e.stopPropagation();return false})}}else if(event.type=="mouseout"){if(_yardscreen.hasClass("hover")==true){_self.m_Touchs=null;_yardscreen.removeClass("hover");_yardscreen.off("mousedown");_yardscreen.off("mouseup")}}}event.stopPropagation();return false});_roomscreen.on("mouseover mouseout",function(event){if(_self._4==null){if(event.type=="mouseover"){if(_roomscreen.hasClass("hover")==false){_roomscreen.addClass("hover");_roomscreen.on("mousedown",function(e){_self.m_Touchs={x:e.pageX,y:e.pageY};e.stopPropagation();return false});_roomscreen.on("mouseup",function(e){if(_self.m_Touchs!=null){_self._f1d(_self.m_Touchs.x,_self.m_Touchs.y,e.pageX,e.pageY);_self.m_Touchs=null}e.stopPropagation();return false})}}else if(event.type=="mouseout"){if(_roomscreen.hasClass("hover")==true){_self.m_Touchs=null;_roomscreen.removeClass("hover");_roomscreen.off("mousedown");_roomscreen.off("mouseup")}}}event.stopPropagation();return false})}};_self._f4g=function(x0,y0,x1,y1,x2,y2,x3,y3){var divisor=(y2-y3)*(x1-x3)+(x3-x2)*(y1-y3);var a=((y2-y3)*(x0-x3)+(x3-x2)*(y0-y3))/divisor;var b=((y3-y1)*(x0-x3)+(x1-x3)*(y0-y3))/divisor;var c=1-a-b;return a>=0&&a<=1&&b>=0&&b<=1&&c>=0&&c<=1};_self._f4h=function(nodediv,confirmFun,cancelFun){_self._5=_self._6.find("[name='confirmdialog-message-div']");_self._5.closeCallBack=cancelFun;_self._5.doClose=function(){_self._5.hide();if(_self._5.closeCallBack!=null){_self._5.closeCallBack()}_self._5=null};var _div=_self._5.find("[name='confirmdialog-content']");_div.empty();_div.append(nodediv);_self._5.show();_div.css({width:"75%",position:"absolute","border-radius":10,"background-color":"rgba(243, 231, 191,0.9)",color:"#956950","font-weight":"bold",border:"solid 2px #795643",padding:"10px 10px",top:(g_ClientHeight-_div.height())/2,left:(g_offsetWidth-g_offsetWidth*.75)/2});_div.find("[name='confirmbtn']").one("click",function(){_self._5.hide();_self._5=null;confirmFun()});if(_div.find("[name='cancelbtn']").length>0){_div.find("[name='cancelbtn']").one("click",function(){_self._5.doClose()})}else{_self._5.one("click",function(){_self._5.doClose()})}};_self._f4j=function(){var subBuff=[];subBuff.push("<div name='moidify-tip' style='overflow:hidden;margin:5px auto;'><div style='width:200px;height:200px;margin: 0 auto;'><div name='avatar' style='width:100%;height:100%;'></div><input name='inputimg' type='file' accept='image/*' style='width: 100%;height: 100%;cursor: pointer;outline: medium none;position: relative;opacity: 0;-moz-opacity: 0;-o-opacity: 0;top: -200px;left: 0;'/></div><div style='overflow:hidden;margin:20px 0 10px 0;'><div name='confirmbtn' class='button button-raised button-royal button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>");subBuff.push("ä¿®&nbsp;&nbsp;æ¹");subBuff.push("</div><div name='cancelbtn' class='button button-raised button-caution button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>");subBuff.push("å&nbsp;&nbsp;æ¶");subBuff.push("</div></div></div>");subBuff.push("<div name='modify-watting' style='display:none;font-weight: bold;text-align: center;font-size: 14px;'><i class='fa fa-spinner fa-pulse'></i>&nbsp;&nbsp;æ­£å¨ä¿®æ¹ç¨æ·ï¼ç¨åâ¦</div>");_self._5=_self._6.find("[name='modify-div']");_self._5.doClose=function(){_self._5.find("[name='inputimg']").off("change");_self._5.hide();_self._5=null};var _div=_self._5.find("[name='modify-content']");_div.empty();var _node=$(subBuff.join(""));_node.find("[name='modify-input-name']").val(_self.m_GameData.name);var _picurl;if(_self.m_GameData.avatar==""){var _ricon=_self.m_GameData.uid%12;if(_self.m_GameData.gender==0){_picurl="data/dog/avatar/boy/"+_ricon+".jpg"}else{_picurl="data/dog/avatar/girl/"+_ricon+".jpg"}}else{_picurl="data/users/"+_self.m_pFrame.site_info.auth_address+"/"+_self.m_GameData.avatar}_node.find("[name='avatar']").css({"background-image":"url("+_picurl+")","background-size":"100% 100%","box-shadow":"4px 4px 4px","-moz-box-shadow":"4px 4px 4px","-o-box-shadow":"4px 4px 4px","-webkit-box-shadow":"4px 4px 4px"});_div.append(_node);_self._5.show();var _css={width:"90%",position:"relative","border-radius":10,"background-color":"rgba(243, 231, 191, 0.95)",color:"#956950","font-weight":"bold",border:"solid 2px #795643",padding:"10px 10px","font-size":16,"text-align":"center",top:(g_ClientHeight-_div.height())/2};_div.css(_css);_self._5.find("[name='inputimg']").on("change",function(){var fileList=this.files;if(fileList.length!=1){return false}if(g_checkIsImageFile(this.files[0])==false){return false}g_photoFix(this.files[0],function(url,w,h){var _width=w,_height=h;if(w>h){_width=Math.round(300/_height*_width);_height=300}else{_height=Math.round(300/_width*_height);_width=300}var img=new Image;img.onload=function(){var canvas=document.createElement("canvas");canvas.width=_width;canvas.height=_height;var context=canvas.getContext("2d");context.drawImage(img,0,0,_width,_height);var _src=canvas.toDataURL("image/jpeg",1);var img2=new Image;img2.onload=function(){var canvas=document.createElement("canvas");canvas.width=300;canvas.height=300;var context=canvas.getContext("2d");if(_width>_height){context.drawImage(img2,(_width-300)/2,0,300,300,0,0,300,300)}else{context.drawImage(img2,0,(_height-300)/2,300,300,0,0,300,300)}var _src2=canvas.toDataURL("image/jpeg",.75);_node.find("[name='avatar']").css({"background-image":"url("+_src2+")"})};img2.src=_src};img.src=url})});_self._5.find("[name='confirmbtn']").one("click",function(event){var _arr="",base64=_self._5.find("[name='avatar']").css("backgroundImage").replace("url(","").replace(")","");if(base64.toLowerCase().indexOf("data:image/jpeg;base64")==1){_arr=base64.split(",")[1]}if(_arr!=""){_self._5.find("[name='moidify-tip']").hide();_self._5.find("[name='modify-watting']").show();var _divContent=_self._5.find("[name='modify-content']");_divContent.css({top:(g_ClientHeight-_divContent.height())/2});_self._5.doClose();var content_inner_path="data/users/"+_self.m_pFrame.site_info.auth_address+"/content.json";var params={mediaType:3};var blobBin=g_dataURLtoBlob(base64);params.fileType=blobBin.type.split("/")[1];var formdata=new FormData;formdata.append("file",blobBin);_self.m_pFrame.cmd("bigfileUploadInit",["data/users/"+_self.m_pFrame.site_info.auth_address+"/"+"avatar.jpg",blobBin.size],function(init_res){var req=new XMLHttpRequest;req.upload.addEventListener("loadend",function(){_self.m_pFrame.cmd("sitePublish",{inner_path:content_inner_path,sign:true});if(_self.m_GameData.avatar==""){_self.m_GameData.avatar="avatar.jpg";var data_inner_path="data/users/"+_self.m_pFrame.site_info.auth_address+"/data.json";var content_inner_path="data/users/"+_self.m_pFrame.site_info.auth_address+"/content.json";_self.m_pFrame.cmd("fileGet",{inner_path:data_inner_path,required:false},function(data){if(data){data=JSON.parse(data);var _playerdata=JSON.parse(data.message[0].playerdata);_playerdata.avatar="avatar.jpg";data.message[0].playerdata=JSON.stringify(_playerdata);var json_raw=unescape(encodeURIComponent(JSON.stringify(data,void 0,"	")));_self.m_pFrame.cmd("fileWrite",[data_inner_path,btoa(json_raw)],function(res){if(res=="ok"){_self.m_pFrame.cmd("sitePublish",{inner_path:content_inner_path,sign:true})}else{_self.m_pFrame.cmd("wrapperNotification",["error","File write error: #{res}"])}})}})}});req.withCredentials=true;req.open("POST",init_res.url);req.send(formdata)})}else{_self._5.doClose()}event.stopPropagation();return false});_self._5.find("[name='cancelbtn']").one("click",function(event){_self._5.doClose();event.stopPropagation();return false})};_self._f4k=function(photoData,cts){_self.m_GameData.pics.push({content:photoData,date_added:cts});_self.m_GameData.pics.sort(function(a,b){return b.date_added-a.date_added});_self.m_GameData.photoid++};_self._f4l=function(MailData,cts){_self.m_GameData.mails.push({content:MailData,date_added:cts});_self.m_GameData.mails.sort(function(a,b){return b.date_added-a.date_added});_self.m_GameData.mailid++};_self._f4m=function(values,cts){if(values.length!=7)return false;var nCityID=values[0];if(nCityID!=1)return false;var strCityID=nCityID.toString();var nLocal=values[1];if(nLocal<0||nLocal>=_self.m_Citys[strCityID].maxlocals)return false;var nDesignated=values[2];if(nDesignated<0||nDesignated>=_self.m_Citys[strCityID].locations[nLocal].photos.length)return false;var mailRewordTime=values[3];if(mailRewordTime!=cts+_self.m_Citys[strCityID].spendts/2*36e5)return false;var mailPhotoTime=values[4];if(mailPhotoTime!=cts+_self.m_Citys[strCityID].spendts/4*36e5)return false;var mailFriendTime=values[5];if(mailFriendTime!=cts+36e5*5)return false;var nextActionsTime=values[6];if(nextActionsTime!=cts+_self.m_Citys[strCityID].spendts*36e5)return false;var _data={money:2,tstata:63,goods:[],iconographs:[],bag:[{id:2,nums:1,type:1}],table:[],tickets:0,lands:[]};var _now=Date.now(),_mailBackData,_MailData;_self.m_GameData.travel=1;_self.m_GameData.mailid=1;_self.m_GameData.mails=[];_self.m_GameData.pics=[];_MailData={title:"èå® ç¯çæè¡ç¤¾",resume:"å¨ï¼ä½ å¥½ï¼æ¬¢è¿æ¨çå å¥èå® ç¯çæè¡ç¤¾",content:"<p>å¨ï¼ä½ å¥½ï¼æ¬¢è¿æ¨çå å¥èå® ç¯çæè¡ç¤¾ã</p><p>å¨æè¡æé´ï¼TAä¼éå°ä¸äºå¶ä»åæ¸¸å°ä¼ä¼´å¹¶ä»ç»ç»ä½ è®¤è¯ã</p><p>ææ¶ä¹ä¼åæ¥æè¡çåç§ç§çï¼åä½ è®²è®²ææ¸¸çæäºï¼ä¹æèä¼è´­ä¹°ä¸äºå½å°ç¹äº§ç»ä½ ã</p><div style='text-align: center;color: #222;font-weight: bold;'>æ«æäºç»´ç ,å³æ³¨å¾®å</div><div style='text-align: center;width:100%;margin-bottom: 10px;'><img data-url='data/imgs/wbqcode.jpg' style='width:128px;height:128px;'/></div><div style='text-align: center;color: #222;font-weight: bold;'>ç©å¬ç½åèº«ç<br><span style='color: #22a1ff;'>å¾®åå·ï¼å°ä¼å½±å¨</span></div>",attachment:{key:"money",money:18},pid:_self.m_GameData.mailid};_self._f4l(_MailData,cts);if(_now>=mailRewordTime){_mailBackData={type:_self.m_Citys[strCityID].locations[nLocal].reword.type,id:_self.m_Citys[strCityID].locations[nLocal].reword.id};var _dataReword;if(_mailBackData.type==0){_dataReword=_self.m_Iconographs[_mailBackData.id.toString()];if(typeof _dataReword!="undefined"){_MailData={title:_dataReword.mail.title,resume:_dataReword.mail.resume,content:_dataReword.mail.content,attachment:{key:"iconograph",data:{id:_dataReword.id,name:_dataReword.name,resume:_dataReword.resume,icon:_dataReword.icon,type:_dataReword.type}},pid:_self.m_GameData.mailid};_self._f4l(_MailData,mailRewordTime)}else{return false}}else if(_mailBackData.type==2){_dataReword=_self.m_Iconographs[_mailBackData.id.toString()];if(typeof _dataReword!="undefined"){_MailData={title:_dataReword.mail.title,resume:_dataReword.mail.resume,content:_dataReword.mail.content,attachment:{key:"iconograph",data:{id:_dataReword.id,name:_dataReword.name,resume:_dataReword.resume,res01:_dataReword.res01,res02:_dataReword.res02,icon:_dataReword.icon,type:_dataReword.type}},pid:_self.m_GameData.mailid};_self._f4l(_MailData,mailRewordTime)}else{return false}}else{_dataReword=_self.m_Iconographs[_mailBackData.id.toString()];if(typeof _dataReword!="undefined"){_MailData={title:_dataReword.mail.title,resume:_dataReword.mail.resume,content:_dataReword.mail.content,attachment:{key:"goods",data:{id:_dataReword.id,name:_dataReword.name,nums:1,resume:_dataReword.resume,icon:_dataReword.icon,type:_dataReword.type}},pid:_self.m_GameData.mailid};_self._f4l(_MailData,mailRewordTime)}else{return false}}}if(_now>=mailPhotoTime){_mailBackData={id:_self.m_Citys[strCityID].locations[nLocal].photos[nDesignated]};var _dataPicture=_self.m_Pictures[_mailBackData.id.toString()];if(typeof _dataPicture!="undefined"){var _mailcityInfo=_self.m_Mailcitys[_dataPicture.id.toString()];if(typeof _mailcityInfo!="undefined"){_MailData={title:_mailcityInfo.title,resume:_mailcityInfo.resume,content:_mailcityInfo.content,attachment:{key:"photo",data:{id:_dataPicture.id,icon:_dataPicture.icon}},pid:_self.m_GameData.mailid};_self._f4l(_MailData,mailPhotoTime)}else{return false}}else{return false}}if(cts>=mailFriendTime&&cts<=mailFriendTime+(_self.m_Citys[strCityID].spendts-5)*36e5){_self.m_NeedQueryFriend={id:nCityID,st:mailFriendTime}}_data.nextActTS=nextActionsTime;for(var i=0;i<9;i++){_data.lands.push({state:0,ts:cts+24*36e5})}_self.m_GameData.data=_data;return true};_self._f4n=function(data,ts,callback){if((_self.m_GameData.data.tstata&32)==32){var msgObj={contract:{key:"buy",values:[data.id]}};_self._f1x(msgObj,function(err){if(err==null){_self._f4o([data.id],ts);return callback()}})}else{var i,nGoodIndex=-1;for(i=0;i<_self.m_GameData.data.goods.length;i++){if(_self.m_GameData.data.goods[i].id==data.id){nGoodIndex=i}}_self.m_GameData.data.money-=data.price;if(nGoodIndex!=-1){_self.m_GameData.data.goods[nGoodIndex].nums++}else{_self.m_GameData.data.goods.push({id:data.id,nums:1,name:data.name,resume:data.resume,icon:data.icon,type:data.type})}return callback()}};_self._f4o=function(values,ts){var _goodsInfo=_self.m_GoodsInShopping[values[0].toString()];if(typeof _goodsInfo=="undefined"){return false}var i,nGoodIndex=-1;for(i=0;i<_self.m_GameData.data.goods.length;i++){if(_self.m_GameData.data.goods[i].id==values[0]){nGoodIndex=i}}_self.m_GameData.data.money-=_goodsInfo.price;if(_self.m_GameData.data.money<0)return false;if(nGoodIndex!=-1){_self.m_GameData.data.goods[nGoodIndex].nums++}else{_self.m_GameData.data.goods.push({id:_goodsInfo.id,nums:1,name:_goodsInfo.name,resume:_goodsInfo.resume,icon:_goodsInfo.icon,type:_goodsInfo.type})}return true};_self._f4p=function(values,ts){var i,j,nA=0,nB=0,nC=0,bFound;if(values.length>8||_self.m_GameData.data.money==0){return false}for(i=0;i<values.length;i++){switch(values[i].type){case 0:nA++;break;case 1:nB++;break;case 2:nC++;break}}if(nA>2||nB>2||nC>4){return false}for(i=0;i<_self.m_GameData.data.table.length;i++){bFound=false;for(j=0;j<_self.m_GameData.data.goods.length;j++){if(_self.m_GameData.data.goods[j].id==_self.m_GameData.data.table[i]){bFound=true;_self.m_GameData.data.goods[j].nums++;break}}if(bFound==false){_self.m_GameData.data.goods.push({id:_self.m_GameData.data.table[i].id,name:_self.m_GameData.data.table[i].name,resume:_self.m_GameData.data.table[i].resume,icon:_self.m_GameData.data.table[i].icon,nums:1,type:_self.m_GameData.data.table[i].type})}}_self.m_GameData.data.table=[];var table=[];for(i=0;i<values.length;i++){for(j=0;j<_self.m_GameData.data.goods.length;j++){if(_self.m_GameData.data.goods[j].id==values[i].id){_self.m_GameData.data.goods[j].nums--;table.push({id:_self.m_GameData.data.goods[j].id,name:_self.m_GameData.data.goods[j].name,resume:_self.m_GameData.data.goods[j].resume,icon:_self.m_GameData.data.goods[j].icon,nums:1,type:_self.m_GameData.data.goods[j].type});if(_self.m_GameData.data.goods[j].nums==0){_self.m_GameData.data.goods.splice(j,1)}break}}}if(table.length==values.length){_self.m_GameData.data.table=table}_self.m_GameData.data.money--;return true};_self._f5u=function(values,ts){var nCityID=values[0];var _cityInfo=_self.m_Citys[nCityID.toString()];if(nCityID==0||typeof _cityInfo=="undefined")return false;var _now=Date.now();if(_now>=ts&&_now<=ts+(_cityInfo.spendts-5)*36e5){_self.m_NeedQueryFriend={id:values[0],st:ts}}return true};_self._f4q=function(values,ts){var nIndex=-1;for(var i=0;i<_self.m_GameData.mails.length;i++){if(_self.m_GameData.mails[i].content.pid==values[0]){nIndex=i;break}}if(nIndex==-1)return false;_self._f1y(_self.m_GameData.mails[i],nIndex);return true};_self._f4r=function(name,gender,avatar,now,callback){var values=[];values.push(1);var nCityID=1;var nLocal=g_getRandomNum(1,_self.m_Citys[nCityID].maxlocals)-1;values.push(nLocal);var nDesignated=g_getRandomNum(1,_self.m_Citys[nCityID].locations[nLocal].photos.length)-1;values.push(nDesignated);values.push(now+_self.m_Citys[nCityID].spendts/2*36e5);values.push(now+_self.m_Citys[nCityID].spendts/4*36e5);values.push(now+5*36e5);values.push(now+_self.m_Citys[nCityID].spendts*36e5);var newUser={contract:{key:"newplayer",values:values}};_self.m_GameData={name:name,gender:gender,avatar:avatar,uid:g_getRandomNum(1,100)};_self._f4m(values,now);callback(JSON.stringify(newUser))};_self._f4s=function(){_self._6.find("[name='ranking-div']").show();var _picurl,_div=$(_self._6.find("[name='ranking-myself']")[0]);_div.find("[name='ranking-name']").text(_self.m_GameData.name);if(_self.m_GameData.avatar==""||typeof _self.m_GameData.avatar=="undefined"){var _ricon=_self.m_GameData.uid%12;if(_self.m_GameData.gender==0){_picurl="data/dog/avatar/boy/"+_ricon+".jpg"}else{_picurl="data/dog/avatar/girl/"+_ricon+".jpg"}}else{_picurl="data/users/"+_self.m_pFrame.site_info.auth_address+"/"+_self.m_GameData.avatar}_div=_div.find("[name='ranking-avatar']");var _css={"background-image":"url("+_picurl+")","background-size":"100% 100%"};if(_self.m_GameData.gender==1){_css.border="4px solid #e720d7"}_div.css(_css);var _rdiv=_self._1j.find("[name='ranking-screen-self']");if(_self.m_GameData.gender==1){_css.border="1px solid #e720d7"}else{_css.border="";_css["-webkit-box-shadow"]=_css["-o-box-shadow"]=_css["-moz-box-shadow"]=_css["box-shadow"]="2px 2px 2px"}_rdiv.find("[name='rsi-img']").css(_css);_rdiv.find("[name='rsi-name']").text(_self.m_GameData.name);_self.m_nLastQueryMailTS=-1;_self._1v.find("[name='mailbox-screen-loading']").hide();_self.m_nLastQueryPhotoTS=0;_self.m_GameData.pics=[];_self.m_GameData.friends=[];_self._f5a()};_self._f4t=function(fullname,gender,imgarr,base64){var data_inner_path="data/users/"+_self.m_pFrame.site_info.auth_address+"/data.json";var content_inner_path="data/users/"+_self.m_pFrame.site_info.auth_address+"/content.json";var data={message:[],userinfo:[],friends:[],chatmsg:{}};var _now=Date.now();_self._f4r(fullname,gender,imgarr==""?"":"avatar.jpg",_now,function(retdata){data.message.push({playerdata:retdata,date_added:_now});data.userinfo.push({name:_self.m_GameData.name,gender:_self.m_GameData.gender,avatar:_self.m_GameData.avatar,travel:_self.m_GameData.travel,version:_self.m_version,address:_self.m_pFrame.site_info.auth_address,date_added:_now});var json_raw=unescape(encodeURIComponent(JSON.stringify(data,void 0,"	")));_self.m_pFrame.cmd("fileWrite",[data_inner_path,btoa(json_raw)],function(res){if(res=="ok"){_self._5.doClose();if(imgarr!=""){var params={mediaType:3};var blobBin=g_dataURLtoBlob(base64);params.fileType=blobBin.type.split("/")[1];var formdata=new FormData;formdata.append("file",blobBin);_self.m_pFrame.cmd("bigfileUploadInit",["data/users/"+_self.m_pFrame.site_info.auth_address+"/"+"avatar.jpg",blobBin.size],function(init_res){var req=new XMLHttpRequest;req.upload.addEventListener("loadend",function(){_self.m_pFrame.cmd("sitePublish",{inner_path:content_inner_path,sign:true});_self._f4s()});req.withCredentials=true;req.open("POST",init_res.url);req.send(formdata)})}else{_self.m_pFrame.cmd("sitePublish",{inner_path:content_inner_path,sign:true});_self._f4s()}}else{_self.m_pFrame.cmd("wrapperNotification",["error","File write error: #{res}"])}})})};_self._f4u=function(){var subBuff=[];subBuff.push("<div name='moidify-tip' style='overflow:hidden;margin:5px auto;'><div style='margin:10px auto 0 auto;width: 70%;'><input name='modify-input-name' type='text' class='form-control login-field' maxlength='10' style='height:32px;padding: 5px 10px;font-size: 14px;'/></div><div style='font-size: 13px;font-weight: normal;'>åå­é¡»æ¯2ï½10ä¸ªä¸­è±æå­æ¯çç»å<br><span style='color:#286add;'>ä¸å»ºè®®ä½¿ç¨ZeroIDä½ä¸ºç¨æ·å</span></div><div style='margin:0 auto;overflow:auto;text-align: center'><label class='checkbox' style='display: inline-block;font-size: 16px;padding: 0 0;margin-right: 10px;'><input type='radio' name='reguser-sex-radios' value='0' style='position: relative;top: 2px;'/>&nbsp;å¥æ¯å¸å¥</label><label class='checkbox' style='display: inline-block;font-size: 16px;padding: 0 0;margin-left: 10px;'><input type='radio' name='reguser-sex-radios' checked='true' value='1' style='position: relative;top: 2px;'/>&nbsp;å§æ¯ç¾å¥³</label></div><div style='width:200px;height:200px;margin: 0 auto;'><div name='avatar' style='width:100%;height:100%;'></div><input name='inputimg' type='file' accept='image/*' style='width: 100%;height: 100%;cursor: pointer;outline: medium none;position: relative;opacity: 0;-moz-opacity: 0;-o-opacity: 0;top: -200px;left: 0;'/></div><div style='font-size: 13px;font-weight: normal;margin-top: 10px;'>è¯·ä¸ä¼ ä¸å¼ å¤´åï¼ä»¥ä¾¿ç»å¯è½çTAçä¸å¥½å°è±¡ã</div><div style='overflow:hidden;margin:10px auto;'><div name='confirmbtn' class='button button-raised button-royal button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>");subBuff.push("ç¡®&nbsp;&nbsp;è®¤");subBuff.push("</div></div></div>");subBuff.push("<div name='modify-watting' style='display:none;font-weight: bold;text-align: center;font-size: 14px;'><i class='fa fa-spinner fa-pulse'></i>&nbsp;&nbsp;æ­£å¨çæèµæï¼ç¨åâ¦</div>");_self._5=_self._6.find("[name='modify-div']");_self._5.doClose=function(){_self._5.find("[name='inputimg']").off("change");_self._5.hide();_self._5=null};var _div=_self._5.find("[name='modify-content']");_div.empty();var _node=$(subBuff.join(""));_node.find("[name='modify-input-name']").val(_self.m_pFrame.site_info.cert_user_id.substr(0,_self.m_pFrame.site_info.cert_user_id.indexOf("@")));var _picurl="";_node.find("[name='avatar']").css({"background-image":"url("+_picurl+")","background-size":"100% 100%","box-shadow":"4px 4px 4px","-moz-box-shadow":"4px 4px 4px","-o-box-shadow":"4px 4px 4px","-webkit-box-shadow":"4px 4px 4px"});_div.append(_node);_self._5.show();var _css={width:"90%",position:"relative","border-radius":10,"background-color":"rgba(243, 231, 191, 0.95)",color:"#956950","font-weight":"bold",border:"solid 2px #795643",padding:"10px 10px","font-size":16,"text-align":"center",top:"18px"};_div.css(_css);_self._5.find("[name='inputimg']").on("change",function(){var fileList=this.files;if(fileList.length!=1){return false}if(g_checkIsImageFile(this.files[0])==false){return false}g_photoFix(this.files[0],function(url,w,h){var _width=w,_height=h;if(w>h){_width=Math.round(300/_height*_width);_height=300}else{_height=Math.round(300/_width*_height);_width=300}var img=new Image;img.onload=function(){var canvas=document.createElement("canvas");canvas.width=_width;canvas.height=_height;var context=canvas.getContext("2d");context.drawImage(img,0,0,_width,_height);var _src=canvas.toDataURL("image/jpeg",1);var img2=new Image;img2.onload=function(){var canvas=document.createElement("canvas");canvas.width=300;canvas.height=300;var context=canvas.getContext("2d");if(_width>_height){context.drawImage(img2,(_width-300)/2,0,300,300,0,0,300,300)}else{context.drawImage(img2,0,(_height-300)/2,300,300,0,0,300,300)}var _src2=canvas.toDataURL("image/jpeg",.75);_node.find("[name='avatar']").css({"background-image":"url("+_src2+")"})};img2.src=_src};img.src=url})});_self._5.find("[name='confirmbtn']").one("click",function(event){var _inputFullName=_self._5.find("[name='modify-input-name']");var _fullname=_inputFullName.val();g_checkFullNameIsValid(_fullname,function(bValid,result){if(bValid==false){_fullname=_self.m_pFrame.site_info.cert_user_id.substr(0,_self.m_pFrame.site_info.cert_user_id.indexOf("@"))}});var _arr="",base64=_self._5.find("[name='avatar']").css("backgroundImage").replace("url(","").replace(")","");if(base64.toLowerCase().indexOf("data:image/jpeg;base64")==1){_arr=base64.split(",")[1]}var _gender=parseInt(_self._5.find("[name='reguser-sex-radios']:checked").val());_self._5.find("[name='moidify-tip']").hide();_self._5.find("[name='modify-watting']").show();var _divContent=_self._5.find("[name='modify-content']");_divContent.css({top:(g_ClientHeight-_divContent.height())/2});var data_inner_path="data/users/"+_self.m_pFrame.site_info.auth_address+"/data.json";_self.m_pFrame.cmd("fileGet",{inner_path:data_inner_path,required:false},function(data){if(data){_self.m_pFrame.cmd("fileDelete",{inner_path:data_inner_path},function(res){_self._f4t(_fullname,_gender,_arr,base64)})}else{_self._f4t(_fullname,_gender,_arr,base64)}});event.stopPropagation();return false})};_self._f4v=function(){var subBuff=[];subBuff.push("<div name='reguser-tip' style='font-weight: bold;text-align: left;font-size: 13px;'>ä¸åªåèº«ççæè¡å¥éè®°ï¼é¤äºä¼ç»ä½ åæ¥æéç§çãå¸¦æ¥åè²ç¹äº§ãåä¿¡åè¯ä¸åçé£åäººæå¤ï¼<span style='color: #894925;'>å¶å°ä¹ä¼æç»è¯çåè¡å°ä¼ä¼´åå¶å®¶äººä»ç»ç»ä½ å¦<span>ã</div>");subBuff.push("<div name='reguser-tip' style='overflow:hidden;margin:5px auto;'><div name='confirmbtn' class='button button-raised button-royal button-pill button-small' style='margin: 0 5px;padding: 0 20px;font-weight: bold;font-size: 16px;height: 32px;line-height: 32px;'>");subBuff.push("ç»&nbsp;&nbsp;å½");subBuff.push("</div></div>");subBuff.push("<div name='reguser-watting' style='display:none;font-weight: bold;text-align: center;font-size: 14px;'><i class='fa fa-spinner fa-pulse'></i>&nbsp;&nbsp;è¯·éæ©å¸å·è¿è¡ç»å½â¦</div>");_self._5=_self._6.find("[name='register-div']");_self._5.doClose=function(){_self._5.hide();if(_self._5.closeCallBack!=null){_self._5.closeCallBack()}_self._5=null};var _div=_self._5.find("[name='register-content']");_div.html(subBuff.join(""));_self._5.show();var _css={width:"90%",position:"relative","border-radius":10,"background-color":"#F3E7BF",color:"#956950","font-weight":"bold",border:"solid 2px #795643",padding:"10px 10px",opacity:"0.95","font-size":16,"text-align":"center"};_css.top=(g_ClientHeight-_div.height())/2;_div.css(_css);_self._5.find("[name='confirmbtn']").one("click",function(event){_self._5.find("[name='reguser-tip']").hide();_self._5.find("[name='reguser-watting']").show();var _divContent=_self._5.find("[name='register-content']");_divContent.css({top:(g_ClientHeight-_divContent.height())/2});_self.m_pFrame.cmd("certSelect",{accepted_domains:["zeroid.bit"]});event.stopPropagation();return false})};_self._f4w=function(strMsg,callback){_self._5=_self._6.find("[name='dialog-message-div']");_self._5.closeCallBack=callback;_self._5.doClose=function(){_self._5.hide();if(_self._5.closeCallBack!=null){_self._5.closeCallBack()}_self._5=null};var _div=_self._5.find("[name='dialog-content']");_div.html(strMsg);_self._5.show();_div.css({width:"85%",position:"relative","border-radius":10,"background-color":"#F3E7BF",color:"#956950","font-weight":"bold",border:"solid 2px #795643",padding:"10px 10px",opacity:"0.95",left:(g_offsetWidth-g_offsetWidth*.85)/2});_div.css({top:(g_ClientHeight-_div.height())/2});if(callback!=null){_self._5.one("click",function(){_self._5.doClose()})}};_self._f4x=function(data){var hei=g_ClientHeight;var wid=g_offsetWidth;var _scale=hei/1920;var subBuff=[],_node,_w=1085*_scale*.7,_subNode;subBuff.push("<div name='content-box' style='overflow: auto;font-size: 16px;'></div>");_node=$(subBuff.join(""));subBuff=[];subBuff.push("<div style='width:90%;padding:10px;margin:0 auto;'><div style='height:40px;line-height: 40px;'>");subBuff.push(data.name);subBuff.push("</div>");subBuff.push("<div style='border-radius:20px;background-color:#EFDAAB;border:solid 2px #D1A963;margin:0 auto;background-image:url(");if(data.icon.indexOf("/")==-1){subBuff.push("data/dog/items/")}else{subBuff.push("data/imgs/items/")}subBuff.push(data.icon);subBuff.push(");background-size: 100% 100%;height:");subBuff.push(400*_scale);subBuff.push("px;width:");subBuff.push(400*_scale);subBuff.push("px;'></div>");subBuff.push("<div style='text-align:right;font-weight: normal;margin: 5px;border-bottom:3px dashed #E5D7B0;'>");subBuff.push(data.res01);subBuff.push("</div>");subBuff.push("<div style='text-align: left;padding:5px;font-size: 14px;font-weight: normal;'>");subBuff.push(data.resume);subBuff.push("</div>");subBuff.push("<div style='text-align: left;padding:5px;font-size: 14px;font-weight: normal;'>");subBuff.push(data.res02);subBuff.push("</div>");_subNode=$(subBuff.join(""));_node.append(_subNode);_node.css({"text-align":"center",width:_w,position:"absolute","border-radius":40*_scale,"background-color":"#F3E7BF",color:"#956950",border:"solid 2px #795643",left:(wid-_w)/2});return _node};_self._f4y=function(data){var _scale=g_ClientHeight/1920;var subBuff=[],_node;subBuff.push("<div name='goodsitem' style='float: left;width: 50%;height:50%;padding: ");subBuff.push(50*_scale+10);subBuff.push("px 10px 10px 10px;box-sizing: border-box;text-align:center;'>");subBuff.push("</div>");_node=$(subBuff.join(""));_node.data("iteminfo",data);var _plateNode=$("<div></div>");var nFixType=data.type+1;var _plateImg=_self._f1b("plate"+nFixType);_plateImg.attr("name","itemplate");_plateImg.css({transform:"scale("+_scale+")","-o-transform":"scale("+_scale+")","-webkit-transform":"scale("+_scale+")","-moz-transform":"scale("+_scale+")","transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b,"border-radius":20});_plateNode.append(_plateImg);var _itemImg=$("<div></div>");_itemImg.css({"background-image":"url("+"data/dog/items/"+data.icon+".png)","background-size":"100% 100%",width:280,height:280,margin:"0px auto"});
_plateImg.append(_itemImg);_plateNode.css({width:_plateImg.width()*_scale,height:_plateImg.height()*_scale,margin:"0px auto"});_node.append(_plateNode);var _itemPendantNode=$("<div></div>");var _pendant=_self._f1b("pendant");_pendant.css({margin:"0px auto"});_itemPendantNode.append(_pendant);_itemPendantNode.css({position:"relative",transform:"scale("+_scale+")","-o-transform":"scale("+_scale+")","-webkit-transform":"scale("+_scale+")","-moz-transform":"scale("+_scale+")","transform-origin":_self._1b,"-o-transform-origin":_self._1b,"-webkit-transform-origin":_self._1b,"-moz-transform-origin":_self._1b,top:-400*_scale,width:(g_offsetWidth/2-20)/_scale*4/7});var _priceDiv=$("<div name='goodprice'></div>");_self._f5f(data.price,_priceDiv);_priceDiv.css({padding:"5px 0 0 0","background-color":"#FFFCF1",border:"3px solid #BC966F"});_itemPendantNode.append(_priceDiv);_node.append(_itemPendantNode);var _itemNameNode=$("<div></div>");_itemNameNode.css({position:"relative",width:(g_offsetWidth/2-20)/_scale,"font-size":48,"font-weight":"bold",top:_plateImg.height()-(23+47+10)-100*_scale});var _itemName=$("<div name='goodsname'></div>");_itemName.css({width:_plateImg.width()-60,"background-color":"#FFFCF1",border:"6px solid #BC966F","border-radius":20,color:"#d500ff",margin:"0 auto"});var _nums=_self._f1e(data.id);if(_nums!=0){_itemName.html(data.name+"&nbsp;<span style='font-size: 34px;font-weight: normal;color: #775742;'>x"+_nums+"</span>")}else{_itemName.text(data.name)}_node.data("itemnums",_nums);_itemNameNode.append(_itemName);_itemPendantNode.append(_itemNameNode);return _node};_self._f4z=function(){_self._2r.empty();var _scale=g_ClientHeight/1920;var subBuff,i,_node,_h=(950*_scale-14)/5-10;for(i=0;i<_self.m_GameData.data.iconographs.length;i++){if(_self.m_GameData.data.iconographs[i].type>_self._2o)break;if(_self.m_GameData.data.iconographs[i].type==_self._2o){subBuff=[];subBuff.push("<div name='iconographitem' style='float: left;width: 20%;padding: 5px 5px;box-sizing: border-box;'>");subBuff.push("<div name='iconographitemimg' style='background-image:url(");if(_self.m_GameData.data.iconographs[i].icon.indexOf("/")==-1){subBuff.push("data/dog/items/")}else{subBuff.push("data/imgs/items/")}subBuff.push(_self.m_GameData.data.iconographs[i].icon);subBuff.push(");margin: 0 auto;background-size: 100% 100%;border: 1px solid #D5AA66;border-radius: 25%;height:");subBuff.push(_h);subBuff.push("px;'></div>");subBuff.push("</div>");_node=$(subBuff.join(""));_node.data("item",_self.m_GameData.data.iconographs[i]);_self._2r.append(_node)}}if(_self._2r.find("[name='iconographitem']").length==0){subBuff=[];subBuff.push("<div style='text-align: center;margin-top:60px;'><div name='item-empty'></div></div>");_node=$(subBuff.join(""));_node.find("[name='item-empty']").css({"background-image":"url("+"data/dogbg/empty.png)","background-size":"100% 100%",margin:"0 auto",width:306*_scale,height:206*_scale});_self._2r.append(_node)}_self._2q.refresh();_self._f3n()};_self.setExtData=function(extData){_self._7=extData||{}};_self._f5a=function(){if(_self._1h==true||_self._6==null)return;var _div=_self._6.find("[name='yard-mail-box-pop']");var _scale=g_ClientHeight/1920*1.15;var _opacity=1;if(_div.css("opacity")==1){_scale=g_ClientHeight/1920;_opacity=.75}else{_opacity=1}var _strScale="scale("+_scale+")";var _css={transform:_strScale,"-o-transform":_strScale,"-webkit-transform":_strScale,"-moz-transform":_strScale,opacity:_opacity};_div.show();_self._6.find("[name='yard-mail-box-pop']").transition(_css,600,_self._f5a)};_self._f5b=function(){_self._6.find("[name='room-desk']").hide();_self._6.find("[name='room-writeletter']").hide();_self._6.find("[name='room-sleep']").hide();_self._6.find("[name='room-readbook']").hide();_self._6.find("[name='room-cellphone']").hide();_self._6.find("[name='room-cooking']").hide();_self._6.find("[name='room-lunch']").hide();_self._6.find("[name='yard-door']").hide();_self._6.find("[name='yard-window']").hide();_self._6.find("[name='yard-lantern-night']").hide();_self._6.find("[name='yard-lantern']").show();_self._6.find("[name='room-lamp-night']").hide();_self._6.find("[name='room-lamp']").show()};_self._f5c=function(){if(_self.m_GameData.travel!=0)return;_self._6.find("[name='yard-door']").show();_self._6.find("[name='yard-window']").show();_self._6.find("[name='yard-lantern-night']").show();_self._6.find("[name='yard-lantern']").hide();_self._6.find("[name='room-lamp-night']").show();_self._6.find("[name='room-lamp']").hide();var timestamp=(new Date).getTime(),_div,bChange=false;if(timestamp>_self.m_nChangeInRoomStataTime||g_getRandomNum(1,100)<10){_self.m_nStataInRoom=g_getRandomNum(0,6);bChange=true}switch(_self.m_nStataInRoom){case 1:{if(bChange==true){_self.m_nChangeInRoomStataTime=timestamp+15*6e4}_div=_self._6.find("[name='room-desk']");if(_div.children("div").length==0){_div.append(_self._f1a("nap01",228,256))}}break;case 2:{if(bChange==true){_self.m_nChangeInRoomStataTime=timestamp+10*6e4}_div=_self._6.find("[name='room-writeletter']");if(_div.children("div").length==0){_div.append(_self._f1a("writeletter02",166,212))}}break;case 3:{if(bChange==true){_self.m_nChangeInRoomStataTime=timestamp+30*6e4}_div=_self._6.find("[name='room-sleep']");if(_div.children("div").length==0){_div.append(_self._f1a("sleep02",321,232))}}break;case 4:{if(bChange==true){_self.m_nChangeInRoomStataTime=timestamp+15*6e4}_div=_self._6.find("[name='room-readbook']");if(_div.children("div").length==0){_div.append(_self._f1a("readbook02",172,206))}}break;case 5:{if(bChange==true){_self.m_nChangeInRoomStataTime=timestamp+10*6e4}_div=_self._6.find("[name='room-cellphone']");if(_div.children("div").length==0){_div.append(_self._f1a("cellphone01",164,198))}}break;case 6:{if(bChange==true){_self.m_nChangeInRoomStataTime=timestamp+10*6e4}_div=_self._6.find("[name='room-cooking']");if(_div.children("div").length==0){_div.append(_self._f1a("cooking01",200,224))}}break;default:{if(bChange==true){_self.m_nChangeInRoomStataTime=timestamp+10*6e4}_div=_self._6.find("[name='room-lunch']");if(_div.children("div").length==0){_div.append(_self._f1a("eat01",178,211))}}break}_div.show()};_self._f5d=function(nStata){nStata++;var _div=_self._6.find("[name='yard-kettle']");_div.empty();_div.append(_self._f1b("s"+nStata))};_self._f5e=function(nIndex,nStata){var _div=_self._6.find("[name='yg-"+nIndex+"']");var dTypes=[2,1,4,5];_div.empty();var _node=_self._f1b("d"+dTypes[nStata]);_div.data("info",{index:nIndex,stata:nStata});_div.append(_node);if(nStata==3){_node=_self._f1b("d5-dsb");_node.css({position:"absolute",top:0});_div.append(_node)}};_self._f5f=function(nMoney,div){div.empty();div.append(_self._f1b("strawberry").css({display:"inline-block"}).css({"margin-right":"10px"}));var _strMoney=nMoney.toString();for(var i=0;i<_strMoney.length;i++){div.append(_self._f1b(_strMoney.substring(i,i+1)).css({display:"inline-block"}))}};_self._f5g=function(nStep){var _div,subBuff,_node,i;var _toptipdiv=_self._6.find("[name='toptip-msg-div']");if(nStep==0){for(i=0;i<9;i++){_self._f5e(i,3)}subBuff=[];subBuff.push("<div></div>");_node=$(subBuff.join(""));_node.css({"background-image":"url("+"data/dogbg/gift.png)","background-size":"100% 100%",width:267,height:327});_self._6.find("[name='yard-gift']").append(_node).show();_self._6.find("[name='yard-site']").append(_self._f1a("site",222,280));_self._f4w("<div style='font-size:16px;text-align: center;'><div style='text-align: left;margin-left:20px;'>å¨ï¼ä½ å¥½ï¼</div>ç¥ä½ çå¹´è¡å¤§è¿<br>ç¶åâ¦è¿ä¸ªâ¦è¿æé£ä¸ªâ¦<br>ï¼ï¼ï¼ï¼è¯å®æºæºæºï¼<div style='text-align: right;font-size: 14px;margin-right:20px;'>ä½ çæåæ¬ä¸</div></div><div style='font-size:12px;margin: 5px auto;color: #48f;text-align: center;'>ç¹å»åºæ¯ä¸­çç¤¼çï¼æ¥çç¤¼ç©</div><div style='font-size:12px;color: #d723e3;'>é¶ç½å°è¯äºå¨æ¸¸æï¼è¯·å¸®å¿åç§ãææè½å¨4æ1æ¥åï¼è½å®ææ¸¸æä¸­çæææ§è¡åçº¦é¾ãå¨æ­¤ä¹åï¼ææç¨æ·æ°æ®å°ä¼è¢«ä¸å®æå é¤ï¼è°¢è°¢ä½ çæ¯æã</div>",function(){_self.m_bNewbieGif=true;_toptipdiv.show();_toptipdiv.find("[name='toptip-msg']").text("ç¹å»æå¼ç¤¼ç")})}else if(nStep==1){_self.m_GameData.data.tstata=1;_div=_self._6.find("[name='enter-room-btn']");_div.css({"box-shadow":"0 0 60px rgba(22,22,255,0.75) inset","-moz-box-shadow":"0 0 60px rgba(22,22,255,0.75) inset","-o-box-shadow":"0 0 60px rgba(22,22,255,0.75) inset","-webkit-box-shadow":"0 0 60px rgba(22,22,255,0.75) inset"});_div.show();_div.addClass("animated flash").one(g_animationEnd,function(){$(this).removeClass("animated flash");_self._f4w("<div style='font-size:16px;text-align: center;'>æºï¼æºæºï¼ï¼<br>æç¶æ¯ä¼æºç<br>ä¸æ¡åèåèçä¸­åç°å­æ±ª<p style='font-size:12px;margin: 5px auto;color: #48f;'>ç¹å»ç»§ç»­</p></div>",function(){_self._6.find("[name='yard-site']").hide().empty();setTimeout(function(){_self._f4w("<div style='font-size:14px;text-align: center;'><div style='text-align: left;margin-left:20px;'>PSï¼</div><div>è¿æ¯ä¸åªåæ¬¢åå¤é¯è¡çæ±ª<br>å¤§åä¸çï¼é½æ³å»çç<br>åä½ ï¼å¦ï¼æ¯ç¦ä½ ç§é¡¾ï¼</div><div style='font-size:12px;margin: 5px auto;color: #48f;text-align: right;'>ç¹å»å³ä¸è§å°æ¿å­æé®ï¼è¿å¥å®¤å</div></div>",function(){_toptipdiv.show();_toptipdiv.find("[name='toptip-msg']").text("ç¹å»å®¤åæé®ï¼è¿å¥å®¤å")})},0)});_self._6.find("[name='dialog-message-div']").find("[name='dialog-content']").css({top:80})})}else if(nStep==2){_toptipdiv.find("[name='toptip-msg']").text("ççæºæºå¨å¹²åå¢ï¼");_self._6.find("[name='room-site']").show();_toptipdiv.hide();_self._f4w("<div style='font-size:16px;text-align: center;'>åºé¨å¨å¤ï¼ä¸äºä¸æ<div>å¸®çåå¤äºååç¨åå§</div><div>ååºéæå¾å¤åçç¨ç</div><div>å¯ä»¥ç¨èèè´­ä¹°</div></div><div style='font-size:12px;margin: 5px auto;color: #48f;text-align: right;'>é¢å­éçèèå·²ç»æçäºï¼å¿«å»æå§</div>",function(){_self.m_GameData.data.tstata=_self.m_GameData.data.tstata|2;_self._f5j(true);_self._6.find("[name='yard-screen']").css({left:0});_self._f4c();_self._6.find("[name='enter-room-btn']").hide();setTimeout(function(){_self._f5g(3)},0)});_self._6.find("[name='dialog-message-div']").find("[name='dialog-content']").css({top:50})}else if(nStep==3){_div=_self._6.find("[name='yard-screen']");_div.transition({left:g_offsetWidth-g_ClientHeight/1920*2160},"slow",function(){_self._6.find("[name='enter-room-btn']").show();setTimeout(function(){_self._f4w("<div style='font-size:16px;text-align: center;'>ç¹å»èèç°å°±å¯ä»¥æä¸èè<div>ææççèèå¨é½æä¸æ¥å§</div></div><div style='font-size:12px;margin: 5px auto;color: #48f;text-align: center;'>ç¹å»ç»§ç»­</div>",function(){_toptipdiv.show();_toptipdiv.find("[name='toptip-msg']").text("ç¹å»èèå¹¶éé");_self.m_GameData.data.tstata=_self.m_GameData.data.tstata|4;_self._f5h(true)})},0)})}else if(nStep==4){_div=_self._6.find("[name='shop-btn']");_div.css({"box-shadow":"0 0 60px rgba(22,22,255,0.75) inset","-moz-box-shadow":"0 0 60px rgba(22,22,255,0.75) inset","-o-box-shadow":"0 0 60px rgba(22,22,255,0.75) inset","-webkit-box-shadow":"0 0 60px rgba(22,22,255,0.75) inset"});_self._f5k(true);_div.addClass("animated flash").one(g_animationEnd,function(){$(this).removeClass("animated flash");_toptipdiv.hide();setTimeout(function(){_self._f4w("<p style='font-size:16px;'>èèæ¶å®äºï¼ç°å¨å°ååºå»ççæä»ä¹ä¸è¥¿å§<p><div style='font-size:12px;margin: 5px auto;color: #48f;text-align: right;'>ç¹å»å³ä¸è§âååºâæé®</div>",function(){_toptipdiv.show();_toptipdiv.find("[name='toptip-msg']").text("ç¹å»ååºæé®ï¼è¿å¥ååº")})},0)})}else if(nStep==5){_self.m_GameData.data.tstata=_self.m_GameData.data.tstata|16;_toptipdiv.hide();_self._f4a(false);_self._f4w("<div style='font-size:16px;text-align: center'>ç°å¨æé£ç©åç¨åé½è£è¿æ±ªçè¡åå§</div><div style='font-size:12px;margin: 5px auto;color: #48f;text-align: center'>ç¹å»ç»§ç»­</div>",function(){_self._f4b();_toptipdiv.show();_toptipdiv.find("[name='toptip-msg']").text("ç¹å»é£ç©æ ï¼å°ä¸ææ²»æ¾è¿å»");_self._f3k()})}else if(nStep==6){_toptipdiv.hide();_self._f4w("<p style='font-size:16px;'>è¡åå·²ç»åå¤å¥½ï¼ä½ çæ±ªä¸ä¼å°±ä¼ç¦»å¼äºã<p><div style='font-size:12px;margin: 5px auto;color: #48f;text-align: center'>ç¹å»ç»§ç»­</div>",function(){setTimeout(function(){_self._f4w("<p style='font-size:16px;'>å«æå¿ï¼ä½ çæ±ªå·²ç»ä¸æ¯å°å­©å­äºï¼æè¡ç»æåå°±ä¼èªå·±åæ¥çã<p><div style='font-size:12px;margin: 5px auto;color: #48f;text-align: center'>ç¹å»ç»§ç»­</div>",function(){_self._6.find("[name='room-site']").empty();for(var i=0;i<9;i++){_self._f5e(i,0)}_self._f5b();_self.m_cloneGoods=null;_self.m_GameData.data.tstata=_self.m_GameData.data.tstata|32;_self.m_GameData.travel=1;_self._6.find("[name='yard-screen']").css({left:0});_self._f4c();setTimeout(function(){_self._6.find("[name='ranking-div']").hide();_self._f4u()},0)})},0)})}};_self._f5h=function(bShow){var _div=_self._6.find("[name='my-money-div']");if(bShow==true){if((_self.m_GameData.data.tstata&4)==4){_self._6.find("[name='recharge-btn']").show();_div.show()}}else{_div.hide();_self._6.find("[name='recharge-btn']").hide()}};_self._f5j=function(bShow){var _div=_self._6.find("[name='enter-yard-btn']");var _div1=_self._6.find("[name='prepare-btn']");if(bShow==true){if((_self.m_GameData.data.tstata&2)==2){_div.show();_div1.show()}}else{_div.hide();_div1.hide()}};_self._f5k=function(bShow){var _div=_self._6.find("[name='shop-btn']");if(bShow==true){if((_self.m_GameData.data.tstata&8)==8){_div.show()}}else{_div.hide()}};_self._f5l=function(bShow){var _div=_self._6.find("[name='mybag-btn']");if(bShow==true){if((_self.m_GameData.data.tstata&32)==32){_div.show()}}else{_div.hide()}};_self._f5m=function(bShow){var _div=_self._6.find("[name='help-btn']");if(bShow==true){if((_self.m_GameData.data.tstata&32)==32){_div.show()}}else{_div.hide()}};_self._f5n=function(bShow){var _div=_self._6.find("[name='collection-btn']");if(bShow==true){if((_self.m_GameData.data.tstata&32)==32){_div.show()}}else{_div.hide()}};_self._f5o=function(bShow){var _div=_self._6.find("[name='ranking-div']"),_exitBtn=_self._6.find("[name='exitbtn']");if(bShow==true){if((_self.m_GameData.data.tstata&32)==32){_exitBtn.show();_div.show()}}else{_div.hide();_exitBtn.hide()}};_self._f5p=function(){var i,_count=0,_node,_userinfo,_picurl,_css;for(i=_self.m_GameData.friends.length-1;i>=0;i--){_userinfo=_self.m_GameData.friends[i].userinfo[0];_node=$("<div name='ranking-friend' style='height:195px;'><div name='avatar' style='width:145px;height:145px;border-radius:25%;border:4px solid #D5AA66;margin:20px auto 2px;'></div><div name='name' style='word-break:break-all;white-space: nowrap;margin: 0 auto;max-width: 150px;color:#A27F61'></div></div>");if(_userinfo.avatar==""){var _ricon=_userinfo.uid%12;if(_userinfo.gender==0){_picurl="data/dog/avatar/boy/"+_ricon+".jpg"}else{_picurl="data/dog/avatar/girl/"+_ricon+".jpg"}}else{_picurl="data/users/"+_userinfo.address+"/"+_userinfo.avatar}_css={"background-image":"url("+_picurl+")","background-size":"100% 100%"};if(_userinfo.gender==1){_css.border="4px solid #e720d7"}_node.find("[name='avatar']").css(_css);_node.find("[name='name']").text(_userinfo.name);_self._6.find("[name='ranking-div']").find("[name='ranking-content']").append(_node);_count++;if(_count==2){break}}};_self._f5q=function(userdata){var _childrens=_self._1j.find("[name='rsf-item']"),_div;for(var i=0;i<_childrens.length;i++){_div=$(_childrens[i]);if(_div.data("item").uid==userdata.uid){if(userdata.unread==true){_div.find("[name='unread']").show()}else{_div.find("[name='unread']").hide()}_div=_div.find("[name='rsfi-resume']");_self._f1hh(_div,userdata);break}}};_self.RecvFriendChatMessages=function(recvData,bNew){var _userData=_self.getFriendsDivByID(recvData.uid);if(bNew==true){_userData.mid=recvData.data[recvData.data.length-1].mid}var bUnread=false;for(var j=0;j<recvData.data.length;j++){if(_userData.chatMsgs.length>0){if(recvData.data[j].mid<_userData.chatMsgs[0].mid){_userData.chatMsgs.unshift(recvData.data[j])}else{bUnread=true;_userData.chatMsgs.push(recvData.data[j])}}else{bUnread=true;_userData.chatMsgs.push(recvData.data[j])}}if(bUnread==true){_userData.unread=true;_self._f5q(_userData)}};_self.queryFriendInfo=function(friend,callback){var data_inner_path="data/users/"+friend.address+"/data.json";_self.m_pFrame.cmd("fileGet",{inner_path:data_inner_path,required:false},function(data){if(data){data=JSON.parse(data);var bFound=false,j,_chatmsgs,_datamsg;for(var i=0;i<data.friends.length;i++){if(data.friends[i].address==_self.m_pFrame.site_info.auth_address){bFound=true;_chatmsgs=[];_datamsg=data.chatmsg[_self.m_pFrame.site_info.auth_address];if(typeof _datamsg!="undefined"){for(j=0;j<_datamsg.length;j++){_chatmsgs.push({content:_datamsg[j].content,ts:_datamsg[j].ts,uid:0})}}_datamsg=_self.m_pPlayerdata.chatmsg[friend.address];if(typeof _datamsg!="undefined"){for(j=0;j<_datamsg.length;j++){_chatmsgs.push({content:_datamsg[j].content,ts:_datamsg[j].ts,uid:_self.m_GameData.uid})}}_chatmsgs.sort(function(a,b){return a.ts-b.ts});for(j=0;j<_chatmsgs.length;j++){_chatmsgs[j].mid=j+1}callback(null,{userinfo:data.userinfo,chatmsgs:_chatmsgs,ts:friend.ts,lastmid:j});break}}if(bFound==false){callback({message:"not found"})}}else{callback({message:"not found"})}})};_self.queryFriendInfoLoop=function(){if(_self.ZN_NeedQueryFriends.length==0){_self.ZN_NeedQueryFriends=null;_self.m_GameData.friends.sort(function(a,b){return a.mid-b.mid});_self._f5p();return}var _friend={address:_self.ZN_NeedQueryFriends[0].address,ts:_self.ZN_NeedQueryFriends[0].ts};_self.ZN_NeedQueryFriends.splice(0,1);_self.queryFriendInfo(_friend,function(err,result){if(err==null){_self.m_GameData.friends.push(result)}_self.queryFriendInfoLoop()})};_self.loadFriends=function(){var data_inner_path="data/users/"+_self.m_pFrame.site_info.auth_address+"/data.json";_self.m_pFrame.cmd("fileGet",{inner_path:data_inner_path,required:false},function(data){if(data){data=JSON.parse(data);_self.m_pPlayerdata=data;for(var i=0;i<data.friends.length;i++){_self.ZN_NeedQueryFriends.push({address:data.friends[i].address,ts:data.friends[i].date_added})}_self.queryFriendInfoLoop()}})};_self.searchNewFriend=function(){if(_self.m_NeedQueryFriend==null||_self.m_NeedQueryFriend.id!=_self.m_GameData.cur_travel)return;var _qsmg="select * from userinfo where userinfo.json_id !="+_self.m_GameData.uid+" and userinfo.travel="+_self.m_NeedQueryFriend.id+" and userinfo.gender!="+_self.m_GameData.gender+" ORDER BY userinfo.date_added ASC";_self.m_pFrame.cmd("dbQuery",[_qsmg],function(messages){_self.m_NeedQueryFriend=null;if(!(messages==null||messages.length==0)){var _userinfo=messages[g_getRandomNum(1,messages.length)-1];var _cityInfo=_self.m_Citys[_self.m_GameData.cur_travel.toString()];var _Maildata={title:"è®¤è¯äºæ°é©´å",resume:_cityInfo.name+"ä¹æçå¶é",content:"<p>è¿æ¯æå¨"+_cityInfo.name+"è®¤è¯çé©´åï¼æè§çå¬ä¸éçï¼ä¹ä»ç»ç»ä½ è®¤è¯ä¸ã</p>",attachment:{key:"friend",data:{uid:_userinfo.json_id,address:_userinfo.address,gender:_userinfo.gender,name:_userinfo.name,icon:_userinfo.avatar}}};_self._f4l(_Maildata,Date.now())}})};_self._f5r=function(bRebuld,callback){_self.m_GameData={travel:0,data:{tstata:0,money:0,goods:[],bag:[],table:[]}};if(bRebuld==true){var data_inner_path="data/users/"+_self.m_pFrame.site_info.auth_address+"/data.json";_self.m_pFrame.cmd("fileDelete",{inner_path:data_inner_path},function(res){callback()})}else{callback()}};_self._f5s=function(contractObj,cts){if(contractObj.key=="dm"){return _self._f4q(contractObj.values,cts)}else if(contractObj.key=="buy"){return _self._f4o(contractObj.values,cts)}else if(contractObj.key=="pt"){return _self._f4p(contractObj.values,cts)}else if(contractObj.key=="qf"){return _self._f5u(contractObj.values,cts)}return false};_self._f5t=function(callback){var _now=Date.now();var _qsmg="select * from json join userinfo on json.json_id = userinfo.json_id where json.directory='users/"+_self.m_pFrame.site_info.auth_address+"' and userinfo.date_added<"+_now+" ORDER BY userinfo.date_added ASC";_self.m_pFrame.cmd("dbQuery",[_qsmg],function(messages){if(messages==null||messages.length!=1){return callback()}if(messages[0].version!=_self.m_version){return _self._f5r(true,callback)}var _TmpData={name:messages[0].name,gender:messages[0].gender,avatar:messages[0].avatar,cur_travel:messages[0].travel,uid:messages[0].json_id};_qsmg="select * from json join message on json.json_id = message.json_id where json.directory='users/"+_self.m_pFrame.site_info.auth_address+"' and message.date_added<"+_now+" ORDER BY message.date_added ASC";_self.m_pFrame.cmd("dbQuery",[_qsmg],function(messages){if(messages!=null&&messages.length>0){var _dataObj=JSON.parse(messages[0].playerdata);if(_dataObj.contract.key!="newplayer"){return _self._f5r(false,callback)}_self.m_GameData=_TmpData;if(_self._f4m(_dataObj.contract.values,messages[0].date_added)==false){return _self._f5r(false,callback)}for(var i=1;i<messages.length;i++){_dataObj=JSON.parse(messages[i].playerdata);if(_self._f5s(_dataObj.contract,messages[i].date_added)==false){return _self._f5r(false,callback)}}callback()}else{callback()}})})};_self.InitGame=function(){$(_self._2n.find("[name='iconographtab']")[0]).css({"background-color":"#E76624",color:"#fff"});_self._6.find("[name='yard-screen']").css({"background-image":"url("+_self._1f[0]+")","background-size":"100% 100%"});_self._6.find("[name='room-screen']").css({"background-image":"url("+_self._1f[1]+")","background-size":"100% 100%"});_self._2v.find("[name='pic-btn']").append(_self._f1b("pokedex"));_self._2v.find("[name='photo-btn']").append(_self._f1b("photos"));_self._2v.find("[name='calendar-btn']").append(_self._f1b("diary"));_self._f5f(_self.m_GameData.data.money,_self._6.find("[name='scoreNum']"));var i,_childrens,_css={position:"absolute",top:0,left:0,bottom:0,right:0,margin:"auto"};_self._2s.find("[name='shopping-screen-title']").css({background:"url("+"data/dogbg/shoppingtitle.jpg) 100%"});_self._2s.find("[name='shopping-screen-title-tip']").append(_self._f1b("shop-txt"));_childrens=_self._2s.find("[name='shopping-screen-counter']").children("div");for(i=0;i<_childrens.length;i++){$(_childrens[i]).css({background:"url("+"data/dogbg/table.jpg) 100%"})}_self._2s.find("[name='shopping-screen-pagepre']").append(_self._f1b("left"));_self._2s.find("[name='shopping-screen-pagenext']").append(_self._f1b("right"));_self._6.find("[name='recharge-btn']").append(_self._f1b("add").css(_css));_self._6.find("[name='help-btn']").append(_self._f1b("help").css(_css));_self._6.find("[name='collection-btn']").append(_self._f1b("collection").css(_css));_self._6.find("[name='mybag-btn']").append(_self._f1b("prop").css(_css));_self._6.find("[name='enter-room-btn']").append(_self._f1b("indoor").css(_css));_self._6.find("[name='enter-yard-btn']").append(_self._f1b("yard").css(_css));_self._6.find("[name='shop-btn']").append(_self._f1b("shop").css(_css));_self._6.find("[name='backyard-btn']").append(_self._f1b("yard").css(_css));_self._2s.find("[name='shopping-screen-draw-btn']").append(_self._f1b("draw_ioc").css(_css));_self._6.find("[name='prepare-btn']").append(_self._f1b("ready").css(_css));_self._6.find("[name='ranking-icon-no1']").append(_self._f1b("first"));_self._6.find("[name='yard-mail-box']").append(_self._f1b("mailbox"));_self._6.find("[name='yard-mail-box-pop']").append(_self._f1b("mail"));_self._f5d(3);_self._6.find("[name='yard-door']").append(_self._f1b("door"));_self._6.find("[name='yard-window']").append(_self._f1b("top_window"));_self._6.find("[name='yard-lantern-night']").append(_self._f1b("lantern1"));_self._6.find("[name='yard-lantern']").append(_self._f1b("lantern2"));for(i=0;i<9;i++){_self._f5e(i,2)}_self._6.find("[name='room-paper']").append(_self._f1b("paper"));_self._6.find("[name='room-cup']").append(_self._f1b("cup"));_self._6.find("[name='room-clothes']").append(_self._f1b("clothes"));_self._6.find("[name='room-lamp']").append(_self._f1b("table_lamp2"));_self._6.find("[name='room-lamp-night']").append(_self._f1b("table_lamp1"));_self._6.find("[name='loading-div']").hide();_self._6.find("[name='gamecanvas']").show();_self._8=true;if(_self.m_GameData.data.tstata==0){_self._f5g(0)}else{var _picurl,_div,_ricon,_rdiv;_self._6.find("[name='loading-msg']").text("æ´æ°ç¨æ·æ°æ®â¦");_self._6.find("[name='loading-div']").show();for(i=0;i<9;i++){_self._f5e(i,_self.m_GameData.data.lands[i].state)}_div=$(_self._6.find("[name='ranking-myself']")[0]);_div.find("[name='ranking-name']").text(_self.m_GameData.name);if(_self.m_GameData.avatar==""||typeof _self.m_GameData.avatar=="undefined"){_ricon=_self.m_GameData.uid%12;if(_self.m_GameData.gender==0){_picurl="data/dog/avatar/boy/"+_ricon+".jpg"}else{_picurl="data/dog/avatar/girl/"+_ricon+".jpg"}}else{_picurl="data/users/"+_self.m_pFrame.site_info.auth_address+"/"+_self.m_GameData.avatar}_div=_div.find("[name='ranking-avatar']");_css={"background-image":"url("+_picurl+")","background-size":"100% 100%"};if(_self.m_GameData.gender==1){_css.border="4px solid #e720d7"}_div.css(_css);_rdiv=_self._1j.find("[name='ranking-screen-self']");if(_self.m_GameData.gender==1){_css.border="1px solid #e720d7"}else{_css.border="";_css["-webkit-box-shadow"]=_css["-o-box-shadow"]=_css["-moz-box-shadow"]=_css["box-shadow"]="2px 2px 2px"}_rdiv.find("[name='rsi-img']").css(_css);_rdiv.find("[name='rsi-name']").text(_self.m_GameData.name);_self.m_GameData.data.iconographs.sort(function(a,b){return a.type-b.type});_self._1v.find("[name='mailbox-screen-loading']").hide();if(_self.m_GameData.mails.length>0){_self._f5a()}if(_self.m_GameData.travel==1){_self._f5b()}_self.m_nLastQueryPhotoTS=0;_self._f5f(_self.m_GameData.data.money,_self._6.find("[name='scoreNum']"));_self._6.find("[name='enter-room-btn']").show();_self._6.find("[name='shop-btn']").show();_self._6.find("[name='my-money-div']").show();_self._6.find("[name='recharge-btn']").show();_self._6.find("[name='help-btn']").show();_self._6.find("[name='collection-btn']").show();_self._6.find("[name='mybag-btn']").show();_self._6.find("[name='ranking-div']").show();_self._6.find("[name='exitbtn']").show();_self._1j.find("[name='ranking-screen-bottom-bar']").html("æ¯æ¨èå¥½åå å¥ï¼æ´å¤æºä¼è®¤è¯å¶ä»æè¡æ±ªã");_self.m_GameData.friends=[];_self.loadFriends();_self._6.find("[name='loading-div']").hide()}$("#screen_main").resize()};_self.getGameImageResLoop=function(callback){_self.m_pFrame.cmd("wrapperGetAjaxKey",[],function(res){_self.m_pFrame.ajax_key=res;_self._f4e("data/dogbg/gamedata.json",function(err,resText){if(err){_self._6.find("[name='loading-msg']").text("èµæºæ´æ°å¤±è´¥!")}else{var _ret=JSON.parse(resText);_self.m_GoodsInShopping=_ret.goods;_self.m_Citys=_ret.citys;_self.m_Pictures=_ret.pictures;_self.m_Mailcitys=_ret.mailcitys;_self.m_Iconographs=_ret.iconograph;if(callback==null){_self.InitGame()}else{callback()}}})})};_self.getFriendsDivByID=function(uid){var i;for(i=0;i<_self.m_GameData.friends.length;i++){if(_self.m_GameData.friends[i].uid=uid){return _self.m_GameData.friends[i]}}return null};_self.removeFriendRelationship=function(uid){var _userData=null,i;for(i=0;i<_self.m_GameData.friends.length;i++){if(_self.m_GameData.friends[i].uid=uid){_userData=_self.m_GameData.friends[i];_self.m_GameData.friends.splice(i,1);break}}};_self.rebuildFriendsUIByID=function(uid){var _userData=_self.getFriendsDivByID(uid);if(_userData==null)return;_self._f5q(_userData)};_self.updateFile=function(filename){var _filename=filename.slice(11,filename.length-10),i;if(_self.m_pPlayerdata==null)return;for(i=0;i<_self.m_GameData.friends.length;i++){if(_self.m_GameData.friends[i].userinfo[0].address==_filename){var _friend={address:_filename,ts:Date.now()};_self.queryFriendInfo(_friend,function(err,result){if(err==null){if(_self._1a!=null&&_self._1a.m_extData.userinfo.userinfo[0].address==_filename){_self._1a.recvNewChatMessage(result.chatmsgs[result.chatmsgs.length-1])}else{_self.m_GameData.friends[i]=result}}});break}}};_self.show=function(closeFunction){var offsetWidth=g_offsetWidth;var clientHeight=g_ClientHeight;_self._2=closeFunction;if($("link[href$='animate.min.css']").length==0){$("<link>").attr({rel:"stylesheet",type:"text/css",href:"data/animate.min.css",cache:true}).appendTo("head")}var _sfm=$("#screen_main");_self._6=$(_self.m_strDivHtml);_self._6.css({width:offsetWidth,height:clientHeight});_sfm.append(_self._6);_self._6.find("[name='gamecanvas']").css({height:clientHeight,width:offsetWidth});_sfm.css({width:offsetWidth+_self._3+"px",height:clientHeight+"px"});_self._1j=_self._6.find("[name='ranking-screen-div']");_self._1j.setEvent=_self._f1o;_self._1j.unbindEvent=_self._f1g;_self._1k=_self._1j.find("[name='ranking-screen-content']");_self._1m=$(_self._1k.children("div")[0]);_self._1n=_self._6.find("[name='help-screen-div']");_self._1n.setEvent=_self._f1s;_self._1n.unbindEvent=_self._f1p;_self._1o=_self._1n.find("[name='help-screen-content']");_self._1q=$(_self._1o.children("div")[0]);_self._1s=_self._6.find("[name='mailbox-screen-div']");_self._1s.setEvent=_self._f2d;_self._1s.unbindEvent=_self._f1t;_self._1t=_self._1s.find("[name='mailbox-screen-content']");_self._1v=$(_self._1t.children("div")[0]);_self._1x=_self._6.find("[name='calendar-screen-div']");_self._1x.setEvent=_self._f2g;_self._1x.unbindEvent=_self._f2e;_self._1y=_self._1x.find("[name='calendar-screen-content']");_self._2a=$(_self._1y.children("div")[0]);_self._2b=_self._6.find("[name='photo-screen-div']");_self._2b.setEvent=_self._f2r;_self._2b.unbindEvent=_self._f2h;_self._2c=_self._2b.find("[name='photo-screen-content']");_self._2e=$(_self._2c.children("div")[0]);_self._2h=_self._6.find("[name='goods-screen-div']");_self._2h.setEvent=_self._f2v;_self._2h.unbindEvent=_self._f2s;_self._2k=_self._2h.find("[name='goods-screen-content']");_self._2m=$(_self._2k.children("div")[0]);_self._2v=_self._6.find("[name='collection-screen-div']");_self._2v.setEvent=_self._f3r;_self._2v.unbindEvent=_self._f3p;_self._2n=_self._6.find("[name='iconograph-screen-div']");_self._2n.setEvent=_self._f3o;_self._2n.unbindEvent=_self._f3l;_self._2p=_self._2n.find("[name='iconograph-screen-content']");_self._2r=$(_self._2p.children("div")[0]);_self._2s=_self._6.find("[name='shopping-screen-div']");_self.m_preparebagScreen=_self._6.find("[name='preparebag-screen-div']");_self.m_preparebagScreen.setEvent=_self._f3j;_self.m_preparebagScreen.unbindEvent=_self._f3f;_self.m_prepareTableScreen=_self._6.find("[name='preparetable-screen-div']");_self.m_prepareTableScreen.setEvent=_self._f3d;_self.m_prepareTableScreen.unbindEvent=_self._f3a;_self.m_QuitDiv=_self._6.find("[name='endgame-div']");_self.m_pFrame=new iiPFrame;setTimeout(function(){_self.setEvent();$("#screen_main").resize()},0)};return _self}};$(window).resize(function(){var _css={};g_leftFix=0;g_TopFix=0;if(g_isMobile==true){g_offsetWidth=document.body.offsetWidth;g_ClientHeight=document.documentElement.clientHeight;_css.width=g_offsetWidth}else{g_offsetWidth=360;g_ClientHeight=640;if(document.body.offsetWidth<360){g_offsetWidth=document.body.offsetWidth;_css.width=g_offsetWidth;_css.left=0}else{_css.width=g_offsetWidth;_css.left=(document.body.offsetWidth-g_offsetWidth)/2;g_leftFix=_css.left}if(document.documentElement.clientHeight<g_ClientHeight){g_ClientHeight=document.documentElement.clientHeight;g_offsetWidth=g_ClientHeight*360/640;_css.width=g_offsetWidth;_css.left=(document.body.offsetWidth-g_offsetWidth)/2;g_leftFix=_css.left}_css.top=(document.documentElement.clientHeight-g_ClientHeight)/2;_css.g_TopFix=_css.top}$("#screen_main").css(_css);if(g_gs!=null){g_gs.onSizeChange(g_offsetWidth,g_ClientHeight)}});window.onload=function(){g_gs=Video_Game_Screen.createNew();g_gs.show()};var DogTravelChat_Screen={createNew:function(pScreenNode){var _self={};_self.m_pScreenNode=pScreenNode;_self.m_CloseFunction=null;_self.m_oldScreenWidth=$("#screen_main").width();_self.m_MainDiv=null;_self.m_BackBtn=null;_self.m_chatDiv=null;_self.m_chatScroll=null;_self.m_chatContent=null;_self.m_talkBar=null;_self.m_chatInputDiv=null;_self.m_sendMsgBtn=null;_self.m_pDialog=null;_self.m_pSubDialog=null;_self.m_nLastScrollY=null;_self.m_IosInputCheckTimer=null;_self.m_extData=null;_self.m_strDivHtml="<div style='position: absolute;overflow:hidden;float:left;background-color: #F5E7B8;-moz-user-select: none;-webkit-user-select: none;-o-user-select: none;user-select: none;'>                                 <div style='width:100%;margin: 0 auto;height:48px;background-color: #795643;color:#F7E0AC;z-index: 1'>                                     <button class='button button-plain button-borderless' style='width:48px;height:48px;float:left;'><i class='fa fa-arrow-left'></i></button>                                     <span style='text-align:center;line-height:48px;height:48px;float:left;margin-left: 5px;font-size: 14px;'></span>                                 </div>                                 <div><div class='scroller-hidden'>                                    <div name='endspace' style='height:20px;'></div>                                </div></div>                                <div style='position:absolute;z-index:20;background-color:#795643;'>                                    <div style='float:left;margin-top: 3px;'>                                        <div name='myemojione' contenteditable='true' spellcheck='false' style='white-space: normal;word-break: break-all;min-height: 32px;background-color: #F5E7B8;border: 1px solid #BDA673;border-radius: 5px;color: #795643;line-height: 20px;font-size: 16px;'></div>                                    </div>                                    <div style='float:right;'>                                        <div data-type=1 style='width:36px;line-height:26px;margin: 8px 5px 5px 5px;text-align: center;background-color: #87260c;;color: #fff;font-size:12px;border-radius:4px;'><i class='fa fa-plus'></i></div>                                    </div>                                </div>                              </div>";
_self.getNumsScreen=function(){return 1};_self.resetContentSize=function(offsetWidth){_self.m_chatDiv.css({position:"absolute","z-index":"1",top:"48px",bottom:"1px",left:_self.m_oldScreenWidth+"px",overflow:"hidden",height:g_ClientHeight-84+"px",width:offsetWidth+"px"})};_self.unbindEvent=function(){if(_self.m_chatScroll){_self.m_chatScroll.off("slideDown");_self.m_nLastScrollY=_self.m_chatScroll.y;_self.m_chatScroll.destroy();_self.m_chatScroll=null}_self.m_BackBtn.off("click");_self.m_sendMsgBtn.off("click")};_self.backLastScreen=function(){if(typeof _self.m_extData.hidefun=="function"){_self.m_extData.hidefun()}_self.unbindEvent();var _sfm=$("#screen_main");_sfm.transition({left:_self.m_extData.backScreenLeftPos},_self.m_extData.animatspeed,function(){_self.m_MainDiv.hide();_self.m_MainDiv.remove();_self.m_MainDiv=null;_sfm.css({width:_self.m_oldScreenWidth+"px",height:g_ClientHeight+"px"});_self.m_CloseFunction();_sfm.resize()})};_self.forceToBack=function(){if(_self.m_pSubDialog!=null){_self.m_pSubDialog.close();_self.m_pSubDialog=null}if(_self.m_pDialog!=null){_self.m_pDialog.close();_self.m_pDialog=null}_self.unbindEvent();if(typeof _self.m_extData.hidefun=="function"){_self.m_extData.hidefun()}var _sfm=$("#screen_main");_self.m_MainDiv.hide();_self.m_MainDiv.remove();_self.m_MainDiv=null;_sfm.css({left:_self.m_extData.backScreenLeftPos,width:_self.m_oldScreenWidth+"px"});_self.m_CloseFunction();_sfm.resize()};_self.backKeyDown=function(){if(_self.m_pSubDialog!=null){_self.m_pSubDialog.close();_self.m_pSubDialog=null;return false}if(_self.m_pDialog!=null){_self.m_pDialog.close();_self.m_pDialog=null;return false}_self.backLastScreen();return true};_self.onSizeChange=function(offsetWidth,clientHeight){if(_self.m_MainDiv==null)return;var _sfm=$("#screen_main");_self.m_oldScreenWidth=_sfm.width()-offsetWidth;if(clientHeight!=g_ClientHeight){clientHeight=g_ClientHeight}_sfm.css({height:clientHeight+"px"});_self.m_MainDiv.css({width:offsetWidth,height:clientHeight});_self.resetContentSize(offsetWidth);var _barHeight=_self.m_talkBar.height();_self.m_talkBar.css({width:offsetWidth,top:clientHeight-_barHeight});_self.m_nLastTalkBarHeight=_barHeight;if(_self.m_chatScroll!=null){_self.m_chatScroll.refresh();_self.scorllToChatMessageEnd(true)}};_self.addFriendInfoBox=function(){var _node=_self.m_chatContent.find("[name='friendinfobox']");if(_node.length>0)return;_node=$("<div name='friendinfobox' class='message-receive chatmessage chatmessage-receive'><div class='message-info'><div><div class='user-avatar'></div></div><div class='message-content-box' style='box-shadow: 2px 2px 2px rgba(128,128,128,0.5);-o-box-shadow: 2px 2px 2px rgba(128,128,128,0.5);-moz-box-shadow: 2px 2px 2px rgba(128,128,128,0.5);-webkit-box-shadow: 2px 2px 2px rgba(128,128,128,0.5);'><div class='arrow'></div><div class='message-content' style='color:#795643'></div></div></div></div>");var _avatar=$(_node.find(".user-avatar"));var _strBorderType="2px solid #CC33CC";var _userinfo=_self.m_extData.userinfo.userinfo[0];if(_userinfo.gender==0){_strBorderType="2px solid #5874EF"}var _picurl;if(_userinfo.avatar==""){var _ricon=_userinfo.uid%12;if(_self.m_extData.userinfo.data.gender==0){_picurl="data/dog/avatar/boy/"+_ricon+".jpg"}else{_picurl="data/dog/avatar/girl/"+_ricon+".jpg"}}else{_picurl="data/users/"+_userinfo.address+"/"+_userinfo.avatar}_avatar.css({border:_strBorderType,"box-shadow":"2px 2px 2px rgba(128,128,128,0.75)","-moz-box-shadow":"2px 2px 2px rgba(128,128,128,0.75)","-o-box-shadow":"2px 2px 2px rgba(128,128,128,0.75)","-webkit-box-shadow":"2px 2px 2px rgba(128,128,128,0.75)","background-image":"url("+_picurl+")","background-size":"100% 100%"});var _msgcontent=$(_node.find(".message-content"));var subBuff=[];subBuff.push("<div><div class='message-content-img' style='width:200px;height:200px;'></div><div style='margin-top: 5px;'>");subBuff.push("<i class='fa ");if(_userinfo.gender==1){subBuff.push("fa-venus' style='color:#FF3EAE';")}else{subBuff.push("fa-mars' style='color:#544CF0';")}subBuff.push("margin-left:10px;margin-right:10px;></i>&nbsp;&nbsp;");subBuff.push(_userinfo.name);subBuff.push("</div>");_msgcontent.html(subBuff.join(""));_msgcontent.data("msgid",0);_msgcontent.attr("name","images");var _aavatar=$(_msgcontent.find(".message-content-img"));_aavatar.css({"background-image":"url("+_picurl+")"});_self.m_chatContent.prepend(_node)};_self.slideDownEnd=function(){_self.m_chatScroll.off("scrollEnd",_self.slideDownEnd);_self.m_chatScroll.on("slideDown",_self.getMoreChatMsg);_self.m_pScreenNode.queryChatMsgByUid(_self.m_extData.userinfo.uid,function(result){if(_self.m_MainDiv==null)return;var _childrens,i,bEnd=false;if(result==0||result<15){bEnd=true}if(result>0){for(i=result-1;i>=0;i--){_childrens=_self.m_chatContent.children(".chatmessage");if(_childrens.length>1){var _mid=$(_childrens[1]).data("user").mid;if(_mid>_self.m_extData.userinfo.chatMsgs[i].mid){_self.updateChatDiv(_self.m_extData.userinfo.chatMsgs[i],1)}else if(_mid==_self.m_extData.userinfo.chatMsgs[i].mid){break}}else{_self.updateChatDiv(_self.m_extData.userinfo.chatMsgs[i],0)}}}if(bEnd==true){_self.addFriendInfoBox()}_self.resetMessageContentEvent();_self.m_chatScroll.refresh();_self.m_chatScroll.scrollTo(0,_self.m_chatScroll.maxScrollY-_self.m_nLastScrollY,0)})};_self.getMoreChatMsg=function(){if(_self.m_chatScroll.y>40){_self.m_nLastScrollY=_self.m_chatScroll.maxScrollY;_self.m_chatScroll.off("slideDown",_self.getMoreChatMsg);_self.m_chatScroll.on("scrollEnd",_self.slideDownEnd)}};_self.resetMessageContentEvent=function(){};_self.scorllToChatMessageEnd=function(bAtOnce){_self.m_chatScroll.scrollToElement($(_self.m_chatContent.find("[name='endspace']"))[0],bAtOnce==true?0:null)};_self.setEvent=function(){_self.resetMessageContentEvent();_self.m_chatScroll=new IScroll(_self.m_chatDiv[0],{probeType:3,tap:true,mouseWheel:true,hScrollbar:false});_self.m_chatScroll.on("slideDown",_self.getMoreChatMsg);if(_self.m_nLastScrollY!=null){_self.m_chatScroll.scrollTo(0,_self.m_nLastScrollY,0)}else{_self.scorllToChatMessageEnd(true)}_self.m_chatInputDiv.on("focus",function(){_self.m_chatInputDiv.on("input",function(){var _text=_self.m_chatInputDiv.text();var nLen=_text.length;if(_text!="\n"&&nLen>=1){if(_self.m_sendMsgBtn.data("type")==1){_self.m_sendMsgBtn.data("type",0);_self.m_sendMsgBtn.text("çè¨")}if(nLen>1e3){_self.m_chatInputDiv.text(_text.substring(0,1e3))}}else{_self.m_chatInputDiv.text("");_self.m_sendMsgBtn.data("type",1);_self.m_sendMsgBtn.html("<i class='fa fa-plus'></i>")}if(_self.m_talkBar.height()!=_self.m_nLastTalkBarHeight){$("#screen_main").resize()}});_self.m_chatInputDiv.on("blur",function(){if(_self.m_IosInputCheckTimer!=null){clearInterval(_self.m_IosInputCheckTimer);_self.m_IosInputCheckTimer=null}_self.m_chatInputDiv.off("blur");_self.m_chatInputDiv.off("input")})});_self.m_BackBtn.on("click",function(event){_self.backLastScreen();event.stopPropagation();return false});_self.m_sendMsgBtn.on("click",function(event){if($(this).data("type")==1){_self.m_MainDiv.find("div.emojionearea").show();_self.m_pDialog=$.dialog({title:false,closeIcon:false,content:"<span style='font-size: 15px;'>ZeroNetçæºå¶éå¶ï¼ä¸ºé²æ­¢æ»¥ç¨ï¼æ¬çæ¬çèå¤©ä¸æ¯æå¾çåè¯­é³ã</span>",onClose:function(){_self.m_pDialog=null}})}else{var _content=$.trim(_self.m_chatInputDiv.text());_content=_content.replace(/[<>&"]/g,function(c){return{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"}[c]});_self.m_chatInputDiv.text("");$(this).data("type",1);$(this).html("<i class='fa fa-plus'></i>");$("#screen_main").resize();var timestamp=Math.round((new Date).getTime());var _msg={mid:_self.m_extData.userinfo.lastmid,content:_content,ts:timestamp,uid:_self.m_extData.GameData.uid};_self.createNewChatMsg(_msg);_self.m_extData.userinfo.lastmid++;_self.m_extData.userinfo.chatmsgs.push(_msg);if(typeof g_gs.m_pPlayerdata.chatmsg[_self.m_extData.userinfo.userinfo[0].address]=="undefined"){g_gs.m_pPlayerdata.chatmsg[_self.m_extData.userinfo.userinfo[0].address]=[]}g_gs.m_pPlayerdata.chatmsg[_self.m_extData.userinfo.userinfo[0].address].push({content:_content,ts:timestamp});var data_inner_path="data/users/"+g_gs.m_pFrame.site_info.auth_address+"/data.json";var content_inner_path="data/users/"+g_gs.m_pFrame.site_info.auth_address+"/content.json";var json_raw=unescape(encodeURIComponent(JSON.stringify(g_gs.m_pPlayerdata,void 0,"	")));g_gs.m_pFrame.cmd("fileWrite",[data_inner_path,btoa(json_raw)],function(res){if(res=="ok"){g_gs.m_pFrame.cmd("sitePublish",{inner_path:content_inner_path,sign:true})}else{g_gs.m_pFrame.cmd("wrapperNotification",["error","File write error: #{res}"])}})}event.stopPropagation();return false})};_self.createNewChatMsg=function(tmpChatMsg){var subBuff=[];var nLen=_self.m_extData.userinfo.chatmsgs.length;var bAddTimeStr=false;if(nLen>0){if(_self.m_extData.userinfo.chatmsgs[nLen-1].ts<tmpChatMsg.ts-1e3*60*5){bAddTimeStr=true}}if(bAddTimeStr==true||nLen==0){subBuff.push("<div style='text-align: center;margin:0 auto;'><span style='border-radius:4px;padding: 4px 6px;font-size:12px;background-color: #999999;color:#fff;'>");subBuff.push(g_timeAgo(tmpChatMsg.ts));subBuff.push("</span></div>")}subBuff.push("<div class='message-send chatmessage chatmessage-send'><div class='message-info' style='min-height:44px;'><div><div class='user-avatar'></div></div><div class='message-content-box' style='box-shadow: 2px 2px 2px rgba(128,128,128,0.5);-o-box-shadow: 2px 2px 2px rgba(128,128,128,0.5);-moz-box-shadow: 2px 2px 2px rgba(128,128,128,0.5);-webkit-box-shadow: 2px 2px 2px rgba(128,128,128,0.5);'><div class='arrow'></div><div class='message-content' style='color:#795643'></div></div></div></div>");_self.m_chatContent.find("[name='endspace']").before(subBuff.join(""));var _childrens=_self.m_chatContent.children(".chatmessage");var _contentLast=$(_childrens[_childrens.length-1]);_contentLast.data("user",tmpChatMsg);var _avatar=$(_contentLast.find(".user-avatar"));var _strBorderType="2px solid #CC33CC";if(_self.m_extData.GameData.gender==0){_strBorderType="2px solid #5874EF"}var _picurl;if(_self.m_extData.GameData.avatar==""){_ricon=_self.m_extData.GameData.uid%12;if(_self.m_extData.GameData.gender==0){_picurl="data/dog/avatar/boy/"+_ricon+".jpg"}else{_picurl="data/dog/avatar/girl/"+_ricon+".jpg"}}else{_picurl="data/users/"+g_gs.m_pFrame.site_info.auth_address+"/"+_self.m_extData.GameData.avatar}_avatar.css({border:_strBorderType,"box-shadow":"2px 2px 2px rgba(128,128,128,0.75)","-moz-box-shadow":"2px 2px 2px rgba(128,128,128,0.75)","-o-box-shadow":"2px 2px 2px rgba(128,128,128,0.75)","-webkit-box-shadow":"2px 2px 2px rgba(128,128,128,0.75)","background-image":"url("+_picurl+")","background-size":"100% 100%"});var _msgcontent=$(_contentLast.find(".message-content"));var reg=/(http:\/\/|https:\/\/)((\w|=|\?|\.|\/|&|-)+)/g;_msgcontent.html(tmpChatMsg.content.replace(reg,"<a target='_blank' href='$1$2' >$1$2</a>").replace(/\n/g,"<br>"));_msgcontent.data("msginfo",tmpChatMsg.mid);_self.resetMessageContentEvent();_self.m_chatScroll.refresh();_self.m_chatScroll.scrollToElement($(_self.m_chatContent.find("[name='endspace']"))[0])};_self.setExtData=function(extData){_self.m_extData=extData||{}};_self.addChatMsgTimeDiv=function(chatMsg,strBuff){var subBuff=[];var nLen=_self.m_extData.userinfo.chatmsgs.length;var nIndex=jQuery.inArray(chatMsg,_self.m_extData.userinfo.chatmsgs);var bAddTimeStr=false;if(nIndex!=0&&nIndex<nLen){if(_self.m_extData.userinfo.chatmsgs[nIndex-1].ts<chatMsg.ts-1e3*60*5){bAddTimeStr=true}}if(bAddTimeStr==true||nIndex==0){subBuff.push("<div style='text-align: center;margin:0 auto;'><span style='border-radius:4px;padding: 4px 6px;font-size:12px;background-color: #999999;color:#fff;'>");subBuff.push(g_timeAgo(chatMsg.ts));subBuff.push("</span></div>")}subBuff.push(strBuff);return subBuff.join("")};_self.updateChatDiv=function(chatMsg,insertPos){var subBuff=[],_picurl,_strBorderType="2px solid #CC33CC",_ricon;if(chatMsg.mid>=_self.m_extData.userinfo.lastmid){_self.m_extData.userinfo.lastmid=0}if(chatMsg.uid==0){subBuff.push("<div class='message-receive chatmessage chatmessage-receive'>");if(_self.m_extData.userinfo.userinfo[0].gender==0){_strBorderType="2px solid #5874EF"}if(_self.m_extData.userinfo.userinfo[0].avatar==""){if(_self.m_extData.userinfo.userinfo[0].gender==0){_picurl="data/dog/avatar/boy/"+_ricon+".jpg"}else{_picurl="data/dog/avatar/girl/"+_ricon+".jpg"}}else{_picurl="data/users/"+_self.m_extData.userinfo.userinfo[0].address+"/"+_self.m_extData.userinfo.userinfo[0].avatar}}else{subBuff.push("<div class='message-send chatmessage chatmessage-send'>");if(_self.m_extData.GameData.gender==0){_strBorderType="2px solid #5874EF"}if(_self.m_extData.GameData.avatar==""){_ricon=_self.m_extData.GameData.uid%12;if(_self.m_extData.GameData.gender==0){_picurl="data/dog/avatar/boy/"+_ricon+".jpg"}else{_picurl="data/dog/avatar/girl/"+_ricon+".jpg"}}else{_picurl="data/users/"+g_gs.m_pFrame.site_info.auth_address+"/"+_self.m_extData.GameData.avatar}}subBuff.push("<div class='message-info'><div><div class='user-avatar'></div></div><div class='message-content-box'  style='box-shadow: 2px 2px 2px rgba(128,128,128,0.5);-o-box-shadow: 2px 2px 2px rgba(128,128,128,0.5);-moz-box-shadow: 2px 2px 2px rgba(128,128,128,0.5);-webkit-box-shadow: 2px 2px 2px rgba(128,128,128,0.5);'><div class='arrow'></div><div class='message-content'  style='color:#795643'></div></div></div></div>");var _childrens,_contentLast;if(insertPos==0){_self.m_chatContent.find("[name='endspace']").before(_self.addChatMsgTimeDiv(chatMsg,subBuff.join("")));_childrens=_self.m_chatContent.children(".chatmessage");_contentLast=$(_childrens[_childrens.length-1])}else{_self.m_chatContent.prepend(_self.addChatMsgTimeDiv(chatMsg,subBuff.join("")));_childrens=_self.m_chatContent.children(".chatmessage");_contentLast=$(_childrens[0])}_contentLast.data("user",chatMsg);var _avatar=$(_contentLast.find(".user-avatar"));_avatar.css({border:_strBorderType,"box-shadow":"2px 2px 2px rgba(128,128,128,0.75)","-moz-box-shadow":"2px 2px 2px rgba(128,128,128,0.75)","-o-box-shadow":"2px 2px 2px rgba(128,128,128,0.75)","-webkit-box-shadow":"2px 2px 2px rgba(128,128,128,0.75)","background-image":"url("+_picurl+")","background-size":"100% 100%"});var _msgcontent=$(_contentLast.find(".message-content"));var reg=/(http:\/\/|https:\/\/)((\w|=|\?|\.|\/|&|-)+)/g;_msgcontent.html(chatMsg.content.replace(reg,"<a target='_blank' href='$1$2' >$1$2</a>").replace(/\n/g,"<br>"));if(chatMsg.uid==0){_avatar.data("userid",0)}else{_msgcontent.data("msgid",chatMsg.mid)}};_self.recvNewChatMessage=function(msg){_self.m_extData.userinfo.chatmsgs.push(msg);_self.updateChatDiv(_self.m_extData.userinfo.chatmsgs[_self.m_extData.userinfo.chatmsgs.length-1],0);_self.resetMessageContentEvent();var y=_self.m_chatScroll.y,maxScrollY=_self.m_chatScroll.maxScrollY;_self.m_chatScroll.refresh();if(y<maxScrollY+g_ClientHeight/3){_self.m_chatScroll.scrollToElement($(_self.m_chatContent.find("[name='endspace']"))[0],100)}return true};_self.recvRemoveFriendRelationship=function(uid){if(uid!=_self.m_extData.userinfo.uid)return;_self.forceToBack()};_self.show=function(closeFunction){var offsetWidth=g_offsetWidth;var clientHeight=g_ClientHeight;_self.m_CloseFunction=closeFunction;var _sfm=$("#screen_main");_self.m_MainDiv=$(_self.m_strDivHtml);_self.m_MainDiv.css({width:offsetWidth,height:clientHeight});_sfm.append(_self.m_MainDiv);_sfm.css({width:offsetWidth+_self.m_oldScreenWidth,height:clientHeight});var _childrens=_self.m_MainDiv.children("input");_self.inputFile=$(_childrens[0]);_childrens=_self.m_MainDiv.children("div");$($(_childrens[0]).children("span")[0]).text(_self.m_extData.userinfo.userinfo[0].name);_self.m_chatDiv=$(_childrens[1]);_self.m_chatContent=$(_self.m_chatDiv.children("div")[0]);_self.resetContentSize(offsetWidth);_self.m_talkBar=$(_childrens[2]);_self.m_talkBar.css({width:offsetWidth+"px",top:clientHeight-42+"px"});var _talkbarChildrens=_self.m_talkBar.children("div"),_inputDivW=52;$(_talkbarChildrens[0]).css({"margin-left":"5px",width:offsetWidth-_inputDivW});_self.m_chatInputDiv=_self.m_MainDiv.find("[name='myemojione']");_self.m_chatInputDiv.css({width:offsetWidth-_inputDivW,"max-width":offsetWidth-_inputDivW});_self.m_sendMsgBtn=$(_talkbarChildrens[1]).find("div");var _div=$(_childrens[0]);_childrens=_div.children("button");_self.m_BackBtn=$(_childrens[0]);for(var i=0;i<_self.m_extData.userinfo.chatmsgs.length;i++){_self.updateChatDiv(_self.m_extData.userinfo.chatmsgs[i],0)}if(_self.m_extData.userinfo.chatmsgs.length<15){_self.addFriendInfoBox()}_sfm.transition({left:_self.m_extData.moveToLeft+"%"},_self.m_extData.animatspeed,function(){if(typeof _self.m_extData.showfun=="function"){_self.m_extData.showfun()}_self.setEvent();_sfm.resize()})};return _self}};