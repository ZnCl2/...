<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Wireguard Gateway &amp; Android :: MH Site — A simple Homepage</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Setup your Linux Server Your Linux server should be accessible via a public IP by UDP. If the IP address changes, use DynDNS.
First install WireGuard on your Linux server. On the official website you will find the right way for your Linux distro: WireGuard.com/install
Then configure the Gateway. We will use the range 100.64.0.0/10 (RFC 6598) because it doesn&amp;rsquo;t colide with private IPv4 adresses (RFC 1918).
echo &#39;[Interface]&#39; &amp;gt; /etc/wireguard/wg0."/>
<meta name="keywords" content="Homepage 6543"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/post/wireguard-vps-android/" />




<link rel="stylesheet" href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/assets/style.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/img/favicon/orange.png">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Wireguard Gateway &amp; Android :: MH Site — A simple Homepage" />
<meta name="twitter:description" content="Setup your Linux Server Your Linux server should be accessible via a public IP by UDP. If the IP address changes, use DynDNS.
First install WireGuard on your Linux server. On the official website you will find the right way for your Linux distro: WireGuard.com/install
Then configure the Gateway. We will use the range 100.64.0.0/10 (RFC 6598) because it doesn&amp;rsquo;t colide with private IPv4 adresses (RFC 1918).
echo &#39;[Interface]&#39; &amp;gt; /etc/wireguard/wg0." />
<meta name="twitter:site" content="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/" />
<meta name="twitter:creator" content="MH" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Wireguard Gateway &amp; Android :: MH Site — A simple Homepage">
<meta property="og:description" content="Setup your Linux Server Your Linux server should be accessible via a public IP by UDP. If the IP address changes, use DynDNS.
First install WireGuard on your Linux server. On the official website you will find the right way for your Linux distro: WireGuard.com/install
Then configure the Gateway. We will use the range 100.64.0.0/10 (RFC 6598) because it doesn&amp;rsquo;t colide with private IPv4 adresses (RFC 1918).
echo &#39;[Interface]&#39; &amp;gt; /etc/wireguard/wg0." />
<meta property="og:url" content="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/post/wireguard-vps-android/" />
<meta property="og:site_name" content="Wireguard Gateway &amp; Android" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2019-07-07 14:41:00 &#43;0200 CEST" />











</head>
<body class="">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/">
  <div class="logo">
    [MH @ Obermui ~]#
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/about">About</a></li>
        
      
        
          <li><a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/post">Posts</a></li>
        
      
        
          <li><a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/projects">Projects</a></li>
        
      
      
        <ul class="menu__sub-inner">
          <li class="menu__sub-inner-more-trigger">Show more ▾</li>

          <ul class="menu__sub-inner-more hidden">
            
              
                <li><a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/services">Services</a></li>
              
            
              
                <li><a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/index.xml">RSS</a></li>
              
            
          </ul>
        </ul>
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/about">About</a></li>
      
    
      
        <li><a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/post">Posts</a></li>
      
    
      
        <li><a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/projects">Projects</a></li>
      
    
      
        <li><a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/services">Services</a></li>
      
    
      
        <li><a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/index.xml">RSS</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/post/wireguard-vps-android/">Wireguard Gateway &amp; Android</a></h1>
  <div class="post-meta">
      
    <span class="post-date">
      2019-07-07
    </span>
    
    
    <span class="post-author">::
      MH
    </span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/tags/vpn/">VPN</a>&nbsp;
    
    #<a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/tags/wireguard/">Wireguard</a>&nbsp;
    
    #<a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/tags/android/">Android</a>&nbsp;
    
    #<a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/tags/setup/">Setup</a>&nbsp;
    
  </span>
  

  

  <div class="post-content">
    <h1 id="setup-your-linux-server">Setup your Linux Server</h1>
<p>Your Linux server should be accessible via a public IP by UDP.
If the IP address changes, use DynDNS.</p>
<p>First <strong>install WireGuard</strong> on your Linux server. On the official website you will find
the right way for your Linux distro:
<a href="https://www.wireguard.com/install/">WireGuard.com/install</a></p>
<p>Then <strong>configure</strong> the Gateway.
We will use the range 100.64.0.0/10 (RFC 6598) because it doesn&rsquo;t colide with private IPv4 adresses (RFC 1918).</p>
<pre><code>echo '[Interface]'                   &gt; /etc/wireguard/wg0.conf
echo &quot;PrivateKey = $(wg genkey)&quot;    &gt;&gt; /etc/wireguard/wg0.conf
echo 'ListenPort = 50002'           &gt;&gt; /etc/wireguard/wg0.conf
echo &quot;Address = 100.64.0.1/10&quot;      &gt;&gt; /etc/wireguard/wg0.conf

iptables -t nat -A POSTROUTING -s 100.64.0.0/10 -o eth0 -j MASQUERADE
systemctl enable --now wg-quick@wg0
</code></pre>
<p>Don&rsquo;t forget to save the iptables rules for the next start. The easiest way is to use cron, but I don&rsquo;t recommend it.</p>
<p>To get the public key (you need it later on):</p>
<pre><code>wg pubkey &lt;&lt;&lt;$(grep PrivateKey /etc/wireguard/wg0.conf  | cut -d ' ' -f3)
</code></pre>
<p>Now the gateway is configured and running. To get some information, type in wg and use systemd:</p>
<pre><code>systemctl status wg-quick@wg0
wg show
</code></pre>
<h1 id="setup-your-android">Setup your Android</h1>
<p>Download the App from <a href="https://f-droid.org/en/packages/com.wireguard.android/">F-Droid</a> or <a href="https://play.google.com/store/apps/details?id=com.wireguard.android">Google Play</a>.</p>
<p>In WireGuard, you must manually set an IP address for each client. The <code>100.64.0.0.0.0/10</code> area has hosts from <code>100.64.0.1</code> to <code>100.127.255.254</code>, the first one is already occupied by the gateway, so we use <code>100.64.0.0.2</code>.</p>
<table>
<thead>
<tr>
<th><img src="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/
img/wireguard-android/A.jpg" alt=""></th>
<th><img src="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/
img/wireguard-android/B.jpg" alt=""></th>
<th><img src="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/
img/wireguard-android/C.jpg" alt=""></th>
</tr>
</thead>
<tbody>
<tr>
<td>Open the app and &ldquo;Create from scratch&rdquo;</td>
<td>Generate a key pair. Make a note of the public key, you will need it later. Name the configuration and add the client IP address with 32 mask.</td>
<td>Add a peer. Now enter the gateway information. Allowed IPs is <code>0.0.0.0/0</code>.</td>
</tr>
</tbody>
</table>
<h1 id="add-android-client-to-server">Add Android Client to Server</h1>
<p>Now add the client information to the gateway and restart the interface.</p>
<pre><code>[Peer]                            &gt;&gt; /etc/wireguard/wg0.conf
PublicKey = &lt;Client-Pub-Key&gt;      &gt;&gt; /etc/wireguard/wg0.conf
AllowedIPs = 100.64.0.2/32      &gt;&gt; /etc/wireguard/wg0.conf

systemctl restart wg-quick@wg0 &amp;&amp; systemctl status wg-quick@wg0
</code></pre>
<h1 id="sources">Sources</h1>
<p><a href="https://www.wireguard.com/quickstart/">Wireguard Quickstart</a></p>
<p>Heise <a href="https://www.heise.de/select/ct/2019/5/1551091519824850">Besser tunneln</a></p>
<p>Witepaper <a href="https://www.wireguard.com/papers/wireguard.pdf">WireGuard: Next Generation Kernel Network Tunnel</a></p>
<p>Demo Video <a href="https://video.obermui.de/videos/watch/5009724a-a670-4130-bc99-4ab820773da6">Test WireGuard VPN net roaming</a></p>

  </div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span
        class="pagination__title-h">Read other posts</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      <span class="button previous">
        <a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/post/proxy-clearnet-2-onion/">
          <span class="button__icon">←</span>
          <span class="button__text">Clearnet -&gt; Onion Website</span>
        </a>
      </span>
      
      
      <span class="button next">
        <a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/post/setup-namecoin-tld-lookup/">
          <span class="button__text">Setup Namecoin Tld Lookup</span>
          <span class="button__icon">→</span>
        </a>
      </span>
      
    </div>
  </div>
  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    <div class="copyright">
      
        <span>Copyright CC-By-NC-4.0</span>
        <span>::
      
      Powered by <a href="http://gohugo.io">Hugo</a></span>
      <span>&nbsp;::&nbsp;Theme by <a href="https://twitter.com/panr">panr</a></span>
      <span>&nbsp;::&nbsp;<a href="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/contact">Impressum</a></span>
    </div>
  </div>
</footer>

<script src="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/assets/main.js"></script>
<script src="/15VuKHSRKpgyGAX87mCHYF2L95vad33SPY/assets/prism.js"></script>

  
</div>

</body>
</html>
