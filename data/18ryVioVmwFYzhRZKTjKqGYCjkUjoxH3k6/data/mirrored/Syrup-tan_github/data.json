{"cert_user_id": "Syrup-tan@github", "next_comment_id": 3, "comment": {"1604064925_mirrored_unrealwill_github": [{"comment_id": 1, "body": "Hmmm, I think having them all hosted under a single origin is asking for trouble.\n\nThe iframe-nonce-hack seems to work, but it seems to be setting it up for failure as it's going directly against the grain of the Web Browser's security mechanisms.\nI think one of the safest methods would be to provide a SOCKS5 proxy, similar to the way Tor does it.\n\nIn regards to using case-sensitive addresses, perhaps encoding the address to a case-insensitive format would be Good Enough:tm:?\n\nA simple method for encoding could be;\n\n``` js\nfunction encode(str) {\n    return str.replace(/([A-Z])/g, function(c) {\n        return '-' + c.toLowerCase();\n    });\n}\n\nfunction decode(str) {\n    return str.replace(/(-[A-Za-z])/g, function(match) {\n        return match.substr(1).toUpperCase();\n    });\n}\n\nencode('1HeLLo4uzjaLetFx6NH3PMwFP3qbRbTf3D');\n// '1-he-l-lo4uzja-let-fx6-n-h3-p-mw-f-p3qb-rb-tf3-d'\n```\n\nThis isn't very pretty, and it ruins the vanity addresses, but it's simple and doesn't require any base conversions, which would be costly with JavaScript's number implementation.\n\nHmm, if I find some time I'll try some pentesting on the iframe implementation to see if it's worth migrating or such.\n", "added": 1456934490, "modified": 1456934490, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/157#issuecomment-191373944", "source_type": "github"}, {"comment_id": 2, "body": "``` js\n\nfunction getUrl(url, callback) {\n    var xhr = new XMLHttpRequest();\n    xhr.onreadystatechange = function() {\n        if (xhr.readyState == XMLHttpRequest.DONE) {\n            callback(xhr);\n        }\n    };\n    xhr.open('GET', url, true);\n    xhr.send(null);\n}\n\ngetUrl('http://127.0.0.1:43110/zeroid.bit', function(xhr) {\n\n    //var url = xhr.responseText.match(/\\\\\\/.+\\\\\\?wrapper\\\\_nonce\\\\=[a-z0-9]+/)[0].replace(/\\\\/g, '');\n\n    document.write('<iframe src=about:blank id=inner-iframe width=800 height=800></iframe>');\n    eval(xhr.responseText.match(/<!-- Site info -->\\n<script>([^<]+)<\\/script>/)[1]);\n    document.write('<script type=\"text/javascript\" src=\"/uimedia/all.js?rev=915\"></script>');\n\n});\n```\n\nPretty easy to get the wrapper nonce when you're on the same origin.\n", "added": 1456937528, "modified": 1456937528, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/157#issuecomment-191397761", "source_type": "github"}]}}