{"cert_user_id": "grinapo@github", "next_topic_id": 2, "topic": [{"topic_id": 1604066042, "title": "SiteManager Deleting orphan site from content.db // Unhandled exception: FOREIGN KEY constraint failed", "body": "[19:33:13] - Version: 0.5.6 r2109, Python 2.7.11 |Continuum Analytics, Inc.| (default, Dec  6 2015, 18:08:32) \r\n\r\nThis is problematic since zeronet cannot start:\r\n\r\n[19:29:07] SiteManager Deleting orphan site from content.db: ***********\r\n[19:29:07] - Unhandled exception: FOREIGN KEY constraint failed\r\nTraceback (most recent call last):\r\n  File \"/var/tmp/work/zeronet/ZeroBundle/ZeroNet/zeronet.py\", line 18, in main\r\n    main.start()\r\n  File \"/var/tmp/work/zeronet/ZeroBundle/ZeroNet/src/main.py\", line 476, in start\r\n    actions.call(config.action, action_kwargs)\r\n  File \"/var/tmp/work/zeronet/ZeroBundle/ZeroNet/src/main.py\", line 151, in call\r\n    func(**kwargs)\r\n  File \"/var/tmp/work/zeronet/ZeroBundle/ZeroNet/src/main.py\", line 161, in main\r\n    ui_server = UiServer()\r\n  File \"/var/tmp/work/zeronet/ZeroBundle/ZeroNet/src/Ui/UiServer.py\", line 73, in __init__\r\n    self.sites = SiteManager.site_manager.list()\r\n  File \"/var/tmp/work/zeronet/ZeroBundle/ZeroNet/src/Site/SiteManager.py\", line 155, in list\r\n    self.load()\r\n  File \"plugins/Zeroname/SiteManagerPlugin.py\", line 20, in load\r\n    super(SiteManagerPlugin, self).load(*args, **kwargs)\r\n  File \"plugins/MergerSite/MergerSitePlugin.py\", line 338, in load\r\n    super(SiteManagerPlugin, self).load(*args, **kwags)\r\n  File \"/var/tmp/work/zeronet/ZeroBundle/ZeroNet/src/Site/SiteManager.py\", line 63, in load\r\n    content_db.execute(\"DELETE FROM site WHERE ?\", {\"address\": address})\r\n  File \"/var/tmp/work/zeronet/ZeroBundle/ZeroNet/src/Db/Db.py\", line 80, in execute\r\n    return self.cur.execute(query, params)\r\n  File \"/var/tmp/work/zeronet/ZeroBundle/ZeroNet/src/Db/DbCursor.py\", line 49, in execute\r\n    res = self.cursor.execute(query, params)\r\nIntegrityError: FOREIGN KEY constraint failed\r\n\r\nI will probably figure out which sqlite it wanted to delete from _[ZeroNet/data/content.db]_,  but not obvious from the message either, as well as the solution (I have deleted the records manually, no foreign constraints complained).", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1500820386, "modified": 1562059372, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1040", "source_type": "github"}], "next_comment_id": 3, "comment": {"1604066042_mirrored_grinapo_github": [{"comment_id": 1, "body": "@HelloZeroNet the message may be misleading since, as I mentioned, I have manually just did the exact same delete which succeeded. As a wild guess is it possible that something is locking a table or tuple which would be required to be written by the cascade delete?", "added": 1501479618, "modified": 1501479618, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1040#issuecomment-319004831", "source_type": "github"}, {"comment_id": 2, "body": "(or circular reference like mentioned in https://stackoverflow.com/questions/15443913/sqlite3-foreign-key-constraint-failed )", "added": 1501479813, "modified": 1501479813, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1040#issuecomment-319005579", "source_type": "github"}]}}