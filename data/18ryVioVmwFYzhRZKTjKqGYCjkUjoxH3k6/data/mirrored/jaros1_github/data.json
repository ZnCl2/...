{"cert_user_id": "jaros1@github", "next_topic_id": 29, "topic": [{"topic_id": 1604065540, "title": "Old content in all.js", "body": "I have the problem that my all.js file is being generated with old content.\r\nHave deleted some js files in js/lib but they still included in all.js\r\nHave tried commit to github before generating all.js without success.\r\nHave cleared my trash and tried to search for old content on my harddrive\r\nAnd yes, I do clear browser cache before testing changes.\r\n\r\nAny idea why all.js file is being generated with old content?\r\n\r\nWorkaround: cat lib/*.js > all.js", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1478776089, "modified": 1478787889, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/638", "source_type": "github"}, {"topic_id": 1604065568, "title": "danish texts for ZeroNet", "body": "", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1479641064, "modified": 1479648103, "source_link": "https://github.com/HelloZeroNet/ZeroNet/pull/660", "source_type": "github"}, {"topic_id": 1604065610, "title": "CryptMessage - decrypt error handling", "body": "I am sometimes getting error notification when decrypting cryptMessage messages :\r\n<pre>\r\nInternal error: AttributeError: 'NoneType' object has no attribute 'decode'\r\nUiWebsocket.py line 99 > UiWebsocket.py line 184 > CryptMessagePlugin.py line 103\r\n</pre>\r\n\r\nThe problem is mismatch between message and private key after switching cert and reading old messages sent to the old cert. \r\n\r\nIs there any way to catch error in javascript instead of getting error notification in the UI?", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1481204545, "modified": 1481257828, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/696", "source_type": "github"}, {"topic_id": 1604065650, "title": "deleted optional file event/info?", "body": "Any ZeroNet way to get info about downloaded and deleted optional files?\r\n\r\n- step 1. user A creates an optional file a1.json and publish a content.json with optional file a1.json\r\n- step 2. user B receives user A's content.json file and download a1.json\r\n- step 3. user A deletes a1.json, creates a2.json and publish a content.json with optional file a2.json\r\n- step 4. user B receives user A's content.json with optional file a2.json\r\n\r\nWhere can I find information about deleted file a1.json? Both a1.json and a2.json are on file system. Only a2.json is in files_optional list. I have tried to change dbschema.json to get info about the deleted optional files without any luck. \r\n\r\nWill try a workaround with empty {} json files as a logical delete so not a big problem. \r\nRegarding this workaround. Something is missing. There is created .json-old files on filesystem when updating optional files that is not cleanup after OK publish. Not a big issue neither but not nice with a lot of .json-old files on filesystem. \r\n![screenshot from 2017-01-12 15-46-51](https://cloud.githubusercontent.com/assets/4932088/21894203/98b44258-d8de-11e6-971e-9dd571f14cc0.png)\r\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1483018519, "modified": 1486268083, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/726", "source_type": "github"}, {"topic_id": 1604065674, "title": "data cleanup message", "body": "Need a better more consistent solution for data.json cleanup and lost messages. Two already partly working cleanup rutines:\r\n1) sending a received message when receiving a msg with a image. For fast data.json cleanup. Images takes a lot of space in data.json file. \r\n2) sending feedback info in messages. receiver/sender will in next communications detect and resend lost messages. Not perfect but better than nothing\r\n3) data.json cleanup without any notification. testcase: a) send image, b) send msg. a) will be deleted in data.json when sending b)\r\n\r\nSolutions. \r\n- Could move images to encrypted optional files? message in data.json with link to optional file with image. Image encrypted with same password as message\r\n- Could send a special cleanup message. Like received and feedback info.", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1483665906, "modified": 1483665943, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/744", "source_type": "github"}, {"topic_id": 1604065714, "title": "css and wrapperXXXXX dialog/notifications", "body": "Any way to make ZeroFrame API wrapperXXXXX dialog/notifications more responsive?\r\nDoes not look very nice with small screen width. \r\nFor example notification/dialog > 100% screen width", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1484621894, "modified": 1484621894, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/774", "source_type": "github"}, {"topic_id": 1604065733, "title": "Question: ZeroFrame API callbacks", "body": "Any information/rules about ZeroFrame API callbacks that is nice to know?\r\n\r\nI expect callbacks to be executed asyn, independently and as quickly as possible.\r\nA1 => cb1 (long call), A2 => cb2 (short call), A3 => cb3 (short call).\r\nI would expect cb2 and cb3 to be executed before cb1 but it is not always so.\r\nSometimes A1 call will block A2 and A3 calls until A1 is done. \r\nFor example can a fileGet (optional file) block many other ZeroFrame API calls for a long time.\r\n\r\nSo what is the rules for ZeroFrame API callbacks?\r\nIs UI server a blocking resource? Max one running UI server call at any time?", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1485055913, "modified": 1485069093, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/788", "source_type": "github"}, {"topic_id": 1604065787, "title": "Question: information about download processing", "body": "I am trying to test a chat site in a multi user environment and sometimes the files are not replicated and it is very hard to find out which files that hangs and why (I think my problem is with optional files). \r\nVery often the download problem can be seen in top of screen as a hanging download and you must already have all the necessary information for updating the green download indicator.\r\n\r\nIs it possible to see/find the information behind the download indicator?\r\n\r\nJust an idea. Very nice experience to drag the 0 icon left and see all the site info and the extra controllers for the site. Could it be possible to drag the 0 icon down and see download process information?  ", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1486955052, "modified": 1487506742, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/833", "source_type": "github"}, {"topic_id": 1604065794, "title": "Question: tar/zip support and this is my site", "body": "I am very happy with the new zip support in ZeroNet and has added an all.js.tar.bz2 file to my site.\r\nTo support \"old\" clients I load both all.js and all.js.tar.bz2 in my index page. I expect all.js (big 1 Mb file) to be replicated slow on ZeroNet and all.js.tar.bz2 to be replicated fast (small file).\r\nBefore page reload I delete both all.js and all.js.tar.bz2 files.\r\n\r\nall.js is generated from my js-files (OK) and all.js.tar.bx2 is downloaded from ZeroNet (not OK).\r\n\r\nI would have expected that \"this is my site\" would prevent files to be downloaded from ZeroNet?", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1487570967, "modified": 1488262339, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/838", "source_type": "github"}, {"topic_id": 1604065931, "title": "Question: Not a merger site!", "body": "I am trying to add merger feature to a ZeroNet site. Not much documentation available but I have tried to do as ZeroMe & Green hub. I think I understand what is going on but I must have overlooked something important. Data from user hub is loaded OK into main site db, but I am getting permission errors. \r\n\r\nAny hints where to look in my merger site setup? I do not understand the error message or what is going on in the python code ... \r\n\r\nerrors:\r\n- UI: Internal error: Exception: No merger (182Uot1yJ6mZEwQYE5LX1P5f6VPyJ9gUGe) permission to load: \r\nmerged-MoneyNetwork/182Uot1yJ6mZEwQYE5LX1P5f6VPyJ9gUGe/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/1492418540610-1492418506136-4-chat.json (MoneyNetwork not in [])\r\n- UI: Internal error: Exception: No merger (182Uot1yJ6mZEwQYE5LX1P5f6VPyJ9gUGe) permission to load: \r\nmerged-MoneyNetwork/182Uot1yJ6mZEwQYE5LX1P5f6VPyJ9gUGe/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json (MoneyNetwork not in [])\r\nUiWebsocket.py line 174 > MergerSitePlugin.py line 145 > MergerSitePlugin.py line 127 > MergerSitePlugin.py line 43\r\n- console.log: mergerSiteAdd. Sometimes OK, some times \"Not a merger site\".\r\n\r\nMain site: http://127.0.0.1:43110/moneynetwork.bit / https://github.com/jaros1/Money-Network\r\nUser hub: http://127.0.0.1:43110/182Uot1yJ6mZEwQYE5LX1P5f6VPyJ9gUGe/ / https://github.com/jaros1/Money-Network-U1", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1495520379, "modified": 1495630753, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/944", "source_type": "github"}, {"topic_id": 1604065959, "title": "Merger sites - bad files list", "body": "I have been debugging a problem with (temporary) lost merger site permission (see closed issue Question: Not a merger site! #944). I can see that the error occurs (lost merger permission) for fileGet request to a file on bad files list. Adding a list of bad files in my code solved the problem.\r\n\r\nAny way to get a list of bad files in ZeroFrame API for merger sites so I can avoid downloading files on bad list? Or alternative a better fileGet error handling in ZeroFrame API. Empty fileGet response for bad files would be OK for me.  ", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1496724425, "modified": 1496724793, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/965", "source_type": "github"}, {"topic_id": 1604066026, "title": "Potentially unsafe part of the pattern: ]{", "body": "New ZeroNet update.\r\nGetting \"Potentially unsafe part of the pattern\" error for optional pattern: ^[0-9a-f]{10}.[0-9]{13}$\r\nUsed in users content.json files\r\nAn old content.json file now invalid:\r\n<pre>\r\n{\r\n \"address\": \"1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ\",\r\n \"cert_auth_type\": \"web\",\r\n \"cert_sign\": \"HOFnzSDzr7fIevQePi+1G7/YOB+eUbv+xtdstzZsk+zsbC1lx1L61VesCr9/Dnn6j6ZqD6uucRq8oc2j1Q48cP8=\",\r\n \"cert_user_id\": \"17bkaTxefKABo@moneynetwork.bit\",\r\n \"files\": {\r\n  \"wallet.json\": {\r\n   \"sha512\": \"b2d87f021de5654624c2942eb44b298b1fb807abc7a949e07ee77e548d5db4a4\",\r\n   \"size\": 188\r\n  }\r\n },\r\n \"files_optional\": {\r\n  \"2df0ef529c.1499446132848\": {\r\n   \"sha512\": \"7a558a24de7e015a09072966ced13cec2b108d3db915f28c561eded19fd94457\",\r\n   \"size\": 2448\r\n  },\r\n  \"2df0ef529c.1499446146829\": {\r\n   \"sha512\": \"c9ef0ff90dc5b7cf01e91c8b6423c0280ee445cf4642f84ad6e3cd372f59ad5f\",\r\n   \"size\": 2236\r\n  },\r\n  \"2df0ef529c.1499446167867\": {\r\n   \"sha512\": \"8c21541ef464b494c02447e585362443770c7300b91397008324c0d64fed87f5\",\r\n   \"size\": 876\r\n  }\r\n },\r\n \"inner_path\": \"data/users/17bkaTxefKABomUaD9SffeHkywruhMHuU/content.json\",\r\n \"modified\": 1499446169,\r\n \"optional\": \"^[0-9a-f]{10}.[0-9]{13}$\",\r\n \"signs\": {\r\n  \"17bkaTxefKABomUaD9SffeHkywruhMHuU\": \"HEAUiGNe0KVIhDtsfywmjzMDnMHqNB75hjCc7XgswyjBdmqwMVUYDYnS8CSldeBt3i2VHK84IuU9S2Ra9k9ZqvE=\"\r\n }\r\n}\r\n</pre>\r\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1500031072, "modified": 1500042585, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1019", "source_type": "github"}, {"topic_id": 1604066114, "title": "wrapperOpenWindow - Cannot set property 'opener' of null", "body": "I am using wrapperOpenWindow call in test2 to open a new window/tab. \r\n\r\na) Test2 OK\r\nb) Test1+test2 ERROR:\r\nUncaught TypeError: Cannot set property 'opener' of null\r\n    at Wrapper.actionOpenWindow (all.js?rev=2163&lang=en:1036)\r\n    at Wrapper.onMessageInner (all.js?rev=2163&lang=en:983)\r\n    at all.js?rev=2163&lang=en:813\r\n\r\nWrapper.prototype.actionOpenWindow = function(params) {\r\n      var w;\r\n      if (typeof params === \"string\") {\r\n        w = window.open();\r\n        w.opener = null;\r\n        return w.location = params;\r\n      } else {\r\n        w = window.open(null, params[1], params[2]);\r\n        w.opener = null;\r\n        return w.location = params[0];\r\n      }\r\n    };\r\n\r\nLast window.open call returns null in b). \r\n\r\nScreendumps below. params is identical in the two testcases. Minor difference for the windows object. Using callbacks in test1. Maybe wrapperOpenWindow call is not allowed from a callback function?\r\n\r\nDebug a) Test2 OK\r\n![ok-screenshot from 2017-08-21 12-28-42](https://user-images.githubusercontent.com/4932088/29516667-835bdf74-8671-11e7-863a-4ab96e2f8795.png)\r\n\r\nDebug b) Test1+test2 ERROR:\r\n![error-screenshot from 2017-08-21 12-27-16](https://user-images.githubusercontent.com/4932088/29516674-8c75e780-8671-11e7-84a7-0bcb2725f2b6.png)\r\n\r\nDebug a) and Debug b) in one screendump. Only difference is a minor difference in the window object:\r\n![ok-and-error-screenshot from 2017-08-21 12-33-31](https://user-images.githubusercontent.com/4932088/29516754-f691a8fc-8671-11e7-9f9f-02633b78d6bf.png)\r\n\r\nComparing window object:\r\n![window object compare](https://user-images.githubusercontent.com/4932088/29516578-2aa74990-8671-11e7-9025-5f6c9071567b.png)\r\n[error windows object.txt](https://github.com/HelloZeroNet/ZeroNet/files/1238595/error.windows.object.txt)\r\n[ok windows object.txt](https://github.com/HelloZeroNet/ZeroNet/files/1238596/ok.windows.object.txt)\r\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1503302677, "modified": 1503313970, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1089", "source_type": "github"}, {"topic_id": 1604066168, "title": "Site start problem with all.js", "body": "Did a failed ZeroNet upgrade yesterday. Broken instance. Could not restart after upgrade. Some issue with a inconsistent bigfile parameter.  Sorry. Had to restart my comp. and lost the error message.\r\nCould not fix the problem and did a new clean ZeroNet install. Marked my sites with \"This is my site\". \r\n\r\nOK start when local version = signed and published version and using js/all.js.zip/all.js.\r\nStart is hanging when local version != signed and published version and using js/all.js\r\n\r\nFound this lines in ui server log:\r\n<pre>\r\n[10:13:00] - Merged data/1JeHa67QEvrrFpsSow82fLypw8LoRcmCXk/js/all.js (0.10s)\r\n[10:13:00] - UiWSGIHandler error: TypeError: argument of type 'bool' is not iterable in UiServer.py line 40 > pywsgi.py line 494 > UiServer.py line 91 > UiRequest.py line 130 > MutePlugin.py line 138 > UiRequest.py line 272 > UiRequestPlugin.py line 22 > TranslateSitePlugin.py line 25 > FilePackPlugin.py line 66 > UiRequest.py line 473 > BigfilePlugin.py line 111 > BigfilePlugin.py line 381\r\n[10:13:00] Ui.UiServer 127.0.0.1 - - [2017-10-06 10:13:00] \"GET /moneynetwork.bit/js/all.js HTTP/1.1\" 000 - 0.193103\r\n</pre>\r\n\r\nall.js file is created on file system but is not downloaded to browser / not found under sources in browser console.\r\n\r\nDid a siteSign without publish and no problems right now. all.js is being generated and used in browser without problems for some time. Now hanging again. Switching to an other computer with an old ZeroNet instance later today and I am hoping that will work without any problems.", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1507267593, "modified": 1507773028, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1133", "source_type": "github"}, {"topic_id": 1604066179, "title": "FileDelete: No such file or directory", "body": "Having a small problem with fileDelete. File is deleted in filesystem but fileDelete cmd returns No such file or directory. Below console.log and UI server log. Running rev3098\r\n\r\n<pre>\r\nconsole.log:\r\n\r\nfileWrite:\r\n18:47:33.214 MoneyNetworkAPI.js:281 MoneyNetworkAPI.send_message add_optional_files_support callback 4:\r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477 fileWrite started (65). 1 pending ZeroNet API operation (65)\r\n18:47:33.218 MoneyNetworkAPI.js:295 MoneyNetworkAPI.send_message add_optional_files_support callback 4:\r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477 fileWrite finished. res = \"OK\". elapsed time 4 ms (65). No pending ZeroNet API operations\r\n\r\nsiteSign:\r\n18:47:33.219 MoneyNetworkAPI.js:1456 MoneyNetworkAPI.send_message.save_offline_transaction callback 6:\r\nsign content.json with new optional file merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477\r\n18:47:33.219 MoneyNetworkAPI.js:281 MoneyNetworkAPI.send_message.save_offline_transaction callback 6:\r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (66). 1 pending ZeroNet API operation (66)\r\n18:47:33.266 MoneyNetworkAPI.js:295 MoneyNetworkAPI.send_message.save_offline_transaction callback 6:\r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 47 ms (66). No pending ZeroNet API operations\r\n\r\nsubmit cleanup job:\r\n18:47:33.267 MoneyNetworkAPI.js:1456 MoneyNetworkAPI.send_message siteSign callback 7:\r\nSubmit delete_request job for merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477. starts delete_request job in 9667 milliseconds\r\n\r\nfileGet - file is on file system\r\n18:47:42.935 MoneyNetworkAPI.js:281 MoneyNetworkAPI.send_message.delete_request callback:\r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477 fileGet started (67). 1 pending ZeroNet API operation (67)\r\n18:47:42.937 MoneyNetworkAPI.js:295 MoneyNetworkAPI.send_message.delete_request callback:\r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477 fileGet finished. res = \"OK\". elapsed time 2 ms (67). No pending ZeroNet API operations\r\n\r\nfileDelete - file is deleted on filesystem but UI server is returning [Errno 2] No such file or directory\r\n18:47:42.937 MoneyNetworkAPI.js:281 MoneyNetworkAPI.send_message.delete_request callback:\r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477 fileDelete started (68). 1 pending ZeroNet API operation (68)\r\n18:47:42.942 MoneyNetworkAPI.js:295 MoneyNetworkAPI.send_message.delete_request callback:\r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477 fileDelete finished.\r\nres = \"Failed. error = {\\\"error\\\":\\\"Delete error:\r\n[Errno 2] No such file or directory: 'data/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477'\\\"}\". elapsed time 5 ms (68). No pending ZeroNet API operations\r\n\r\n\r\n\r\nUI-server:\r\n\r\n[18:47:33] Site:1JeHa6..mCXk Signing: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json\r\n[18:47:33] Site:1PgyTn..z2zh Opening site data directory: data/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/...\r\n[18:47:33] Site:1PgyTn..z2zh - [SKIPPED] 1507104858304-1496820256791-1-chat.json-old\r\n[18:47:33] Site:1PgyTn..z2zh - [SKIPPED] 1507221875050-1507221875050-1-chat.json-old\r\n[18:47:33] Site:1PgyTn..z2zh - [SKIPPED] 1503919918798-1496820256791-1-chat.json-old\r\n[18:47:33] Site:1PgyTn..z2zh - [SKIPPED] 1503919918798-1496820690619-1-chat.json-old\r\n[18:47:33] Site:1PgyTn..z2zh - data.json\r\n[18:47:33] Site:1PgyTn..z2zh - [SKIPPED] 1496820690619-1496820256791-1-chat.json-old\r\n[18:47:33] Site:1PgyTn..z2zh - [SKIPPED] 1496820256791-1496820256791-1-chat.json-old\r\n\r\n[18:47:33] Site:1PgyTn..z2zh - [OPTIONAL] d945ff7e85.1476986504477\r\n\r\n[18:47:33] Site:1PgyTn..z2zh - [SKIPPED] 1507105144620-1496820690619-1-chat.json-old\r\n[18:47:33] Site:1PgyTn..z2zh - [OPTIONAL] 2415dcb640.1507740450972\r\n[18:47:33] Site:1PgyTn..z2zh - [SKIPPED] 1507105555199-1496820690619-1-chat.json-old\r\n[18:47:33] Site:1PgyTn..z2zh - status.json\r\n[18:47:33] Site:1PgyTn..z2zh - like.json\r\n[18:47:33] Site:1PgyTn..z2zh - [SKIPPED] content.json\r\n[18:47:33] Site:1PgyTn..z2zh Changed files: [u'data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json', u'data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/2415dcb640.1507740450972',\r\nu'data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477']\r\n\r\n[18:47:42] Site:1JeHa6..mCXk Deleting optional file: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477\r\n[18:47:42] Site:1PgyTn..z2zh Deleted file: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477\r\n[18:47:42] Site:1JeHa6..mCXk File delete error: Exception -\r\n[Errno 2] No such file or directory: 'data/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1476986504477'\r\n</pre>\r\n\r\n\r\nUpdate: Added more console.log messages and a workaround. checking file before and after fileDelete operation. console.log:\r\n<pre>\r\nstep 1: fileGet - file exists before step 2 fileDelete\r\n07:48:22.754 MoneyNetworkAPI.js:281 MoneyNetworkAPI.send_message.delete_request callback 0: \r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1475760967876 fileGet started (68). 1 pending ZeroNet API operation (68)\r\n07:48:22.756 MoneyNetworkAPI.js:295 MoneyNetworkAPI.send_message.delete_request callback 0: \r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1475760967876 fileGet finished. res = \"OK\". elapsed time 2 ms (68). No pending ZeroNet API operations\r\n\r\nstep 2: fileDelete - returns Delete error: [Errno 2] No such file or directory. file was deleted from filesystem\r\n07:48:22.757 MoneyNetworkAPI.js:281 MoneyNetworkAPI.send_message.delete_request fileGet callback 1: \r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1475760967876 fileDelete started (69). 1 pending ZeroNet API operation (69)\r\n07:48:22.761 MoneyNetworkAPI.js:1456 MoneyNetworkAPI.send_message.delete_request fileDelete callback 2: \r\nres2 = {\"error\":\"Delete error: [Errno 2] No such file or directory: 'data/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1475760967876'\"}\r\n07:48:22.762 MoneyNetworkAPI.js:1456 MoneyNetworkAPI.send_message.delete_request fileDelete callback 2: \r\nissue 1140. https://github.com/HelloZeroNet/ZeroNet/issues/1140. step 2 FileDelete returned No such file or directory\r\n07:48:22.762 MoneyNetworkAPI.js:281 MoneyNetworkAPI.send_message.delete_request fileDelete callback 2: \r\n\r\nstep 3: fileGet - verify that file was deleted in step 2\r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1475760967876 fileGet started (70). 2 pending ZeroNet API operations (69,70)\r\n07:48:22.764 MoneyNetworkAPI.js:295 MoneyNetworkAPI.send_message.delete_request fileDelete callback 2: \r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1475760967876 fileGet finished. res = \"Not found\". elapsed time 2 ms (70). 1 pending ZeroNet API operation (69)\r\n07:48:22.764 MoneyNetworkAPI.js:295 MoneyNetworkAPI.send_message.delete_request fileGet callback 1: \r\nmerged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/d945ff7e85.1475760967876 fileDelete finished. res = \"OK\". elapsed time 7 ms (69). No pending ZeroNet API operations\r\n</pre>\r\n\r\nJavascript with workaround:\r\n<pre>\r\ndelete_request = function () {\r\n    var pgm = self.module + '.send_message.delete_request callback 0: ';\r\n    var debug_seq1;\r\n    if (!cleanup_job_id) return; // already run\r\n    cleanup_job_id = null;\r\n    // problem with fileDelete: Delete error: [Errno 2] No such file or directory. checking file before fileDelete operation\r\n    // step 1: check file before fileDelete\r\n    debug_seq1 = MoneyNetworkAPILib.debug_z_api_operation_start(pgm, inner_path4, 'fileGet');\r\n    self.ZeroFrame.cmd(\"fileGet\", {inner_path: inner_path4, required: false, timeout: 1}, function (res1) {\r\n        var pgm = self.module + '.send_message.delete_request fileGet callback 1: ';\r\n        var debug_seq2;\r\n        MoneyNetworkAPILib.debug_z_api_operation_end(debug_seq1, res1 ? 'OK' : 'Not found');\r\n        if (!res1) {\r\n            console.log(pgm + 'warning. optional file ' + inner_path4 + ' was not found');\r\n            return;\r\n        }\r\n        // step 2: fileDelete\r\n        debug_seq2 = MoneyNetworkAPILib.debug_z_api_operation_start(pgm, inner_path4, 'fileDelete');\r\n        ZeroFrame.cmd(\"fileDelete\", inner_path4, function (res2) {\r\n            var pgm = self.module + '.send_message.delete_request fileDelete callback 2: ';\r\n            var debug_seq3;\r\n            self.log(pgm, 'res2 = ' + JSON.stringify(res2));\r\n            if ((res2 == 'ok') || (!res2.error.match(/No such file or directory/))) {\r\n                MoneyNetworkAPILib.debug_z_api_operation_end(debug_seq2, res2 == 'ok' ? 'OK' : 'Failed. error = ' + JSON.stringify(res2));\r\n                return;\r\n            }\r\n            // step 3: check file after fileDelete\r\n            // fileDelete returned No such file or directory. Recheck that file has been deleted\r\n            self.log(pgm, 'issue 1140. https://github.com/HelloZeroNet/ZeroNet/issues/1140. step 2 FileDelete returned No such file or directory');\r\n            debug_seq3 = MoneyNetworkAPILib.debug_z_api_operation_start(pgm, inner_path4, 'fileGet');\r\n            self.ZeroFrame.cmd(\"fileGet\", {inner_path: inner_path4, required: false, timeout: 1}, function (res3) {\r\n                var pgm = self.module + '.send_message.delete_request fileGet callback 3: ';\r\n                MoneyNetworkAPILib.debug_z_api_operation_end(debug_seq3, res3 ? 'OK' : 'Not found');\r\n                if (!res3) {\r\n                    // everything is fine. request file was deleted correct in step 2\r\n                    MoneyNetworkAPILib.debug_z_api_operation_end(debug_seq2, 'OK');\r\n                }\r\n                else {\r\n                    self.log(pgm, 'issue 1140. something is very wrong. first fileGet returned OK, fileDelete returned No such file or directory and last fileGet returned OK');\r\n                    MoneyNetworkAPILib.debug_z_api_operation_end(debug_seq2, res2 == 'ok' ? 'OK' : 'Failed. error = ' + JSON.stringify(res2));\r\n                }\r\n            });\r\n        }); // fileDelete callback\r\n\r\n    }); // z_file_get callback\r\n\r\n}; // delete_request\r\n\r\n</pre>", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1507731057, "modified": 1516241215, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1140", "source_type": "github"}, {"topic_id": 1604066190, "title": "Question: content.files_optional + sign", "body": "Has there been a change in siteSign and files_optional object?\r\n\r\nBefore: sign failed for missing optional files in user directory. As a workaround I always clear files_optional object before sign. The optional files in user directory were added to files_optional object. OK functionality.\r\nNow: clear files_optional object before sign => all optional files are deleted from user directory. Is that an error or is it how it should be?\r\n\r\n\r\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1508130084, "modified": 1509597807, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1147", "source_type": "github"}, {"topic_id": 1604066224, "title": "content.json distribution problem - 1 second dif - optional files issue?", "body": "I am trying to use optional files in ZeroNet. \r\nTesting on two different machines with vpn=torando and vpn=sweden and zeronet port open. \r\nI would expect newest content.json file to be distributed to other clients on ZeroNet.\r\n\r\nI have many times seen the situation where there is a very small difference in content.json modified timestamp (1 second) and newest content.json is not distributed on zeronet. I have seen this issue before and the 1 second difference between the two content.json files cannot be something random. Must be UI server doing something \"funny\". \r\n\r\nMaybe a \"merge\" problem due to different files_optional in the two content.json?\r\n\r\nTorando content.json (newest):\r\n\r\n<pre>\r\n{\r\n \"address\": \"1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ\",\r\n \"cert_auth_type\": \"web\",\r\n \"cert_sign\": \"G9KWZvNAg3yVm3F3ICPQCOjnA+lZQOFLvYWBJp7BaRAMDrdIAqyv/x8PYNwlWQ4KvznJPOmjknSxxPkHfnD84tE=\",\r\n \"cert_user_id\": \"jro@zeroid.bit\",\r\n \"files\": {\r\n  \"status.json\": {\r\n   \"sha512\": \"ea18a2cce60357f5a647eef13bd0701a418f63795083226dbabd7f62e32a8e48\",\r\n   \"size\": 31\r\n  },\r\n  \"wallet.json\": {\r\n   \"sha512\": \"5033a27b0aba76b024e04f037eff88a121781dd33d292fc229734f0b9dff6c64\",\r\n   \"size\": 869\r\n  }\r\n },\r\n \"files_optional\": {\r\n  \"7fd09cfaf8-o.1509785536712\": {\r\n   \"sha512\": \"9a53ceadb1336c504692dbd223ba1d2c089d2018122a00e5146a6110a87a8974\",\r\n   \"size\": 548\r\n  },\r\n  \"7fd09cfaf8-o.1509785537477\": {\r\n   \"sha512\": \"765f493bc022b38138817e508ca5301d31d603273604748c07d1a2547b0a3e22\",\r\n   \"size\": 1424\r\n  }\r\n },\r\n \"inner_path\": \"data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json\",\r\n \"modified\": 1509785537,\r\n \"optional\": \"^.*-.*$\",\r\n \"signs\": {\r\n  \"18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ\": \"HCEb8ZkEG29y8BHxK4sjascvZuk/Z20tl4pz++r5j8bJTqog0O2KRqCnJtG65eZ+UkR8MCY/aE6PSlSbz1wwVAk=\"\r\n }\r\n}\r\n</pre>\r\n\r\nUI server log sweden: \r\n\r\ntorando has just published 09:52:17 new data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json with new optional file 7fd09cfaf8-o.1509785537477\r\n\r\n<pre>\r\n[09:52:16] WorkerManager:1PgyTn..z2zh New task: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, peer lock: None, priority: 2, optional_hash_id: None, tasks started: 1\r\n[09:52:17] Site:1HXzvt..w7NJ Update for data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json looks valid, saving...\r\n[09:52:17] Site:1HXzvt..w7NJ Patched successfully: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/status.json (diff: 0.000s, verify: 0.000s, write: 0.001s, on_done: 0.001s)\r\n[09:52:17] Site:1HXzvt..w7NJ Publishing data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json to 3/15 peers (connected: 4) diffs: ['status.json'] (0.09k)...\r\n[09:52:17] Site:1HXzvt..w7NJ Peer:173.239.230.28 already received this update for data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, skipping\r\n[09:52:21] Site:1PgyTn..z2zh Bad files: {'data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json': 2}\r\n[09:52:21] Site:1PgyTn..z2zh Retry 1 bad files\r\n[09:52:28] Site:1HXzvt..w7NJ Successfuly data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json published to 2 peers, publishing to 3 more peers in the background\r\n[09:52:40] WorkerManager:1PgyTn..z2zh 37.203.209.19:39492: Verify failed: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, error: Download failed, failed peers: 0, workers: 5\r\n[09:52:40] WorkerManager:1PgyTn..z2zh Slow task: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, (workers: 6, optional_hash_id: None, peers: 0, failed: 1, asked: 0)\r\n[09:52:47] Site:1HXzvt..w7NJ data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json: verify sign error: VerifyError: Valid signs: 0/1 in ContentManager.py line 861\r\n[09:52:47] FileServer Update for data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json is invalid: Valid signs: 0/1\r\n[09:52:47] RateLimit Added to queue (14.69s left): 16 update 1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json \r\n[09:52:56] WorkerManager:1PgyTn..z2zh Slow task: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, (workers: 5, optional_hash_id: None, peers: 0, failed: 1, asked: 0)\r\n[09:52:56] Site:1HXzvt..w7NJ Announced types ['ip4'] in mode more to 1 trackers in 0.349s, errors: [], slow: []\r\n[09:53:02] RateLimit Calling: 16 update 1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json\r\n[09:53:02] Site:1HXzvt..w7NJ data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json: verify sign error: VerifyError: Valid signs: 0/1 in ContentManager.py line 861\r\n[09:53:02] FileServer Update for data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json is invalid: Valid signs: 0/1\r\n[09:53:10] WorkerManager:1HXzvt..w7NJ 77.241.139.79:37344: Verify failed: data/users/1Mg62SVtQAiRSAfRBvWGKyPqioXZSfwDDW/wallet.json, error: Download failed, failed peers: 9, workers: 1\r\n[09:53:10] WorkerManager:1PgyTn..z2zh 212.27.18.166:28073: Verify failed: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, error: Download failed, failed peers: 1, workers: 4\r\n[09:53:10] WorkerManager:1PgyTn..z2zh 183.27.96.134:15441: Verify failed: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, error: Download failed, failed peers: 2, workers: 3\r\n[09:53:10] WorkerManager:1PgyTn..z2zh 183.27.96.243:15441: Verify failed: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, error: Download failed, failed peers: 3, workers: 2\r\n[09:53:10] WorkerManager:1PgyTn..z2zh gbr6xj5fdxczy6jr.onion:39492: Verify failed: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, error: Download failed, failed peers: 4, workers: 1\r\n[09:53:10] WorkerManager:1PgyTn..z2zh t27vym4lfo3xjuvc.onion:39492: Verify failed: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, error: Download failed, failed peers: 5, workers: 0\r\n[09:53:10] WorkerManager:1HXzvt..w7NJ ljvtyp4ipykefote.onion:39492: Verify failed: data/users/1Mg62SVtQAiRSAfRBvWGKyPqioXZSfwDDW/wallet.json, error: Download failed, failed peers: 10, workers: 0\r\n[09:53:11] WorkerManager:1PgyTn..z2zh Slow task: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, (workers: 5, optional_hash_id: None, peers: 0, failed: 6, asked: 0)\r\n[09:53:12] Site:1PgyTn..z2zh data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json: verify sign error: VerifyError: Valid signs: 0/1 in ContentManager.py line 861\r\n[09:53:12] WorkerManager:1PgyTn..z2zh 173.239.230.28:45260: Verify failed: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, error: Valid signs: 0/1, failed peers: 6, workers: 0\r\n[09:53:12] WorkerManager:1PgyTn..z2zh 127.0.0.1:60838: Verify failed: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json, error: Download failed, failed peers: 7, workers: 4\r\n[09:53:12] WorkerManager:1PgyTn..z2zh 104.199.246.69:15441: Verify correct: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json\r\n[09:53:12] Site:1PgyTn..z2zh data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json loadContent same json file, skipping\r\n[09:53:12] Site:1PgyTn..z2zh data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json loadContent same json file, skipping\r\n</pre>\r\n\r\nSweden content.json (oldest):\r\n\r\n<pre>\r\n{\r\n \"address\": \"1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ\",\r\n \"cert_auth_type\": \"web\",\r\n \"cert_sign\": \"G9KWZvNAg3yVm3F3ICPQCOjnA+lZQOFLvYWBJp7BaRAMDrdIAqyv/x8PYNwlWQ4KvznJPOmjknSxxPkHfnD84tE=\",\r\n \"cert_user_id\": \"jro@zeroid.bit\",\r\n \"files\": {\r\n  \"status.json\": {\r\n   \"sha512\": \"a84a76dfca3849cf7b930852c724cd0f5ab58bb173e64b4f666abc2bfc889b33\",\r\n   \"size\": 31\r\n  },\r\n  \"wallet.json\": {\r\n   \"sha512\": \"5033a27b0aba76b024e04f037eff88a121781dd33d292fc229734f0b9dff6c64\",\r\n   \"size\": 869\r\n  }\r\n },\r\n \"files_optional\": {\r\n  \"7fd09cfaf8-o.1509785536712\": {\r\n   \"sha512\": \"9a53ceadb1336c504692dbd223ba1d2c089d2018122a00e5146a6110a87a8974\",\r\n   \"size\": 548\r\n  },\r\n  \"c6f8666c5b-i.1477976389761\": {\r\n   \"sha512\": \"5ce44bfd2791b58cea417692c10cedc22698cfbe6615e29bf8ca04735fe7e300\",\r\n   \"size\": 1316\r\n  },\r\n  \"c6f8666c5b-i.1479193655354\": {\r\n   \"sha512\": \"7a5b61ce3aa612fbe6fcdaca85d6e0f4524144c60e3857324560890f426e9142\",\r\n   \"size\": 1316\r\n  },\r\n  \"c6f8666c5b-i.1480073346388\": {\r\n   \"sha512\": \"08993fa11262ab18c88badb97605f6d70386bf67ac70ec13f1051f66b658d3e9\",\r\n   \"size\": 1316\r\n  }\r\n },\r\n \"inner_path\": \"data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json\",\r\n \"modified\": 1509785536,\r\n \"optional\": \"^.*-.*$\",\r\n \"signs\": {\r\n  \"18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ\": \"G7etvqxwJRx+jy7v2QG+GgZ0KklUIGfJM7S4nBPcs1BLCQ0Emm/ANc99bQADsr2fmRy+q4RCuY31LtXIh7X7Kuw=\"\r\n }\r\n}\r\n</pre>\r\n\r\ncompare content.json files:\r\n![screenshot from 2017-11-04 10-23-30](https://user-images.githubusercontent.com/4932088/32404566-0a2484aa-c152-11e7-96da-0d9b0c21ce9b.png)\r\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1509779751, "modified": 1510156040, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1173", "source_type": "github"}, {"topic_id": 1604066256, "title": "Question: detect hanging fileGet operations", "body": "### Step 1: Please describe your environment\r\n\r\n  * ZeroNet version: 0.6.0 / rev3146\r\n  * Operating system: Ubuntu\r\n  * Web browser: Chrome\r\n  * Tor status: Closed/Error\r\n  * Opened port: no\r\n  * Special configuration: \r\n\r\n### Step 2: Describe the problem:\r\n\r\nDistribution optional files. I know that ZeroNet port must be open for this, but serverInfo.ip_external info maybe old. Info can be refreshed with a serverPortcheck call that requires ADMIN permission and ADMIN permission opens for a lot of other API operations. And re-check port takes some time to finish.\r\nQuestion: In ZeroNet, is there any way to detect hanging fileGet operations? That is, other peers, waiting to download a optional file? Could be a very nice info in optionalFileInfo or a setSiteInfo event. Will make it possible for sending peer to trigger workaround for failed optional file download (port re-check, change to normal file, notification or whatever).", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1512018633, "modified": 1512810107, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1196", "source_type": "github"}, {"topic_id": 1604066269, "title": "content.json not distributed after OK publish", "body": "### Step 1: Please describe your environment\r\n\r\n  * ZeroNet version: 0.6.0 - rev 3171\r\n  * Operating system: Linux/ubuntu 16.04\r\n  * Web browser: Chrome  62.0.3202.94 (64 bits)\r\n  * Tor status: error\r\n  * Opened port: no\r\n  * Special configuration: ____\r\n\r\n### Step 2: Describe the problem:\r\n11:37:38.768 JS: sitePublish OK. elapsed time for sitrePublish 169 ms. Very short time for a sitePublish request!!! sitePublish response should have been about 8 seconds. Se below.\r\n11:37:38 UI server: RateLimit Added to queue (12.96s left)\r\n11:37:38.903 JS: siteSign OK\r\n11:37:46 UI server content.json published to 1 peers, publishing to 5 more peers in the background\r\nThe content.json file published at 11:37:38.768 was never distributed on ZeroNet. \r\n\r\n#### Steps to reproduce:\r\n\r\nHave only seen this problem once. Maybe hard to reproduce:\r\n  1. sitePublish with RateLimit added to queue in UI server log\r\n  2. siteSign\r\n \r\n#### Observed Results:\r\n\r\n  * content.json file was not distributed on ZeroNet\r\n\r\n#### Expected Results:\r\n\r\n  * content.json file to be distributed after OK publish\r\n\r\n[issue262-test11-w2-torando.log](https://github.com/HelloZeroNet/ZeroNet/files/1565767/issue262-test11-w2-torando.log)\r\n[issue262-test11-ui-torando.log](https://github.com/HelloZeroNet/ZeroNet/files/1565768/issue262-test11-ui-torando.log)\r\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1513512595, "modified": 1513576107, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1206", "source_type": "github"}, {"topic_id": 1604066323, "title": "Feature request: localStorage backup and restore (all sites)", "body": "### Step 1: Please describe your environment\r\n\r\n  * ZeroNet version: 0.6.0 rev3171\r\n  * Operating system: Ubunty 16.04\r\n  * Web browser: Google Chrome 63.0\r\n  * Tor status: error\r\n  * Opened port: no\r\n  * Special configuration: no\r\n\r\n### Step 2: Describe the problem:\r\n\r\nCan use JS to backup and restore localStorage data for current site using wrapperXetLocalStorage API calls. Can use OS backup but methods are different for each browser, not very user friendly and may change in new browser versions.\r\n\r\nCould be nice to backup and restore localStorage data for all ZeroNet sites. \r\nwrapperXetLocalStorage cmd with ADMIN permission or button in 0 sidebar?", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1516080114, "modified": 1517938576, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1247", "source_type": "github"}, {"topic_id": 1604066361, "title": "Linux 32-bit - ImportError: No module named fallback", "body": "### Step 1: Please describe your environment\r\n\r\n  * ZeroNet version: master / latest 32-bit\r\n  * Operating system: linux 32-bit / ubuntu 12.04 / armv7l\r\n  * Web browser: n/a\r\n  * Tor status: n/a\r\n  * Opened port: n/a\r\n  * Special configuration: ____\r\n\r\n### Step 2: Describe the problem:\r\n\r\nTried to install ZeroNet on an old cubox pro. ubuntu 12.04. \r\nTried\r\n- a) https://github.com/HelloZeroNet/ZeroNet Manual install for Debian Linux (+ copied ZeroNet from a other comp).\r\n- b) download and unzip Manual install for Debian Linux\r\n\r\nUI-server stops in both versions with ImportError: No module named fallback\r\n\r\nSe log\r\n[terminal.log](https://github.com/HelloZeroNet/ZeroNet/files/1704078/terminal.log)", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1518013329, "modified": 1518020760, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1277", "source_type": "github"}, {"topic_id": 1604066365, "title": "verify sign error: VerifyError: No rules in ContentManager.py", "body": "### Step 1: Please describe your environment\r\n\r\n  * ZeroNet version: _0.6.1 r3225\r\n  * Operating system: arch linux 3.14.79-3-ARCH armv7l\r\n  * Web browser: n/a\r\n  * Tor status: ?\r\n  * Opened port: no\r\n  * Special configuration: ____\r\n\r\n### Step 2: Describe the problem:\r\n\r\nIncoming (updated) content.json files from other peers are rejected with: verify sign error: VerifyError: No rules in ContentManager.py line 857 > ContentManager.py line 771 > ContentManager.py line 782. Se log. Repeated 6 times for site 1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh\r\n\r\nWhat does the error message mean? And is there other things in log file that looks wrong?\r\n\r\nAdditional info: Fresh arch linux install on a Cubox pro. I am new on arch linux and have followed ZeroNet install for arch linux https://wiki.archlinux.org/index.php/ZeroNet\r\nNo browser interface is available (403 Not found when tested from browser) but ZeroNet UI server is running OK. Se attached log file. \r\n\r\n[archlinux.log](https://github.com/HelloZeroNet/ZeroNet/files/1710253/archlinux.log)\r\n\r\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1518154910, "modified": 1518157588, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1279", "source_type": "github"}, {"topic_id": 1604066389, "title": "ZeroNet shutdown. ctrl-c or ZeroHello shutdown", "body": "### Step 1: Please describe your environment\r\n\r\n  * ZeroNet version: 0.6.2\r\n  * Operating system: linux\r\n  * Web browser: Opera\r\n  * Tor status: error\r\n  * Opened port: yes\r\n  * Special configuration: ____\r\n\r\n### Step 2: Describe the problem:\r\n\r\nTestcase. Merger site. First contact test. New visitor downloading site. Always starting with new ZeroNet install from ZeroBundle-linux64.tar.gz, localStorage data deleted and running browser with debug (no cache). Site will add hubs until finding 10 optional files to download. Checking for peers for optional files once every 5 seconds. \r\nRunning with two other supporting machines as peers. vpn enabled + ZeroNet port open on both servers. There should always be 2 peers. \r\nTest is running on a machine with vpn and with ZeroNet port open. \r\n\r\nProblem finding peers serving optional files after stopping ui-server with ctrl-c. Optional files are often not served (peer=0) or test must run for a very long time before finding optional files to download (peer>0).\r\nNo problem when using \"Shut down ZeroNet\" in ZeroHello. Finding optional file with peer > 0 relative fast.\r\n\r\nTest started and test results will be added below:\r\n\r\nTest 1. Control. Test OK. \r\n18:47:19.874 all.js:17687 MoneyNetworkService.get_and_load_chat_file z_file_get callback 2: waited 74 seconds for first optional file from 182Uot1yJ6mZEwQYE5LX1P5f6VPyJ9gUGe\r\n18:49:17.299 all.js:17687 MoneyNetworkService.get_and_load_chat_file z_file_get callback 2: waited 71 seconds for first optional file from 1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh\r\nTest 1 shutdown from HelloZeroNet. \r\n[issue1297-test1-ok.log](https://github.com/HelloZeroNet/ZeroNet/files/1748980/issue1297-test1-ok.log)\r\n\r\nTest 2 OK. \r\n19:03:26.556 all.js:17687 MoneyNetworkService.get_and_load_chat_file z_file_get callback 2: waited 70 seconds for first optional file from 1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh\r\n[issue1297-test2-ok.log](https://github.com/HelloZeroNet/ZeroNet/files/1749026/issue1297-test2-ok.log)\r\nTest 2 shutfdown from HelloZeroNet.\r\n\r\nTest 3 Failed. \r\n19:08:54.296 MoneyNetworkAPI.js:2109 MoneyNetworkAPILib.z_merger_site_add mergerSiteAdd callback 1: new hub 1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh was added. hub must be ready. wait for jsons (dbQuery) before first fileGet request to new hub\r\nWaited 10+ minutes without finding any peers serving optional files from 1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh\r\nSo using ZeroHello for shutdown did not solve the issue with missing peers\r\n[issue1297-test3-failed.log](https://github.com/HelloZeroNet/ZeroNet/files/1749077/issue1297-test3-failed.log)\r\n\r\n\r\n\r\n\r\n\r\n\r\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1519311057, "modified": 1519788337, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1297", "source_type": "github"}, {"topic_id": 1604066401, "title": "RuntimeError: maximum recursion depth exceeded", "body": "### Step 1: Please describe your environment\r\n\r\n  * ZeroNet version: 0.6.2 (3323)\r\n  * Operating system: Linux, Ubuntu 16.04\r\n  * Web browser: Chrome\r\n  * Tor status: disabled\r\n  * Opened port: no\r\n  * Special configuration: ____\r\n\r\n### Step 2: Describe the problem:\r\nRandom error in a test run. ZeroNet notification \"RuntimeError: maximum recursion depth exceeded\"\r\n\r\n#### Steps to reproduce: \r\nMinor issue. Error only seen once. But maybe you can use log for something. I guess it was a fileGet request that triggered the error but I am not sure.\r\n\r\n[issue-1306.log](https://github.com/HelloZeroNet/ZeroNet/files/1763981/issue-1306.log)\r\n\r\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1519741182, "modified": 1519751312, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1306", "source_type": "github"}, {"topic_id": 1604066421, "title": "all.js.zip/all.js 404 (Not Found)", "body": "### Step 1: Please describe your environment\r\n\r\n  * ZeroNet version: 0.6.2 (rev 3356)\r\n  * Operating system: Ubuntu 16.04\r\n  * Web browser: Opera\r\n  * Tor status: disabled\r\n  * Opened port: yes\r\n  * Special configuration: ____\r\n\r\n### Step 2: Describe the problem:\r\n\r\nNew ZeroNet install from ZeroBundle-linux64.tar.gz. \r\nVisit site moneynetwork.bit\r\n127.0.0.1/:2571 GET http://127.0.0.1:43110/moneynetwork.bit/js/all.js.zip/all.js net::ERR_ABORTED\r\n10:48:22.240 127.0.0.1/:2571 GET http://127.0.0.1:43110/moneynetwork.bit/js/all.js.zip/all.js 404 (Not Found)\r\n\r\nChecked. all.js.zip was downloaded correct. Could be unzipped. Changed index.html to use all.js and site was working OK\r\n\r\nLog starting with all.js.zip/all.js (ERROR) and page reload at 10:38:36.824 with unzipped all.js (OK)\r\n[127.0.0.1-1520674918554.log](https://github.com/HelloZeroNet/ZeroNet/files/1799252/127.0.0.1-1520674918554.log)\r\n\r\n\r\n#### Steps to reproduce:\r\n\r\n  1. _____\r\n  2. _____\r\n  3. _____\r\n\r\n#### Observed Results:\r\n\r\n  * What happened? This could be a screenshot, a description, log output (you can send log/debug.log file to hello@zeronet.io if necessary), etc.\r\n\r\n#### Expected Results:\r\n\r\n  * What did you expect to happen?\r\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1520664849, "modified": 1521085138, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1322", "source_type": "github"}, {"topic_id": 1604066473, "title": "Question - file still in sync warning", "body": "### Step 1: Please describe your environment\r\n\r\n  * ZeroNet version: 0.6.2 (rev 3367)\r\n  * Operating system: Ubuntu 16.04\r\n  * Web browser: Chrome 65\r\n  * Tor status: disabled\r\n  * Opened port: no\r\n  * Special configuration: two merger sites communication with files\r\n\r\n### Step 2: Describe the problem:\r\n\r\nI do not understand \"This file still in sync, ...Write content anyway\" warning. I am often running into this problem. Sometimes easy to debug and fix. Other times hard to debug and fix. In this case hard to debug and fix. \r\n\r\nMy setup is merger sites using files for cross site communication. Site 1 using hub A and site 2 using hub B. The two sites are not updating same user directory.\r\n\r\nTest 1. using identical ZeroNet certificates in both sites. 2 hanging fileWrite operations, 7 slow task warning in UI server log and this file still in sync warning in UI. Normally not a problem. I cannot see why identical certificates should not be allowed when using different hubs for file update operations.\r\n[test1.log](https://github.com/HelloZeroNet/ZeroNet/files/1847527/test1.log)\r\n\r\nTest 2. using different ZeroNet certificates in the two sites. No problem with hanging fileWrite and no this file still in sync warning in UI. There is some slow task warnings in UI server log but not related to hub used in test 2.\r\n[test2.log](https://github.com/HelloZeroNet/ZeroNet/files/1847528/test2.log)\r\n\r\nRetested \"Test 1\" (using identical certificates in site 1 and site 2) on two other  ZeroNet installations. No problem there. Failed \"Test 1\" must be a \"random\" error. Closing issue. \r\n\r\n#### Steps to reproduce:\r\n\r\n  1. _____\r\n  2. _____\r\n  3. _____\r\n\r\n#### Observed Results:\r\n\r\n  * What happened? This could be a screenshot, a description, log output (you can send log/debug.log file to hello@zeronet.io if necessary), etc.\r\n\r\n#### Expected Results:\r\n\r\n  * What did you expect to happen?\r\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1522051976, "modified": 1522070258, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1361", "source_type": "github"}, {"topic_id": 1604066504, "title": "ValueError: invalid literal for int() with base 10: 'contactSrc'", "body": "### Step 1: Please describe your environment\r\n\r\n  * ZeroNet version: 0.6.2 (rev 3408)\r\n  * Operating system: ubuntu 16.04\r\n  * Web browser: Version 65.0.3325.181 (Official Build) (64-bit)\r\n  * Tor status: disabled\r\n  * Opened port: no\r\n  * Special configuration: ____\r\n\r\n### Step 2: Describe the problem:\r\n\r\n- 15:32:47 ValueError: invalid literal for int() with base 10: 'contactSrc' in UI-server log\r\n- fileGet merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json fails after this UI-server error. \r\n- siteSign fails after this error: Site sign failed: data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json: VerifyError: File not allowed\r\n\r\nweb console + UI server log:\r\n[127.0.0.1-1523626412006.log](https://github.com/HelloZeroNet/ZeroNet/files/1907791/127.0.0.1-1523626412006.log)\r\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1523619802, "modified": 1524125646, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1384", "source_type": "github"}, {"topic_id": 1604066514, "title": "Question: hanging fileWrite - verify failed - download failed", "body": "### Step 1: Please describe your environment\r\n\r\n  * ZeroNet version: 0.6.2 (3408)\r\n  * Operating system: ubuntu 16.04\r\n  * Web browser: chrone\r\n  * Tor status: disabled\r\n  * Opened port: no\r\n  * Special configuration: using same certificate 1CCiJ97XHgVeJrkbnzLgfXvYRr8QEWxnWF in the different ZeroNet clients for same site. Merger site. \r\n\r\n### Step 2: Describe the problem:\r\n\r\nfileWrite 44fb40d546-i.1524133183764 is hanging. New optional file. Using unix timestamp (here 1524133183764) as extension. \r\nUI notification: This file still in sync, if you write it now, then the previous content may be lost.\r\n\r\nChecked UI-server log. Looks like fileWrite cmd is waiting for other peers. Why? \r\n\r\n7 download failed errors for <b>new</b> optional file in UI server log:\r\n[12:19:44] WorkerManager:1W3Et1..V2Ft 185.230.124.53:22014: Verify failed: data/users/1CCiJ97XHgVeJrkbnzLgfXvYRr8QEWxnWF/44fb40d546-i.1524133183764, error: Download failed, failed peers: 0, workers: 0\r\n[12:19:44] WorkerManager:1W3Et1..V2Ft 107.181.189.86:57108: Verify failed: data/users/1CCiJ97XHgVeJrkbnzLgfXvYRr8QEWxnWF/44fb40d546-i.1524133183764, error: Download failed, failed peers: 1, workers: 0\r\n[12:19:44] WorkerManager:1W3Et1..V2Ft 185.230.124.51:22014: Verify failed: data/users/1CCiJ97XHgVeJrkbnzLgfXvYRr8QEWxnWF/44fb40d546-i.1524133183764, error: Download failed, failed peers: 2, workers: 0\r\n[12:19:46] WorkerManager:1W3Et1..V2Ft 172.83.40.24:37394: Verify failed: data/users/1CCiJ97XHgVeJrkbnzLgfXvYRr8QEWxnWF/44fb40d546-i.1524133183764, error: Download failed, failed peers: 3, workers: 0\r\n[12:20:28] WorkerManager:1W3Et1..V2Ft 192.38.140.232:0: Verify failed: data/users/1CCiJ97XHgVeJrkbnzLgfXvYRr8QEWxnWF/44fb40d546-i.1524133183764, error: Download failed, failed peers: 4, workers: 0\r\n[12:20:36] WorkerManager:1W3Et1..V2Ft 172.83.40.24:37394: Verify failed: data/users/1CCiJ97XHgVeJrkbnzLgfXvYRr8QEWxnWF/44fb40d546-i.1524133183764, error: Download failed, failed peers: 5, workers: 1\r\n[12:20:36] WorkerManager:1W3Et1..V2Ft 185.230.124.51:22014: Verify failed: data/users/1CCiJ97XHgVeJrkbnzLgfXvYRr8QEWxnWF/44fb40d546-i.1524133183764, error: Download failed, failed peers: 6, workers: 0\r\n\r\n[127.0.0.1-1524135236587.log](https://github.com/HelloZeroNet/ZeroNet/files/1927999/127.0.0.1-1524135236587.log)\r\n\r\n\r\nUpdate 1: repeated test with ZeroNet port open. Same problem with fileWrite and This file still in sync, if you write it now, then the previous content may be lost\r\n\r\nUpdate 2: did a OK siteSign 1W3Et1D5BnqfsXfx2kSx8T61fTPz5V2Ft --inner_path data/users/1CCiJ97XHgVeJrkbnzLgfXvYRr8QEWxnWF/content.json --remove_missing_optional --publish to \"cleanup\" any problems with 1CCiJ97XHgVeJrkbnzLgfXvYRr8QEWxnWF user directory. Repeated test with ZeroNet port open. Same result.\r\n\r\nUpdate 3: changed certificate to 18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ (jro@zeroid.bit). No problem with this certificate.\r\n\r\nUpdate 4: changed back to 1CCiJ97XHgVeJrkbnzLgfXvYRr8QEWxnWF. Still problem with hanging fileWrite.\r\n\r\nUpdate 5: edit sites.json file and removed 2 1CCiJ97XHgVeJrkbnzLgfXvYRr8QEWxnWF bad files for site 1W3Et1D5BnqfsXfx2kSx8T61fTPz5V2Ft. Restarted UI server and tested OK without hanging fileWrite cmd. So removing bad files helped .... ?", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1524128694, "modified": 1524895879, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1391", "source_type": "github"}], "next_comment_id": 65, "comment": {"1604065540_mirrored_jaros1_github": [{"comment_id": 1, "body": "3 \\* check. I known. I have been a Zero dev for about a month. But have been clearing browser cache manual. Thanks for the advice with \"Disable cache\".\n\nRechecked. \n- Using UI server for all.js generation. I am back to older version of JS code after doing above and regenerated all.js. Code in all.js is not correct.\n- Used \"cat lib/*.js > all.js\" command. Code in all.js is correct\n\nI do not understand ...\n", "added": 1478785382, "modified": 1478785407, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/638#issuecomment-259741058", "source_type": "github"}, {"comment_id": 2, "body": "Deleting content of all.js file and page refresh. Site does not start.\nDeleting all.js and page refresh. Cannot see any info about all.js file generation in UI server log or in console log. But all.js  is not equal sum of js files. Old content in all.js\n", "added": 1478786886, "modified": 1478787889, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/638#issuecomment-259748238", "source_type": "github"}, {"comment_id": 3, "body": "Is my UI server getting all.js from ZeroNet instead of generating it from js/lib files?\n<pre>\n[17:51:44] WorkerManager:1JeHa6..mCXk New task: js/all.js, peer lock: None, priority: 9, optional_hash_id: None, tasks started: 1\n[17:51:46] WorkerManager:1JeHa6..mCXk 188.166.30.172:15441: Hash correct: js/all.js\n", "added": 1478787624, "modified": 1478787624, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/638#issuecomment-259751403", "source_type": "github"}, {"comment_id": 4, "body": "Thanks. You had already written the answer. \"This is my site\" should be enabled on sidebar\". I have moved my environment to two different comp. within a week. Sorry about that.\n", "added": 1478787835, "modified": 1478787835, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/638#issuecomment-259752240", "source_type": "github"}], "1604065610_mirrored_jaros1_github": [{"comment_id": 5, "body": "You are right. First step in decryption, eciesDecrypt, returns null when mismatch between encryption in incoming message and private key. No problem. Closing the issue", "added": 1481257828, "modified": 1481257828, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/696#issuecomment-265951370", "source_type": "github"}], "1604065674_mirrored_jaros1_github": [{"comment_id": 6, "body": "Sorry. Wrong project.", "added": 1483665943, "modified": 1483665943, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/744#issuecomment-270828596", "source_type": "github"}], "1604065733_mirrored_jaros1_github": [{"comment_id": 7, "body": "Thanks for the info. Will try to be smarter in my API calls. \r\n\r\nRegarding fileGet. Sometimes fileGet fails with a timeout (empty response in callback) and the requested file will arrive later and is detected in file_done event. Sometimes very long time after the failed fileGet request. I have used that in my message processing. \r\nMaybe add a timeout parameter to fileGet? Would be nice with shorter timeout period.", "added": 1485064852, "modified": 1485064852, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/788#issuecomment-274318432", "source_type": "github"}], "1604065787_mirrored_jaros1_github": [{"comment_id": 8, "body": "OK. On one of my VM machines there are 271 missing files (required files) from user areas. A lot of \"data/users/xxxx/content.json invalid cert!\" errors in UI log. And no green download indicator in top of screen. \r\nI think that the download indicator in top of screen is showing pending download for current page (fileGets) and not all missing files. I am interested in the pending fileGets behind the hanging green indicator in top of page. Requests with pending response. Not all missing files.", "added": 1486970445, "modified": 1486970445, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/833#issuecomment-279346527", "source_type": "github"}, {"comment_id": 9, "body": "Closing this issue. Tried a number of different things to get a better file replication for my site. The major problems in my site were:\r\n1) a very big main content.json file with many optional files (fixed). Now moved to smaller content.json files. \r\n2) a big all.js file about 1 Mb (todo).  \r\n3) many invalid content.json files (invalid cert) (fixed). I think the mayor problem was that the UI server were busy trying to replicate the invalid content.json files again and again and did not replicate the other site content (optional files and js-files).\r\n4) disabled TOR also helper.\r\n\r\nBut it was a very frustrating debug process and it could be nice with more build-in ZeroNet help. \r\nI cannot be the only one wondering why some files are not replicated as expected", "added": 1487499064, "modified": 1487499064, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/833#issuecomment-280918131", "source_type": "github"}], "1604065931_mirrored_jaros1_github": [{"comment_id": 10, "body": "History: User data was extracted from main site and moved into the new user hub, signed and published using user hub private key. I have tried deleting user hub and adding user hub with mergerSiteAdd. Same error. Have also recreated content.db. Same error. ", "added": 1495520906, "modified": 1495520906, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/944#issuecomment-303343096", "source_type": "github"}, {"comment_id": 11, "body": "On hold. I am not getting the error right now. Will do some more code changing and tests and get back ", "added": 1495535856, "modified": 1495535856, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/944#issuecomment-303400229", "source_type": "github"}, {"comment_id": 12, "body": "Have done some debugging to get closer to the problem. The error \"No merger permission to load\" comes after a fileGet call to a optional file. Optional file is on bad list. Merger permission is in session before fileGet and is missing after UI server error / in fileGet callback. Problem starts at 18:12:11 in log.\r\n\r\n[127.0.0.1-1495556017978.txt](https://github.com/HelloZeroNet/ZeroNet/files/1022967/127.0.0.1-1495556017978.txt)\r\n\r\nIt is only \"in session\" that merger permission disappears in client. Merger permission is there again after page reload without any new grant.", "added": 1495547496, "modified": 1495600387, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/944#issuecomment-303464040", "source_type": "github"}, {"comment_id": 13, "body": "The problems may be caused by the migrated user data. Will try with an empty data user hub and see if that works ...", "added": 1495606735, "modified": 1495606748, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/944#issuecomment-303667193", "source_type": "github"}, {"comment_id": 14, "body": "Closing. It succeed the third time I tried to create a user hub. Last time I created the user hub as a clone of the main site. I am not sure about what was the problem with the two first user hubs", "added": 1495630753, "modified": 1495630753, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/944#issuecomment-303769630", "source_type": "github"}], "1604066026_mirrored_jaros1_github": [{"comment_id": 15, "body": "Temporary workaround until fixed. edit /src/util/SafeRe.py and remove the new unsafe pattern check:\r\n<pre>\r\nimport re\r\n\r\n\r\nclass UnsafePatternError(Exception):\r\n    pass\r\n\r\n\r\ndef isSafePattern(pattern):\r\n    if len(pattern) > 255:\r\n        raise UnsafePatternError(\"Pattern too long: %s characters\" % len(pattern))\r\n\r\n    # unsafe_pattern_match = re.search(\"[^\\.][\\*\\{\\+]\", pattern)  # Always should be \".\" before \"*{+\" characters to avoid ReDoS\r\n    # if unsafe_pattern_match:\r\n    #     raise UnsafePatternError(\"Potentially unsafe part of the pattern: %s\" % unsafe_pattern_match.group(0))\r\n    return True\r\n\r\n\r\ndef match(pattern, *args, **kwargs):\r\n    if isSafePattern(pattern):\r\n        return re.match(pattern, *args, **kwargs)\r\n</pre>", "added": 1500033618, "modified": 1500033648, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1019#issuecomment-315382047", "source_type": "github"}, {"comment_id": 16, "body": "OK. Not nice. It will be a very big work moving optional files to separate folders and optional files pattern will be very weak using .* and .+ pattern. \".+\" and \".*\" matches any characters!\r\nWhy the 255 characters length? Can solve my problem by repeating [] groups n times manually but then I will run into the 255 characters limit for some of my sites.", "added": 1500036417, "modified": 1500036417, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1019#issuecomment-315394009", "source_type": "github"}, {"comment_id": 17, "body": "Sounds like optional files pattern will end up almost useless and \"^.*$\" could be used instead (or a seperate folder).\r\nHow is it with \"files_allowed\" and \"optional\" patterns if a file in a user directory matches both files_allowed and optional? (I have no problems with files_allowed patterns). \r\nWill the file be a normal or an optional file?", "added": 1500038944, "modified": 1500038944, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1019#issuecomment-315404286", "source_type": "github"}, {"comment_id": 18, "body": "I have used regular expressions to exact match my optional files and that is no longer allowed due to the new restrictions. For example \"optional\": \"([0-9]{13}-[0-9]{13}-[0-9]+-chat.json|[0-9]{13}-image.json|[0-9]{13}-[0-9]+-image.json|[0-9a-f]{10}.[0-9]{13})\" in MonetNetwork. \r\n\r\n[0-9].* is an options as no of my allowed files have digits in filenames. I will change my optional files patterns to the new rules. I do not like it, but OK if that is the way it is :-)\r\n\r\n", "added": 1500042585, "modified": 1500042585, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1019#issuecomment-315418127", "source_type": "github"}], "1604066114_mirrored_jaros1_github": [{"comment_id": 19, "body": "Updated ZeroNet from rev2163 to rev2187. Identical test result. a) OK and b) failed\r\n\r\nRestarted comp. to clear memory.\r\nchrome 58.0.3029.81. Identical test result. a) OK and b) failed\r\nfirefox 54.0. a) OK and b) OK\r\nopera 47.0.2631.55. a) OK and b) OK\r\nSo the problem is \"only\" in chrome\r\n", "added": 1503303355, "modified": 1503305799, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1089#issuecomment-323717502", "source_type": "github"}, {"comment_id": 20, "body": "Thanks for the answer. Closing this issue", "added": 1503313970, "modified": 1503313970, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1089#issuecomment-323753037", "source_type": "github"}], "1604066168_mirrored_jaros1_github": [{"comment_id": 21, "body": "Have upgrated to rev3098. Still having a problem with hanging zite as descripted above. \r\nNow without any error messages in UI server log. siteSign without publish option works fine as a workaround", "added": 1507730300, "modified": 1507730300, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1133#issuecomment-335876795", "source_type": "github"}, {"comment_id": 22, "body": "Found the problem. I now sign and publish with all.js.zip and without all.js. No reason to publish with all.js when all.js.zip is the file being used in index.html. OK sign and publish.\r\nDeveloping: switching to all.js, update some js and press f5 (site is hanging, no error messages and all.js is missing in content.json).\r\nSiteSign: now both all.js and all.js.zip is in content.json. pass f5 and site is working ok in development mode", "added": 1507773028, "modified": 1507773028, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1133#issuecomment-336019989", "source_type": "github"}], "1604066190_mirrored_jaros1_github": [{"comment_id": 23, "body": "I think you have tested the issue from OS. I am using JS in my test. Have added some extra debug lines in console.log. Added callback 4 to check files_optional after sign. It will take some time to write a separate ZeroNet site to document this bug. Hope below documentation is OK ... \r\n\r\n                        // loop. sign each content.json file (remove files_optional and add optional)\r\n                        sign = function () {\r\n                            var pgm = service + '.get_my_user_hub.step_2_compare_tables.sign: ';\r\n                            var dictionary, inner_path, debug_seq0 ;\r\n                            dictionary = dictionaries.shift() ;\r\n                            // 1: read content.json\r\n                            inner_path = 'merged-MoneyNetwork/' + dictionary + '/content.json' ;\r\n                            z_file_get(pgm, {inner_path: inner_path, required: false}, function (content_str) {\r\n                                var pgm = service + '.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: ';\r\n                                var content, json_raw, debug_seq1 ;\r\n                                if (content_str) content = JSON.parse(content_str) ;\r\n                                else content = {} ;\r\n                                content.optional = Z_CONTENT_OPTIONAL ;\r\n\r\n                                // # https://github.com/HelloZeroNet/ZeroNet/issues/1147\r\n                                if (!content.files_optional || !Object.keys(content.files_optional).length) {\r\n                                    console.log(pgm + 'issue #1147: no optional files in content.json') ;\r\n                                }\r\n                                else {\r\n                                    console.log(pgm + 'issue #1147: content.files_optional = ' + JSON.stringify(content.files_optional)) ;\r\n                                    if (show_debug('issue_1147')) {\r\n                                        console.log(pgm + 'issue #1147 = true: old workaround for siteSign failure. deleting content.files_optional before sign') ;\r\n                                        delete content.files_optional ;\r\n                                    }\r\n                                    else console.log(pgm + 'issue #1147 = false: new fix. keeping content.files_optional') ;\r\n                                }\r\n\r\n                                // 2: write content.json\r\n                                json_raw = unescape(encodeURIComponent(JSON.stringify(content)));\r\n                                // debug_seq1 = MoneyNetworkHelper.debug_z_api_operation_start('z_file_write', pgm + inner_path + ' fileWrite');\r\n                                debug_seq1 = debug_z_api_operation_start(pgm, inner_path, 'fileWrite', show_debug('z_file_write'));\r\n                                ZeroFrame.cmd(\"fileWrite\", [inner_path, btoa(json_raw)], function (res) {\r\n                                    var pgm = service + '.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: ';\r\n                                    var debug_seq2 ;\r\n                                    // MoneyNetworkHelper.debug_z_api_operation_end(debug_seq1);\r\n                                    debug_z_api_operation_end(debug_seq1, format_res(res));\r\n                                    if (res != 'ok') {\r\n                                        console.log(pgm + 'Error: ' + inner_path + ' fileWrite failed. res = ' + JSON.stringify(res));\r\n                                        return step_3_find_user_hubs() ; // error - continue with next step\r\n                                    }\r\n                                    // 3: sign\r\n                                    // debug_seq2 = MoneyNetworkHelper.debug_z_api_operation_start('z_site_publish', pgm + inner_path + ' sign') ;\r\n                                    debug_seq2 = debug_z_api_operation_start(pgm, inner_path, 'siteSign', show_debug('z_site_publish')) ;\r\n                                    ZeroFrame.cmd(\"siteSign\", {inner_path: inner_path}, function (res) {\r\n                                        var pgm = service + '.get_my_user_hub.step_2_compare_tables.sign siteSign callback 3: ';\r\n                                        // MoneyNetworkHelper.debug_z_api_operation_end(debug_seq2);\r\n                                        debug_z_api_operation_end(debug_seq2, format_res(res));\r\n                                        if (res != 'ok') {\r\n                                            console.log(pgm + inner_path + ' siteSign failed. error = ' + JSON.stringify(res));\r\n                                            return step_3_find_user_hubs() ; // error - continue with next step;\r\n                                        }\r\n\r\n                                        // sign ok\r\n\r\n                                        // # https://github.com/HelloZeroNet/ZeroNet/issues/1147\r\n                                        // check files_optional after sign\r\n                                        z_file_get(pgm, {inner_path: inner_path, required: false}, function (content_str) {\r\n                                            var pgm = service + '.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: ';\r\n                                            var content ;\r\n                                            content = JSON.parse(content_str) ;\r\n                                            console.log(pgm + 'issue #1147. issue_1147 = ' + show_debug('issue_1147') + ', files_optional = ' + JSON.stringify(content.files_optional)) ;\r\n\r\n                                            if (!dictionaries.length) return step_3_find_user_hubs() ; // done - continue with next step\r\n                                            // next sign in 1 second to keep modified sequence\r\n                                            setTimeout(sign, 1000) ;\r\n\r\n                                        }) ; // z_file_get callback 4\r\n\r\n                                    }) ; // siteSign callback 3\r\n\r\n                                }) ; // fileWrite callback 2\r\n\r\n                            }) ; // z_file_get callback 1\r\n\r\n                        } ; // sign\r\n                        // start sign loop\r\n                        sign() ;\r\n\r\nissue 1147 test 1. zeronet port open + deleting content.files_optional before sign. Test result. Optional files was deleted. bug!\r\n<pre>\r\n16:20:37.356 all.js:2617 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147: no optional files in content.json\r\n16:20:37.365 MoneyNetworkAPI.js:281 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (18). 1 pending ZeroNet API operation (18)\r\n16:20:37.430 MoneyNetworkAPI.js:295 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 66 ms (18). No pending ZeroNet API operations\r\n16:20:37.435 all.js:2661 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: issue #1147. issue_1147 = true, files_optional = undefined\r\n16:20:38.438 all.js:2617 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147: no optional files in content.json\r\n16:20:38.443 MoneyNetworkAPI.js:281 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (22). 1 pending ZeroNet API operation (22)\r\n16:20:38.501 MoneyNetworkAPI.js:295 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 58 ms (22). No pending ZeroNet API operations\r\n16:20:38.503 all.js:2661 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: issue #1147. issue_1147 = true, files_optional = undefined\r\n \r\n16:22:01.883 all.js:2617 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147: no optional files in content.json\r\n16:22:01.888 MoneyNetworkAPI.js:281 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (71). 1 pending ZeroNet API operation (71)\r\n16:22:01.944 MoneyNetworkAPI.js:295 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 56 ms (71). No pending ZeroNet API operations\r\n16:22:01.948 all.js:2661 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: issue #1147. issue_1147 = true, files_optional = undefined\r\n16:22:02.951 all.js:2620 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147: content.files_optional = {\"1508163706713-1508163706713-2-chat.json\":{\"sha512\":\"28f6633566fe975e689fdac7b7639becc7fd4de483ae3df18f7e60750277f06b\",\"size\":187}}\r\n16:22:02.952 all.js:2622 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147 = true: old workaround for siteSign failure. deleting content.files_optional before sign\r\n16:22:02.958 MoneyNetworkAPI.js:281 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (75). 1 pending ZeroNet API operation (75)\r\n16:22:03.010 MoneyNetworkAPI.js:295 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 53 ms (75). No pending ZeroNet API operations\r\n16:22:03.012 all.js:2661 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: issue #1147. issue_1147 = true, files_optional = undefined\r\n</pre>\r\n\r\nissue 1147 test 2. zeronet port open + keeping content.files_optional before sign. Test OK. No optional files were deleted:\r\n<pre>\r\n16:25:37.491 all.js:2617 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147: no optional files in content.json\r\n16:25:37.506 MoneyNetworkAPI.js:281 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (18). 1 pending ZeroNet API operation (18)\r\n16:25:37.580 MoneyNetworkAPI.js:295 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 74 ms (18). No pending ZeroNet API operations\r\n16:25:37.590 all.js:2661 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: issue #1147. issue_1147 = false, files_optional = undefined\r\n16:25:38.593 all.js:2617 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147: no optional files in content.json\r\n16:25:38.603 MoneyNetworkAPI.js:281 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (22). 1 pending ZeroNet API operation (22)\r\n16:25:38.658 MoneyNetworkAPI.js:295 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 55 ms (22). No pending ZeroNet API operations\r\n16:25:38.662 all.js:2661 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: issue #1147. issue_1147 = false, files_optional = undefined\r\n...\r\n16:27:31.255 all.js:2617 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147: no optional files in content.json\r\n16:27:31.259 MoneyNetworkAPI.js:281 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (69). 1 pending ZeroNet API operation (69)\r\n16:27:31.324 MoneyNetworkAPI.js:295 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 64 ms (69). No pending ZeroNet API operations\r\n16:27:31.327 all.js:2661 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: issue #1147. issue_1147 = false, files_optional = undefined\r\n16:27:32.329 all.js:2620 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147: content.files_optional = {\"1508164016545-1508164016545-2-chat.json\":{\"sha512\":\"965a97fd6335650930ebfff5c4a93d4538a689d005897906aa72c26327142316\",\"size\":227}}\r\n16:27:32.329 all.js:2625 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147 = false: new fix. keeping content.files_optional\r\n16:27:32.335 MoneyNetworkAPI.js:281 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (73). 1 pending ZeroNet API operation (73)\r\n16:27:32.385 MoneyNetworkAPI.js:295 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 50 ms (73). No pending ZeroNet API operations\r\n16:27:32.387 all.js:2661 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: issue #1147. issue_1147 = false, files_optional = {\"1508164016545-1508164016545-2-chat.json\":{\"sha512\":\"965a97fd6335650930ebfff5c4a93d4538a689d005897906aa72c26327142316\",\"size\":227}}\r\n</pre>\r\n\r\nissue 1147 test 3. zeronet port closed + deleting content.files_optional before sign. Test result. Optional files was deleted. bug!\r\n<pre>\r\n16:30:06.292 all.js:2617 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147: no optional files in content.json\r\n16:30:06.311 MoneyNetworkAPI.js:281 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (18). 1 pending ZeroNet API operation (18)\r\n16:30:06.404 MoneyNetworkAPI.js:295 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 93 ms (18). No pending ZeroNet API operations\r\n16:30:06.412 all.js:2661 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: issue #1147. issue_1147 = true, files_optional = undefined\r\n16:30:07.416 all.js:2620 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147: content.files_optional = {\"1508164016545-1508164016545-2-chat.json\":{\"sha512\":\"965a97fd6335650930ebfff5c4a93d4538a689d005897906aa72c26327142316\",\"size\":227}}\r\n16:30:07.417 all.js:2622 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147 = true: old workaround for siteSign failure. deleting content.files_optional before sign\r\n16:30:07.425 MoneyNetworkAPI.js:281 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (22). 1 pending ZeroNet API operation (22)\r\n16:30:07.485 MoneyNetworkAPI.js:295 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 60 ms (22). No pending ZeroNet API operations\r\n16:30:07.488 all.js:2661 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: issue #1147. issue_1147 = true, files_optional = undefined\r\n...\r\n16:30:53.416 all.js:2617 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147: no optional files in content.json\r\n16:30:53.420 MoneyNetworkAPI.js:281 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (68). 1 pending ZeroNet API operation (68)\r\n16:30:53.485 MoneyNetworkAPI.js:295 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 65 ms (68). No pending ZeroNet API operations\r\n16:30:53.489 all.js:2661 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: issue #1147. issue_1147 = true, files_optional = undefined\r\n16:30:54.491 all.js:2620 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147: content.files_optional = {\"1508164241927-1508164241927-2-chat.json\":{\"sha512\":\"1f4796bd5c667d99d6cdf0265f8bd498348881c62591c44e9d9e1a8ecfb69aaf\",\"size\":236}}\r\n16:30:54.491 all.js:2622 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file_get callback 1: issue #1147 = true: old workaround for siteSign failure. deleting content.files_optional before sign\r\n16:30:54.498 MoneyNetworkAPI.js:281 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign started (72). 1 pending ZeroNet API operation (72)\r\n16:30:54.550 MoneyNetworkAPI.js:295 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign fileWrite callback 2: merged-MoneyNetwork/1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json siteSign finished. res = \"OK\". elapsed time 52 ms (72). No pending ZeroNet API operations\r\n16:30:54.552 all.js:2661 MoneyNetworkHubService.get_my_user_hub.step_2_compare_tables.sign z_file:_get callback 4: issue #1147. issue_1147 = true, files_optional = undefined\r\n</pre>", "added": 1508153637, "modified": 1508153704, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1147#issuecomment-336906023", "source_type": "github"}, {"comment_id": 24, "body": "https://github.com/jaros1/Money-Network/blob/master/js/lib/72-angular-service1.js#L563", "added": 1508153900, "modified": 1508153900, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1147#issuecomment-336907394", "source_type": "github"}, {"comment_id": 25, "body": "OK. Will write a little site to verify the issue", "added": 1508157412, "modified": 1508157412, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1147#issuecomment-336926140", "source_type": "github"}, {"comment_id": 26, "body": "Tried to recreate the error in a small separate site and did not get same problem. Only big difference between my site and the new site is merger site feature. ", "added": 1508215921, "modified": 1508215921, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1147#issuecomment-337148254", "source_type": "github"}, {"comment_id": 27, "body": "Can see in test log that two different data hubs are involved in process. Will do some more testing. I guess it is NOT a ZeroNet bug", "added": 1508226012, "modified": 1508226012, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1147#issuecomment-337191413", "source_type": "github"}, {"comment_id": 28, "body": "Still problem in my site.  Can see that I sign two different content.json files from two different data hubs and that the optional file is deleted from data hub in sign. Will create a simple merger site and see if I can recreate the problem.\r\n\r\n[127.0.0.1-1508239399628.log](https://github.com/HelloZeroNet/ZeroNet/files/1390891/127.0.0.1-1508239399628.log)\r\n", "added": 1508230633, "modified": 1508230633, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1147#issuecomment-337208041", "source_type": "github"}, {"comment_id": 29, "body": "No problem on non merger sites. Problem on merger sites.\r\n\r\nCreated main site Issue #1147 with address 14EQaGqfahEJ9iV8tBqanZojHza7N1A3cM\r\nand data hub with address 15bk2bBQMN44i3qcnEFmaiqK42ortd3U8r\r\nDon't know why fileWrite operations take so long time. Be patient ...\r\nTest fails on https://fuckcf.cf/14EQaGqfahEJ9iV8tBqanZojHza7N1A3cM/ with error message \"Test failed. No optional files were found.\"\r\n( checking number of optional files in content.json after sign)\r\n\r\n[fuckcf.cf-1508245725947.log](https://github.com/HelloZeroNet/ZeroNet/files/1391071/fuckcf.cf-1508245725947.log)\r\n\r\n\r\n\r\n", "added": 1508235156, "modified": 1508306511, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1147#issuecomment-337226724", "source_type": "github"}, {"comment_id": 30, "body": "Looks random. Some test OK. Sometimes test fails. I cannot see the pattern ...\r\n\r\nTest 1. On my old laptop. Test failed. No optional files were found\r\n[test-1-old-laptop-no-optional-files-were-found.log](https://github.com/HelloZeroNet/ZeroNet/files/1427151/test-1-old-laptop-no-optional-files-were-found.log)\r\n\r\nTest 2. On my new laptop. Test OK. 5 optional files.\r\n[test-2-new-laptop-5-optional-files.log](https://github.com/HelloZeroNet/ZeroNet/files/1427161/test-2-new-laptop-5-optional-files.log)\r\n\r\nTest 3. proxy.th3nd.com proxy server. cannot test. too many websocket open/close for the test\r\n\r\nTest 4. new fresh ZeroBundle install on new laptop. Test failed. No optional files were found.\r\n[test4-no-optional-files-were-found.log](https://github.com/HelloZeroNet/ZeroNet/files/1427242/test4-no-optional-files-were-found.log)\r\n\r\nTest 5. from a windows 10 vm and edge. Test failed. No optional files were found.\r\n\r\n\r\n", "added": 1509355728, "modified": 1509359593, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1147#issuecomment-340429639", "source_type": "github"}, {"comment_id": 31, "body": "Fixed the problem with long running operations and retested on fuckcf.cf. Still \"Test failed. No optional files were found\".\r\n\r\nChecked siteSign cmd and there is an \"remove_missing_optional\" parameter that I can use instead of deleting content.files_optional before sign. The original problem that I was trying to solve was failed siteSign due to missing optional files. \r\n\r\nStill a bug but only a minor bug as remove_missing_optional is a \"nicer\" solution to the problem.", "added": 1509597807, "modified": 1509597807, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1147#issuecomment-341341247", "source_type": "github"}], "1604066224_mirrored_jaros1_github": [{"comment_id": 32, "body": "Thank you. The 15 sec limit can explain my problems.\r\n\r\nRegarding 1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ and 1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh. \r\nThey are both MoneyNetwork merger sites.\r\n\r\nI have one running site MoneyNetwork using 1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh as a hub \r\nand an other running site MoneyNetworkW2 using 1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ as a hub.\r\nThe sign/publish operations in the two sites should use different user directories but I have to check my logs. But the two sites may sign and publish content to fast to be accepted by other clients. I will add some extra js code to keep publish interval > 15 seconds. \r\n", "added": 1509786452, "modified": 1509786452, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1173#issuecomment-341891877", "source_type": "github"}, {"comment_id": 33, "body": "I know that ZeroFrame JS code has a 30 seconds publish queue. Very nice UI and okay when publishing from one site but this does not work when publishing from 2 sites at the same time in two different windows or browser tabs. \r\n\r\nIs it possible to let the UI server return an ratelimit error when publishing content too fast? \r\nNow the UI server returns OK publish to the client but the published content.json file will be rejected by other ZeroNet clients due to ratelimit. So the OK published is really a failed publish.", "added": 1509853173, "modified": 1509853173, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1173#issuecomment-341952603", "source_type": "github"}, {"comment_id": 34, "body": "Yes. I have for now MoneyNetwork and MoneyNetworkW2 that is merger sites using hubs with merger_type=MoneyNetwork. Publish in both sites at the same time. \r\nThe plan is to extent with n MoneyNetworkW{n} wallets where each wallet will handle API access to an external money system. And each wallet site will do \"batch\" processing and publish operations independent of main MoneyNetwork site.\r\n\r\nI am working on a JS queue to prevent getting below the ratelimit when publishing from two merger sites but a \"little\" hard to implement. Do not yet know if my special JS queue will work. Maybe easier to catch in the UI server and return Publish failed: ratelimit or something like this to the UI?\r\n\r\nI am sure that this is a very rare problem but I have spend many hours before learning that ratelimit while publishing was the problem and that publish OK not already is publish OK.", "added": 1509979778, "modified": 1510015422, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1173#issuecomment-342229342", "source_type": "github"}, {"comment_id": 35, "body": "Regarding ratelimit check. I guess that I can use content.modified timestamp + 15 seconds before starting next publish?", "added": 1510044813, "modified": 1510044813, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1173#issuecomment-342460159", "source_type": "github"}, {"comment_id": 36, "body": "Added a publish queue in MoneyNetwork with 15 seconds between publish and content.json files are being distributed OK now. Closing this issue but I still  think that the error (ratelimit) should be reported already at publish time and not just being blocked by receiver peers", "added": 1510121309, "modified": 1510121330, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1173#issuecomment-342755052", "source_type": "github"}, {"comment_id": 37, "body": "Run into the same problem with 26 seconds dif between the two content.json files. Have increased my internal publish queue wait to 30 seconds and everything looks fine now. Thank you for your help.", "added": 1510142674, "modified": 1510142674, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1173#issuecomment-342844752", "source_type": "github"}], "1604066269_mirrored_jaros1_github": [{"comment_id": 38, "body": "Maybe a problem with too many sitePublish calls (merger site). Have added some JS code in my site prevent publish calls with interval < 30 sec. Hoping that it will prevent \"RateLimit Added to queue\" message in UI server and failed content.json distribution ...", "added": 1513576107, "modified": 1513576107, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1206#issuecomment-352361745", "source_type": "github"}], "1604066323_mirrored_jaros1_github": [{"comment_id": 39, "body": "Few sites I think. Closing this issue. Will use JS for backup & restore", "added": 1517938576, "modified": 1517938576, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1247#issuecomment-363556864", "source_type": "github"}], "1604066389_mirrored_HelloZeroNet_github": [{"comment_id": 40, "body": "Will cert pattern \"cert_pattern\": \"^1\" be allowed in this implementation? (while list all cert providers).", "added": 1516849242, "modified": 1516849242, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1258#issuecomment-360369685", "source_type": "github"}], "1604066365_mirrored_jaros1_github": [{"comment_id": 41, "body": "Closing. Dropped 1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh and added 1PgyTnnACGd1XRdpfiDihgKwYRRnzgz2zh with siteDownload. Now working correct :-)", "added": 1518157588, "modified": 1518157588, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1279#issuecomment-364380834", "source_type": "github"}], "1604066389_mirrored_jaros1_github": [{"comment_id": 42, "body": "Did solve the problem with missing peers in an other way. peer table was empty and peer = 0 in optional_files table either for a very long time or sometimes for ever.\r\nNow sending \"dummy\" fileGet requests to optional files without peers. Somehow it triggers peer information update in content.db. Lots of rows in peer table and peer > 0 in optional files table.", "added": 1519788337, "modified": 1519788337, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1297#issuecomment-369135195", "source_type": "github"}], "1604066421_mirrored_jaros1_github": [{"comment_id": 43, "body": "It is the first time I have seen problems with all.js.zip/all.js unzip in ZeroNet. Normally working OK. \r\nTested first contact from a win10 VM using google chrome ZeroNet 0.6.2 rev 3327. No problem here. \r\nWill upgrade to rev 3356 and retest\r\nTest in win10 with rev 3356 fails with same error. So unzip is working in rev 3327 but not in rev 3356.\r\nIs also running ZeroNet 24/7 on an arch linux install rev 3340. No unzip problem here.", "added": 1520665792, "modified": 1520666336, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1322#issuecomment-372018685", "source_type": "github"}, {"comment_id": 44, "body": "Tried using all.js.tar.gz/all.js instead of all.js.zip/all.js. Same error. Checked UI-server log :\r\n[18:05:13] Ui.UiServer Error opening archive file: local variable 'header_allow_ajax' referenced before assignment\r\n[18:05:13] Ui.UiServer 127.0.0.1 - - [2018-03-14 18:05:13] \"GET /moneynetwork.bit/js/all.js.tar.gz/all.js HTTP/1.1\" 404 439 0.001977\r\n", "added": 1521036522, "modified": 1521036522, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1322#issuecomment-373100552", "source_type": "github"}, {"comment_id": 45, "body": "Thank you. Tested OK in Opera with rev 3367 and tar.gz / zip archives", "added": 1521084357, "modified": 1521085132, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1322#issuecomment-373273709", "source_type": "github"}], "1604066504_mirrored_jaros1_github": [{"comment_id": 46, "body": "The first problem with \"anyfilename|contactSrc\" must be an img src=\"xxx\" where an angularJS filter is \"leaking\" through UI-server. Never seen before and can probably be ignored. \r\n\r\nMy problem is that fileGet merged-MoneyNetwork/1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ/data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json starts failing just after this error. 6 OK fileGet content.json before invalid literal for int() with base 10: 'contactSrc' exception.\r\n\r\nThe last problem with failed siteSign is my \"fault\". My workaround for a failed fileGet content.json is not working. It will be a rather big workaround as I will have to remove all optional files, sign without optional files, add optional pattern, add optional files and sign with optional files ...", "added": 1523622108, "modified": 1523622565, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1384#issuecomment-381169979", "source_type": "github"}, {"comment_id": 47, "body": "Closing. Have only seen this error once.", "added": 1524125646, "modified": 1524125646, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1384#issuecomment-382697662", "source_type": "github"}], "1604066514_mirrored_jaros1_github": [{"comment_id": 48, "body": "Added a fileWrite wrapper with timeout after 1 second. Will test if file exists on file system and if file is in bad_files list. ", "added": 1524311344, "modified": 1524371651, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1391#issuecomment-383302606", "source_type": "github"}, {"comment_id": 49, "body": "Same error once more. ZeroNet 0.6.2 (3408), chrome 66, ubuntu 16.04, tor disabled, port closed. Writing a new optional file e46aad1bc3-i.1524378848965, hanging fileWrite operation.\r\nNo extra info from fileWrite wrapper. fileList cmd is also hanging and only number of bad-files in mergerSiteList.\r\n\r\nSee browser and UI-server log:\r\n[w2-127.0.0.1-1524379573676.log](https://github.com/HelloZeroNet/ZeroNet/files/1935299/w2-127.0.0.1-1524379573676.log)\r\n\r\nUI-server summary:\r\n- 3 times error: e46aad1bc3-i.1524378848965, error: Download failed\r\n- 2 times Skipping ... /e46aad1bc3-i.1524378848965'\r\n- 1 time e46aad1bc3-i.1524378848965, removing from bad_files\r\n\r\nChecked sites.json. e46aad1bc3-i.1524378848965 was not in bad_files list", "added": 1524371611, "modified": 1524371679, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1391#issuecomment-383361831", "source_type": "github"}, {"comment_id": 50, "body": "I am not sure what you want me to do but I will check F12>network>websocket next time I run into this issue. In log, see line 19 and 51. Start and end for fileWrite cmd. Elapsed time 84 seconds.\r\nI can see that fileWrite cmd operation is not starting until pressing OK to \"This file still in sync, if you write it now, then the previous content may be lost\". \r\nFile is not in fileList response from timeout function and not on file system until user presses OK to warning. \r\n\r\n\"fixed\" above problem with manual \"siteSign 1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ --inner_path data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json --remove_missing_optional --publish\" from console. Next test run completed without any problems. \r\n\r\nCan add a workaround with \"siteSign 1HXzvtSLuvxZfh6LgdaqTk4FSVf7x8w7NJ --inner_path data/users/18DbeZgtVCcLghmtzvg4Uv8uRQAwR8wnDQ/content.json --remove_missing_optional --publish\" in my fileWrite timeout function but I also want to get a better understanding of the \"This file still in sync, if you write it now, then the previous content may be lost\" warning. \r\n\r\nHave seen this warning many times. Sometimes I understand the reason, sometimes not. \r\n\r\nI think that content.json has been updated on an other computer A before running test on this computer B and maybe the problem is that I am using sign without publish on B. sign+publish solved the problem on computer B. ", "added": 1524377744, "modified": 1524377744, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1391#issuecomment-383367158", "source_type": "github"}, {"comment_id": 51, "body": "Thanks. I will try a workaround based on sign+publish when running into hanging fileWrite. Will update later :-) The written file is always new. Any way to detect if content.json is in bad_files? Tried mergerSiteList but there is only number of bad_files. Not a list.", "added": 1524384657, "modified": 1524384797, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1391#issuecomment-383373709", "source_type": "github"}, {"comment_id": 52, "body": "I can confirm that the problem is \"I think that content.json has been updated on an other computer A before running test on this computer B and maybe the problem is that I am using sign without publish on B. sign+publish solved the problem on computer B\". \r\nCheck this morning and content.json + data.json were in bad_files list in sites.json.\r\nI am using sign without publish for cross zeronet site communication (json files). Too slow and too many failed publish if I have to use sign+publish for each json message.\r\n\r\nWill continue on my workaround for hanging fileWrite (sign+publish). \r\nhttps://github.com/jaros1/Money-Network/issues/359#issuecomment-383487871\r\n\r\nUpdate:\r\nI can see that my workaround using sign + remove_missing_optional + publish is not working when using ZeroNet API commands.\r\nStopped UI server. Found 5 files including content.json in bad files. Did a manual sign + remove_missing_optional + publish from terminal. Started UI server and the 5 files were removed from bad files and no longer hanging fileWrite in site.", "added": 1524460171, "modified": 1524461897, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1391#issuecomment-383490526", "source_type": "github"}, {"comment_id": 53, "body": "Run into same problem this morning. \r\nMy workaround with JS sign + publish did not fix the problem.\r\nStop UI-server, manual sign+publish in terminal, start UI-server and reload site did fix the problem.\r\n\r\nWhy this difference between sign+publish in JS and manual sign+publish? I am using user certificate in JS and is using site certificate in manual sign and publish.\r\n\r\nhttps://github.com/jaros1/Money-Network/issues/359#issuecomment-384223842\r\n", "added": 1524643875, "modified": 1524644071, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1391#issuecomment-384250316", "source_type": "github"}], "1604066505_mirrored_anoadragon453_github": [{"comment_id": 54, "body": "https://github.com/HelloZeroNet/ZeroNet/issues/1384\r\nMy problem was a angularJS filter |xxx. Don't know why but the image src was not parsed by angularJS and sent to UI-server with | in file name", "added": 1524372211, "modified": 1524372211, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1394#issuecomment-383362299", "source_type": "github"}], "1604066536_mirrored_ghost_github": [{"comment_id": 55, "body": "See ZeroFrame API \r\nhttps://zeronet.readthedocs.io/en/latest/site_development/zeroframe_api_reference/#wrappergetlocalstorage\r\nhttps://zeronet.readthedocs.io/en/latest/site_development/zeroframe_api_reference/#wrappersetlocalstorage-data", "added": 1524371907, "modified": 1524371932, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1399#issuecomment-383362073", "source_type": "github"}, {"comment_id": 56, "body": "I keep a copy of localStorage in a JS object:\r\n\r\nvar local_storage = {} ;\r\nZeroFrame.cmd(\"wrapperGetLocalStorage\", [], function (res) {\r\n  var key ;\r\n  for (key in local_storage) if (!res.hasOwnProperty(key)) delete local_storage[key] ;\r\n  for (key in res) local_storage[key] = res[key] ;\r\n}) ;\r\n\r\nupdate local_storage as a normal object\r\n\r\nsave to ZeroFrame:\r\nZeroFrame.cmd(\"wrapperSetLocalStorage\", [local_storage], function () {}) ;\r\n\r\n\r\n", "added": 1524374667, "modified": 1524375915, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1399#issuecomment-383364399", "source_type": "github"}, {"comment_id": 57, "body": "Do you have a ZeroFrame class in your JS code?\r\nhttps://github.com/HelloZeroNet/ZeroTalk/blob/master/js/utils/ZeroFrame.coffee\r\n", "added": 1524378119, "modified": 1524378119, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1399#issuecomment-383367471", "source_type": "github"}, {"comment_id": 58, "body": "You cannot reference localStorage direct. Please use ZeroFrame.\r\nI can see that Page is used instead of ZeroFrame in your all.js\r\nMaybe the fix is:\r\n\r\n<pre>\r\nvar local_storage = {};\r\nPage.cmd(\"wrapperGetLocalStorage\", [], function (res) {\r\n    var key;\r\n    for(key in local_storage) {\r\n        if(!res.hasOwnProperty(key)) {\r\n            delete local_storage[key] ;\r\n        }\r\n    }\r\n    for(key in res) {\r\n        local_storage[key] = res[key];\r\n    }\r\n\r\n    // put code which uses localstorage here\r\n    // when you want to get from localstorage, use local_storage[key]\r\n    // when you want to save to localstorage, use local_storage[key] = value; \r\n\r\n   Page.cmd(\"wrapperSetLocalStorage\", local_storage);\r\n});\r\n</pre>", "added": 1524384236, "modified": 1524384342, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1399#issuecomment-383373351", "source_type": "github"}, {"comment_id": 59, "body": "@DATSEC  Sorry, I am not very good at OO and coffee script. Just using a JS version of ZeroFrame and strait ZeroFrame.cmd calls in my js code. \r\n[30-ZeroFrame.txt](https://github.com/HelloZeroNet/ZeroNet/files/1935532/30-ZeroFrame.txt)\r\n\r\n\r\n\r\n", "added": 1524387205, "modified": 1524387205, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1399#issuecomment-383376014", "source_type": "github"}, {"comment_id": 60, "body": "Not tested! Maybe you use Page instead of ZeroFrame?\r\n\r\n<pre>\r\n'use strict';\r\n// create <link rel=\"stylesheet\" href=\"light|dark.css\">\r\nlet head = document.head,\r\n    link = document.createElement('link');\r\nlink.rel = 'stylesheet';\r\n\r\nZeroFrame.cmd(\"wrapperGetLocalStorage\", [], function (local_storage) {\r\n\r\n    // put code which uses localstorage here\r\nif (local_storage['themeStyle'] === 'dark') {\r\n  link.href = 'css/dark.css'; // link to a dark style\r\n  document.getElementById('switch-1').setAttribute('checked', true); // switch the checkbox to the \"dark theme\"\r\n}\r\n// default light theme\r\nelse {\r\n  link.href = 'css/light.css'; // link to light style\r\n}\r\nhead.appendChild(link); // insert the <link rel=\"stylesheet\" href=\"light|dark.css\"> into the header of the page between the head\r\n\r\n// event when switching checkbox\r\ndocument.getElementById('switch-1').addEventListener('change', ev => {\r\n  let btn = ev.target;\r\n  // if the checkbox is enabled\r\n  if (btn.checked) {\r\n    link.href = 'css/dark.css'; // turn off the dark theme\r\n    local_storage['themeStyle'] = 'dark'; // write the value in localStorage\r\n  }\r\n  else {\r\n    link.href = 'css/light.css'; // turn on the light theme\r\n    local_storage['themeStyle'] = 'light'; // write the value in localStorage\r\n  }\r\n\r\n    // when you want to save to localstorage, use local_storage[key] = value; \r\nzeroFrame.cmd(\"wrapperSetLocalStorage\", local_storage);\r\n});\r\n});\r\n</pre>\r\n   \r\n\r\n", "added": 1524389722, "modified": 1524389797, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1399#issuecomment-383378401", "source_type": "github"}, {"comment_id": 61, "body": "@DATSEC Have you tried JS debugger? Should be possible to follow js execution line by line and call by call.", "added": 1524401287, "modified": 1524401287, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1399#issuecomment-383390976", "source_type": "github"}, {"comment_id": 62, "body": "@DATSEC I am not using Safari but I don't think it is a safari issue. Anywhere I can see and test your code?", "added": 1524403228, "modified": 1524403228, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1399#issuecomment-383393275", "source_type": "github"}, {"comment_id": 63, "body": "Added this window.ZeroFrame = new ZeroFrame; \r\nbefore new code. Still errors but localStorage is loaded from ZeroFrame API.\r\n\r\nMaybe just missing some css files:\r\nall.js?lang={lang}:3558 GET http://127.0.0.1:43110/1uPLoaDwKzP6MCGoVzw48r4pxawRBdmQc/css/light.css 404 (Not Found)\r\n(anonymous) @ all.js?lang={lang}:3558\r\n19:11:45.904 all.js?lang={lang}:25 [ZeroUp] Websocket callback not found: {cmd: \"response\", to: 14, result: undefined}\r\n19:11:45.905 all.js?lang={lang}:25 [ZeroFrame] Websocket callback not found: {cmd: \"response\", to: 14, result: undefined}\r\n19:11:46.662 all.js?lang={lang}:3554 GET http://127.0.0.1:43110/1uPLoaDwKzP6MCGoVzw48r4pxawRBdmQc/css/dark.css 404 (Not Found)\r\n(anonymous) @ all.js?lang={lang}:3554\r\n19:11:46.662 all.js?lang={lang}:25 [ZeroUp] Websocket callback not found: {cmd: \"response\", to: 15, result: undefined}\r\n19:11:46.663 all.js?lang={lang}:25 [ZeroFrame] Websocket callback not found: {cmd: \"response\", to: 15, result: undefined}", "added": 1524406240, "modified": 1524406346, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1399#issuecomment-383396828", "source_type": "github"}, {"comment_id": 64, "body": "<pre>\r\nwindow.ZeroFrame = new ZeroFrame;\r\n\r\nZeroFrame.cmd(\"wrapperGetLocalStorage\", [], function (local_storage) {\r\n\r\n    // put code which uses localstorage here\r\n    if (local_storage['themeStyle'] === 'dark') {\r\n        link.href = 'css/dark.css'; // link to a dark style\r\n        document.getElementById('switch-1').setAttribute('checked', true); // switch the checkbox to the \"dark theme\"\r\n    }\r\n// default light theme\r\n    else {\r\n        link.href = 'css/light.css'; // link to light style\r\n    }\r\n    head.appendChild(link); // insert the  into the header of the page between the head\r\n\r\n// event when switching checkbox\r\n    document.getElementById('switch-1').addEventListener('change', function (ev) {\r\n        var btn = ev.target;\r\n// if the checkbox is enabled\r\n    if (btn.checked) {\r\n        link.href = 'css/dark.css'; // turn off the dark theme\r\n        local_storage['themeStyle'] = 'dark'; // write the value in localStorage\r\n    }\r\n    else {\r\n        link.href = 'css/light.css'; // turn on the light theme\r\n        local_storage['themeStyle'] = 'light'; // write the value in localStorage\r\n    }\r\n\r\n    // when you want to save to localstorage, use local_storage[key] = value;\r\n    Page.cmd(\"wrapperSetLocalStorage\", local_storage);\r\n});\r\n});\r\n</pre>", "added": 1524406531, "modified": 1524406531, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/1399#issuecomment-383397175", "source_type": "github"}]}}