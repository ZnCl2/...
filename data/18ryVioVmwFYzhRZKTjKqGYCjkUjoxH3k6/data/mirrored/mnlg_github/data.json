{"cert_user_id": "mnlg@github", "next_topic_id": 3, "topic": [{"topic_id": 1604065200, "title": "Fix issue parsing @keyframes in css files", "body": "ZeroNet breaks css in the compilation / merge process under certain circumstances. This example will fail to compile a valid css file. \n\n```\n@keyframes flip {                                                                                                                                         \n    0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}                                                                                 \n    50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}                                                                                    \n    100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}                                                                         \n} \n```\n\nIt produces this css code:\n\n```\n@keyframes flip {\n    0%   { -webkit-transform: perspective(120px) rotateX(0deg) rotateY(0deg); -moz-transform: perspective(120px) rotateX(0deg) rotateY(0deg); -o-transform: perspective(120px) rotateX(0deg) rotateY(0deg); -ms-transform: perspective(120px) rotateX(0deg) rotateY(0deg); transform: perspective(120px) rotateX(0deg) rotateY(0deg) ;}\n@-webkit-keyframes flip {\n    0%   { -webkit-transform: perspective(120px) rotateX(0deg) rotateY(0deg); -moz-transform: perspective(120px) rotateX(0deg) rotateY(0deg); -o-transform: perspective(120px) rotateX(0deg) rotateY(0deg); -ms-transform: perspective(120px) rotateX(0deg) rotateY(0deg); transform: perspective(120px) rotateX(0deg) rotateY(0deg) ;}\n@-moz-keyframes flip {\n    0%   { -webkit-transform: perspective(120px) rotateX(0deg) rotateY(0deg); -moz-transform: perspective(120px) rotateX(0deg) rotateY(0deg); -o-transform: perspective(120px) rotateX(0deg) rotateY(0deg); -ms-transform: perspective(120px) rotateX(0deg) rotateY(0deg); transform: perspective(120px) rotateX(0deg) rotateY(0deg) ;}\n\n    50%  { -webkit-transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg); -moz-transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg); -o-transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg); -ms-transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg); transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg) }\n    100% { -webkit-transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg); -moz-transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg); -o-transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg); -ms-transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg); transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg) ;}\n}\n```\n\nIt stops processing the keyframe rule after the first percentage keyword and starts with the next vendor-prefix without closing the bracket, which causes the issue.\n\nThis seems to happen when there isn't an space character before the closing bracket in the percentage rules, caused by `{.*?[^ ]}`. Replacing the regular expression makes the trick.\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1458225862, "modified": 1458235556, "source_link": "https://github.com/HelloZeroNet/ZeroNet/pull/370", "source_type": "github"}, {"topic_id": 1604065204, "title": "Fix issue parsing @keyframes in css files", "body": "This works better than #370.\n\nHowever, there still is an issue here, if the original file already includes the prefixed version of the @keyframes it will generate them again and will be duplicated in the compiled css file.\n\nIt's not a priority as far as it compiles a valid css file, but maybe it's worth considering to remove this from the ZeroNet core and leave it to the web developer, tools such as css pre-processors already compile, merge and add the prefixes when needed.\n", "parent_topic_uri": "1604062980_users_1Cy3ntkN2GN9MH6EaW6eHpi4YoRS2nK5Di", "added": 1458234701, "modified": 1458234910, "source_link": "https://github.com/HelloZeroNet/ZeroNet/pull/372", "source_type": "github"}], "next_comment_id": 6, "comment": {"1604065200_mirrored_mnlg_github": [{"comment_id": 1, "body": "EDIT: You'r right, it produces valid css but the it repeats some of the rules few times.\n\n```\n.test {\n    border-radius: 5px;\n    background: linear-gradient(red, blue);\n}\n\n\n@keyframes flip {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n@keyframes flip2 {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n@-webkit-keyframes flip {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n@keyframes flip2 {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n@-moz-keyframes flip {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n@keyframes flip2 {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n```\n", "added": 1458230144, "modified": 1458230733, "source_link": "https://github.com/HelloZeroNet/ZeroNet/pull/370#issuecomment-198033472", "source_type": "github"}, {"comment_id": 2, "body": "It doesn't add the prefixes.\n\n```\n.test {\n    border-radius: 5px;\n    background: linear-gradient(red, blue);\n}\n\n\n@keyframes flip {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n@keyframes flip2 {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n```\n", "added": 1458232178, "modified": 1458232178, "source_link": "https://github.com/HelloZeroNet/ZeroNet/pull/370#issuecomment-198046953", "source_type": "github"}, {"comment_id": 3, "body": "This seems to work better `(.*? {.*?}\\s*})`, can you check it out?\n\n```\n@keyframes flip {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n@-webkit-keyframes flip {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n@-moz-keyframes flip {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n\n@keyframes flip2 {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n@-webkit-keyframes flip2 {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n@-moz-keyframes flip2 {\n  0%   { transform: perspective(120px) rotateX(0deg) rotateY(0deg);}\n  50%  { transform: perspective(120px) rotateX(-180.1deg) rotateY(0deg)}\n  100% { transform: perspective(120px) rotateX(-180deg) rotateY(-179.9deg);}\n}\n```\n\nI'll give it a try with more complex css keyframes and see it it works.\n", "added": 1458232912, "modified": 1458233026, "source_link": "https://github.com/HelloZeroNet/ZeroNet/pull/370#issuecomment-198051877", "source_type": "github"}, {"comment_id": 4, "body": "I tested the regex with different css animation libraries and it worked for me, I created a new pull request with the fix.\n\nThis can be closed in favour of #372.\n", "added": 1458234875, "modified": 1458234875, "source_link": "https://github.com/HelloZeroNet/ZeroNet/pull/370#issuecomment-198064381", "source_type": "github"}], "1604067608_mirrored_ZeroNetTickBot_github": [{"comment_id": 5, "body": "I don't care", "added": 1582039244, "modified": 1582039244, "source_link": "https://github.com/HelloZeroNet/ZeroNet/issues/2273#issuecomment-587605034", "source_type": "github"}]}}