{
    "db_name": "ZeroChat",
    "db_file": "data/zerochat.db",
    "version": 2,
    "maps": {
        "users/.+/data.json": {
            "to_table": [ 
				{
					"node": "message",
					"table": "message"
				}, 
				{
					"node": "problem",
					"table": "problem"
				}, 
				{
					"node": "submission",
					"table": "submission"
				}
			]
        },
        "users/.+/content.json": {
            "to_json_table": [ "cert_user_id" ],
            "file_name": "data.json"
        }
    },
    "tables": {
        "json": {
            "cols": [
                ["json_id", "INTEGER PRIMARY KEY AUTOINCREMENT"],
                ["directory", "TEXT"],
                ["file_name", "TEXT"],
                ["cert_user_id", "TEXT"]
            ],
            "indexes": ["CREATE UNIQUE INDEX path ON json(directory, file_name)"],
            "schema_changed": 10
        },
        "message": {
            "cols": [
                ["body", "TEXT"],
                ["date_added", "INTEGER"],
                ["json_id", "INTEGER REFERENCES json (json_id)"]
            ],
            "indexes": ["CREATE UNIQUE INDEX message_key ON message(json_id, date_added)"],
            "schema_changed": 10
        },
		"problem" :{
			"cols":[
                ["json_id", "INTEGER REFERENCES json (json_id)"],
				["pub","TEXT"],
				["question","TEXT"],
				["ckey","TEXT"],
				["date_added","INTEGER"]
			],
			"indexes":["CREATE UNIQUE INDEX problem_key ON problem(date_added,json_id)"],
			"schema_changed" : 1
		},
		"submission" :{
			"cols":[
                ["json_id", "INTEGER REFERENCES json (json_id)"],
				["pub","TEXT"],
				["result","TEXT"],
				["user","TEXT"],
				["sig","TEXT"],
				["date_added","INTEGER"]
			],
			"indexes":["CREATE UNIQUE INDEX submission_key ON submission(json_id,date_added)"],
			"schema_changed" : 1
		}
    }
}