<!DOCTYPE html><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title> Freenet On Qubes</title><meta name="description" content=" As a fan of Freenet due to its decentralization and anonymity and an user of Qubes OS, I wanted to combine these two to achieve better security. Specifically... "><link rel="stylesheet" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/assets/main.css"><link rel="canonical" href="http://127.0.0.1:43110/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/02/06/freenet-on-qubes.html"><link rel="alternate" type="application/rss+xml" title="Nerde Nolzda" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/feed.xml"><header role="banner"> <a class="site-title" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/">Nerde Nolzda</a><nav> <a href="#" class="menu-icon">&#9776;</a><div class="trigger"> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/about/">About</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/keys/">Keys</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/mirrors/">Mirrors</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/">Tags</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/feed.xml">RSS</a></div></nav></header><main><article itemscope itemtype="http://schema.org/BlogPosting"><header><h1 itemprop="name headline"> <a itemprop="mainEntityOfPage url" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/02/06/freenet-on-qubes.html"> Freenet On Qubes </a></h1><p class="post-meta"> <time datetime="2017-02-06T18:15:00+08:00" itemprop="datePublished"> Feb 6, 2017 </time> • <time datetime="2018-06-02T22:25:17+08:00" itemprop="dateModified"> Jun 2, 2018 </time> • <span itemprop="author publisher" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">WillyPillow</span> </span> • <span itemprop="keywords"> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/en.html" rel="tag">en</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/security.html" rel="tag">security</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/qubes.html" rel="tag">qubes</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/freenet.html" rel="tag">freenet</a></span> • <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/sigs/posts/2017-02-06-freenet-on-qubes.md.asc"> Signature </a></p></header><div itemprop="articleBody text"><p>As a fan of <a href="https://freenetproject.org/">Freenet</a> due to its decentralization and anonymity and an user of <a href="https://www.qubes-os.org/">Qubes OS</a>, I wanted to combine these two to achieve better security. Specifically, my goal is to make it work like <a href="https://freenetproject.org/">Whonix</a>, splitting it into a “Freenet Gateway” and “Freenet Workstation”, with the latter not being able to connect to other places except the gateway.</p><h2 id="steps">Steps</h2><ol><li>Create a firewallVm as the gateway, with the Freenet software installed on it.<li>Create an appVm that uses the gateway as its firewallVm. This will act as the workstation.<li>Right click the workstation entry in the VM manager, click “VM Settings”, and take note of the “IP” and “Gateway” address. These will be referred to as <code>[IP]</code> and <code>[GATEWAY]</code> respectively in the following steps.<br /> <img src="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/assets/freenet-on-qubes/1.png" alt="VM Settings" /><li>Navigate to the “Firewall rules” tab in the workstation settings, choose “Deny network access except…”, and untick all three boxes on the right.<br /> <img src="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/assets/freenet-on-qubes/2.png" alt="Firewall rules" /><li>In the webUI of Freenet (on the gateway), navigate to “Configuration -&gt; Web Interface”<br /> <img src="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/assets/freenet-on-qubes/3.png" alt="Web Interface Config" /><li>Change “IP address to bind to” to <code>[GATEWAY]</code><br /> <img src="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/assets/freenet-on-qubes/4.png" alt="IP to Bind to" /><li>Change “Hostnames or IP addresses that are allowed to connect to the web interface” to <code>127.0.0.1,[IP],[GATEWAY]</code>.<li>Change “Hosts having a full access to the Freenet web interface” to <code>127.0.0.1,[GATEWAY]</code>.<br /> <img src="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/assets/freenet-on-qubes/5.png" alt="Allowed Hosts" /><li>In the gateway, run the following commands:<pre><code> echo 'iptables -I INPUT -s [GATEWAY0]/24 -d [GATEWAY] -p tcp --dport 8888 -j ACCEPT' | sudo tee -a /rw/config/qubes-firewall-user-script
 sudo chmod +x /rw/config/qubes-firewall-user-script
</code></pre><p><img src="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/assets/freenet-on-qubes/6.png" alt="Iptables" /></p><li>Reboot the gateway</ol><p>This way, Freenet can be accessed in the workstation VM at <code>http://[GATEWAY]:8888/</code>.</p><p>Also, note that, due to how networking in Qubes works, you may have to start the workstation VM before launching Freenet on the gateway.</p></div><div><h1>Related Posts</h1><ul><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/30/zeronet-offline-sign.html"> Zeronet Offline Sign </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/30/gpg-setup.html"> GPG Setup </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2018/08/24/setting-up-yubikey.html"> Setting Up Yubikey & NMC + Zeronet Update </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/10/23/revoking-my-gpg-keys.html"> Revoking My GPG Keys </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/27/jekyll-gpg-signature.html"> Jekyll GPG Signature </a></ul></div><div><h1><span itemprop="commentCount">2</span> comments</h1><div itemprop="comment" itemscope itemtype="https://schema.org/Comment"> <a name="comment_2017-10-12+17%3A06"></a><div> <cite itemprop="creator">DxDark</cite> | <a itemprop="url" href="http://127.0.0.1:43110/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/02/06/freenet-on-qubes.html#comment_2017-10-12+17%3A06">Permalink</a> | <time itemprop="dateCreated" datetime="2017-10-12 17:06">2017-10-12 17:06</time></div><div itemprop="text"><p>Can we get a visual update to this post? I’ve been through the set up a few times and have never been able to get the AppVM to connect.<br /> Something like a network diagram would be nice as well.</p></div></div><div itemprop="comment" itemscope itemtype="https://schema.org/Comment"> <a name="comment_2017-10-17+21%3A45"></a><div> <cite itemprop="creator">WillyPillow</cite> | <a itemprop="url" href="http://127.0.0.1:43110/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/02/06/freenet-on-qubes.html#comment_2017-10-17+21%3A45">Permalink</a> | <time itemprop="dateCreated" datetime="2017-10-17 21:45">2017-10-17 21:45</time></div><div itemprop="text"><p>@DxDark Sorry for the late reply. (Been a bit busy lately.) I’ve updated the article.<br /> The network diagram is simply “[WORKSTATION] =&gt; [GATEWAY] =&gt; outside”, nothing really special :)<br /> Feel free to ask if you got any questions.</p></div></div><h2>Post a comment</h2><p> Send an email to <a href="mailto:comment@nerde.pw">comment@nerde.pw</a>.</p></div></article></main><footer itemscope itemtype="http://schema.org/Person"><ul><li itemprop="name">WillyPillow<li><a itemprop="email" href="mailto:wp@nerde.pw">wp@nerde.pw</a><li> Gitlab: <a href="https://gitlab.com/willypillow">WillyPillow</a><li> BitBucket: <a href="https://bitbucket.org/WillyPillow">WillyPillow</a><li> Github: <a href="https://github.com/WillyPillow">WillyPillow</a><li> Diaspora*: <a href="https://diasporing.ch/people/7abf8850bce50134011e7a163e59d8f4">WillyPillow</a><li> Reddit: <a href="https://www.reddit.com/user/WillyPillow/">WillyPillow</a><li>Bitcoin: 15ii2SMbgZSyzKxVSYwim7KtT2uqdSdjVm<li>Namecoin: NES89UkGDutphGbVYNUkGkQuRGs6vFQk6h</ul></footer>
