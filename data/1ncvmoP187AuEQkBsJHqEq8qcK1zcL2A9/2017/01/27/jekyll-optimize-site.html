<!DOCTYPE html><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title> Jekyll Optimize Site</title><meta name="description" content=" I used to use Gulp for optimizing the pages on the site for speed. However, because I moved to Netlify for hosting and building the site, I didn’t want to us... "><link rel="stylesheet" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/assets/main.css"><link rel="canonical" href="http://127.0.0.1:43110/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/27/jekyll-optimize-site.html"><link rel="alternate" type="application/rss+xml" title="Nerde Nolzda" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/feed.xml"><header role="banner"> <a class="site-title" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/">Nerde Nolzda</a><nav> <a href="#" class="menu-icon">&#9776;</a><div class="trigger"> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/about/">About</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/keys/">Keys</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/mirrors/">Mirrors</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/">Tags</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/feed.xml">RSS</a></div></nav></header><main><article itemscope itemtype="http://schema.org/BlogPosting"><header><h1 itemprop="name headline"> <a itemprop="mainEntityOfPage url" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/27/jekyll-optimize-site.html"> Jekyll Optimize Site </a></h1><p class="post-meta"> <time datetime="2017-01-27T19:58:00+08:00" itemprop="datePublished"> Jan 27, 2017 </time> • <time datetime="2018-06-02T22:25:14+08:00" itemprop="dateModified"> Jun 2, 2018 </time> • <span itemprop="author publisher" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">WillyPillow</span> </span> • <span itemprop="keywords"> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/en.html" rel="tag">en</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/site.html" rel="tag">site</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/jekyll.html" rel="tag">jekyll</a></span> • <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/sigs/posts/2017-01-27-jekyll-optimize-site.md.asc"> Signature </a></p></header><div itemprop="articleBody text"><p>I used to use <a href="https://gitlab.com/willypillow/JekyllGulp">Gulp</a> for optimizing the pages on the site for speed. However, because I moved to Netlify for hosting and building the site, I didn’t want to use something that not only required quite a few dependencies but was also rather slow. In the article below, I will list the tools I am using as alternatives right now.</p><h2 id="css-minify">CSS Minify</h2><p>This is actually pretty easy, since it turns out that <code>sass</code>, which Jekyll use to generate CSS files, has an option that does exactly this. Just add the following to <code>_config.yml</code>:</p><pre><code>sass:
  style: compressed
</code></pre><h2 id="html-minify">HTML Minify</h2><p><a href="https://github.com/penibelst/jekyll-compress-html">This layout</a> does the job nicely. Basically, just throw <code>compress.html</code> in <code>_layouts</code>, set the layout of <code>default.html</code> to <code>compress</code>, and optionally tweak the settings in <code>_config.yml</code>.</p><p>A special thing about this is that it was completely written in Liquid, without requiring any extra plugins. Thus, it can also work with Github Pages, where the automatic building of Jekyll sites does not support plugins.</p><h2 id="css-inline">CSS Inline</h2><p>As written <a href="https://developers.google.com/speed/docs/insights/InlineCSS">on Google</a> and a lot of other websites, it is generally recommended to inline (small enough) CSS files in HTML documents since it eliminates an additional request that potentially blocks the display of content.</p><p>A lot of articles I’ve read recommended moving <code>main.scss</code> to <code>_includes/</code> and replacing <code>&lt;link rel="stylesheet"...</code> line in <code>head.html</code> with the following code:</p><pre><code>{% capture scss %}{% include main.scss %}{% endcapture %}
{{ scss | scssify }}
</code></pre><p>However, I realized that <code>scssify</code> is called for each post, resulting in a lot of redundant computations. Therefore, I came up with <a href="https://gitlab.com/willypillow/NerdeNolzda/blob/master/_plugins/inline_css.rb">a simple Ruby plugin</a> that essentially replaces the CSS import line in the generated HTML files with the CSS content itself. This way, the CSS is only generated once, drastically improving the speed (about a 60% speedup).</p><h2 id="removing-redundant-css">Removing Redundant CSS</h2><p><code>UnCSS</code> was used to remove unused or redundant CSS rules in the Gulp script. However, there doesn’t seem to be an Jekyll/Ruby-only equivalent. Thus, I just manually compared the raw styles and the ones processed by UnCSS, commenting out the rules I didn’t use. Admittedly, this isn’t as complete as the previous solution, since my Gulp script optimizes the CSS for each HTML file separately, but I guess it works well enough.</p><h2 id="not-implemented">Not Implemented</h2><p>The following are the functionalities in the script that I deemed unnecessary, thus did not search for alternatives:</p><h3 id="optimize-images">Optimize Images</h3><p>There aren’t many images on this site to begin with, and I could always manually compress them if needed.</p><h3 id="optimize-xml">Optimize XML</h3><p>Again, there aren’t a lot of XML files on this site, and most of them are usually processed by servers that aren’t that sensitive about bandwidth anyway.</p></div><div><h1>Related Posts</h1><ul><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2016/08/09/jekyll-last-modified-date.html"> Jekyll Last Modified Date </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2016/07/15/accessing-jekyll-page-front-matter.html"> Accessing Jekyll Page Front Matter </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/27/jekyll-gpg-signature.html"> Jekyll GPG Signature </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/24/url-change.html"> URL Change </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/23/software-and-site-changes.html"> Software And Site Changes </a></ul></div><div><h1><span itemprop="commentCount">0</span> comments</h1><h2>Post a comment</h2><p> Send an email to <a href="mailto:comment@nerde.pw">comment@nerde.pw</a>.</p></div></article></main><footer itemscope itemtype="http://schema.org/Person"><ul><li itemprop="name">WillyPillow<li><a itemprop="email" href="mailto:wp@nerde.pw">wp@nerde.pw</a><li> Gitlab: <a href="https://gitlab.com/willypillow">WillyPillow</a><li> BitBucket: <a href="https://bitbucket.org/WillyPillow">WillyPillow</a><li> Github: <a href="https://github.com/WillyPillow">WillyPillow</a><li> Diaspora*: <a href="https://diasporing.ch/people/7abf8850bce50134011e7a163e59d8f4">WillyPillow</a><li> Reddit: <a href="https://www.reddit.com/user/WillyPillow/">WillyPillow</a><li>Bitcoin: 15ii2SMbgZSyzKxVSYwim7KtT2uqdSdjVm<li>Namecoin: NES89UkGDutphGbVYNUkGkQuRGs6vFQk6h</ul></footer>
