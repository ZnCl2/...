<!DOCTYPE html><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title> Jekyll GPG Signature</title><meta name="description" content=" As mentioned here, the Git repo of this blog is PGP signed. However, I realized that it isn’t exactly convenient to verify the signatures since you have to c... "><link rel="stylesheet" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/assets/main.css"><link rel="canonical" href="http://127.0.0.1:43110/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/27/jekyll-gpg-signature.html"><link rel="alternate" type="application/rss+xml" title="Nerde Nolzda" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/feed.xml"><header role="banner"> <a class="site-title" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/">Nerde Nolzda</a><nav> <a href="#" class="menu-icon">&#9776;</a><div class="trigger"> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/about/">About</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/keys/">Keys</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/mirrors/">Mirrors</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/">Tags</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/feed.xml">RSS</a></div></nav></header><main><article itemscope itemtype="http://schema.org/BlogPosting"><header><h1 itemprop="name headline"> <a itemprop="mainEntityOfPage url" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/27/jekyll-gpg-signature.html"> Jekyll GPG Signature </a></h1><p class="post-meta"> <time datetime="2017-01-27T08:27:00+08:00" itemprop="datePublished"> Jan 27, 2017 </time> • <time datetime="2018-06-02T22:25:13+08:00" itemprop="dateModified"> Jun 2, 2018 </time> • <span itemprop="author publisher" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">WillyPillow</span> </span> • <span itemprop="keywords"> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/en.html" rel="tag">en</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/site.html" rel="tag">site</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/gpg.html" rel="tag">gpg</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/encryption.html" rel="tag">encryption</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/security.html" rel="tag">security</a></span> • <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/sigs/posts/2017-01-27-jekyll-gpg-signature.md.asc"> Signature </a></p></header><div itemprop="articleBody text"><p>As mentioned <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/keys/">here</a>, the Git repo of this blog is PGP signed. However, I realized that it isn’t exactly convenient to verify the signatures since you have to clone the whole repo. Thus, I started searching for a way to serve the signatures along with the HTML.</p><p>Most of the solutions I’ve found (e.g. <a href="https://github.com/kormoc/jekyll-gpg_clearsign">jekyll-gpg_clearsign</a> and <a href="http://blog.merovius.de/2014/01/23/signed-blog-posts.html">another one that only signs the Markdown files</a>) all require the private key in the building process, which is not optimal for me since this site is built on a third party server (i.e. Netlify). In addition, they both embed the signature directly in the HTML, which kind of wastes bandwidth for the majority of users who don’t care about verifying.</p><p>Therefore, I decided to roll my own solution. In a nutshell, the signed Markdown files are placed in a different directory, which are then linked to from the article (i.e. the <code>Signature</code> link just below the title).</p><p>Implementing it is fairly simple. Basically, it boils down to writing a pre-commit hook that signs changed files (much like <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2016/08/09/jekyll-last-modified-date.html">my modified date mechanism</a>) and editing the page layout to include the link.</p><p>For the pre-commit hook, see <a href="https://gitlab.com/willypillow/NerdeNolzda/commit/8c3238af192cdd3bfc7158a62d38d2d75c59b18e">this commit</a> (lines 8~15). As for the layout, see <a href="https://gitlab.com/willypillow/NerdeNolzda/commit/258907261be144444a6cb7263e8c5deb822de62e">this commit</a> (<code>_layouts/page.html</code> and <code>_layouts/post.html</code>).</p><p>As you can see from the hook, only <code>*.md</code> files are signed. This is due to the fact that those files are mainly posts, while other files (e.g. <code>*.html</code>) are mainly layouts, config, ..etc.</p><p>One interesting thing is that Jekyll seems to treat files under <code>*/_posts/</code> as posts rather than plain static files. Thus, I had to jump through a few hoops, replacing <code>_posts</code> with <code>posts</code> in the path of the signature file, and modify the link to it accordingly.</p><h2 id="verifying">Verifying</h2><p>To verify the signature, just download it and pass it to <code>gpg</code>. For example, for this page, you can run the following:</p><pre><code>curl http://127.0.0.1:43110/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/sigs/posts/2017-01-27-jekyll-gpg-signature.md.asc | gpg
</code></pre><p>which outputs the Markdown content and whether it is properly signed or not.</p><p>It is important to note that, since the HTML is not signed, an attacker might modify it, making it different from the Markdown file. As a result, even if the Markdown file’s signature is valid, it does NOT mean that you can trust the web page. Instead, only the Markdown content that is outputed by GPG is guranteed not to be modified.</p></div><div><h1>Related Posts</h1><ul><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/23/software-and-site-changes.html"> Software And Site Changes </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2018/08/24/setting-up-yubikey.html"> Setting Up Yubikey & NMC + Zeronet Update </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/10/23/revoking-my-gpg-keys.html"> Revoking My GPG Keys </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/30/gpg-setup.html"> GPG Setup </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/30/zeronet-offline-sign.html"> Zeronet Offline Sign </a></ul></div><div><h1><span itemprop="commentCount">0</span> comments</h1><h2>Post a comment</h2><p> Send an email to <a href="mailto:comment@nerde.pw">comment@nerde.pw</a>.</p></div></article></main><footer itemscope itemtype="http://schema.org/Person"><ul><li itemprop="name">WillyPillow<li><a itemprop="email" href="mailto:wp@nerde.pw">wp@nerde.pw</a><li> Gitlab: <a href="https://gitlab.com/willypillow">WillyPillow</a><li> BitBucket: <a href="https://bitbucket.org/WillyPillow">WillyPillow</a><li> Github: <a href="https://github.com/WillyPillow">WillyPillow</a><li> Diaspora*: <a href="https://diasporing.ch/people/7abf8850bce50134011e7a163e59d8f4">WillyPillow</a><li> Reddit: <a href="https://www.reddit.com/user/WillyPillow/">WillyPillow</a><li>Bitcoin: 15ii2SMbgZSyzKxVSYwim7KtT2uqdSdjVm<li>Namecoin: NES89UkGDutphGbVYNUkGkQuRGs6vFQk6h</ul></footer>
