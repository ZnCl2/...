<!DOCTYPE html><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title> Simple Monero Mining Botnet Analysis</title><meta name="description" content=" I was browsing Code Scenic, a Chinese blog written by a friend the other day, when I discovered this post. "><link rel="stylesheet" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/assets/main.css"><link rel="canonical" href="http://127.0.0.1:43110/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2016/07/12/simple-monero-mining-botnet-analysis.html"><link rel="alternate" type="application/rss+xml" title="Nerde Nolzda" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/feed.xml"><header role="banner"> <a class="site-title" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/">Nerde Nolzda</a><nav> <a href="#" class="menu-icon">&#9776;</a><div class="trigger"> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/about/">About</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/keys/">Keys</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/mirrors/">Mirrors</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/">Tags</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/feed.xml">RSS</a></div></nav></header><main><article itemscope itemtype="http://schema.org/BlogPosting"><header><h1 itemprop="name headline"> <a itemprop="mainEntityOfPage url" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2016/07/12/simple-monero-mining-botnet-analysis.html"> Simple Monero Mining Botnet Analysis </a></h1><p class="post-meta"> <time datetime="2016-07-12T21:55:48+08:00" itemprop="datePublished"> Jul 12, 2016 </time> • <time datetime="2018-06-02T22:24:21+08:00" itemprop="dateModified"> Jun 2, 2018 </time> • <span itemprop="author publisher" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">WillyPillow</span> </span> • <span itemprop="keywords"> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/en.html" rel="tag">en</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/security.html" rel="tag">security</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/malware.html" rel="tag">malware</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/botnet.html" rel="tag">botnet</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/monero.html" rel="tag">monero</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/cryptocurrency.html" rel="tag">cryptocurrency</a></span> • <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/sigs/posts/2016-07-12-simple-monero-mining-botnet-analysis.md.asc"> Signature </a></p></header><div itemprop="articleBody text"><p>I was browsing <a href="http://codingsimplifylife.blogspot.tw/">Code Scenic</a>, a Chinese blog written by a friend the other day, when I discovered <a href="http://codingsimplifylife.blogspot.tw/2016/07/blog-post.html">this post</a>.</p><p>Simply put, he found his flash drive infected with a virus, which moved his data into a hidden folder (<code>_</code>) and created a shortcut in the root of the disk that will not only open the hidden directory, but also infect your box. Anyway, the reason I’m writing about this is that my family happened to be victims of the malware just a few months ago.</p><h2 id="infection-to-box-movemenoregvbs">Infection To Box (movemenoreg.vbs)</h2><p>The shortcut mentioned above directly invokes <code>movemenoreg.vbs</code>, which moves these four files from <code>{DISK}:\WindowsServices</code> into <code>%APPDATA%\WindowsServices</code>:</p><ul><li>helper.vbs<li>installer.vbs<li>movemenoreg.vbs<li>WindowsServices.exe</ul><p>if they’re not existent, and make them hidden. Lastly, it launches <code>helper.vbs</code> if it is not yet started.</p><h2 id="core-helpervbs">Core (helper.vbs)</h2><p>In contrast to its name, <code>helper.vbs</code> can be said to be the main part of the malware, which does the following:</p><ol><li>Add a shortcut to itself to the startup folder<li><code>installer.vbs</code> is called to infect other USB devices if it is not yet running<li><code>WindowsServices.exe</code>, a Monero mining client, is launched if it is not started</ol><p>The three steps above are repeatedly executed every 5 seconds.</p><h2 id="infection-to-usb-installervbs">Infection To USB (installer.vbs)</h2><p>Every time the script is started, it scans for connected USB devices and enter a infinite loop where it then does the following:</p><ol><li>Check the execution of <code>helper.vbs</code><li>Create <code>\WindowsServices</code> if it is not existent<li>Copy the four files into the directory<li>Create the shortcut that launches <code>_</code> if it is not already there<li>Create <code>_</code> if it doesn’t exist, and move all the files/directories except for <code>_</code>, <code>System Volume Information</code>, and <code>WindowsServces</code> into it</ol><h2 id="monero-mining-client-windowsservicesexe">Monero Mining Client (WindowsServices.exe)</h2><p>This is just a normal Monero mining client, which can be easily downloaded from the Internet. In case you don’t know what mining is, it’s basically doing computations to verify transactions on the Monero network, which earns Monero coins (XMR), in this case, for the author of the botnet. For more information see <a href="https://en.wikipedia.org/wiki/Bitcoin#Mining">this Wikipedia article</a>.</p><p>You can get the wallet address and mining pool address from the arguments by which <code>WindowsServices.exe</code> is called. As for 2016-07-13, a search for the wallet address on the mining pool website shows that about 11.4 XMR (~23 USD) is made. Somehow, I feel sorry for the malware author. The program seemed to be on my family’s computer since February or March, which means (s)he only earned that amount in at least 4 months.</p><h2 id="what-is-monero">What Is Monero?</h2><p>Basically, <a href="https://getmonero.org/">Monero</a> is a cryptocurrency similar to Bitcoin. However, one big difference is that while Bitcoin is pseudoanonymous, Monero is completely anonymous.</p><p>For example, Alice has a Bitcoin wallet A. She sends the funds to Bob, Chris, and David, each with the wallet B, C, and D. While people peeking at these transactions can not simply link A, B, C, and D to their respective owners Alice, Bob, Chris, and David, they can trivially see that it’s the same wallet A that sends money into B, C, and D.</p><p>On the other hand, in the case of Monero, there is simply no (simple) way to know that the same wallet A is used.</p><p>So why is this important? For the former case of Bitcoin, it’s rather easy to link the wallet to the method of converting the funds into fiat currency, like buying and selling them at an exchange, and eventually trace to your personal identity. As for the latter case, since an attacker can’t easily link the transactions done by the same wallet together, such methods become significantly more difficult.</p><p>Now, you might be complaining about how anonymous tools do no good except benefiting criminals. This is a complete fallacy. However, it’s a bit off-topic to discuss this in this article. Hopefully, I’ll cover the topic in another post in the near future.</p><h2 id="conclusion">Conclusion</h2><p>Even though this is only a set of simple VBS scripts, I feel that it’s nice material for learning. The structure is quite easy, while having the ability to self-replicate. Also, the code is well-formatted, even with comments. (If you’re a malware author writing in an interpreted language, be sure to obfuscate the code :D)</p><p>Lastly, CPU mining doesn’t exactly make a lot of money.</p><p>Full code for the scripts can be found <a href="https://bitbucket.org/snippets/WillyPillow/4j4p4">here</a>.</p></div><div><h1>Related Posts</h1><ul><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2016/07/17/bitcoin-mining-q-a.html"> 比特幣挖礦問答 Bitcoin Mining Q/A </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2018/08/24/setting-up-yubikey.html"> Setting Up Yubikey & NMC + Zeronet Update </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/10/23/revoking-my-gpg-keys.html"> Revoking My GPG Keys </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/02/06/freenet-on-qubes.html"> Freenet On Qubes </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/01/30/zeronet-offline-sign.html"> Zeronet Offline Sign </a></ul></div><div><h1><span itemprop="commentCount">0</span> comments</h1><h2>Post a comment</h2><p> Send an email to <a href="mailto:comment@nerde.pw">comment@nerde.pw</a>.</p></div></article></main><footer itemscope itemtype="http://schema.org/Person"><ul><li itemprop="name">WillyPillow<li><a itemprop="email" href="mailto:wp@nerde.pw">wp@nerde.pw</a><li> Gitlab: <a href="https://gitlab.com/willypillow">WillyPillow</a><li> BitBucket: <a href="https://bitbucket.org/WillyPillow">WillyPillow</a><li> Github: <a href="https://github.com/WillyPillow">WillyPillow</a><li> Diaspora*: <a href="https://diasporing.ch/people/7abf8850bce50134011e7a163e59d8f4">WillyPillow</a><li> Reddit: <a href="https://www.reddit.com/user/WillyPillow/">WillyPillow</a><li>Bitcoin: 15ii2SMbgZSyzKxVSYwim7KtT2uqdSdjVm<li>Namecoin: NES89UkGDutphGbVYNUkGkQuRGs6vFQk6h</ul></footer>
