<!DOCTYPE html><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title> Putty/Kitty To Local Clipboard</title><meta name="description" content=" Once in a while, I need to use Putty on Windows to connect to a guest Linux installation in VirtualBox for things that aren’t compatible with Cygwin. However... "><link rel="stylesheet" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/assets/main.css"><link rel="canonical" href="http://127.0.0.1:43110/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2016/07/17/putty-kitty-to-local-clipboard.html"><link rel="alternate" type="application/rss+xml" title="Nerde Nolzda" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/feed.xml"><header role="banner"> <a class="site-title" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/">Nerde Nolzda</a><nav> <a href="#" class="menu-icon">&#9776;</a><div class="trigger"> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/about/">About</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/keys/">Keys</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/mirrors/">Mirrors</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/">Tags</a> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/feed.xml">RSS</a></div></nav></header><main><article itemscope itemtype="http://schema.org/BlogPosting"><header><h1 itemprop="name headline"> <a itemprop="mainEntityOfPage url" href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2016/07/17/putty-kitty-to-local-clipboard.html"> Putty/Kitty To Local Clipboard </a></h1><p class="post-meta"> <time datetime="2016-07-17T13:41:39+08:00" itemprop="datePublished"> Jul 17, 2016 </time> • <time datetime="2018-06-02T22:24:26+08:00" itemprop="dateModified"> Jun 2, 2018 </time> • <span itemprop="author publisher" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">WillyPillow</span> </span> • <span itemprop="keywords"> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/en.html" rel="tag">en</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/putty.html" rel="tag">putty</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/kitty.html" rel="tag">kitty</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/ssh.html" rel="tag">ssh</a>, <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/tag/windows.html" rel="tag">windows</a></span> • <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/sigs/posts/2016-07-17-putty-kitty-to-local-clipboard.md.asc"> Signature </a></p></header><div itemprop="articleBody text"><p>Once in a while, I need to use <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">Putty</a> on Windows to connect to a guest Linux installation in <a href="https://www.virtualbox.org/">VirtualBox</a> for things that aren’t compatible with Cygwin. However, a slight annoyance is that I can’t copy, say, a whole file to the Windows clipboard.</p><p>After some research, I found <a href="http://www.dmst.aueb.gr/dds/sw/windows/puttyclip/">PuttyClip</a>, which is essentially a patch on Putty that adds an option to allow the remote to send <a href="https://en.wikipedia.org/wiki/ANSI_escape_code">ANSI escape codes</a> (AUX port on/off) to modify the local clipboard.</p><p>However, the putty version provided is outdated, and does not support some new cipher standards. Shortly after, I realized the Putty fork I had been using, <a href="http://www.9bis.net/kitty/?action=news&amp;zone=en">KiTTY</a>, has the patch included.</p><p>With the client set up properly, the only thing left is to write a script on the remote box that sends the ANSI codes.</p><pre><code class="language-sh">#!/bin/sh
echo -ne '\e[5i'
cat $*
echo -ne '\e[4i'
</code></pre><p>Which can then be called by <code>[scriptName] [textFile]</code> or <code>cat [textFile] | [scriptName]</code>. However, this does not work on <a href="https://tmux.github.io/">Tmux</a>. A solution is the following:</p><pre><code class="language-sh">#!/bin/sh
echo -ne '\ePtmux;\e\e[5i\e\\'
cat $*
echo -ne '\ePtmux;\e\e[4i\e\\'
</code></pre><p>This creates some escape codes at the beginning of the content, which look positioning related. I have no idea on how to remove them, but manually deleting them (at least for my usage) isn’t that much of a problem.</p></div><div><h1>Related Posts</h1><ul><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2016/07/17/windows-touchpad-simulate-middle-click.html"> Windows Touchpad Simulate Middle Click </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2018/08/24/setting-up-yubikey.html"> Setting Up Yubikey & NMC + Zeronet Update </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/10/23/revoking-my-gpg-keys.html"> Revoking My GPG Keys </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/07/04/codechef-prefixor.html"> Codechef PREFIXOR: Prefix XOR </a><li> <a href="/1ncvmoP187AuEQkBsJHqEq8qcK1zcL2A9/2017/07/04/persistent-segment-tree-in-scala.html"> Persistent Segment Tree In Scala </a></ul></div><div><h1><span itemprop="commentCount">0</span> comments</h1><h2>Post a comment</h2><p> Send an email to <a href="mailto:comment@nerde.pw">comment@nerde.pw</a>.</p></div></article></main><footer itemscope itemtype="http://schema.org/Person"><ul><li itemprop="name">WillyPillow<li><a itemprop="email" href="mailto:wp@nerde.pw">wp@nerde.pw</a><li> Gitlab: <a href="https://gitlab.com/willypillow">WillyPillow</a><li> BitBucket: <a href="https://bitbucket.org/WillyPillow">WillyPillow</a><li> Github: <a href="https://github.com/WillyPillow">WillyPillow</a><li> Diaspora*: <a href="https://diasporing.ch/people/7abf8850bce50134011e7a163e59d8f4">WillyPillow</a><li> Reddit: <a href="https://www.reddit.com/user/WillyPillow/">WillyPillow</a><li>Bitcoin: 15ii2SMbgZSyzKxVSYwim7KtT2uqdSdjVm<li>Namecoin: NES89UkGDutphGbVYNUkGkQuRGs6vFQk6h</ul></footer>
