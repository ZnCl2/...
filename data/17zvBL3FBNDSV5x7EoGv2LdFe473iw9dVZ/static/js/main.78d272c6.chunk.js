(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,n){e.exports=n(40)},30:function(e,t,n){},32:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(13),s=n.n(i),c=n(8),o=n(43),l=n(42),u=(n(30),n(32),"17zvBL3FBNDSV5x7EoGv2LdFe473iw9dVZ"),p=n(17),d=n(12),h=n(11),m=n.n(h),f=n(16),b=n(7),g=n(45),v=n(44),E=n(41),_=n(2),w=n(10),x=n(21),y=n(22),k=function(){function e(t){Object(x.a)(this,e),this.url=t,this.waiting_cb={},this.on_request_listeners={},this.wrapper_nonce=document.location.href.replace(/.*wrapper_nonce=([A-Za-z0-9]+).*/,"$1"),this.connect(),this.next_message_id=1,this.init()}return Object(y.a)(e,[{key:"init",value:function(){return this}},{key:"connect",value:function(){var e=this;this.target=window.parent,window.addEventListener("message",function(t){return e.onMessage(t)},!1),this.cmd("innerReady")}},{key:"onMessage",value:function(e){var t=e.data,n=t.cmd;"response"===n?void 0!==this.waiting_cb[t.to]?this.waiting_cb[t.to](t.result):this.log("Websocket callback not found:",t):"wrapperReady"===n?this.cmd("innerReady"):"ping"===n?this.response(t.id,"pong"):"wrapperOpenedWebsocket"===n?this.onOpenWebsocket():"wrapperClosedWebsocket"===n?this.onCloseWebsocket():this.onRequest(n,t)}},{key:"onRequest",value:function(e,t){var n=this.on_request_listeners[e];if(n&&n.length>0)return n.forEach(function(e){return e(t)});this.log("Unknown request",t)}},{key:"on_cmd",value:function(e,t){var n=this;return this.on_request_listeners[e]=this.on_request_listeners[e]||[],this.on_request_listeners[e].push(t),function(){return n.on_request_listeners[e]=n.on_request_listeners[e].filter(function(e){return e!==t})}}},{key:"response",value:function(e,t){this.send({cmd:"response",to:e,result:t})}},{key:"cmd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.send({cmd:e,params:t},n)}},{key:"cmdp",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(a,r){t.cmd(e,n,function(e){e&&e.error?r(e.error):a(e)})})}},{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.wrapper_nonce=this.wrapper_nonce,e.id=this.next_message_id,this.next_message_id++,this.target.postMessage(e,"*"),t&&(this.waiting_cb[e.id]=t)}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log.apply(console,["[ZeroFrame]"].concat(t))}},{key:"onOpenWebsocket",value:function(){this.log("Websocket open")}},{key:"onCloseWebsocket",value:function(){this.log("Websocket close")}},{key:"monkeyPatchAjax",value:function(){var e=this,t=this;XMLHttpRequest.prototype.realOpen=XMLHttpRequest.prototype.open,this.cmd("wrapperGetAjaxKey",[],function(t){e.ajax_key=t});XMLHttpRequest.prototype.open=function(e,n,a){return n+="?ajax_key="+t.ajax_key,this.realOpen(e,n,a)}}}]),e}(),j=window.zframe=new k,O=(n(36),function(e){return e.stopPropagation()}),N=function(e){var t=e.children,n=e.on_outside_click;return s.a.createPortal(r.a.createElement(c.a.div,{css:"position:fixed;top:0;width:100vw;height:100vh;background:#000a;overflow:auto;display:flex;align-items:center;justify-content:center;> div{background:#fff;}",onClick:function(e){return n&&n()}},r.a.createElement("div",{onClick:O},t)),document.body)},S=function(){return r.a.createElement(c.a.div,{css:"ol{padding-inline-start:40px;}"},r.a.createElement("h1",{id:"what-s-stargate"},"What's StarGate"),r.a.createElement("p",null,"StarGate is a hash sharing site for IPFS network. And since IPFS's full name is ",r.a.createElement("strong",null,"Inter-Planetary File System"),", I name StarGate"," ",r.a.createElement("strong",null,"StarGate"),"."),r.a.createElement("h1",{id:"how-to-use"},"How to use"),r.a.createElement("ol",null,r.a.createElement("li",null,"install ipfs: ",r.a.createElement("a",{href:"https://docs.ipfs.io/introduction/install/"},"https://docs.ipfs.io/introduction/install/")),r.a.createElement("li",null,"init an ipfs repo: ",r.a.createElement("code",null,"ipfs init")),r.a.createElement("li",null,"start an ipfs gateway daemon on the default port: ",r.a.createElement("code",null,"ipfs daemon")),r.a.createElement("li",null,"browse StarGate"),r.a.createElement("li",null,"add a file or a directory to ipfs: ",r.a.createElement("code",null,"ipfs add big_buck_bunny.mp4")," or ",r.a.createElement("code",null,"ipfs add -r sintel")," and get the hash"),r.a.createElement("li",null,"post the hash and the file or directory name to StarGate by click the top left upload icon"),r.a.createElement("li",null,"browse StarGate")),r.a.createElement("h1",{id:"contact-me"},"Contact me"),r.a.createElement("a",{href:"/Mail.ZeroNetwork.bit/?to=xialvjun",target:"_blank",class:"active",rel:"noopener noreferrer"},r.a.createElement("span",null,"contact me")))},C=function(e,t){var n=Object(a.useState)({loading:!!t,error:null,res:null}),r=Object(b.a)(n,2),i=r[0],s=r[1],c=function(){var t=Object(f.a)(m.a.mark(function t(){var n,a=arguments;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s({loading:!0,error:null,res:i.res}),t.prev=1,t.next=4,e.apply(void 0,a);case 4:n=t.sent,s({loading:!1,error:null,res:n}),t.next=12;break;case 8:throw t.prev=8,t.t0=t.catch(1),s({loading:!1,error:t.t0,res:i.res}),t.t0;case 12:case"end":return t.stop()}},t,this,[[1,8]])}));return function(){return t.apply(this,arguments)}}();return Object(a.useEffect)(function(e){t&&c.apply(void 0,Object(p.a)(t))},Object(p.a)(t||[])),[c,i,s]},q=function(e,t){var n=Object(a.useRef)(null);return function(){for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];clearTimeout(n.current),n.current=setTimeout(function(){return e.apply(void 0,r)},t)}},P=w.a.object({hash:[w.a.string("hash is a not empty string"),w.a.length_gt(0,"hash is a not empty string")],name:[w.a.string("name is a not empty string"),w.a.length_gt(0,"name is a not empty string")],desc:w.a.string("desc is a string"),series:w.a.string("series is a string")}),R=function(){return{hash:"",is_dir:!1,name:"",desc:"",series:""}};window.history.pushState=function(e,t,n){var a=n.split(u).pop();return j.cmdp("wrapperPushState",[e,t,a])},window.history.replaceState=function(e,t,n){var a=n.split(u).pop();return j.cmdp("wrapperReplaceState",[e,t,a])},s.a.render(r.a.createElement(o.a,{basename:"/".concat(u)},r.a.createElement(c.a.Provider,null,r.a.createElement(l.a,{to:window.location.href.split(/[\?\&]/g)[1]}),r.a.createElement(function(){var e=Object(a.useState)(!1),t=Object(b.a)(e,2),n=(t[0],t[1],Object(a.useState)(null)),i=Object(b.a)(n,2),s=i[0],o=i[1],l=C(function(e){return j.cmdp("siteInfo")},[]),u=Object(b.a)(l,3),p=u[0],h=u[1],w=(u[2],C(function(e){return j.cmdp("certSelect",{accepted_domains:["zeroid.bit","cryptoid.bit"],accept_any:!0})})),x=Object(b.a)(w,3),y=x[0],k=(x[1],x[2],Object(a.useState)("")),O=Object(b.a)(k,2),W=O[0],G=O[1],F=q(G,500),I=Object(a.useState)(W),z=Object(b.a)(I,2),L=z[0],M=z[1],A=C(function(e){return j.cmdp("dbQuery",{query:"SELECT * FROM hashes LEFT JOIN json USING (json_id) ORDER BY updated_at DESC"})},[]),D=Object(b.a)(A,3),J=D[0],T=D[1],B=(D[2],C(function(){var e=Object(f.a)(m.a.mark(function e(t,n){var a,r,i,s,c,o,l;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("delete"!==t){e.next=5;break}if("string"===typeof n&&""!==n.length){e.next=3;break}throw"wrong data";case 3:e.next=8;break;case 5:if(P(n).is_valid){e.next=8;break}throw"wrong data";case 8:if(a=Object(_.b)(h,"res.cert_user_id"),r=Object(_.b)(h,"res.auth_address"),a&&r){e.next=13;break}throw j.cmdp("wrapperNotification",{type:"info",message:"Please, select your account."}),Error("Please, select your account.");case 13:return i="data/users/"+r+"/data.json",s="data/users/"+r+"/content.json",e.prev=15,e.next=18,j.cmdp("fileGet",{inner_path:i,required:!1});case 18:c=e.sent,o=null;try{o=JSON.parse(c)}catch(u){}return(o=o||{}).hashes=o.hashes||{},"delete"===t?delete o.hashes[n]:o.hashes[n.hash]={name:n.name,desc:n.desc,series:n.series,is_dir:n.is_dir||!1,updated_at:Date.now()},l=unescape(encodeURIComponent(JSON.stringify(o,void 0,"\t"))),e.next=27,j.cmdp("fileWrite",{inner_path:i,content_base64:btoa(l)});case 27:J(),j.cmdp("sitePublish",{inner_path:s,sign:!0}),e.next=35;break;case 31:throw e.prev=31,e.t0=e.catch(15),j.cmdp("wrapperNotification",{type:"error",message:"File write error: ${error}"}),e.t0;case 35:case"end":return e.stop()}},e,this,[[15,31]])}));return function(t,n){return e.apply(this,arguments)}}())),H=Object(b.a)(B,3),Z=H[0],U=H[1],X=(H[2],W.split(/\s/g));return r.a.createElement(c.a.div,{css:"height:100vh;overflow:hidden;display:flex;flex-flow:column;align-items:stretch;.nav{flex:none;height:56px;box-shadow:0 0 10px -5px #333;display:flex;align-items:center;justify-content:space-between;.user{margin-left:20px;span{margin-left:10px;cursor:pointer;}}.logo{margin-right:100px;}}.main{flex:auto;display:flex;}.explorer{margin:14px 14px 0 0;width:440px;overflow-y:auto;.search{margin:25px auto;width:360px;height:40px;padding:0 10px 0 20px;display:flex;align-items:center;border-radius:20px;box-shadow:0 0 10px -5px #333;font-size:20px;input{font-size:inherit;border:none;flex:auto;margin-right:5px;}}ul.list{margin:0 auto;width:400px;list-style:none;font-size:12px;li{padding:14px;transition:background .2s ease;span{cursor:pointer;}.row{margin:5px 0;display:flex;align-items:flex-end;justify-content:space-between;}.operations{opacity:0;span{margin-left:10px;}}&:hover{background:#eee;.operations{opacity:1;}}.name{font-size:16px;}}}}.browser{margin-top:14px;flex:auto;box-shadow:0 0 10px -5px;iframe{width:100%;height:100%;border:none;}}"},r.a.createElement("div",{className:"nav"},r.a.createElement("div",{className:"user"},Object(_.b)(h,"res.cert_user_id")&&r.a.createElement("span",{onClick:function(e){return y().then(function(e){return p()})}},h.res.cert_user_id),r.a.createElement("span",{onClick:function(){var e=Object(f.a)(m.a.mark(function e(t){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(_.b)(h,"res.cert_user_id")){e.next=3;break}return e.next=3,y().then(function(e){return p()});case 3:o(R());case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),className:"icon-upload",title:"upload"}),r.a.createElement(g.a,{to:"/about"},r.a.createElement("span",{className:"icon-question-circle",title:"about and help"})),r.a.createElement("span",{className:"icon-feed",title:"republish: when you publish failed, you need it.",onClick:function(e){var t="data/users/"+Object(_.b)(h,"res.auth_address")+"/content.json";j.cmdp("sitePublish",{inner_path:t,sign:!0})}})),r.a.createElement("h2",{className:"logo"},"StarGate")),r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"explorer"},r.a.createElement("div",{className:"search"},r.a.createElement("input",{value:L,onChange:function(e){M(e.target.value),F(e.target.value)}}),r.a.createElement("span",{className:"icon-search"})),r.a.createElement("ul",{className:"list"},(Object(_.b)(T,"res")||[]).filter(function(e){return X.every(function(t){return t.startsWith("cert_user_id:")?e.cert_user_id===t.replace("cert_user_id:",""):t.startsWith("series:")?e.series===t.replace("series:",""):e.name.indexOf(t)>-1||e.desc.indexOf(t)>-1})}).map(function(e){return r.a.createElement("li",{key:e.hash+"@"+e.cert_user_id},r.a.createElement("div",{className:"row"},r.a.createElement("span",null,r.a.createElement(g.a,{className:"name",to:"/hashes/".concat(e.hash)},e.name," ",!!e.is_dir&&r.a.createElement("span",{className:"icon-folder-open",title:"this is a directory"}))),r.a.createElement("span",{className:"series",onClick:function(t){var n=W+" series:".concat(e.series," cert_user_id:").concat(e.cert_user_id);M(n),G(n)}},e.series)),r.a.createElement("div",{className:"row"},r.a.createElement("span",{className:"cert_user_id",onClick:function(t){var n=W+" cert_user_id:".concat(e.cert_user_id);M(n),G(n)}},e.cert_user_id),r.a.createElement("div",{className:"operations"},r.a.createElement("a",{href:"http://localhost:8080/ipfs/".concat(e.hash),target:"_blank",rel:"noopener noreferrer"},r.a.createElement("span",{className:"icon-link",title:"open it in a new tab"})),r.a.createElement("a",{href:"http://localhost:8080/ipfs/".concat(e.hash),download:e.name,rel:"noopener noreferrer"},r.a.createElement("span",{className:"icon-download",title:"download it"})),Object(_.b)(h,"res.cert_user_id")===e.cert_user_id&&r.a.createElement("span",{onClick:function(t){return o(e)},className:"icon-pencil",title:"edit it"}))),r.a.createElement("div",{className:"desc"},e.desc))}))),r.a.createElement("div",{className:"browser"},r.a.createElement(v.a,null,r.a.createElement(E.a,{path:"/hashes/:hash",render:function(e){e.location,e.history;var t=e.match;return r.a.createElement("iframe",{key:t.params.hash,src:"http://localhost:8080/ipfs/".concat(t.params.hash),allowFullScreen:!0})}}),r.a.createElement(E.a,{path:"/about",component:S})))),s&&r.a.createElement(N,{on_outside_click:function(e){return o(null)}},r.a.createElement(c.a.div,{css:"margin:14px;width:400px;label > div{margin:14px 0;}label input,textarea{width:100%;}footer{text-align:right;button{padding:5px;margin-left:10px;}}",onSubmit:function(e){e.preventDefault(),e.stopPropagation()}},r.a.createElement("label",null,r.a.createElement("div",null,r.a.createElement("div",null,"hash"),r.a.createElement("input",{value:Object(_.b)(s,"hash",""),onChange:function(e){return o(Object(d.a)({},s,{hash:e.target.value}))}}))),r.a.createElement("label",null,r.a.createElement("div",null,r.a.createElement("div",null,"name (with extension)"),r.a.createElement("input",{value:Object(_.b)(s,"name",""),onChange:function(e){return o(Object(d.a)({},s,{name:e.target.value}))}}))),r.a.createElement("label",null,r.a.createElement("div",null,r.a.createElement("div",null,"series"),r.a.createElement("input",{value:Object(_.b)(s,"series",""),onChange:function(e){return o(Object(d.a)({},s,{series:e.target.value}))}}))),r.a.createElement("label",null,r.a.createElement("div",null,r.a.createElement("div",null,"desc"),r.a.createElement("textarea",{value:Object(_.b)(s,"desc",""),onChange:function(e){return o(Object(d.a)({},s,{desc:e.target.value}))}}))),r.a.createElement("label",{onClick:function(e){return o(Object(d.a)({},s,{is_dir:!Object(_.b)(s,"is_dir")}))}},r.a.createElement("span",{className:"icon-checkbox-".concat(Object(_.b)(s,"is_dir")?"":"un","checked")})," This hash is a directory."),r.a.createElement("footer",null,r.a.createElement("button",{type:"button",onClick:function(e){return Z("delete",s.hash)},disabled:U.loading},"delete"),r.a.createElement("button",{type:"submit",onClick:function(e){return Z("upsert",s)},disabled:U.loading},"upsert")))))},null))),document.getElementById("root"))}},[[24,2,1]]]);
//# sourceMappingURL=main.78d272c6.chunk.js.map