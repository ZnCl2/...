public void rect(int px, int py, int w, int h, int c, IntBuffer screen) 
{
    int wmax = screen.getWidth();
    int hmax = screen.getHeight();
    
    int x = px - (w>>1);
    int y = py - (h>>1);
    
    int xoff = (x<0)?-x:0;
    int yoff = (y<0)?-y:0;
    w = ((w+x) >= wmax)? -x+wmax :w;
    h = ((h+y) >= hmax)? -y+hmax :h;
    
    for (int j=yoff,k=h; j<k; j++)
    for (int i=xoff,l=w; i<l; i++)
        screen.plot(i+x, j+y, c);
}